<!-- HTML header for doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libMesh: libMesh::UniformRefinementEstimator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="../styles.css" rel="stylesheet" type="text/css" />
<link href="doxygen_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <nav id="fixedbar">
    <ul id="fixednav">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../support.html">About Us</a></li>
      <li><a href="../publications.html">Publications</a></li>
      <li><a href="../developers.html">Developers</a></li>
      <li><a href="../installation.html">Installation</a></li>
      <li><a href="../examples.html">Examples</a></li>
      <li><a href="../doxygen/index.html">Documentation</a></li>
    </ul>
  </nav>
  <div id="w">
    <header id="logo"><a href="index.html"><span id="logobg">SomeWebsiteLogo</span></a></header>
    <nav id="navigation">
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../support.html">About Us</a></li>
        <li><a href="../publications.html">Publications</a></li>
        <li><a href="../developers.html">Developers</a></li>
        <li><a href="../installation.html">Installation</a></li>
        <li><a href="../examples.html">Examples</a></li>
        <li><a href="../doxygen/index.html">Documentation</a></li>
      </ul>
    </nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <\!--BEGIN TITLEAREA-\-> -->
<!-- <div id="titlearea"> -->
<!-- <table cellspacing="0" cellpadding="0"> -->
<!--  <tbody> -->
<!--  <tr style="height: 56px;"> -->
<!--   <\!--BEGIN PROJECT_LOGO-\-> -->
<!--   <td id="projectlogo"><img alt="Logo" src=""/></td> -->
<!--   <\!--END PROJECT_LOGO-\-> -->
<!--   <\!--BEGIN PROJECT_NAME-\-> -->
<!--   <td style="padding-left: 0.5em;"> -->
<!--    <div id="projectname">libMesh -->
<!--    <\!--BEGIN PROJECT_NUMBER-\->&#160;<span id="projectnumber"></span><\!--END PROJECT_NUMBER-\-> -->
<!--    </div> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-><div id="projectbrief"></div><\!--END PROJECT_BRIEF-\-> -->
<!--   </td> -->
<!--   <\!--END PROJECT_NAME-\-> -->
<!--   <\!--BEGIN !PROJECT_NAME-\-> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-> -->
<!--     <td style="padding-left: 0.5em;"> -->
<!--     <div id="projectbrief"></div> -->
<!--     </td> -->
<!--    <\!--END PROJECT_BRIEF-\-> -->
<!--   <\!--END !PROJECT_NAME-\-> -->
<!--   <\!--BEGIN DISABLE_INDEX-\-> -->
<!--    <\!--BEGIN SEARCHENGINE-\-> -->
<!--    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td> -->
<!--    <\!--END SEARCHENGINE-\-> -->
<!--   <\!--END DISABLE_INDEX-\-> -->
<!--  </tr> -->
<!--  </tbody> -->
<!-- </table> -->
<!-- </div> -->
<!-- <\!--END TITLEAREA-\-> -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classlibMesh_1_1UniformRefinementEstimator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::UniformRefinementEstimator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="uniform__refinement__estimator_8h_source.html">uniform_refinement_estimator.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for libMesh::UniformRefinementEstimator:</div>
<div class="dyncontent">
<div class="center"><img src="classlibMesh_1_1UniformRefinementEstimator__inherit__graph.png" border="0" usemap="#libMesh_1_1UniformRefinementEstimator_inherit__map" alt="Inheritance graph"/></div>
<map name="libMesh_1_1UniformRefinementEstimator_inherit__map" id="libMesh_1_1UniformRefinementEstimator_inherit__map">
<area shape="rect" id="node2" href="classlibMesh_1_1ErrorEstimator.html" title="libMesh::ErrorEstimator" alt="" coords="20,5,181,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a662486f8192c2f70733efa723a9fb336"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::pair&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int &gt;, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a></td></tr>
<tr class="separator:a662486f8192c2f70733efa723a9fb336"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a624b544253bac5b2f48624df7bc5717c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a624b544253bac5b2f48624df7bc5717c">UniformRefinementEstimator</a> ()</td></tr>
<tr class="separator:a624b544253bac5b2f48624df7bc5717c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00899c7decd3d8aeb44c957e60185418"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a00899c7decd3d8aeb44c957e60185418">UniformRefinementEstimator</a> (const <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;)=default</td></tr>
<tr class="separator:a00899c7decd3d8aeb44c957e60185418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa590d4c24eece91b44be618db03173eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#aa590d4c24eece91b44be618db03173eb">UniformRefinementEstimator</a> (<a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&amp;)=default</td></tr>
<tr class="separator:aa590d4c24eece91b44be618db03173eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb1a2cd13e58631f50d7e5e0406cf3ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#abb1a2cd13e58631f50d7e5e0406cf3ad">operator=</a> (const <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;)=default</td></tr>
<tr class="separator:abb1a2cd13e58631f50d7e5e0406cf3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1093a882cfc326ba4d4ee591a55157a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a1093a882cfc326ba4d4ee591a55157a4">operator=</a> (<a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&amp;)=default</td></tr>
<tr class="separator:a1093a882cfc326ba4d4ee591a55157a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa97201c833c01188b6d7d0aa87e332fb"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#aa97201c833c01188b6d7d0aa87e332fb">~UniformRefinementEstimator</a> ()=default</td></tr>
<tr class="separator:aa97201c833c01188b6d7d0aa87e332fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b4d100efdd6e093b90e0ea3951f67d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#af4b4d100efdd6e093b90e0ea3951f67d">estimate_error</a> (const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *solution_vector=nullptr, bool estimate_parent_error=false) override</td></tr>
<tr class="separator:af4b4d100efdd6e093b90e0ea3951f67d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a8763fa2f4a7999a38bdc8afe7d2566"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a8a8763fa2f4a7999a38bdc8afe7d2566">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;error_norms, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false) override</td></tr>
<tr class="separator:a8a8763fa2f4a7999a38bdc8afe7d2566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a12902561609d903b2a0404bfe808f0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a7a12902561609d903b2a0404bfe808f0">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a> &amp;errors_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false) override</td></tr>
<tr class="separator:a7a12902561609d903b2a0404bfe808f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a609d6a6006b38e8c2f841556b88344e4"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a609d6a6006b38e8c2f841556b88344e4">type</a> () const override</td></tr>
<tr class="separator:a609d6a6006b38e8c2f841556b88344e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a56a3616889bb1dd45d39bfea2bc90e71"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">number_h_refinements</a></td></tr>
<tr class="separator:a56a3616889bb1dd45d39bfea2bc90e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacb05f92e83591d82273cf51df20c9a1"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">number_p_refinements</a></td></tr>
<tr class="separator:aacb05f92e83591d82273cf51df20c9a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a></td></tr>
<tr class="separator:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a871c80eb88e30dac850bbb198a21a129"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a871c80eb88e30dac850bbb198a21a129">_estimate_error</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> *equation_systems, const <a class="el" href="classlibMesh_1_1System.html">System</a> *system, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> *error_per_cell, std::map&lt; std::pair&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int &gt;, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> *&gt; *errors_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; *error_norms, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</td></tr>
<tr class="separator:a871c80eb88e30dac850bbb198a21a129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a5807a86e0751edc399afa2ac44ae89"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a6a5807a86e0751edc399afa2ac44ae89">reduce_error</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;error_per_cell, const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;comm) const</td></tr>
<tr class="separator:a6a5807a86e0751edc399afa2ac44ae89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements a `&lsquo;brute force&rsquo;' error estimator which integrates differences between the current solution and the solution on a uniformly refined (in h and/or p, for an arbitrary number of levels) grid.</p>
<dl class="section author"><dt>Author</dt><dd>Roy H. Stogner </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2006 </dd></dl>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8h_source.html#l00045">45</a> of file <a class="el" href="uniform__refinement__estimator_8h_source.html">uniform_refinement_estimator.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a662486f8192c2f70733efa723a9fb336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a662486f8192c2f70733efa723a9fb336">&#9670;&nbsp;</a></span>ErrorMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::pair&lt;const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int&gt;, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> *&gt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">libMesh::ErrorEstimator::ErrorMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>When calculating many error vectors at once, we need a data structure to hold them all </p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8h_source.html#l00124">124</a> of file <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a624b544253bac5b2f48624df7bc5717c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a624b544253bac5b2f48624df7bc5717c">&#9670;&nbsp;</a></span>UniformRefinementEstimator() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::UniformRefinementEstimator::UniformRefinementEstimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Sets the most common default parameter values. </p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8C_source.html#l00053">53</a> of file <a class="el" href="uniform__refinement__estimator_8C_source.html">uniform_refinement_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="error__estimator_8h_source.html#l00161">libMesh::ErrorEstimator::error_norm</a>, and <a class="el" href="enum__norm__type_8h_source.html#l00037">libMesh::H1</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                                       :</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="classlibMesh_1_1ErrorEstimator.html#abd4e67c1f8f49543f64859513208faa4">ErrorEstimator</a>(),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">number_h_refinements</a>(1),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">number_p_refinements</a>(0)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938">H1</a>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1UniformRefinementEstimator_html_a56a3616889bb1dd45d39bfea2bc90e71"><div class="ttname"><a href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">libMesh::UniformRefinementEstimator::number_h_refinements</a></div><div class="ttdeci">unsigned char number_h_refinements</div><div class="ttdef"><b>Definition:</b> <a href="uniform__refinement__estimator_8h_source.html#l00116">uniform_refinement_estimator.h:116</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938"><div class="ttname"><a href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938">libMesh::H1</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__norm__type_8h_source.html#l00037">enum_norm_type.h:37</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00161">error_estimator.h:161</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_abd4e67c1f8f49543f64859513208faa4"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#abd4e67c1f8f49543f64859513208faa4">libMesh::ErrorEstimator::ErrorEstimator</a></div><div class="ttdeci">ErrorEstimator()=default</div></div>
<div class="ttc" id="classlibMesh_1_1UniformRefinementEstimator_html_aacb05f92e83591d82273cf51df20c9a1"><div class="ttname"><a href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">libMesh::UniformRefinementEstimator::number_p_refinements</a></div><div class="ttdeci">unsigned char number_p_refinements</div><div class="ttdef"><b>Definition:</b> <a href="uniform__refinement__estimator_8h_source.html#l00121">uniform_refinement_estimator.h:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00899c7decd3d8aeb44c957e60185418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00899c7decd3d8aeb44c957e60185418">&#9670;&nbsp;</a></span>UniformRefinementEstimator() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::UniformRefinementEstimator::UniformRefinementEstimator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copy/move ctor, copy/move assignment operator, and destructor are all explicitly defaulted for this simple class. </p>

</div>
</div>
<a id="aa590d4c24eece91b44be618db03173eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa590d4c24eece91b44be618db03173eb">&#9670;&nbsp;</a></span>UniformRefinementEstimator() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::UniformRefinementEstimator::UniformRefinementEstimator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa97201c833c01188b6d7d0aa87e332fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa97201c833c01188b6d7d0aa87e332fb">&#9670;&nbsp;</a></span>~UniformRefinementEstimator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual libMesh::UniformRefinementEstimator::~UniformRefinementEstimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a871c80eb88e30dac850bbb198a21a129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871c80eb88e30dac850bbb198a21a129">&#9670;&nbsp;</a></span>_estimate_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::UniformRefinementEstimator::_estimate_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> *&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> *&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> *&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::pair&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int &gt;, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> *&gt; *&#160;</td>
          <td class="paramname"><em>errors_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; *&#160;</td>
          <td class="paramname"><em>error_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The code for estimate_error and both estimate_errors versions is very similar, so we use the same function for all three </p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">117</a> of file <a class="el" href="uniform__refinement__estimator_8C_source.html">uniform_refinement_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="equation__systems_8C_source.html#l00476">libMesh::EquationSystems::adjoint_solve()</a>, <a class="el" href="system_8h_source.html#l02300">libMesh::System::adjoint_solve()</a>, <a class="el" href="classlibMesh_1_1FEGenericBase.html#a92798d25cf244b4258e97b19c893537e">libMesh::FEGenericBase&lt; OutputType &gt;::build()</a>, <a class="el" href="numeric__vector_8C_source.html#l00048">libMesh::NumericVector&lt; T &gt;::build()</a>, <a class="el" href="numeric__vector_8h_source.html#l00796">libMesh::NumericVector&lt; T &gt;::clear()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="system_8h_source.html#l01535">libMesh::System::current_local_solution</a>, <a class="el" href="system_8C_source.html#l00194">libMesh::System::current_solution()</a>, <a class="el" href="fe__type_8C_source.html#l00031">libMesh::FEType::default_quadrature_rule()</a>, <a class="el" href="system_8h_source.html#l02275">libMesh::System::disable_cache()</a>, <a class="el" href="dof__map_8C_source.html#l01930">libMesh::DofMap::dof_indices()</a>, <a class="el" href="error__estimator_8h_source.html#l00161">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="libmesh__common_8h_source.html#l00202">libMesh::ErrorVectorReal</a>, <a class="el" href="numeric__vector_8h_source.html#l00806">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="system_8C_source.html#l00969">libMesh::System::get_adjoint_solution()</a>, <a class="el" href="system_8h_source.html#l02049">libMesh::System::get_dof_map()</a>, <a class="el" href="system_8h_source.html#l00712">libMesh::System::get_equation_systems()</a>, <a class="el" href="equation__systems_8h_source.html#l00622">libMesh::EquationSystems::get_mesh()</a>, <a class="el" href="dof__map_8h_source.html#l00450">libMesh::DofMap::get_send_list()</a>, <a class="el" href="equation__systems_8h_source.html#l00742">libMesh::EquationSystems::get_system()</a>, <a class="el" href="system_8C_source.html#l00774">libMesh::System::get_vector()</a>, <a class="el" href="enum__norm__type_8h_source.html#l00037">libMesh::H1</a>, <a class="el" href="enum__norm__type_8h_source.html#l00043">libMesh::H1_SEMINORM</a>, <a class="el" href="enum__norm__type_8h_source.html#l00038">libMesh::H2</a>, <a class="el" href="enum__norm__type_8h_source.html#l00044">libMesh::H2_SEMINORM</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="int__range_8h_source.html#l00104">libMesh::index_range()</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, <a class="el" href="enum__norm__type_8h_source.html#l00036">libMesh::L2</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="system_8h_source.html#l02278">libMesh::System::n_qois()</a>, <a class="el" href="equation__systems_8h_source.html#l00637">libMesh::EquationSystems::n_systems()</a>, <a class="el" href="tecplot__io_8C_source.html#l00069">n_vars</a>, <a class="el" href="system_8h_source.html#l02105">libMesh::System::n_vars()</a>, <a class="el" href="tensor__tools_8h_source.html#l00070">libMesh::TensorTools::norm_sq()</a>, <a class="el" href="type__vector_8h_source.html#l00943">libMesh::TypeVector&lt; T &gt;::norm_sq()</a>, <a class="el" href="type__tensor_8h_source.html#l01299">libMesh::TypeTensor&lt; T &gt;::norm_sq()</a>, <a class="el" href="uniform__refinement__estimator_8h_source.html#l00116">number_h_refinements</a>, <a class="el" href="uniform__refinement__estimator_8h_source.html#l00121">number_p_refinements</a>, <a class="el" href="elem_8h_source.html#l02479">libMesh::Elem::parent()</a>, <a class="el" href="system_8h_source.html#l00794">libMesh::System::project_solution_on_reinit()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, <a class="el" href="error__estimator_8C_source.html#l00032">libMesh::ErrorEstimator::reduce_error()</a>, <a class="el" href="equation__systems_8C_source.html#l00121">libMesh::EquationSystems::reinit()</a>, <a class="el" href="system_8C_source.html#l00716">libMesh::System::request_vector()</a>, <a class="el" href="enum__parallel__type_8h_source.html#l00035">libMesh::SERIAL</a>, <a class="el" href="system_8h_source.html#l01523">libMesh::System::solution</a>, <a class="el" href="equation__systems_8C_source.html#l00456">libMesh::EquationSystems::solve()</a>, <a class="el" href="system_8h_source.html#l00326">libMesh::System::solve()</a>, <a class="el" href="numeric__vector_8h_source.html#l00974">libMesh::NumericVector&lt; T &gt;::swap()</a>, <a class="el" href="system__norm_8C_source.html#l00110">libMesh::SystemNorm::type()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">libMesh::MeshRefinement::uniformly_coarsen()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01661">libMesh::MeshRefinement::uniformly_p_coarsen()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01647">libMesh::MeshRefinement::uniformly_p_refine()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01676">libMesh::MeshRefinement::uniformly_refine()</a>, <a class="el" href="system_8C_source.html#l00408">libMesh::System::update()</a>, <a class="el" href="dof__map_8h_source.html#l01792">libMesh::DofMap::variable_type()</a>, <a class="el" href="system_8h_source.html#l02245">libMesh::System::vectors_begin()</a>, <a class="el" href="system_8h_source.html#l02257">libMesh::System::vectors_end()</a>, and <a class="el" href="system__norm_8C_source.html#l00175">libMesh::SystemNorm::weight_sq()</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00069">estimate_error()</a>, and <a class="el" href="uniform__refinement__estimator_8C_source.html#l00086">estimate_errors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// Get a vector of the Systems we&#39;re going to work on,</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// and set up a error_norms map if necessary</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  std::vector&lt;System *&gt; system_list;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  std::unique_ptr&lt;std::map&lt;const System *, SystemNorm&gt;&gt; error_norms =</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    std::unique_ptr&lt;std::map&lt;const System *, SystemNorm&gt;&gt;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    (<span class="keyword">new</span> std::map&lt;const System *, SystemNorm&gt;);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (_es)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      libmesh_assert(!_system);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      libmesh_assert(_es-&gt;n_systems());</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      _system = &amp;(_es-&gt;get_system(0));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      libmesh_assert_equal_to (&amp;(_system-&gt;get_equation_systems()), _es);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      libmesh_assert(_es-&gt;n_systems());</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != _es-&gt;n_systems(); ++i)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// We have to break the rules here, because we can&#39;t refine a const System</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        system_list.push_back(const_cast&lt;System *&gt;(&amp;(_es-&gt;get_system(i))));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="comment">// If we&#39;re computing one vector, we need to know how to scale</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">// each variable&#39;s contributions to it.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">if</span> (_error_norms)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          libmesh_assert(!errors_per_cell);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">// If we&#39;re computing many vectors, we just need to know which</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// variables to skip</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          libmesh_assert (errors_per_cell);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          _error_norms = error_norms.get();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i!= _es-&gt;n_systems(); ++i)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;              <span class="keyword">const</span> System &amp; sys = _es-&gt;get_system(i);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = sys.n_vars();</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;              std::vector&lt;Real&gt; weights(<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>, 0.0);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v != <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; ++v)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                  <span class="keywordflow">if</span> (errors_per_cell-&gt;find(std::make_pair(&amp;sys, v)) ==</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                      errors_per_cell-&gt;end())</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                  weights[v] = 1.0;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              (*error_norms)[&amp;sys] =</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                SystemNorm(std::vector&lt;FEMNormType&gt;(<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>, <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#a9b4c480464ba82ef2c50f78483876cb4">type</a>(0)),</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                           weights);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      libmesh_assert(_system);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">// We have to break the rules here, because we can&#39;t refine a const System</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      system_list.push_back(const_cast&lt;System *&gt;(_system));</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      libmesh_assert(!_error_norms);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      (*error_norms)[_system] = <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      _error_norms = error_norms.get();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// An EquationSystems reference will be convenient.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">// We have to break the rules here, because we can&#39;t refine a const System</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  EquationSystems &amp; es =</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const_cast&lt;</span>EquationSystems &amp;<span class="keyword">&gt;</span>(_system-&gt;get_equation_systems());</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// The current mesh</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  MeshBase &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a> = es.get_mesh();</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// The dimensionality of the mesh</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.mesh_dimension();</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// Resize the error_per_cell vectors to be</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// the number of elements, initialize them to 0.</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">if</span> (error_per_cell)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      error_per_cell-&gt;clear();</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      error_per_cell-&gt;resize (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.max_elem_id(), 0.);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      libmesh_assert(errors_per_cell);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : *errors_per_cell)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          ErrorVector * e = pr.second;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          e-&gt;clear();</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          e-&gt;resize(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.max_elem_id(), 0.);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// We&#39;ll want to back up all coarse grid vectors</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  std::vector&lt;std::map&lt;std::string, std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt;&gt;&gt; coarse_vectors(system_list.size());</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  std::vector&lt;std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt;&gt; coarse_solutions(system_list.size());</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  std::vector&lt;std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt;&gt; coarse_local_solutions(system_list.size());</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// And make copies of projected solutions</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  std::vector&lt;std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt;&gt; projected_solutions(system_list.size());</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// And we&#39;ll need to temporarily change solution projection settings</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  std::vector&lt;bool&gt; old_projection_settings(system_list.size());</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// And it&#39;ll be best to avoid any repartitioning</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  std::unique_ptr&lt;Partitioner&gt; old_partitioner(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.partitioner().release());</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// And we can&#39;t allow any renumbering</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> old_renumbering_setting = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.allow_renumbering();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.allow_renumbering(<span class="keyword">false</span>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(system_list))</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      System &amp; system = *system_list[i];</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="comment">// Check for valid error_norms</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      libmesh_assert (_error_norms-&gt;find(&amp;system) !=</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                      _error_norms-&gt;end());</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">// Back up the solution vector</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      coarse_solutions[i] = system.solution-&gt;clone();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      coarse_local_solutions[i] = system.current_local_solution-&gt;clone();</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// Back up all other coarse grid vectors</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classlibMesh_1_1System.html#aeabc80381862f579b9bf8c17d084689b">System::vectors_iterator</a> vec = system.vectors_begin(); vec !=</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;             system.vectors_end(); ++vec)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <span class="comment">// The (string) name of this vector</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="keyword">const</span> std::string &amp; var_name = vec-&gt;first;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          coarse_vectors[i][var_name] = vec-&gt;second-&gt;clone();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">// Use a non-standard solution vector if necessary</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">if</span> (solution_vectors &amp;&amp;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          solution_vectors-&gt;find(&amp;system) != solution_vectors-&gt;end() &amp;&amp;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          solution_vectors-&gt;find(&amp;system)-&gt;second &amp;&amp;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          solution_vectors-&gt;find(&amp;system)-&gt;second != system.solution.get())</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          NumericVector&lt;Number&gt; * newsol =</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keyword">const_cast&lt;</span>NumericVector&lt;Number&gt; *<span class="keyword">&gt;</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            (solution_vectors-&gt;find(&amp;system)-&gt;second);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          newsol-&gt;swap(*system.solution);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          system.update();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// Make sure the solution is projected when we refine the mesh</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      old_projection_settings[i] = system.project_solution_on_reinit();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      system.project_solution_on_reinit() = <span class="keyword">true</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// Find the number of coarse mesh elements, to make it possible</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// to find correct coarse elem ids later</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> max_coarse_elem_id = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.max_elem_id();</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// n_coarse_elem is only used in an assertion later so</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// avoid declaring it unless asserts are active.</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_coarse_elem = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.n_elem();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// Uniformly refine the mesh</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  MeshRefinement mesh_refinement(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  libmesh_assert (<a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">number_h_refinements</a> &gt; 0 || <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">number_p_refinements</a> &gt; 0);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// FIXME: this may break if there is more than one System</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// on this mesh but estimate_error was still called instead of</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// estimate_errors</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i != <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">number_h_refinements</a>; ++i)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      mesh_refinement.uniformly_refine(1);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      es.reinit();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i != <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">number_p_refinements</a>; ++i)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      mesh_refinement.uniformly_p_refine(1);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      es.reinit();</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(system_list))</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      System &amp; system = *system_list[i];</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">// Copy the projected coarse grid solutions, which will be</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">// overwritten by solve()</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      projected_solutions[i] = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(system.comm());</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      projected_solutions[i]-&gt;init(system.solution-&gt;size(), <span class="keyword">true</span>, <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">SERIAL</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      system.solution-&gt;localize(*projected_solutions[i],</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                system.get_dof_map().get_send_list());</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// Are we doing a forward or an adjoint solve?</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">bool</span> solve_adjoint = <span class="keyword">false</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span> (solution_vectors)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      System * sys = system_list[0];</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      libmesh_assert (solution_vectors-&gt;find(sys) !=</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                      solution_vectors-&gt;end());</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keyword">const</span> NumericVector&lt;Number&gt; * vec = solution_vectors-&gt;find(sys)-&gt;second;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != sys-&gt;n_qois(); ++j)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          std::ostringstream adjoint_name;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          adjoint_name &lt;&lt; <span class="stringliteral">&quot;adjoint_solution&quot;</span> &lt;&lt; j;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <span class="keywordflow">if</span> (vec == sys-&gt;request_vector(adjoint_name.str()))</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;              solve_adjoint = <span class="keyword">true</span>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// Get the uniformly refined solution.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">if</span> (_es)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="comment">// Even if we had a decent preconditioner, valid matrix etc. before</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">// refinement, we don&#39;t any more.</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != es.n_systems(); ++i)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        es.get_system(i).disable_cache();</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="comment">// No specified vectors == forward solve</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">if</span> (!solution_vectors)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        es.solve();</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          libmesh_assert_equal_to (solution_vectors-&gt;size(), es.n_systems());</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          libmesh_assert (solution_vectors-&gt;find(system_list[0]) !=</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                          solution_vectors-&gt;end());</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          libmesh_assert(solve_adjoint ||</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                         (solution_vectors-&gt;find(system_list[0])-&gt;second ==</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                          system_list[0]-&gt;solution.get()) ||</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                         !solution_vectors-&gt;find(system_list[0])-&gt;second);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; sys : system_list)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;              libmesh_assert (solution_vectors-&gt;find(sys) !=</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                              solution_vectors-&gt;end());</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;              <span class="keyword">const</span> NumericVector&lt;Number&gt; * vec = solution_vectors-&gt;find(sys)-&gt;second;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;              <span class="keywordflow">if</span> (solve_adjoint)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                  <span class="keywordtype">bool</span> found_vec = <span class="keyword">false</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != sys-&gt;n_qois(); ++j)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                      std::ostringstream adjoint_name;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                      adjoint_name &lt;&lt; <span class="stringliteral">&quot;adjoint_solution&quot;</span> &lt;&lt; j;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                      <span class="keywordflow">if</span> (vec == sys-&gt;request_vector(adjoint_name.str()))</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                        {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                          found_vec = <span class="keyword">true</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  libmesh_assert(found_vec);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                libmesh_assert(vec == sys-&gt;solution.get() || !vec);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="keywordflow">if</span> (solve_adjoint)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;              std::vector&lt;unsigned int&gt; adjs(system_list.size(),</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                             <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;              <span class="comment">// Set up proper initial guesses</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(system_list))</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                  System * sys = system_list[i];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                  libmesh_assert (solution_vectors-&gt;find(sys) !=</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                  solution_vectors-&gt;end());</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                  <span class="keyword">const</span> NumericVector&lt;Number&gt; * vec = solution_vectors-&gt;find(sys)-&gt;second;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0, n_qois = sys-&gt;n_qois();</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                       j != n_qois; ++j)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                      std::ostringstream adjoint_name;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                      adjoint_name &lt;&lt; <span class="stringliteral">&quot;adjoint_solution&quot;</span> &lt;&lt; j;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                      <span class="keywordflow">if</span> (vec == sys-&gt;request_vector(adjoint_name.str()))</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                          adjs[i] = j;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                  libmesh_assert_not_equal_to (adjs[i], <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                  sys-&gt;get_adjoint_solution(adjs[i]) = *sys-&gt;solution;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;              es.adjoint_solve();</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;              <span class="comment">// Put the adjoint_solution into solution for</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;              <span class="comment">// comparisons</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(system_list))</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                  system_list[i]-&gt;get_adjoint_solution(adjs[i]).swap(*system_list[i]-&gt;solution);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                  system_list[i]-&gt;update();</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            es.solve();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      System * sys = system_list[0];</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="comment">// Even if we had a decent preconditioner, valid matrix etc. before</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="comment">// refinement, we don&#39;t any more.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      sys-&gt;disable_cache();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="comment">// No specified vectors == forward solve</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">if</span> (!solution_vectors)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        sys-&gt;solve();</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          libmesh_assert (solution_vectors-&gt;find(sys) !=</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                          solution_vectors-&gt;end());</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          <span class="keyword">const</span> NumericVector&lt;Number&gt; * vec = solution_vectors-&gt;find(sys)-&gt;second;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          libmesh_assert(solve_adjoint ||</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                         (solution_vectors-&gt;find(sys)-&gt;second ==</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                          sys-&gt;solution.get()) ||</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                         !solution_vectors-&gt;find(sys)-&gt;second);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          <span class="keywordflow">if</span> (solve_adjoint)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> adj = <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0, n_qois = sys-&gt;n_qois();</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                   j != n_qois; ++j)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                  std::ostringstream adjoint_name;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                  adjoint_name &lt;&lt; <span class="stringliteral">&quot;adjoint_solution&quot;</span> &lt;&lt; j;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                  <span class="keywordflow">if</span> (vec == sys-&gt;request_vector(adjoint_name.str()))</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                      adj = j;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;              libmesh_assert_not_equal_to (adj, <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;              <span class="comment">// Set up proper initial guess</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;              sys-&gt;get_adjoint_solution(adj) = *sys-&gt;solution;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;              sys-&gt;adjoint_solve();</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;              <span class="comment">// Put the adjoint_solution into solution for</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;              <span class="comment">// comparisons</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;              sys-&gt;get_adjoint_solution(adj).swap(*sys-&gt;solution);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;              sys-&gt;update();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            sys-&gt;solve();</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// Get the error in the uniformly refined solution(s).</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> sysnum : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(system_list))</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      System &amp; system = *system_list[sysnum];</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = system.n_vars();</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      DofMap &amp; dof_map = system.get_dof_map();</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keyword">const</span> SystemNorm &amp; system_i_norm =</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        _error_norms-&gt;find(&amp;system)-&gt;second;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      NumericVector&lt;Number&gt; * projected_solution = projected_solutions[sysnum].get();</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">// Loop over all the variables in the system</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> var=0; var&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; var++)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          <span class="comment">// Get the error vector to fill for this system and variable</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          ErrorVector * err_vec = error_per_cell;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          <span class="keywordflow">if</span> (!err_vec)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;              libmesh_assert(errors_per_cell);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;              err_vec =</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                (*errors_per_cell)[std::make_pair(&amp;system,var)];</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          <span class="comment">// The type of finite element to use for this variable</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          <span class="keyword">const</span> FEType &amp; fe_type = dof_map.variable_type (var);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          <span class="comment">// Finite element object for each fine element</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          std::unique_ptr&lt;FEBase&gt; fe (<a class="code" href="classlibMesh_1_1FEGenericBase.html#a92798d25cf244b4258e97b19c893537e">FEBase::build</a> (dim, fe_type));</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;          <span class="comment">// Build and attach an appropriate quadrature rule</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;          std::unique_ptr&lt;QBase&gt; qrule = fe_type.default_quadrature_rule(dim);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          fe-&gt;attach_quadrature_rule (qrule.get());</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;          <span class="keyword">const</span> std::vector&lt;Real&gt; &amp;  JxW = fe-&gt;get_JxW();</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt;&gt; &amp; phi = fe-&gt;get_phi();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          <span class="keyword">const</span> std::vector&lt;std::vector&lt;RealGradient&gt;&gt; &amp; dphi =</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            fe-&gt;get_dphi();</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_SECOND_DERIVATIVES</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          <span class="keyword">const</span> std::vector&lt;std::vector&lt;RealTensor&gt;&gt; &amp; d2phi =</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            fe-&gt;get_d2phi();</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          <span class="comment">// The global DOF indices for the fine element</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          std::vector&lt;dof_id_type&gt; dof_indices;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          <span class="comment">// Iterate over all the active elements in the fine mesh</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="comment">// that live on this processor.</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_element_ptr_range())</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;              <span class="comment">// Find the element id for the corresponding coarse grid element</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;              <span class="keyword">const</span> Elem * coarse = elem;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> e_id = coarse-&gt;id();</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;              <span class="keywordflow">while</span> (e_id &gt;= max_coarse_elem_id)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                  libmesh_assert (coarse-&gt;parent());</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                  coarse = coarse-&gt;parent();</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                  e_id = coarse-&gt;id();</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;              <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> L2normsq = 0., H1seminormsq = 0.;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_SECOND_DERIVATIVES</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;              <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> H2seminormsq = 0.;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;              <span class="comment">// reinitialize the element-specific data</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;              <span class="comment">// for the current element</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;              fe-&gt;reinit (elem);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;              <span class="comment">// Get the local to global degree of freedom maps</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;              dof_map.dof_indices (elem, dof_indices, var);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;              <span class="comment">// The number of quadrature points</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_qp = qrule-&gt;n_points();</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;              <span class="comment">// The number of shape functions</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sf =</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                cast_int&lt;unsigned int&gt;(dof_indices.size());</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;              <span class="comment">//</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;              <span class="comment">// Begin the loop over the Quadrature points.</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;              <span class="comment">//</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp=0; qp&lt;n_qp; qp++)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                  <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> u_fine = 0., u_coarse = 0.;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                  <a class="code" href="namespacelibMesh.html#a4b46bf2d57c1815051b6684921702ef2">Gradient</a> grad_u_fine, grad_u_coarse;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_SECOND_DERIVATIVES</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                  <a class="code" href="namespacelibMesh.html#a5f437145a24acdee8c954a449f6389af">Tensor</a> grad2_u_fine, grad2_u_coarse;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                  <span class="comment">// Compute solution values at the current</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                  <span class="comment">// quadrature point.  This requires a sum</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                  <span class="comment">// over all the shape functions evaluated</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                  <span class="comment">// at the quadrature point.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_sf; i++)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                    {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                      u_fine            += phi[i][qp]*system.current_solution (dof_indices[i]);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                      u_coarse          += phi[i][qp]*(*projected_solution) (dof_indices[i]);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                      grad_u_fine       += dphi[i][qp]*system.current_solution (dof_indices[i]);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                      grad_u_coarse     += dphi[i][qp]*(*projected_solution) (dof_indices[i]);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_SECOND_DERIVATIVES</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                      grad2_u_fine      += d2phi[i][qp]*system.current_solution (dof_indices[i]);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                      grad2_u_coarse    += d2phi[i][qp]*(*projected_solution) (dof_indices[i]);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                  <span class="comment">// Compute the value of the error at this quadrature point</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> val_error = u_fine - u_coarse;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                  <span class="comment">// Add the squares of the error to each contribution</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                  <span class="keywordflow">if</span> (system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a71490c0b88084ba46be0c58b19fbedb7">L2</a> ||</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                      system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938">H1</a> ||</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                      system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da">H2</a>)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                      L2normsq += JxW[qp] * system_i_norm.weight_sq(var) *</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        <a class="code" href="namespacelibMesh_1_1TensorTools.html#a04923dfce4c2b77e2d964c9733dcf034">TensorTools::norm_sq</a>(val_error);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                      libmesh_assert_greater_equal (L2normsq, 0.);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                  <span class="comment">// Compute the value of the error in the gradient at this</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                  <span class="comment">// quadrature point</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                  <span class="keywordflow">if</span> (system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938">H1</a> ||</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                      system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da">H2</a> ||</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                      system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a33d26daaa44db9f50ec54fd2108f77ce">H1_SEMINORM</a>)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                    {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                      <a class="code" href="namespacelibMesh.html#a4b46bf2d57c1815051b6684921702ef2">Gradient</a> grad_error = grad_u_fine - grad_u_coarse;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                      H1seminormsq += JxW[qp] * system_i_norm.weight_sq(var) *</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                        grad_error.<a class="code" href="classlibMesh_1_1TypeVector.html#a66b268a0248a2dccd3b129dc6d8c0172">norm_sq</a>();</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                      libmesh_assert_greater_equal (H1seminormsq, 0.);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                  <span class="comment">// Compute the value of the error in the hessian at this</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                  <span class="comment">// quadrature point</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                  <span class="keywordflow">if</span> (system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da">H2</a> ||</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                      system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a98cc51bf727b3607cec0d39d7b3983d5">H2_SEMINORM</a>)</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_SECOND_DERIVATIVES</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                      <a class="code" href="namespacelibMesh.html#a5f437145a24acdee8c954a449f6389af">Tensor</a> grad2_error = grad2_u_fine - grad2_u_coarse;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                      H2seminormsq += JxW[qp] * system_i_norm.weight_sq(var) *</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        grad2_error.<a class="code" href="classlibMesh_1_1TypeTensor.html#abbdaee6daf2a9b75901ecd9edc586955">norm_sq</a>();</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                      libmesh_assert_greater_equal (H2seminormsq, 0.);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                      libmesh_error_msg</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        (<span class="stringliteral">&quot;libMesh was not configured with --enable-second&quot;</span>);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                } <span class="comment">// end qp loop</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;              <span class="keywordflow">if</span> (system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a71490c0b88084ba46be0c58b19fbedb7">L2</a> ||</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                  system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938">H1</a> ||</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                  system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da">H2</a>)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                (*err_vec)[e_id] +=</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                  <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(L2normsq);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;              <span class="keywordflow">if</span> (system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938">H1</a> ||</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                  system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da">H2</a> ||</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                  system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a33d26daaa44db9f50ec54fd2108f77ce">H1_SEMINORM</a>)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                (*err_vec)[e_id] +=</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                  <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(H1seminormsq);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_SECOND_DERIVATIVES</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              <span class="keywordflow">if</span> (system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da">H2</a> ||</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                  system_i_norm.type(var) == <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a98cc51bf727b3607cec0d39d7b3983d5">H2_SEMINORM</a>)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                (*err_vec)[e_id] +=</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                  <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(H2seminormsq);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            } <span class="comment">// End loop over active local elements</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        } <span class="comment">// End loop over variables</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="comment">// Don&#39;t bother projecting the solution; we&#39;ll restore from backup</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="comment">// after coarsening</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      system.project_solution_on_reinit() = <span class="keyword">false</span>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">// Uniformly coarsen the mesh, without projecting the solution</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  libmesh_assert (<a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">number_h_refinements</a> &gt; 0 || <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">number_p_refinements</a> &gt; 0);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i != <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">number_h_refinements</a>; ++i)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      mesh_refinement.uniformly_coarsen(1);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="comment">// FIXME - should the reinits here be necessary? - RHS</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      es.reinit();</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i != <a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">number_p_refinements</a>; ++i)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      mesh_refinement.uniformly_p_coarsen(1);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      es.reinit();</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// We should be back where we started</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  libmesh_assert_equal_to (n_coarse_elem, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.n_elem());</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// Each processor has now computed the error contributions</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">// for its local elements.  We need to sum the vector</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">// and then take the square-root of each component.  Note</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">// that we only need to sum if we are running on multiple</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// processors, and we only need to take the square-root</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">// if the value is nonzero.  There will in general be many</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="comment">// zeros for the inactive elements.</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">if</span> (error_per_cell)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">// First sum the vector of estimated error values</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a6a5807a86e0751edc399afa2ac44ae89">reduce_error</a>(*error_per_cell, es.comm());</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="comment">// Compute the square-root of each component.</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      LOG_SCOPE(<span class="stringliteral">&quot;std::sqrt()&quot;</span>, <span class="stringliteral">&quot;UniformRefinementEstimator&quot;</span>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; val : *error_per_cell)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">if</span> (val != 0.)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          val = std::sqrt(val);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : *errors_per_cell)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;          ErrorVector &amp; e = *(pr.second);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          <span class="comment">// First sum the vector of estimated error values</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a6a5807a86e0751edc399afa2ac44ae89">reduce_error</a>(e, es.comm());</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          <span class="comment">// Compute the square-root of each component.</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          LOG_SCOPE(<span class="stringliteral">&quot;std::sqrt()&quot;</span>, <span class="stringliteral">&quot;UniformRefinementEstimator&quot;</span>);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; val : e)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keywordflow">if</span> (val != 0.)</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;              val = std::sqrt(val);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// Restore old solutions and clean up the heap</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(system_list))</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      System &amp; system = *system_list[i];</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      system.project_solution_on_reinit() = old_projection_settings[i];</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">// Restore the coarse solution vectors and delete their copies</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      *system.solution = *coarse_solutions[i];</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      *system.current_local_solution = *coarse_local_solutions[i];</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classlibMesh_1_1System.html#aeabc80381862f579b9bf8c17d084689b">System::vectors_iterator</a> vec = system.vectors_begin(); vec !=</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;             system.vectors_end(); ++vec)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <span class="comment">// The (string) name of this vector</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="keyword">const</span> std::string &amp; var_name = vec-&gt;first;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          system.get_vector(var_name) = *coarse_vectors[i][var_name];</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          coarse_vectors[i][var_name]-&gt;clear();</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">// Restore old partitioner and renumbering settings</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.partitioner().reset(old_partitioner.release());</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.allow_renumbering(old_renumbering_setting);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1UniformRefinementEstimator_html_a56a3616889bb1dd45d39bfea2bc90e71"><div class="ttname"><a href="classlibMesh_1_1UniformRefinementEstimator.html#a56a3616889bb1dd45d39bfea2bc90e71">libMesh::UniformRefinementEstimator::number_h_refinements</a></div><div class="ttdeci">unsigned char number_h_refinements</div><div class="ttdef"><b>Definition:</b> <a href="uniform__refinement__estimator_8h_source.html#l00116">uniform_refinement_estimator.h:116</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938"><div class="ttname"><a href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a88669f32e92aeb476b5b8f94aa1a9938">libMesh::H1</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__norm__type_8h_source.html#l00037">enum_norm_type.h:37</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00161">error_estimator.h:161</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab64fa61b4505bc7554e508972dfaecd5"><div class="ttname"><a href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">libMesh::index_range</a></div><div class="ttdeci">IntRange&lt; std::size_t &gt; index_range(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00104">int_range.h:104</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00069">tecplot_io.C:69</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00202">libmesh_common.h:202</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2fef831ba9c2670aafb97bcb7e597346a98cc51bf727b3607cec0d39d7b3983d5"><div class="ttname"><a href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a98cc51bf727b3607cec0d39d7b3983d5">libMesh::H2_SEMINORM</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__norm__type_8h_source.html#l00044">enum_norm_type.h:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f"><div class="ttname"><a href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">libMesh::SERIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__parallel__type_8h_source.html#l00035">enum_parallel_type.h:35</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2fef831ba9c2670aafb97bcb7e597346a33d26daaa44db9f50ec54fd2108f77ce"><div class="ttname"><a href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a33d26daaa44db9f50ec54fd2108f77ce">libMesh::H1_SEMINORM</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__norm__type_8h_source.html#l00043">enum_norm_type.h:43</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da"><div class="ttname"><a href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a4010025278fbf76c31b4fc36e6e8d5da">libMesh::H2</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__norm__type_8h_source.html#l00038">enum_norm_type.h:38</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_a9b4c480464ba82ef2c50f78483876cb4"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#a9b4c480464ba82ef2c50f78483876cb4">libMesh::SystemNorm::type</a></div><div class="ttdeci">FEMNormType type(unsigned int var) const</div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00110">system_norm.C:110</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a4b46bf2d57c1815051b6684921702ef2"><div class="ttname"><a href="namespacelibMesh.html#a4b46bf2d57c1815051b6684921702ef2">libMesh::Gradient</a></div><div class="ttdeci">NumberVectorValue Gradient</div><div class="ttdef"><b>Definition:</b> <a href="exact__solution_8h_source.html#l00057">exact_solution.h:57</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEGenericBase_html_a92798d25cf244b4258e97b19c893537e"><div class="ttname"><a href="classlibMesh_1_1FEGenericBase.html#a92798d25cf244b4258e97b19c893537e">libMesh::FEGenericBase::build</a></div><div class="ttdeci">static std::unique_ptr&lt; FEGenericBase &gt; build(const unsigned int dim, const FEType &amp;type)</div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a6a5807a86e0751edc399afa2ac44ae89"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a6a5807a86e0751edc399afa2ac44ae89">libMesh::ErrorEstimator::reduce_error</a></div><div class="ttdeci">void reduce_error(std::vector&lt; ErrorVectorReal &gt; &amp;error_per_cell, const Parallel::Communicator &amp;comm) const</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8C_source.html#l00032">error_estimator.C:32</a></div></div>
<div class="ttc" id="classlibMesh_1_1UniformRefinementEstimator_html_aacb05f92e83591d82273cf51df20c9a1"><div class="ttname"><a href="classlibMesh_1_1UniformRefinementEstimator.html#aacb05f92e83591d82273cf51df20c9a1">libMesh::UniformRefinementEstimator::number_p_refinements</a></div><div class="ttdeci">unsigned char number_p_refinements</div><div class="ttdef"><b>Definition:</b> <a href="uniform__refinement__estimator_8h_source.html#l00121">uniform_refinement_estimator.h:121</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adba4a30965537656bb3b0c6f924ff040"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">libMesh::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package())</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00048">numeric_vector.C:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1System_html_aeabc80381862f579b9bf8c17d084689b"><div class="ttname"><a href="classlibMesh_1_1System.html#aeabc80381862f579b9bf8c17d084689b">libMesh::System::vectors_iterator</a></div><div class="ttdeci">std::map&lt; std::string, NumericVector&lt; Number &gt; * &gt;::iterator vectors_iterator</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00748">system.h:748</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2fef831ba9c2670aafb97bcb7e597346a71490c0b88084ba46be0c58b19fbedb7"><div class="ttname"><a href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a71490c0b88084ba46be0c58b19fbedb7">libMesh::L2</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__norm__type_8h_source.html#l00036">enum_norm_type.h:36</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1TensorTools_html_a04923dfce4c2b77e2d964c9733dcf034"><div class="ttname"><a href="namespacelibMesh_1_1TensorTools.html#a04923dfce4c2b77e2d964c9733dcf034">libMesh::TensorTools::norm_sq</a></div><div class="ttdeci">T norm_sq(T a)</div><div class="ttdef"><b>Definition:</b> <a href="tensor__tools_8h_source.html#l00070">tensor_tools.h:70</a></div></div>
<div class="ttc" id="classlibMesh_1_1TypeVector_html_a66b268a0248a2dccd3b129dc6d8c0172"><div class="ttname"><a href="classlibMesh_1_1TypeVector.html#a66b268a0248a2dccd3b129dc6d8c0172">libMesh::TypeVector::norm_sq</a></div><div class="ttdeci">Real norm_sq() const</div><div class="ttdef"><b>Definition:</b> <a href="type__vector_8h_source.html#l00943">type_vector.h:943</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5f437145a24acdee8c954a449f6389af"><div class="ttname"><a href="namespacelibMesh.html#a5f437145a24acdee8c954a449f6389af">libMesh::Tensor</a></div><div class="ttdeci">NumberTensorValue Tensor</div><div class="ttdef"><b>Definition:</b> <a href="exact__solution_8h_source.html#l00055">exact_solution.h:55</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="classlibMesh_1_1TypeTensor_html_abbdaee6daf2a9b75901ecd9edc586955"><div class="ttname"><a href="classlibMesh_1_1TypeTensor.html#abbdaee6daf2a9b75901ecd9edc586955">libMesh::TypeTensor::norm_sq</a></div><div class="ttdeci">Real norm_sq() const</div><div class="ttdef"><b>Definition:</b> <a href="type__tensor_8h_source.html#l01299">type_tensor.h:1299</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af4b4d100efdd6e093b90e0ea3951f67d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b4d100efdd6e093b90e0ea3951f67d">&#9670;&nbsp;</a></span>estimate_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::UniformRefinementEstimator::estimate_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>solution_vector</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function does uniform refinements and a solve to get an improved solution on each cell, then estimates the error by integrating differences between the coarse and fine solutions.</p>
<p>system.solve() must be called, and so should have no side effects.</p>
<p>Only the provided system is solved on the refined mesh; for problems decoupled into multiple systems, use of <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a8a8763fa2f4a7999a38bdc8afe7d2566">estimate_errors()</a> should be more reliable.</p>
<p>The estimated error is output in the vector <code>error_per_cell</code> </p>

<p>Implements <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8C_source.html#l00069">69</a> of file <a class="el" href="uniform__refinement__estimator_8C_source.html">uniform_refinement_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">_estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;estimate_error()&quot;</span>, <span class="stringliteral">&quot;UniformRefinementEstimator&quot;</span>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  std::map&lt;const System *, const NumericVector&lt;Number&gt; *&gt; solution_vectors;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  solution_vectors[&amp;_system] = solution_vector;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a871c80eb88e30dac850bbb198a21a129">_estimate_error</a> (<span class="keyword">nullptr</span>,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                         &amp;_system,</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                         &amp;error_per_cell,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                         <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                         <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                         &amp;solution_vectors,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                         estimate_parent_error);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1UniformRefinementEstimator_html_a871c80eb88e30dac850bbb198a21a129"><div class="ttname"><a href="classlibMesh_1_1UniformRefinementEstimator.html#a871c80eb88e30dac850bbb198a21a129">libMesh::UniformRefinementEstimator::_estimate_error</a></div><div class="ttdeci">virtual void _estimate_error(const EquationSystems *equation_systems, const System *system, ErrorVector *error_per_cell, std::map&lt; std::pair&lt; const System *, unsigned int &gt;, ErrorVector *&gt; *errors_per_cell, const std::map&lt; const System *, SystemNorm &gt; *error_norms, const std::map&lt; const System *, const NumericVector&lt; Number &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</div><div class="ttdef"><b>Definition:</b> <a href="uniform__refinement__estimator_8C_source.html#l00117">uniform_refinement_estimator.C:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a8763fa2f4a7999a38bdc8afe7d2566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a8763fa2f4a7999a38bdc8afe7d2566">&#9670;&nbsp;</a></span>estimate_errors() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::UniformRefinementEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Currently this function ignores the error_norm member variable, and uses the function argument error_norms instead.</p>
<p>This function is named estimate_errors instead of estimate_error because otherwise C++ can get confused. </p>

<p>Reimplemented from <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a513952f2b4a0b30834c04e1411cd030f">libMesh::ErrorEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8C_source.html#l00086">86</a> of file <a class="el" href="uniform__refinement__estimator_8C_source.html">uniform_refinement_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">_estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;estimate_errors()&quot;</span>, <span class="stringliteral">&quot;UniformRefinementEstimator&quot;</span>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a871c80eb88e30dac850bbb198a21a129">_estimate_error</a> (&amp;_es,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                         <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                         &amp;error_per_cell,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                         <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                         &amp;error_norms,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                         solution_vectors,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                         estimate_parent_error);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1UniformRefinementEstimator_html_a871c80eb88e30dac850bbb198a21a129"><div class="ttname"><a href="classlibMesh_1_1UniformRefinementEstimator.html#a871c80eb88e30dac850bbb198a21a129">libMesh::UniformRefinementEstimator::_estimate_error</a></div><div class="ttdeci">virtual void _estimate_error(const EquationSystems *equation_systems, const System *system, ErrorVector *error_per_cell, std::map&lt; std::pair&lt; const System *, unsigned int &gt;, ErrorVector *&gt; *errors_per_cell, const std::map&lt; const System *, SystemNorm &gt; *error_norms, const std::map&lt; const System *, const NumericVector&lt; Number &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</div><div class="ttdef"><b>Definition:</b> <a href="uniform__refinement__estimator_8C_source.html#l00117">uniform_refinement_estimator.C:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a12902561609d903b2a0404bfe808f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a12902561609d903b2a0404bfe808f0">&#9670;&nbsp;</a></span>estimate_errors() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::UniformRefinementEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a> &amp;&#160;</td>
          <td class="paramname"><em>errors_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Currently this function ignores the component_scale member variable, because it calculates each error individually, unscaled.</p>
<p>The user selects which errors get computed by filling a map with error vectors: If errors_per_cell[&amp;system][v] exists, it will be filled with the error values in variable <code>v</code> of <code>system</code> </p>

<p>Reimplemented from <a class="el" href="classlibMesh_1_1ErrorEstimator.html#aa1ddba9905e39aa89ed2aff7438b1b6e">libMesh::ErrorEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8C_source.html#l00102">102</a> of file <a class="el" href="uniform__refinement__estimator_8C_source.html">uniform_refinement_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">_estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;estimate_errors()&quot;</span>, <span class="stringliteral">&quot;UniformRefinementEstimator&quot;</span>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1UniformRefinementEstimator.html#a871c80eb88e30dac850bbb198a21a129">_estimate_error</a> (&amp;_es,</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                         <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                         <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                         &amp;errors_per_cell,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                         <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                         solution_vectors,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                         estimate_parent_error);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1UniformRefinementEstimator_html_a871c80eb88e30dac850bbb198a21a129"><div class="ttname"><a href="classlibMesh_1_1UniformRefinementEstimator.html#a871c80eb88e30dac850bbb198a21a129">libMesh::UniformRefinementEstimator::_estimate_error</a></div><div class="ttdeci">virtual void _estimate_error(const EquationSystems *equation_systems, const System *system, ErrorVector *error_per_cell, std::map&lt; std::pair&lt; const System *, unsigned int &gt;, ErrorVector *&gt; *errors_per_cell, const std::map&lt; const System *, SystemNorm &gt; *error_norms, const std::map&lt; const System *, const NumericVector&lt; Number &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</div><div class="ttdef"><b>Definition:</b> <a href="uniform__refinement__estimator_8C_source.html#l00117">uniform_refinement_estimator.C:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb1a2cd13e58631f50d7e5e0406cf3ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb1a2cd13e58631f50d7e5e0406cf3ad">&#9670;&nbsp;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a>&amp; libMesh::UniformRefinementEstimator::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1093a882cfc326ba4d4ee591a55157a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1093a882cfc326ba4d4ee591a55157a4">&#9670;&nbsp;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a>&amp; libMesh::UniformRefinementEstimator::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html">UniformRefinementEstimator</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a5807a86e0751edc399afa2ac44ae89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a5807a86e0751edc399afa2ac44ae89">&#9670;&nbsp;</a></span>reduce_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::reduce_error </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method takes the local error contributions in <code>error_per_cell</code> from each processor and combines them to get the global error vector. </p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8C_source.html#l00032">32</a> of file <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">libMesh::Parallel::Communicator::sum()</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">_estimate_error()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00055">libMesh::WeightedPatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00153">libMesh::PatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00053">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>, and <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// parallel_object_only();</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">// Each processor has now computed the error contributions</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// for its local elements.  We may need to sum the vector to</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// recover the error for each element.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  comm.sum(error_per_cell);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a609d6a6006b38e8c2f841556b88344e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a609d6a6006b38e8c2f841556b88344e4">&#9670;&nbsp;</a></span>type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a> libMesh::UniformRefinementEstimator::type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The type for the <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> subclass. </dd></dl>

<p>Implements <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a8a3162f59ee5f231d73ab54252cfa8f1">libMesh::ErrorEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8C_source.html#l00063">63</a> of file <a class="el" href="uniform__refinement__estimator_8C_source.html">uniform_refinement_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="enum__error__estimator__type_8h_source.html#l00043">libMesh::UNIFORM_REFINEMENT</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7aaacdbf766a52cb79f11d464e140a3761">UNIFORM_REFINEMENT</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="ttc" id="namespacelibMesh_html_a370493a82a7f09613a0fdc56fc7912b7aaacdbf766a52cb79f11d464e140a3761"><div class="ttname"><a href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7aaacdbf766a52cb79f11d464e140a3761">libMesh::UNIFORM_REFINEMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__error__estimator__type_8h_source.html#l00043">enum_error_estimator_type.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a9d626496b0b6f99f679c4ef4f0a5e46e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d626496b0b6f99f679c4ef4f0a5e46e">&#9670;&nbsp;</a></span>error_norm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> libMesh::ErrorEstimator::error_norm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>When estimating the error in a single system, the <code>error_norm</code> is used to control the scaling and norm choice for each variable. Not all estimators will support all norm choices. The default scaling is for all variables to be weighted equally. The default norm choice depends on the error estimator.</p>
<p>Part of this functionality was supported via component_scale and sobolev_order in older <a class="el" href="namespacelibMesh.html">libMesh</a> versions, and a small part was supported via component_mask in even older versions. Hopefully the encapsulation here will allow us to avoid changing this API again. </p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8h_source.html#l00161">161</a> of file <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">_estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00073">libMesh::AdjointRefinementEstimator::AdjointRefinementEstimator()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00129">libMesh::DiscontinuityMeasure::boundary_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00135">libMesh::KellyErrorEstimator::boundary_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00041">libMesh::DiscontinuityMeasure::DiscontinuityMeasure()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00053">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00060">libMesh::AdjointResidualErrorEstimator::estimate_error()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="error__estimator_8C_source.html#l00047">libMesh::ErrorEstimator::estimate_errors()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00048">libMesh::ExactErrorEstimator::ExactErrorEstimator()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00401">libMesh::ExactErrorEstimator::find_squared_element_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00063">libMesh::LaplacianErrorEstimator::init_context()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00059">libMesh::DiscontinuityMeasure::init_context()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00059">libMesh::KellyErrorEstimator::init_context()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">libMesh::DiscontinuityMeasure::internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00041">libMesh::KellyErrorEstimator::KellyErrorEstimator()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00046">libMesh::LaplacianErrorEstimator::LaplacianErrorEstimator()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00112">libMesh::WeightedPatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00210">libMesh::PatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00065">libMesh::PatchRecoveryErrorEstimator::PatchRecoveryErrorEstimator()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00424">libMesh::JumpErrorEstimator::reinit_sides()</a>, and <a class="el" href="uniform__refinement__estimator_8C_source.html#l00053">UniformRefinementEstimator()</a>.</p>

</div>
</div>
<a id="a56a3616889bb1dd45d39bfea2bc90e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a3616889bb1dd45d39bfea2bc90e71">&#9670;&nbsp;</a></span>number_h_refinements</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char libMesh::UniformRefinementEstimator::number_h_refinements</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many h refinements to perform to get the fine grid </p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8h_source.html#l00116">116</a> of file <a class="el" href="uniform__refinement__estimator_8h_source.html">uniform_refinement_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">_estimate_error()</a>.</p>

</div>
</div>
<a id="aacb05f92e83591d82273cf51df20c9a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacb05f92e83591d82273cf51df20c9a1">&#9670;&nbsp;</a></span>number_p_refinements</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char libMesh::UniformRefinementEstimator::number_p_refinements</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many p refinements to perform to get the fine grid </p>

<p class="definition">Definition at line <a class="el" href="uniform__refinement__estimator_8h_source.html#l00121">121</a> of file <a class="el" href="uniform__refinement__estimator_8h_source.html">uniform_refinement_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">_estimate_error()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="uniform__refinement__estimator_8h_source.html">uniform_refinement_estimator.h</a></li>
<li><a class="el" href="uniform__refinement__estimator_8C_source.html">uniform_refinement_estimator.C</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
generated by <a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a>
</small></address>
<!-- dynamic header stuff -->
<script type="text/javascript">
$(document).ready(function(){
  $(window).on('scroll',function() {
    var scrolltop = $(this).scrollTop();
    if(scrolltop >= 215) {
      $('#fixedbar').fadeIn(250);
    }
    else if(scrolltop <= 210) {
      $('#fixedbar').fadeOut(250);
    }
  });
});
</script>
<!-- Google Analytics stuff -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24978333-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
