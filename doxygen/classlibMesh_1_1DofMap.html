<!-- HTML header for doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libMesh: libMesh::DofMap Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="../styles.css" rel="stylesheet" type="text/css" />
<link href="doxygen_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <nav id="fixedbar">
    <ul id="fixednav">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../support.html">About Us</a></li>
      <li><a href="../publications.html">Publications</a></li>
      <li><a href="../developers.html">Developers</a></li>
      <li><a href="../installation.html">Installation</a></li>
      <li><a href="../examples.html">Examples</a></li>
      <li><a href="../doxygen/index.html">Documentation</a></li>
    </ul>
  </nav>
  <div id="w">
    <header id="logo"><a href="index.html"><span id="logobg">SomeWebsiteLogo</span></a></header>
    <nav id="navigation">
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../support.html">About Us</a></li>
        <li><a href="../publications.html">Publications</a></li>
        <li><a href="../developers.html">Developers</a></li>
        <li><a href="../installation.html">Installation</a></li>
        <li><a href="../examples.html">Examples</a></li>
        <li><a href="../doxygen/index.html">Documentation</a></li>
      </ul>
    </nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <\!--BEGIN TITLEAREA-\-> -->
<!-- <div id="titlearea"> -->
<!-- <table cellspacing="0" cellpadding="0"> -->
<!--  <tbody> -->
<!--  <tr style="height: 56px;"> -->
<!--   <\!--BEGIN PROJECT_LOGO-\-> -->
<!--   <td id="projectlogo"><img alt="Logo" src=""/></td> -->
<!--   <\!--END PROJECT_LOGO-\-> -->
<!--   <\!--BEGIN PROJECT_NAME-\-> -->
<!--   <td style="padding-left: 0.5em;"> -->
<!--    <div id="projectname">libMesh -->
<!--    <\!--BEGIN PROJECT_NUMBER-\->&#160;<span id="projectnumber"></span><\!--END PROJECT_NUMBER-\-> -->
<!--    </div> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-><div id="projectbrief"></div><\!--END PROJECT_BRIEF-\-> -->
<!--   </td> -->
<!--   <\!--END PROJECT_NAME-\-> -->
<!--   <\!--BEGIN !PROJECT_NAME-\-> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-> -->
<!--     <td style="padding-left: 0.5em;"> -->
<!--     <div id="projectbrief"></div> -->
<!--     </td> -->
<!--    <\!--END PROJECT_BRIEF-\-> -->
<!--   <\!--END !PROJECT_NAME-\-> -->
<!--   <\!--BEGIN DISABLE_INDEX-\-> -->
<!--    <\!--BEGIN SEARCHENGINE-\-> -->
<!--    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td> -->
<!--    <\!--END SEARCHENGINE-\-> -->
<!--   <\!--END DISABLE_INDEX-\-> -->
<!--  </tr> -->
<!--  </tbody> -->
<!-- </table> -->
<!-- </div> -->
<!-- <\!--END TITLEAREA-\-> -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1DofMap.html">DofMap</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classlibMesh_1_1DofMap-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::DofMap Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manages the degrees of freedom (DOFs) in a simulation.  
 <a href="classlibMesh_1_1DofMap.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="dof__map_8h_source.html">dof_map.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for libMesh::DofMap:</div>
<div class="dyncontent">
<div class="center"><img src="classlibMesh_1_1DofMap__inherit__graph.png" border="0" usemap="#libMesh_1_1DofMap_inherit__map" alt="Inheritance graph"/></div>
<map name="libMesh_1_1DofMap_inherit__map" id="libMesh_1_1DofMap_inherit__map">
<area shape="rect" id="node2" href="classlibMesh_1_1ReferenceCountedObject.html" title="libMesh::ReferenceCounted\lObject\&lt; DofMap \&gt;" alt="" coords="5,80,192,121"/>
<area shape="rect" id="node3" href="classlibMesh_1_1ReferenceCounter.html" title="Common base for all objects whose creations/destructions are counted. " alt="" coords="7,5,191,32"/>
<area shape="rect" id="node4" href="classlibMesh_1_1ParallelObject.html" title="An object whose state is distributed along a set of processors. " alt="" coords="217,87,375,114"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">AugmentSendList</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html">AugmentSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ade33ee85034b79ffb7febd62a9e8fe97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ade33ee85034b79ffb7febd62a9e8fe97">DofMap</a> (const unsigned int <a class="el" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>, <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>)</td></tr>
<tr class="separator:ade33ee85034b79ffb7febd62a9e8fe97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addb6136725455c3a28e17193d3edf7ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#addb6136725455c3a28e17193d3edf7ee">~DofMap</a> ()</td></tr>
<tr class="separator:addb6136725455c3a28e17193d3edf7ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10200782a0f8fe0c4d3f7bdf10cedc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa10200782a0f8fe0c4d3f7bdf10cedc6">attach_matrix</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix)</td></tr>
<tr class="separator:aa10200782a0f8fe0c4d3f7bdf10cedc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42a8ae63f7d7c5cfeb14b93bb78a3a3f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a42a8ae63f7d7c5cfeb14b93bb78a3a3f">is_attached</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix)</td></tr>
<tr class="separator:a42a8ae63f7d7c5cfeb14b93bb78a3a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab986eb7bbf9bbb5119a49a145306a980"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab986eb7bbf9bbb5119a49a145306a980">distribute_dofs</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:ab986eb7bbf9bbb5119a49a145306a980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49379ce3a542eab41a8f8e44d0f154c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a49379ce3a542eab41a8f8e44d0f154c2">compute_sparsity</a> (const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:a49379ce3a542eab41a8f8e44d0f154c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6481536ea3c70d31fb18fa35bfc88e33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6481536ea3c70d31fb18fa35bfc88e33">clear_sparsity</a> ()</td></tr>
<tr class="separator:a6481536ea3c70d31fb18fa35bfc88e33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02a5778a146177c6965d1bf997878ca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a02a5778a146177c6965d1bf997878ca4">remove_default_ghosting</a> ()</td></tr>
<tr class="separator:a02a5778a146177c6965d1bf997878ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71555fd980f9337928ae75bc36a1bd4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a71555fd980f9337928ae75bc36a1bd4e">add_default_ghosting</a> ()</td></tr>
<tr class="separator:a71555fd980f9337928ae75bc36a1bd4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17b27f47b3731f6ce72312edd957bf7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a> (<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;coupling_functor, bool to_mesh=true)</td></tr>
<tr class="separator:ae17b27f47b3731f6ce72312edd957bf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f8cd289185341279958ce2baaed3fc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2f8cd289185341279958ce2baaed3fc0">remove_coupling_functor</a> (<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;coupling_functor)</td></tr>
<tr class="separator:a2f8cd289185341279958ce2baaed3fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd64cdbcb7af43bb9d35f4e2266ff0b3"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> * &gt;::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acd64cdbcb7af43bb9d35f4e2266ff0b3">coupling_functors_begin</a> () const</td></tr>
<tr class="separator:acd64cdbcb7af43bb9d35f4e2266ff0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e35c4e14684a92a817a75e5b29cddd8"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> * &gt;::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6e35c4e14684a92a817a75e5b29cddd8">coupling_functors_end</a> () const</td></tr>
<tr class="separator:a6e35c4e14684a92a817a75e5b29cddd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa387f2af29a1998bc1236a20a9870b64"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">default_coupling</a> ()</td></tr>
<tr class="separator:aa387f2af29a1998bc1236a20a9870b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0c5eeda42bc54bb3ae1c2d05ec5227"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a> (<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;evaluable_functor, bool to_mesh=true)</td></tr>
<tr class="separator:a9a0c5eeda42bc54bb3ae1c2d05ec5227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf50c47e4d226197777f2aef750b47d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5bf50c47e4d226197777f2aef750b47d">remove_algebraic_ghosting_functor</a> (<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;evaluable_functor)</td></tr>
<tr class="separator:a5bf50c47e4d226197777f2aef750b47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed266bbf799984810031a7c7693ac10"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> * &gt;::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1ed266bbf799984810031a7c7693ac10">algebraic_ghosting_functors_begin</a> () const</td></tr>
<tr class="separator:a1ed266bbf799984810031a7c7693ac10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b52496e0c72a29d73d87e499bb7993"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> * &gt;::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a59b52496e0c72a29d73d87e499bb7993">algebraic_ghosting_functors_end</a> () const</td></tr>
<tr class="separator:a59b52496e0c72a29d73d87e499bb7993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac341c27edd859113d774716d5ad18d9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">default_algebraic_ghosting</a> ()</td></tr>
<tr class="separator:ac341c27edd859113d774716d5ad18d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b0f23dac6f24ce69e7aa1d2077d3b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae0b0f23dac6f24ce69e7aa1d2077d3b8">attach_extra_sparsity_object</a> (<a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html">DofMap::AugmentSparsityPattern</a> &amp;asp)</td></tr>
<tr class="separator:ae0b0f23dac6f24ce69e7aa1d2077d3b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5058fffef0da9dcdc175a0ee63f587d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5058fffef0da9dcdc175a0ee63f587d8">attach_extra_sparsity_function</a> (void(*func)(<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;sparsity, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *), void *context=nullptr)</td></tr>
<tr class="separator:a5058fffef0da9dcdc175a0ee63f587d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50b05ef1b5ff63ad103626f5622729d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae50b05ef1b5ff63ad103626f5622729d">attach_extra_send_list_object</a> (<a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">DofMap::AugmentSendList</a> &amp;asl)</td></tr>
<tr class="separator:ae50b05ef1b5ff63ad103626f5622729d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f672b01ab7060eb641b946abeff74b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a36f672b01ab7060eb641b946abeff74b">attach_extra_send_list_function</a> (void(*func)(std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *), void *context=nullptr)</td></tr>
<tr class="separator:a36f672b01ab7060eb641b946abeff74b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47865aeb6379c68169e926dd0ecc2b71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a47865aeb6379c68169e926dd0ecc2b71">prepare_send_list</a> ()</td></tr>
<tr class="separator:a47865aeb6379c68169e926dd0ecc2b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b8f0990aae87c873d050e33792fe28"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab2b8f0990aae87c873d050e33792fe28">get_send_list</a> () const</td></tr>
<tr class="separator:ab2b8f0990aae87c873d050e33792fe28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af18504bfd61cccfba4878a656b428e4a"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af18504bfd61cccfba4878a656b428e4a">get_n_nz</a> () const</td></tr>
<tr class="separator:af18504bfd61cccfba4878a656b428e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8691c98219d905b8525a7dc5106f973c"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8691c98219d905b8525a7dc5106f973c">get_n_oz</a> () const</td></tr>
<tr class="separator:a8691c98219d905b8525a7dc5106f973c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4133d7ac625a4524f438c6b4589de0f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4133d7ac625a4524f438c6b4589de0f3">add_variable_group</a> (const <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &amp;var_group)</td></tr>
<tr class="separator:a4133d7ac625a4524f438c6b4589de0f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694b0be4a4514f1d7f0775ddfec78d4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a694b0be4a4514f1d7f0775ddfec78d4b">set_error_on_cyclic_constraint</a> (bool error_on_cyclic_constraint)</td></tr>
<tr class="separator:a694b0be4a4514f1d7f0775ddfec78d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df4304dec439a5cabd1d7008a2e3e45"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a> (const unsigned int c) const</td></tr>
<tr class="separator:a7df4304dec439a5cabd1d7008a2e3e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ed397847e6a1c3be2236e2faf622ec"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Variable.html">Variable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">variable</a> (const unsigned int c) const</td></tr>
<tr class="separator:a46ed397847e6a1c3be2236e2faf622ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52dcf2c805ae5b8849eb760ae665a600"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a52dcf2c805ae5b8849eb760ae665a600">variable_order</a> (const unsigned int c) const</td></tr>
<tr class="separator:a52dcf2c805ae5b8849eb760ae665a600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9032dff0b884e2a6951eaafdaa192f0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad9032dff0b884e2a6951eaafdaa192f0">variable_group_order</a> (const unsigned int vg) const</td></tr>
<tr class="separator:ad9032dff0b884e2a6951eaafdaa192f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b731b2150d70797262acdbfaf1b53e8"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1FEType.html">FEType</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">variable_type</a> (const unsigned int c) const</td></tr>
<tr class="separator:a9b731b2150d70797262acdbfaf1b53e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e2386689a26b75068e5bde44fc00b7"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1FEType.html">FEType</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a87e2386689a26b75068e5bde44fc00b7">variable_group_type</a> (const unsigned int vg) const</td></tr>
<tr class="separator:a87e2386689a26b75068e5bde44fc00b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a994ec3105079a55c9432a37e8bbcf5"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a> () const</td></tr>
<tr class="separator:a1a994ec3105079a55c9432a37e8bbcf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b3182cbf57ead72821d826275512b0"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a> () const</td></tr>
<tr class="separator:a25b3182cbf57ead72821d826275512b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe1b4047e5c1f2c0503d06e364173321"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abe1b4047e5c1f2c0503d06e364173321">has_blocked_representation</a> () const</td></tr>
<tr class="separator:abe1b4047e5c1f2c0503d06e364173321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919e7fba5895d6a5a7857874605c58b1"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a919e7fba5895d6a5a7857874605c58b1">block_size</a> () const</td></tr>
<tr class="separator:a919e7fba5895d6a5a7857874605c58b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e989f4bcf03847736e84ff054e41111"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1e989f4bcf03847736e84ff054e41111">n_dofs</a> () const</td></tr>
<tr class="separator:a1e989f4bcf03847736e84ff054e41111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31c7dfd8d972d20ca28e945565a5526"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af31c7dfd8d972d20ca28e945565a5526">n_SCALAR_dofs</a> () const</td></tr>
<tr class="separator:af31c7dfd8d972d20ca28e945565a5526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2879bd4cc7db35e8d94ffd3355c143fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2879bd4cc7db35e8d94ffd3355c143fd">n_local_dofs</a> () const</td></tr>
<tr class="separator:a2879bd4cc7db35e8d94ffd3355c143fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17864ba577f0016a69d81d472655047"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae17864ba577f0016a69d81d472655047">n_dofs_on_processor</a> (const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc) const</td></tr>
<tr class="separator:ae17864ba577f0016a69d81d472655047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3382a9c9fd8c1b92812cec779dee24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9c3382a9c9fd8c1b92812cec779dee24">first_dof</a> (const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc) const</td></tr>
<tr class="separator:a9c3382a9c9fd8c1b92812cec779dee24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94601bbfdd0675c7259adebea917cd13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">first_dof</a> () const</td></tr>
<tr class="separator:a94601bbfdd0675c7259adebea917cd13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fb0c1467e6e44d65c1bc6a181718892"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3fb0c1467e6e44d65c1bc6a181718892">first_old_dof</a> (const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc) const</td></tr>
<tr class="separator:a3fb0c1467e6e44d65c1bc6a181718892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230e63e9bae81249d8b20267a7bb9c2b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a230e63e9bae81249d8b20267a7bb9c2b">first_old_dof</a> () const</td></tr>
<tr class="separator:a230e63e9bae81249d8b20267a7bb9c2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a94100187d0c3a089801dc1ebe40d00"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6a94100187d0c3a089801dc1ebe40d00">last_dof</a> (const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc) const</td></tr>
<tr class="separator:a6a94100187d0c3a089801dc1ebe40d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe087f3cbd7135bbbc1c007d2d27deea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abe087f3cbd7135bbbc1c007d2d27deea">last_dof</a> () const</td></tr>
<tr class="separator:abe087f3cbd7135bbbc1c007d2d27deea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6bba480fbe9bd4364e5ff8545ea0d38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af6bba480fbe9bd4364e5ff8545ea0d38">end_dof</a> (const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc) const</td></tr>
<tr class="separator:af6bba480fbe9bd4364e5ff8545ea0d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08c13836ca9040d9ebfd511549e4da94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">end_dof</a> () const</td></tr>
<tr class="separator:a08c13836ca9040d9ebfd511549e4da94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123a56fff4389e347b6f40a591859eef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a123a56fff4389e347b6f40a591859eef">dof_owner</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof) const</td></tr>
<tr class="separator:a123a56fff4389e347b6f40a591859eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b14cac6dcf52d987a0fbc598edfe470"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7b14cac6dcf52d987a0fbc598edfe470">end_old_dof</a> (const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc) const</td></tr>
<tr class="separator:a7b14cac6dcf52d987a0fbc598edfe470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98aac498dd6a690e8152c5f23d40e1c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a98aac498dd6a690e8152c5f23d40e1c3">end_old_dof</a> () const</td></tr>
<tr class="separator:a98aac498dd6a690e8152c5f23d40e1c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3962af7f276a08be8f22bffd304bdab7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a> (const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *const elem, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di) const</td></tr>
<tr class="separator:a3962af7f276a08be8f22bffd304bdab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46bb224192bd1d99d434c2176cd9f14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac46bb224192bd1d99d434c2176cd9f14">dof_indices</a> (const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *const elem, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn, int p_level=-12345) const</td></tr>
<tr class="separator:ac46bb224192bd1d99d434c2176cd9f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac2a12aa327e27b445818bf0eb87fc8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#afac2a12aa327e27b445818bf0eb87fc8">dof_indices</a> (const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *const node, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di) const</td></tr>
<tr class="separator:afac2a12aa327e27b445818bf0eb87fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9db06d7650334c564ba1b7b3a6e5c1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad9db06d7650334c564ba1b7b3a6e5c1f">dof_indices</a> (const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *const node, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn) const</td></tr>
<tr class="separator:ad9db06d7650334c564ba1b7b3a6e5c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ef75ddf2020ea30f1200cd317c0126"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const</td></tr>
<tr class="separator:aa6ef75ddf2020ea30f1200cd317c0126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8374de5322b20e3e4719c5c04b038291"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8374de5322b20e3e4719c5c04b038291">semilocal_index</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_index) const</td></tr>
<tr class="separator:a8374de5322b20e3e4719c5c04b038291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e77e8156c618833437ebb0f3984aa4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a23e77e8156c618833437ebb0f3984aa4">all_semilocal_indices</a> (const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;<a class="el" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a>) const</td></tr>
<tr class="separator:a23e77e8156c618833437ebb0f3984aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e2c5542effbe52f997e0011218486ff"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_index) const</td></tr>
<tr class="separator:a9e2c5542effbe52f997e0011218486ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4f9eed9d208af06f1b0165451d17ed"><td class="memTemplParams" colspan="2">template&lt;typename DofObjectSubclass &gt; </td></tr>
<tr class="memitem:a3b4f9eed9d208af06f1b0165451d17ed"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3b4f9eed9d208af06f1b0165451d17ed">is_evaluable</a> (const DofObjectSubclass &amp;obj, unsigned int var_num=<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>) const</td></tr>
<tr class="separator:a3b4f9eed9d208af06f1b0165451d17ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb44e4da2c8afcd039995ef239457da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2eb44e4da2c8afcd039995ef239457da">set_implicit_neighbor_dofs</a> (bool implicit_neighbor_dofs)</td></tr>
<tr class="separator:a2eb44e4da2c8afcd039995ef239457da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bf72ada83076ab80eb67d568189f462"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1bf72ada83076ab80eb67d568189f462">use_coupled_neighbor_dofs</a> (const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>) const</td></tr>
<tr class="separator:a1bf72ada83076ab80eb67d568189f462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d2cbc2df5723e1616de1581e878ddf0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4d2cbc2df5723e1616de1581e878ddf0">extract_local_vector</a> (const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;Ug, const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;<a class="el" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a>, <a class="el" href="classlibMesh_1_1DenseVectorBase.html">DenseVectorBase</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;Ue) const</td></tr>
<tr class="separator:a4d2cbc2df5723e1616de1581e878ddf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ce6dda12c7c485f3766d7be119401c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad7ce6dda12c7c485f3766d7be119401c">local_variable_indices</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;idx, const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, unsigned int var_num) const</td></tr>
<tr class="separator:ad7ce6dda12c7c485f3766d7be119401c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376da0a998e9cbd79b82bda6582ecf94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a376da0a998e9cbd79b82bda6582ecf94">n_constrained_dofs</a> () const</td></tr>
<tr class="separator:a376da0a998e9cbd79b82bda6582ecf94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72a20ecabf2b79d288ca4b4cff8782f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab72a20ecabf2b79d288ca4b4cff8782f">n_local_constrained_dofs</a> () const</td></tr>
<tr class="separator:ab72a20ecabf2b79d288ca4b4cff8782f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f28e23df955b3a8c63af68b94be82d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8f28e23df955b3a8c63af68b94be82d4">n_constrained_nodes</a> () const</td></tr>
<tr class="separator:a8f28e23df955b3a8c63af68b94be82d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7892d89bda5e4d39308dcb4e9a982bfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7892d89bda5e4d39308dcb4e9a982bfc">create_dof_constraints</a> (const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> time=0)</td></tr>
<tr class="separator:a7892d89bda5e4d39308dcb4e9a982bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21fda1ca99f13ac340a05a8e41ecc8e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a21fda1ca99f13ac340a05a8e41ecc8e9">allgather_recursive_constraints</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:a21fda1ca99f13ac340a05a8e41ecc8e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db4816e2bba5ce9617e7bee6329de19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3db4816e2bba5ce9617e7bee6329de19">scatter_constraints</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:a3db4816e2bba5ce9617e7bee6329de19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ad8b64590135362f5ac09c581f828bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">gather_constraints</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, std::set&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;unexpanded_dofs, bool look_for_constrainees)</td></tr>
<tr class="separator:a2ad8b64590135362f5ac09c581f828bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae07a8531f8f6a082a473c2e4b17a9ea2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae07a8531f8f6a082a473c2e4b17a9ea2">process_constraints</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:ae07a8531f8f6a082a473c2e4b17a9ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a6ab4b65749be311da80b48f312fd3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a30a6ab4b65749be311da80b48f312fd3">check_for_cyclic_constraints</a> ()</td></tr>
<tr class="separator:a30a6ab4b65749be311da80b48f312fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada019c02054ed5945504a6c5fc856d69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">add_constraint_row</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_number, const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;constraint_row, const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> constraint_rhs, const bool forbid_constraint_overwrite)</td></tr>
<tr class="separator:ada019c02054ed5945504a6c5fc856d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf485df94525efa4993f755c5b65a448"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acf485df94525efa4993f755c5b65a448">add_adjoint_constraint_row</a> (const unsigned int qoi_index, const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_number, const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;constraint_row, const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> constraint_rhs, const bool forbid_constraint_overwrite)</td></tr>
<tr class="separator:acf485df94525efa4993f755c5b65a448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84adefac2c57cc5a76ceae26ef7f9472"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a84adefac2c57cc5a76ceae26ef7f9472">add_constraint_row</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_number, const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;constraint_row, const bool forbid_constraint_overwrite=true)</td></tr>
<tr class="separator:a84adefac2c57cc5a76ceae26ef7f9472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10228d8fb61396223cce22a2f129b749"><td class="memItemLeft" align="right" valign="top">DofConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a10228d8fb61396223cce22a2f129b749">constraint_rows_begin</a> () const</td></tr>
<tr class="separator:a10228d8fb61396223cce22a2f129b749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad98041b12294b87501a840c09bbb99d2"><td class="memItemLeft" align="right" valign="top">DofConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad98041b12294b87501a840c09bbb99d2">constraint_rows_end</a> () const</td></tr>
<tr class="separator:ad98041b12294b87501a840c09bbb99d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f54b69e830ade14656c309586850f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a72f54b69e830ade14656c309586850f8">stash_dof_constraints</a> ()</td></tr>
<tr class="separator:a72f54b69e830ade14656c309586850f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08d2b93738109ef74741d685e063982"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af08d2b93738109ef74741d685e063982">unstash_dof_constraints</a> ()</td></tr>
<tr class="separator:af08d2b93738109ef74741d685e063982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab813d5c9448a6e4cfd9703322195d57"><td class="memItemLeft" align="right" valign="top">NodeConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aab813d5c9448a6e4cfd9703322195d57">node_constraint_rows_begin</a> () const</td></tr>
<tr class="separator:aab813d5c9448a6e4cfd9703322195d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28da578251a8067b50276b006ed75c62"><td class="memItemLeft" align="right" valign="top">NodeConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a28da578251a8067b50276b006ed75c62">node_constraint_rows_end</a> () const</td></tr>
<tr class="separator:a28da578251a8067b50276b006ed75c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3acc1d2a8ab28b00464406deb1d40f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof) const</td></tr>
<tr class="separator:a8a3acc1d2a8ab28b00464406deb1d40f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87c8a1c7e7552562359b4123efc58e14"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a87c8a1c7e7552562359b4123efc58e14">has_heterogenous_adjoint_constraints</a> (const unsigned int qoi_num) const</td></tr>
<tr class="separator:a87c8a1c7e7552562359b4123efc58e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a568e5b1ec17eebb82ac45d537e375d2c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a568e5b1ec17eebb82ac45d537e375d2c">has_heterogenous_adjoint_constraint</a> (const unsigned int qoi_num, const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof) const</td></tr>
<tr class="separator:a568e5b1ec17eebb82ac45d537e375d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b140935368fe85cf0ead6d5a0452c0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4b140935368fe85cf0ead6d5a0452c0b">get_primal_constraint_values</a> ()</td></tr>
<tr class="separator:a4b140935368fe85cf0ead6d5a0452c0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a9aeffe76edfe89cc65a16035b864e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad7a9aeffe76edfe89cc65a16035b864e">is_constrained_node</a> (const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *node) const</td></tr>
<tr class="separator:ad7a9aeffe76edfe89cc65a16035b864e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6419529efffb5e240d7365c778daab8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6419529efffb5e240d7365c778daab8e">print_dof_constraints</a> (std::ostream &amp;os=<a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a>, bool print_nonlocal=false) const</td></tr>
<tr class="separator:a6419529efffb5e240d7365c778daab8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af00f24f96d87b453b8c8233f5a828d60"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af00f24f96d87b453b8c8233f5a828d60">get_local_constraints</a> (bool print_nonlocal=false) const</td></tr>
<tr class="separator:af00f24f96d87b453b8c8233f5a828d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f25fd7893ffeb88979a8f0f2898fdd"><td class="memItemLeft" align="right" valign="top">std::pair&lt; <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a77f25fd7893ffeb88979a8f0f2898fdd">max_constraint_error</a> (const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *v=nullptr) const</td></tr>
<tr class="separator:a77f25fd7893ffeb88979a8f0f2898fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61a0468c8fbc8d9995356028c00a2014"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a61a0468c8fbc8d9995356028c00a2014">constrain_element_matrix</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true) const</td></tr>
<tr class="separator:a61a0468c8fbc8d9995356028c00a2014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7594c80a87b0691ac2d28884ec102249"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7594c80a87b0691ac2d28884ec102249">constrain_element_matrix</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;row_dofs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;col_dofs, bool asymmetric_constraint_rows=true) const</td></tr>
<tr class="separator:a7594c80a87b0691ac2d28884ec102249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a985d73544c865d9ab1a7afd9bdd1d61a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a985d73544c865d9ab1a7afd9bdd1d61a">constrain_element_vector</a> (<a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;dofs, bool asymmetric_constraint_rows=true) const</td></tr>
<tr class="separator:a985d73544c865d9ab1a7afd9bdd1d61a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af26a2e86c6d46ef12e0e7d03f4c17c3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af26a2e86c6d46ef12e0e7d03f4c17c3c">constrain_element_matrix_and_vector</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true) const</td></tr>
<tr class="separator:af26a2e86c6d46ef12e0e7d03f4c17c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5683e8943240f69888e3212bfb6533a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae5683e8943240f69888e3212bfb6533a">heterogenously_constrain_element_matrix_and_vector</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const</td></tr>
<tr class="separator:ae5683e8943240f69888e3212bfb6533a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad15780d510bc235a3d71def13bb438d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aad15780d510bc235a3d71def13bb438d">heterogenously_constrain_element_vector</a> (const <a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const</td></tr>
<tr class="separator:aad15780d510bc235a3d71def13bb438d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac4d315f9e2eddc22fae37311d26b96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abac4d315f9e2eddc22fae37311d26b96">constrain_element_dyad_matrix</a> (<a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;v, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;w, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;row_dofs, bool asymmetric_constraint_rows=true) const</td></tr>
<tr class="separator:abac4d315f9e2eddc22fae37311d26b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84bdea16d50899fd9a94e9e4cc3210b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a84bdea16d50899fd9a94e9e4cc3210b3">constrain_nothing</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;dofs) const</td></tr>
<tr class="separator:a84bdea16d50899fd9a94e9e4cc3210b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10a1b7c2c61c9b155d897fef566bebe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa10a1b7c2c61c9b155d897fef566bebe">enforce_constraints_exactly</a> (const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *v=nullptr, bool homogeneous=false) const</td></tr>
<tr class="separator:aa10a1b7c2c61c9b155d897fef566bebe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae37d0a3e61ea6274b3116bbeaa8ee02c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae37d0a3e61ea6274b3116bbeaa8ee02c">enforce_adjoint_constraints_exactly</a> (<a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;v, unsigned int q) const</td></tr>
<tr class="separator:ae37d0a3e61ea6274b3116bbeaa8ee02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade407291cc858bb97e3476cd47259702"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ade407291cc858bb97e3476cd47259702">add_periodic_boundary</a> (const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;periodic_boundary)</td></tr>
<tr class="separator:ade407291cc858bb97e3476cd47259702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a724af7741f2b45c26cf950b2f3b6d146"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a724af7741f2b45c26cf950b2f3b6d146">add_periodic_boundary</a> (const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;boundary, const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;inverse_boundary)</td></tr>
<tr class="separator:a724af7741f2b45c26cf950b2f3b6d146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6ea4cb428f8fbbc6ada2d2ee53a2c9a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab6ea4cb428f8fbbc6ada2d2ee53a2c9a">is_periodic_boundary</a> (const <a class="el" href="namespacelibMesh.html#a3f4d8a52b5ef6ff6156ca209e12b5564">boundary_id_type</a> boundaryid) const</td></tr>
<tr class="separator:ab6ea4cb428f8fbbc6ada2d2ee53a2c9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8fbe12a80566efce1259ea93601dc2a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad8fbe12a80566efce1259ea93601dc2a">get_periodic_boundaries</a> ()</td></tr>
<tr class="separator:ad8fbe12a80566efce1259ea93601dc2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b7566f3cf2608d913792fd3e963b5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a47b7566f3cf2608d913792fd3e963b5d">add_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary)</td></tr>
<tr class="separator:a47b7566f3cf2608d913792fd3e963b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7473e667efd0197d42213c8126ad910a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7473e667efd0197d42213c8126ad910a">add_adjoint_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary, unsigned int q)</td></tr>
<tr class="separator:a7473e667efd0197d42213c8126ad910a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6183b4266a0562a8e53f898d685c689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae6183b4266a0562a8e53f898d685c689">remove_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary)</td></tr>
<tr class="separator:ae6183b4266a0562a8e53f898d685c689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0fefa113360f285feebc78bd3d27f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1b0fefa113360f285feebc78bd3d27f5">remove_adjoint_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary, unsigned int q)</td></tr>
<tr class="separator:a1b0fefa113360f285feebc78bd3d27f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18524baa4b783871c63439ba69cb7430"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a18524baa4b783871c63439ba69cb7430">get_dirichlet_boundaries</a> () const</td></tr>
<tr class="separator:a18524baa4b783871c63439ba69cb7430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae079c07a133ed49ebf98cefbf348c197"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae079c07a133ed49ebf98cefbf348c197">get_dirichlet_boundaries</a> ()</td></tr>
<tr class="separator:ae079c07a133ed49ebf98cefbf348c197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab45010302963c18b5a31a32079f883a9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab45010302963c18b5a31a32079f883a9">has_adjoint_dirichlet_boundaries</a> (unsigned int q) const</td></tr>
<tr class="separator:ab45010302963c18b5a31a32079f883a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b769c65fb3e949cd627fa4502b36bc0"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3b769c65fb3e949cd627fa4502b36bc0">get_adjoint_dirichlet_boundaries</a> (unsigned int q) const</td></tr>
<tr class="separator:a3b769c65fb3e949cd627fa4502b36bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e870d5119711e35e9aecf9b487a4ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af8e870d5119711e35e9aecf9b487a4ee">get_adjoint_dirichlet_boundaries</a> (unsigned int q)</td></tr>
<tr class="separator:af8e870d5119711e35e9aecf9b487a4ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d332950190e394616401c9b0df59330"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6d332950190e394616401c9b0df59330">old_dof_indices</a> (const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *const elem, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn=<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>) const</td></tr>
<tr class="separator:a6d332950190e394616401c9b0df59330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae68477b8c280a345eda62d7aa1c6bfc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae68477b8c280a345eda62d7aa1c6bfc1">n_old_dofs</a> () const</td></tr>
<tr class="separator:ae68477b8c280a345eda62d7aa1c6bfc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8e17a57f38de4ae0060311b5497989"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1c8e17a57f38de4ae0060311b5497989">constrain_p_dofs</a> (unsigned int var, const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *elem, unsigned int s, unsigned int p)</td></tr>
<tr class="separator:a1c8e17a57f38de4ae0060311b5497989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf4ed8e608b51a7a4e95935bf42ebbb1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abf4ed8e608b51a7a4e95935bf42ebbb1">reinit</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>)</td></tr>
<tr class="separator:abf4ed8e608b51a7a4e95935bf42ebbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480f80bc9234a5586711833b87a89784"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784">clear</a> ()</td></tr>
<tr class="separator:a480f80bc9234a5586711833b87a89784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72dbf3012e202aa431d33287c6e3216"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac72dbf3012e202aa431d33287c6e3216">print_info</a> (std::ostream &amp;os=<a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a>) const</td></tr>
<tr class="separator:ac72dbf3012e202aa431d33287c6e3216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a7473e230bd8db0b8196e92417f766"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae1a7473e230bd8db0b8196e92417f766">get_info</a> () const</td></tr>
<tr class="separator:ae1a7473e230bd8db0b8196e92417f766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da9fb24e48ff357df1bb82b0100f0d5"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a> () const</td></tr>
<tr class="separator:a7da9fb24e48ff357df1bb82b0100f0d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dfeba78f759a8e42683bb559ce1e9fa"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a> () const</td></tr>
<tr class="separator:a4dfeba78f759a8e42683bb559ce1e9fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6fe0cda2874d85c373ba4493822651c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a> () const</td></tr>
<tr class="separator:aa6fe0cda2874d85c373ba4493822651c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62700690227d24d28c853ab62d38ebb9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a> () const</td></tr>
<tr class="separator:a62700690227d24d28c853ab62d38ebb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a103b37125ae9eaaadf6f7854df17faa2"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">get_info</a> ()</td></tr>
<tr class="separator:a103b37125ae9eaaadf6f7854df17faa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f46edb253f11a90bfc5f824b45ed596"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a6f46edb253f11a90bfc5f824b45ed596">print_info</a> (std::ostream &amp;<a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">out</a>=<a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a>)</td></tr>
<tr class="separator:a6f46edb253f11a90bfc5f824b45ed596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e74641afc6e2870c9e1ce412f8c44f"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a50e74641afc6e2870c9e1ce412f8c44f">n_objects</a> ()</td></tr>
<tr class="separator:a50e74641afc6e2870c9e1ce412f8c44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86837c50216b2ddb800b3836d2a08c09"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a86837c50216b2ddb800b3836d2a08c09">enable_print_counter_info</a> ()</td></tr>
<tr class="separator:a86837c50216b2ddb800b3836d2a08c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c0a2d3d3c531f9f069b0d623d4ace0f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a5c0a2d3d3c531f9f069b0d623d4ace0f">disable_print_counter_info</a> ()</td></tr>
<tr class="separator:a5c0a2d3d3c531f9f069b0d623d4ace0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ab276e172c5488ab3b387b235e28556cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1CouplingMatrix.html">CouplingMatrix</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a></td></tr>
<tr class="separator:ab276e172c5488ab3b387b235e28556cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:adb5daadc989c1fe71ec8d173adf0ed1e"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::string, std::pair&lt; unsigned int, unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">Counts</a></td></tr>
<tr class="separator:adb5daadc989c1fe71ec8d173adf0ed1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a4d69475c6ae8e441306e90e57d755ced"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a4d69475c6ae8e441306e90e57d755ced">increment_constructor_count</a> (const std::string &amp;name)</td></tr>
<tr class="separator:a4d69475c6ae8e441306e90e57d755ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8ca3935940b9b1a60f7645e856f2e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a9f8ca3935940b9b1a60f7645e856f2e4">increment_destructor_count</a> (const std::string &amp;name)</td></tr>
<tr class="separator:a9f8ca3935940b9b1a60f7645e856f2e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1ffb5b08919ab435109a302f94a7b3eb"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a></td></tr>
<tr class="separator:a1ffb5b08919ab435109a302f94a7b3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a7c913252d05560f8bc7c75a63547c4c3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">Counts</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a></td></tr>
<tr class="separator:a7c913252d05560f8bc7c75a63547c4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c30f0f71dcd00f00faa8e46aa3e043"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibMesh_1_1Threads_1_1atomic.html">Threads::atomic</a>&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">_n_objects</a></td></tr>
<tr class="separator:ad2c30f0f71dcd00f00faa8e46aa3e043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abedbd3a4ce19686187449a8a0557b74b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibMesh_1_1Threads_1_1spin__mutex.html">Threads::spin_mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#abedbd3a4ce19686187449a8a0557b74b">_mutex</a></td></tr>
<tr class="separator:abedbd3a4ce19686187449a8a0557b74b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f75e8a4a280f2c41636f2ae1307a311"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = true</td></tr>
<tr class="separator:a8f75e8a4a280f2c41636f2ae1307a311"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:abbb34b303bc677ac3a1de56b2da3f8fc"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *(DofMap::*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abbb34b303bc677ac3a1de56b2da3f8fc">dofobject_accessor</a>) (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const</td></tr>
<tr class="separator:abbb34b303bc677ac3a1de56b2da3f8fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ad1d420cf89d32c1853354a324ded2317"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad1d420cf89d32c1853354a324ded2317">_dof_indices</a> (const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> &amp;elem, int p_level, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vg, const unsigned int vig, const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *const *nodes, unsigned int <a class="el" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> #ifdef DEBUG, const unsigned int v, std::size_t &amp;tot_size #endif) const</td></tr>
<tr class="separator:ad1d420cf89d32c1853354a324ded2317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7146774c15f7b99381e2a1d7895eb1de"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7146774c15f7b99381e2a1d7895eb1de">build_sparsity</a> (const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>) const</td></tr>
<tr class="separator:a7146774c15f7b99381e2a1d7895eb1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8f3f26dfcdeaa8d024516ea750127c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#afd8f3f26dfcdeaa8d024516ea750127c">invalidate_dofs</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>) const</td></tr>
<tr class="separator:afd8f3f26dfcdeaa8d024516ea750127c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adddf429ac3d11389582986155f4d2d72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#adddf429ac3d11389582986155f4d2d72">node_ptr</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const</td></tr>
<tr class="separator:adddf429ac3d11389582986155f4d2d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6a304637b5e23e58dc33e0849443d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ade6a304637b5e23e58dc33e0849443d0">elem_ptr</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const</td></tr>
<tr class="separator:ade6a304637b5e23e58dc33e0849443d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bad83b3b5e37a8afe4ea251d72df300"><td class="memTemplParams" colspan="2">template&lt;typename iterator_type &gt; </td></tr>
<tr class="memitem:a7bad83b3b5e37a8afe4ea251d72df300"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">set_nonlocal_dof_objects</a> (iterator_type objects_begin, iterator_type objects_end, <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, <a class="el" href="classlibMesh_1_1DofMap.html#abbb34b303bc677ac3a1de56b2da3f8fc">dofobject_accessor</a> objects)</td></tr>
<tr class="separator:a7bad83b3b5e37a8afe4ea251d72df300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af781ec4ff23b34cd4332a357f1647fdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">distribute_local_dofs_var_major</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;next_free_dof, <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>)</td></tr>
<tr class="separator:af781ec4ff23b34cd4332a357f1647fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa08b142ac3e34a8213017252b96d30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">distribute_local_dofs_node_major</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;next_free_dof, <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>)</td></tr>
<tr class="separator:a5fa08b142ac3e34a8213017252b96d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed8eba054300e64164af4a8257bae8d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">add_neighbors_to_send_list</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>)</td></tr>
<tr class="separator:aed8eba054300e64164af4a8257bae8d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a599877e0ae2c03dccbd5e8e9750d7fb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;C, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, const bool called_recursively=false) const</td></tr>
<tr class="separator:a599877e0ae2c03dccbd5e8e9750d7fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7b5749fe8231535dfd67985c6a5858e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">build_constraint_matrix_and_vector</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;C, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;H, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const</td></tr>
<tr class="separator:ad7b5749fe8231535dfd67985c6a5858e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5f8f1f45829f6b6fd9895ea00753b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3f5f8f1f45829f6b6fd9895ea00753b7">find_connected_dofs</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs) const</td></tr>
<tr class="separator:a3f5f8f1f45829f6b6fd9895ea00753b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0c68d975715b184edae6544c29d5d25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad0c68d975715b184edae6544c29d5d25">find_connected_dof_objects</a> (std::vector&lt; const <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *&gt; &amp;objs) const</td></tr>
<tr class="separator:ad0c68d975715b184edae6544c29d5d25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0783b9a05a297be8f1c3e630301e0604"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0783b9a05a297be8f1c3e630301e0604">add_constraints_to_send_list</a> ()</td></tr>
<tr class="separator:a0783b9a05a297be8f1c3e630301e0604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c15409067d14ae53d7523b2b9c3076"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a28c15409067d14ae53d7523b2b9c3076">check_dirichlet_bcid_consistency</a> (const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;boundary) const</td></tr>
<tr class="separator:a28c15409067d14ae53d7523b2b9c3076"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:af63ec595dadc28f2b6673499641a1683"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af63ec595dadc28f2b6673499641a1683">merge_ghost_functor_outputs</a> (<a class="el" href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">GhostingFunctor::map_type</a> &amp;elements_to_ghost, std::set&lt; <a class="el" href="classlibMesh_1_1CouplingMatrix.html">CouplingMatrix</a> *&gt; &amp;temporary_coupling_matrices, const std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::iterator &amp;gf_begin, const std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::iterator &amp;gf_end, const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;elems_begin, const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;elems_end, <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p)</td></tr>
<tr class="separator:af63ec595dadc28f2b6673499641a1683"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a33e3d8408ce7a9125dd1c22d1428fd97"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a33e3d8408ce7a9125dd1c22d1428fd97">_error_on_cyclic_constraint</a></td></tr>
<tr class="separator:a33e3d8408ce7a9125dd1c22d1428fd97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5232a8054e580a408f394ba1574c63df"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlibMesh_1_1Variable.html">Variable</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a></td></tr>
<tr class="separator:a5232a8054e580a408f394ba1574c63df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad840cf4659b6b1a2f781d29225e82743"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a></td></tr>
<tr class="separator:ad840cf4659b6b1a2f781d29225e82743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04bedd57c80ef97a7d9a0a3e2fe8a248"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a></td></tr>
<tr class="separator:a04bedd57c80ef97a7d9a0a3e2fe8a248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b9faf7127f48555386705a952460d6"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">_sys_number</a></td></tr>
<tr class="separator:a32b9faf7127f48555386705a952460d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f1617e6f28fc596497b370092bcc17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a></td></tr>
<tr class="separator:ac0f1617e6f28fc596497b370092bcc17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf8838eb951b139f05e56e338ac2195"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a></td></tr>
<tr class="separator:aacf8838eb951b139f05e56e338ac2195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72062de06b72df985ac5bf16837a7da"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a></td></tr>
<tr class="separator:ab72062de06b72df985ac5bf16837a7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43f96a9e11b3f4221306fdfd4511aaa"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a></td></tr>
<tr class="separator:af43f96a9e11b3f4221306fdfd4511aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1fc10139391d71da470387d9e4adbb5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a></td></tr>
<tr class="separator:af1fc10139391d71da470387d9e4adbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b3873478d701811b9562b514fc2c369"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a></td></tr>
<tr class="separator:a2b3873478d701811b9562b514fc2c369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5f0ce99b32ad1a22d5e78161d27ad3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html">AugmentSparsityPattern</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">_augment_sparsity_pattern</a></td></tr>
<tr class="separator:ab5f0ce99b32ad1a22d5e78161d27ad3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a727fc57aa0deeee20ce64711b56ccf65"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">_extra_sparsity_function</a> )(<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *)</td></tr>
<tr class="separator:a727fc57aa0deeee20ce64711b56ccf65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a283ce213140aa281498b56e138ee8de2"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a></td></tr>
<tr class="separator:a283ce213140aa281498b56e138ee8de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409a5dccf85edf7260f6186482cb9c9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">AugmentSendList</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a></td></tr>
<tr class="separator:a409a5dccf85edf7260f6186482cb9c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61a1aecc00b716b0cf00f68c68e7c80"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">_extra_send_list_function</a> )(std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *)</td></tr>
<tr class="separator:ad61a1aecc00b716b0cf00f68c68e7c80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c450ba54bc8caffac28eed88a98a17d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a></td></tr>
<tr class="separator:a6c450ba54bc8caffac28eed88a98a17d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb069d1433ad6f8eeb4d5ebf44ae4dc8"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a></td></tr>
<tr class="separator:abb069d1433ad6f8eeb4d5ebf44ae4dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb9c9ed9c530781aac48df4fc0cf27b"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a></td></tr>
<tr class="separator:a4eb9c9ed9c530781aac48df4fc0cf27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378d58f5e860f781a52adb61464c9378"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a></td></tr>
<tr class="separator:a378d58f5e860f781a52adb61464c9378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1ebc9176a3f7ec9607ba4b26808991"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a></td></tr>
<tr class="separator:aef1ebc9176a3f7ec9607ba4b26808991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ed6583656addff061ba113f0ca4347"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a></td></tr>
<tr class="separator:aa8ed6583656addff061ba113f0ca4347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14c66a56c0815c857dc662bea96f124"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a></td></tr>
<tr class="separator:ab14c66a56c0815c857dc662bea96f124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15dc47f3b7fdd20f9ec062de8e842561"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a></td></tr>
<tr class="separator:a15dc47f3b7fdd20f9ec062de8e842561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446ebcd42da6b4edbe58238cb4c12b7c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a></td></tr>
<tr class="separator:a446ebcd42da6b4edbe58238cb4c12b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0964620ae8054b969297d1d9087b7b05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a></td></tr>
<tr class="separator:a0964620ae8054b969297d1d9087b7b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dbee781954d22ad785846b3a2a45193"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a></td></tr>
<tr class="separator:a8dbee781954d22ad785846b3a2a45193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbca79dca4f02ab917e89aeac3113808"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a></td></tr>
<tr class="separator:abbca79dca4f02ab917e89aeac3113808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab91d708f5167f50c0392b2fd5dea2559"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a></td></tr>
<tr class="separator:ab91d708f5167f50c0392b2fd5dea2559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab96f5b260e5925063553da996bb3b428"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a></td></tr>
<tr class="separator:ab96f5b260e5925063553da996bb3b428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92da14cf60e82ed600bfe67ca3422765"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a></td></tr>
<tr class="separator:a92da14cf60e82ed600bfe67ca3422765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7fe4d0cf13618e6dd04ff22fdaca0ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a></td></tr>
<tr class="separator:af7fe4d0cf13618e6dd04ff22fdaca0ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21470daae1a06d29df4bac4807a019c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a></td></tr>
<tr class="separator:af21470daae1a06d29df4bac4807a019c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24e7c497429c2bd81a5cc39f71cfa6e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a></td></tr>
<tr class="separator:a24e7c497429c2bd81a5cc39f71cfa6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89fdd1d933dc29089eabf3e07908374d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1AdjointDofConstraintValues.html">AdjointDofConstraintValues</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a></td></tr>
<tr class="separator:a89fdd1d933dc29089eabf3e07908374d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8856db766d722a0edaa9f5c5d94d40f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1NodeConstraints.html">NodeConstraints</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a></td></tr>
<tr class="separator:a8856db766d722a0edaa9f5c5d94d40f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab91693b08a22cfe1af7781287157ac8a"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a></td></tr>
<tr class="separator:ab91693b08a22cfe1af7781287157ac8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e9be7e72291d4fd6e841ae7733a5ff0"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a></td></tr>
<tr class="separator:a2e9be7e72291d4fd6e841ae7733a5ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e77603adbd2d7c119334ff2ce82a877"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a></td></tr>
<tr class="separator:a7e77603adbd2d7c119334ff2ce82a877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ed76ce98cd73ed8339f505a5284fef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a></td></tr>
<tr class="separator:aa6ed76ce98cd73ed8339f505a5284fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09368a6dcd32c12d7a51dc00852982d5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a></td></tr>
<tr class="separator:a09368a6dcd32c12d7a51dc00852982d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a298e05b1935249e7045795d918f46d70"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a298e05b1935249e7045795d918f46d70">SparsityPattern::Build</a></td></tr>
<tr class="separator:a298e05b1935249e7045795d918f46d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manages the degrees of freedom (DOFs) in a simulation. </p>
<p>This class handles the numbering of degrees of freedom on a mesh. For systems of equations the class supports a fixed number of variables. The degrees of freedom are numbered such that sequential, contiguous blocks belong to distinct processors. This is so that the resulting data structures will work well with parallel linear algebra packages.</p>
<dl class="section author"><dt>Author</dt><dd>Benjamin S. Kirk </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-2007 </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00176">176</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="adb5daadc989c1fe71ec8d173adf0ed1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb5daadc989c1fe71ec8d173adf0ed1e">&#9670;&nbsp;</a></span>Counts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::string, std::pair&lt;unsigned int, unsigned int&gt; &gt; <a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">libMesh::ReferenceCounter::Counts</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure to log the information. The log is identified by the class name. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00117">117</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

</div>
</div>
<a id="abbb34b303bc677ac3a1de56b2da3f8fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbb34b303bc677ac3a1de56b2da3f8fc">&#9670;&nbsp;</a></span>dofobject_accessor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a>*(DofMap::* libMesh::DofMap::dofobject_accessor) (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A member function type like <code><a class="el" href="classlibMesh_1_1DofMap.html#adddf429ac3d11389582986155f4d2d72">node_ptr()</a></code> or <code><a class="el" href="classlibMesh_1_1DofMap.html#ade6a304637b5e23e58dc33e0849443d0">elem_ptr()</a></code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01376">1376</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ade33ee85034b79ffb7febd62a9e8fe97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade33ee85034b79ffb7febd62a9e8fe97">&#9670;&nbsp;</a></span>DofMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::DofMap::DofMap </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>sys_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor. Requires the number of the system for which we will be numbering degrees of freedom &amp; the parent object we are contained in, which defines our communication space. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00130">130</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01587">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01595">_default_evaluating</a>, <a class="el" href="dof__map_8h_source.html#l01525">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01518">_mesh</a>, <a class="el" href="dof__map_8h_source.html#l01707">_periodic_boundaries</a>, <a class="el" href="dof__map_8C_source.html#l01829">add_algebraic_ghosting_functor()</a>, and <a class="el" href="dof__map_8C_source.html#l01809">add_coupling_functor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                :</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="classlibMesh_1_1ParallelObject.html#a503a851291cc9665284daf6a304337a5">ParallelObject</a> (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.comm()),</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a33e3d8408ce7a9125dd1c22d1428fd97">_error_on_cyclic_constraint</a>(<span class="keyword">false</span>),</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>(),</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>(),</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>(),</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">_sys_number</a>(number),</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>),</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>(),</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>(),</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>(),</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>(),</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>(),</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">_augment_sparsity_pattern</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">_extra_sparsity_function</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">_extra_send_list_function</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>(<span class="keyword">new</span> DefaultCoupling()),</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>(<span class="keyword">new</span> DefaultCoupling()),</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>(<span class="keyword">false</span>),</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>(<span class="keyword">nullptr</span>),</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a>(0),</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a>(0)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a>(0),</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>(),</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>(),</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a>()</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>()</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>()</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>()</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>()</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>()</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>(<span class="keyword">new</span> PeriodicBoundaries)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_DIRICHLET</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>(<span class="keyword">new</span> DirichletBoundaries)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>()</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a>(<span class="keyword">false</span>),</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a>(<span class="keyword">false</span>)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.clear();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_mesh(&amp;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_mesh(&amp;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_n_levels(1);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_periodic_boundaries(<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>.get());</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_periodic_boundaries(<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>.get());</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01503">dof_map.h:1503</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a503a851291cc9665284daf6a304337a5"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a503a851291cc9665284daf6a304337a5">libMesh::ParallelObject::ParallelObject</a></div><div class="ttdeci">ParallelObject(const Parallel::Communicator &amp;comm_in)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00058">parallel_object.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a33e3d8408ce7a9125dd1c22d1428fd97"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a33e3d8408ce7a9125dd1c22d1428fd97">libMesh::DofMap::_error_on_cyclic_constraint</a></div><div class="ttdeci">bool _error_on_cyclic_constraint</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01493">dof_map.h:1493</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ed76ce98cd73ed8339f505a5284fef"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">libMesh::DofMap::_implicit_neighbor_dofs_initialized</a></div><div class="ttdeci">bool _implicit_neighbor_dofs_initialized</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01736">dof_map.h:1736</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a32b9faf7127f48555386705a952460d6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">libMesh::DofMap::_sys_number</a></div><div class="ttdeci">const unsigned int _sys_number</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01513">dof_map.h:1513</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a09368a6dcd32c12d7a51dc00852982d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">libMesh::DofMap::_implicit_neighbor_dofs</a></div><div class="ttdeci">bool _implicit_neighbor_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01737">dof_map.h:1737</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a283ce213140aa281498b56e138ee8de2"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">libMesh::DofMap::_extra_sparsity_context</a></div><div class="ttdeci">void * _extra_sparsity_context</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01564">dof_map.h:1564</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab5f0ce99b32ad1a22d5e78161d27ad3b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">libMesh::DofMap::_augment_sparsity_pattern</a></div><div class="ttdeci">AugmentSparsityPattern * _augment_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01552">dof_map.h:1552</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01721">dof_map.h:1721</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01672">dof_map.h:1672</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae17b27f47b3731f6ce72312edd957bf7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">libMesh::DofMap::add_coupling_functor</a></div><div class="ttdeci">void add_coupling_functor(GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01809">dof_map.C:1809</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01667">dof_map.h:1667</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01541">dof_map.h:1541</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a15dc47f3b7fdd20f9ec062de8e842561"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">libMesh::DofMap::_n_nz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_nz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01638">dof_map.h:1638</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a409a5dccf85edf7260f6186482cb9c9c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">libMesh::DofMap::_augment_send_list</a></div><div class="ttdeci">AugmentSendList * _augment_send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01569">dof_map.h:1569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a446ebcd42da6b4edbe58238cb4c12b7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">libMesh::DofMap::_n_oz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_oz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01644">dof_map.h:1644</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01624">dof_map.h:1624</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01678">dof_map.h:1678</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a727fc57aa0deeee20ce64711b56ccf65"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">libMesh::DofMap::_extra_sparsity_function</a></div><div class="ttdeci">void(* _extra_sparsity_function)(SparsityPattern::Graph &amp;, std::vector&lt; dof_id_type &gt; &amp;n_nz, std::vector&lt; dof_id_type &gt; &amp;n_oz, void *)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01557">dof_map.h:1557</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01655">dof_map.h:1655</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01319">dof_map.h:1319</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6c450ba54bc8caffac28eed88a98a17d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">libMesh::DofMap::_extra_send_list_context</a></div><div class="ttdeci">void * _extra_send_list_context</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01579">dof_map.h:1579</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; *&gt; _matrices</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01525">dof_map.h:1525</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01707">dof_map.h:1707</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01587">dof_map.h:1587</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01498">dof_map.h:1498</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01662">dof_map.h:1662</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01530">dof_map.h:1530</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad61a1aecc00b716b0cf00f68c68e7c80"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">libMesh::DofMap::_extra_send_list_function</a></div><div class="ttdeci">void(* _extra_send_list_function)(std::vector&lt; dof_id_type &gt; &amp;, void *)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01574">dof_map.h:1574</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01518">dof_map.h:1518</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01595">dof_map.h:1595</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01508">dof_map.h:1508</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9a0c5eeda42bc54bb3ae1c2d05ec5227"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">libMesh::DofMap::add_algebraic_ghosting_functor</a></div><div class="ttdeci">void add_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01829">dof_map.C:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01649">dof_map.h:1649</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="addb6136725455c3a28e17193d3edf7ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addb6136725455c3a28e17193d3edf7ee">&#9670;&nbsp;</a></span>~DofMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::DofMap::~DofMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00201">201</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01727">_adjoint_dirichlet_boundaries</a>, <a class="el" href="dof__map_8h_source.html#l01587">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01595">_default_evaluating</a>, <a class="el" href="dof__map_8h_source.html#l01518">_mesh</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, and <a class="el" href="mesh__base_8C_source.html#l00281">libMesh::MeshBase::remove_ghosting_functor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;{</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784">clear</a>();</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// clear() resets all but the default DofMap-based functors.  We</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// need to remove those from the mesh too before we die.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">remove_ghosting_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">remove_ghosting_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_DIRICHLET</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; bnd : <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">delete</span> bnd;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshBase_html_a617b958e22a85c29f02af80867367daa"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">libMesh::MeshBase::remove_ghosting_functor</a></div><div class="ttdeci">void remove_ghosting_functor(GhostingFunctor &amp;ghosting_functor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00281">mesh_base.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a480f80bc9234a5586711833b87a89784"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784">libMesh::DofMap::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00828">dof_map.C:828</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01587">dof_map.h:1587</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01518">dof_map.h:1518</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01595">dof_map.h:1595</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad1d420cf89d32c1853354a324ded2317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1d420cf89d32c1853354a324ded2317">&#9670;&nbsp;</a></span>_dof_indices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::_dof_indices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> &amp;&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *const *&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int <a class="el" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> #ifdef&#160;</td>
          <td class="paramname"><em>DEBUG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;tot_size #&#160;</td>
          <td class="paramname"><em>endif</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function that gets the dof indices on the current element for a non-SCALAR type variable, where the variable is identified by its variable group number <code>vg</code> and its offset <code>vig</code> from the first variable in that group.</p>
<p>In DEBUG mode, the tot_size parameter will add up the total number of dof indices that should have been added to di, and v will be the variable number corresponding to vg and vig. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02209">2209</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="elem_8h_source.html#l02390">libMesh::Elem::active()</a>, <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="classlibMesh_1_1Elem.html#a90a7ca1f28a92f659ab6f8cdef91d806">libMesh::Elem::dim()</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="fe__interface_8C_source.html#l01412">libMesh::FEInterface::extra_hanging_dofs()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="classlibMesh_1_1Elem.html#af5eecb2e1afee8bc7ebf8632da91e4ff">libMesh::Elem::infinite()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="classlibMesh_1_1Elem.html#ac56e382d9871ff243a781940ee13ed87">libMesh::Elem::is_vertex()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00036">libMesh::LAGRANGE</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="fe__interface_8C_source.html#l00454">libMesh::FEInterface::n_dofs()</a>, <a class="el" href="fe__interface_8C_source.html#l00473">libMesh::FEInterface::n_dofs_at_node()</a>, <a class="el" href="fe__interface_8C_source.html#l00493">libMesh::FEInterface::n_dofs_at_node_function()</a>, <a class="el" href="fe__interface_8C_source.html#l00504">libMesh::FEInterface::n_dofs_per_elem()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="dof__object_8h_source.html#l00749">libMesh::DofObject::n_systems()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="enum__fe__family_8h_source.html#l00055">libMesh::SUBDIVISION</a>, <a class="el" href="elem_8h_source.html#l02034">libMesh::Elem::subdomain_id()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ad06f8ac22978144723179eed42d10bae">libMesh::Elem::type()</a>, <a class="el" href="dof__object_8h_source.html#l00887">libMesh::DofObject::var_to_vg_and_offset()</a>, and <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01930">dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;{</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="keywordflow">if</span> (var.active_on_subdomain(elem.subdomain_id()))</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">ElemType</a> type        = elem.type();</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim     = elem.dim();</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> is_inf          = elem.infinite();</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="comment">// Increase the polynomial order on p refined elements</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      FEType fe_type = var.type();</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      fe_type.order = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a><span class="keyword">&gt;</span>(fe_type.order + p_level);</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> extra_hanging_dofs =</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <a class="code" href="classlibMesh_1_1FEInterface.html#ac0363b6fc2b8355ff0416ac65b522066">FEInterface::extra_hanging_dofs</a>(fe_type);</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      <span class="comment">// The number of dofs per element is non-static for subdivision FE</span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="keywordflow">if</span> (fe_type.family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2da152bf3fd0b05483f7989875a781ab2c6">SUBDIVISION</a>)</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        tot_size += <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        tot_size += <a class="code" href="classlibMesh_1_1FEInterface.html#a8d6e670715080e79706ded0009742acc">FEInterface::n_dofs</a>(dim,fe_type,type);</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1FEInterface.html#a78f9b38911ff4edec8d824d3272cc617">FEInterface::n_dofs_at_node_ptr</a> ndan =</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        <a class="code" href="classlibMesh_1_1FEInterface.html#a580bf91fc4171dc3ae16441f9c03250d">FEInterface::n_dofs_at_node_function</a>(dim, fe_type);</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <span class="comment">// Get the node-based DOF numbers</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; n++)</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        {</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;          <span class="keyword">const</span> Node * node      = nodes[n];</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;          <span class="comment">// Cache the intermediate lookups that are common to every</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;          <span class="comment">// component</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;          <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            vg_and_offset = node-&gt;var_to_vg_and_offset(sys_num,v);</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;          libmesh_assert_equal_to (vg, vg_and_offset.first);</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;          libmesh_assert_equal_to (vig, vg_and_offset.second);</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node-&gt;n_comp_group(sys_num,vg);</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;          <span class="comment">// There is a potential problem with h refinement.  Imagine a</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;          <span class="comment">// quad9 that has a linear FE on it.  Then, on the hanging side,</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;          <span class="comment">// it can falsely identify a DOF at the mid-edge node. This is why</span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;          <span class="comment">// we go through FEInterface instead of node-&gt;n_comp() directly.</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc =</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            is_inf ?</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;            <a class="code" href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">FEInterface::n_dofs_at_node</a>(dim, fe_type, type, n) :</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;#endif</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            ndan (type, fe_type.order, n);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;          <span class="comment">// If this is a non-vertex on a hanging node with extra</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;          <span class="comment">// degrees of freedom, we use the non-vertex dofs (which</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;          <span class="comment">// come in reverse order starting from the end, to</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;          <span class="comment">// simplify p refinement)</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;          <span class="keywordflow">if</span> (extra_hanging_dofs &amp;&amp; !elem.is_vertex(n))</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            {</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">int</span> dof_offset = n_comp - nc;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;              <span class="comment">// We should never have fewer dofs than necessary on a</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;              <span class="comment">// node unless we&#39;re getting indices on a parent element,</span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;              <span class="comment">// and we should never need the indices on such a node</span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;              <span class="keywordflow">if</span> (dof_offset &lt; 0)</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                {</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                  libmesh_assert(!elem.active());</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                  di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                }</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=n_comp-1; i&gt;=dof_offset; i--)</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                  {</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                      node-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                    libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                    di.push_back(d);</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                  }</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            }</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;          <span class="comment">// If this is a vertex or an element without extra hanging</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;          <span class="comment">// dofs, our dofs come in forward order coming from the</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;          <span class="comment">// beginning</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nc; i++)</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;              {</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                  node-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                di.push_back(d);</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;              }</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        }</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="comment">// If there are any element-based DOF numbers, get them</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc = <a class="code" href="classlibMesh_1_1FEInterface.html#aaf96d4ec7921d2f2a1d4cdbdbc63656a">FEInterface::n_dofs_per_elem</a>(dim,</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                                                           fe_type,</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                                                           type);</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="comment">// We should never have fewer dofs than necessary on an</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      <span class="comment">// element unless we&#39;re getting indices on a parent element,</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      <span class="comment">// and we should never need those indices</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      <span class="keywordflow">if</span> (nc != 0)</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        {</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = elem.n_comp_group(sys_num,vg);</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;          <span class="keywordflow">if</span> (elem.n_systems() &gt; sys_num &amp;&amp; nc &lt;= n_comp)</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            {</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nc; i++)</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                {</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                    elem.dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                  libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                  di.push_back(d);</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                }</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            }</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            {</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;              libmesh_assert(!elem.active() || fe_type.family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2da0b0bdaef8cef619acc3e552276abfe8f">LAGRANGE</a> || fe_type.family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2da152bf3fd0b05483f7989875a781ab2c6">SUBDIVISION</a>);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;              di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            }</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        }</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    }</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1FEInterface_html_aaf96d4ec7921d2f2a1d4cdbdbc63656a"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#aaf96d4ec7921d2f2a1d4cdbdbc63656a">libMesh::FEInterface::n_dofs_per_elem</a></div><div class="ttdeci">static unsigned int n_dofs_per_elem(const unsigned int dim, const FEType &amp;fe_t, const ElemType t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00504">fe_interface.C:504</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2da0b0bdaef8cef619acc3e552276abfe8f"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2da0b0bdaef8cef619acc3e552276abfe8f">libMesh::LAGRANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00036">enum_fe_family.h:36</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a3f482b3acb4beb528f0ce89f161ff967"><div class="ttname"><a href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">libMesh::ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition:</b> <a href="enum__elem__type_8h_source.html#l00033">enum_elem_type.h:33</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af3eb3e8751995b944fc135ea53b09da2"><div class="ttname"><a href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">libMesh::Order</a></div><div class="ttdeci">Order</div><div class="ttdef"><b>Definition:</b> <a href="enum__order_8h_source.html#l00040">enum_order.h:40</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a8d6e670715080e79706ded0009742acc"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a8d6e670715080e79706ded0009742acc">libMesh::FEInterface::n_dofs</a></div><div class="ttdeci">static unsigned int n_dofs(const unsigned int dim, const FEType &amp;fe_t, const ElemType t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00454">fe_interface.C:454</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_ac0363b6fc2b8355ff0416ac65b522066"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#ac0363b6fc2b8355ff0416ac65b522066">libMesh::FEInterface::extra_hanging_dofs</a></div><div class="ttdeci">static bool extra_hanging_dofs(const FEType &amp;fe_t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l01412">fe_interface.C:1412</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a580bf91fc4171dc3ae16441f9c03250d"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a580bf91fc4171dc3ae16441f9c03250d">libMesh::FEInterface::n_dofs_at_node_function</a></div><div class="ttdeci">static n_dofs_at_node_ptr n_dofs_at_node_function(const unsigned int dim, const FEType &amp;fe_t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00493">fe_interface.C:493</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a9d448e5766ac099a401541d191439d0b"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">libMesh::FEInterface::n_dofs_at_node</a></div><div class="ttdeci">static unsigned int n_dofs_at_node(const unsigned int dim, const FEType &amp;fe_t, const ElemType t, const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00473">fe_interface.C:473</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a78f9b38911ff4edec8d824d3272cc617"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a78f9b38911ff4edec8d824d3272cc617">libMesh::FEInterface::n_dofs_at_node_ptr</a></div><div class="ttdeci">unsigned int(* n_dofs_at_node_ptr)(const ElemType, const Order, const unsigned int)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8h_source.html#l00114">fe_interface.h:114</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2da152bf3fd0b05483f7989875a781ab2c6"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2da152bf3fd0b05483f7989875a781ab2c6">libMesh::SUBDIVISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00055">enum_fe_family.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acf485df94525efa4993f755c5b65a448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf485df94525efa4993f755c5b65a448">&#9670;&nbsp;</a></span>add_adjoint_constraint_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_adjoint_constraint_row </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;&#160;</td>
          <td class="paramname"><em>constraint_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&#160;</td>
          <td class="paramname"><em>constraint_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>forbid_constraint_overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side for the adjoint constraint equation.</p>
<p><code>forbid_constraint_overwrite</code> here only tests for overwriting the rhs. This method should only be used when an equivalent constraint (with a potentially different rhs) already exists for the primal problem. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01373">1373</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;{</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="comment">// Optionally allow the user to overwrite constraints.  Defaults to false.</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordflow">if</span> (forbid_constraint_overwrite)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(dof_number))</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        libmesh_error_msg(<span class="stringliteral">&quot;ERROR: DOF &quot;</span> &lt;&lt; dof_number &lt;&lt; <span class="stringliteral">&quot; has no corresponding primal constraint!&quot;</span>);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="comment">// No way to do this without a non-normalized tolerance?</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="comment">// // If the user passed in more than just the rhs, let&#39;s check the</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="comment">// // coefficients for consistency</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="comment">// if (!constraint_row.empty())</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="comment">//   {</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="comment">//     DofConstraintRow row = _dof_constraints[dof_number];</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="comment">//     for (const auto &amp; pr : row)</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="comment">//       libmesh_assert(constraint_row.find(pr.first)-&gt;second == pr.second);</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="comment">//   }</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="comment">// if (_adjoint_constraint_values[qoi_index].find(dof_number) !=</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="comment">//     _adjoint_constraint_values[qoi_index].end())</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="comment">//   libmesh_assert_equal_to(_adjoint_constraint_values[qoi_index][dof_number],</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="comment">//                           constraint_rhs);</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    }</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="comment">// Creates the map of rhs values if it doesn&#39;t already exist; then</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="comment">// adds the current value to that map</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="comment">// We don&#39;t get insert_or_assign until C++17 so we make do.</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  std::pair&lt;DofConstraintValueMap::iterator, bool&gt; rhs_it =</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>[qoi_index].insert(std::make_pair(dof_number,</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                                                constraint_rhs));</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="keywordflow">if</span> (!rhs_it.second)</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    rhs_it.first-&gt;second = constraint_rhs;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7473e667efd0197d42213c8126ad910a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7473e667efd0197d42213c8126ad910a">&#9670;&nbsp;</a></span>add_adjoint_dirichlet_boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_adjoint_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a copy of the specified Dirichlet boundary to the system, corresponding to the adjoint problem defined by Quantity of Interest <code>q</code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04279">4279</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;{</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size = cast_int&lt;unsigned int&gt;</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    (<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.size());</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = old_size; i &lt;= qoi_index; ++i)</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.push_back(<span class="keyword">new</span> <a class="code" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>());</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;push_back</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;    (<span class="keyword">new</span> <a class="code" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a>(dirichlet_boundary));</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DirichletBoundary_html"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundary.html">libMesh::DirichletBoundary</a></div><div class="ttdoc">Class for specifying Dirichlet boundary conditions as constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00089">dirichlet_boundaries.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1DirichletBoundaries_html"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundaries.html">libMesh::DirichletBoundaries</a></div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00194">dirichlet_boundaries.h:194</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a0c5eeda42bc54bb3ae1c2d05ec5227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0c5eeda42bc54bb3ae1c2d05ec5227">&#9670;&nbsp;</a></span>add_algebraic_ghosting_functor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_algebraic_ghosting_functor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;&#160;</td>
          <td class="paramname"><em>evaluable_functor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_mesh</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors. Degrees of freedom on other processors which match the elements and variables returned by these functors will be added to the send_list, and the elements on other processors will be ghosted on a distributed mesh, so that the elements can always be found and the solutions on them will always be evaluable.</p>
<p><a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> memory must be managed by the code which calls this function; the <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> lifetime is expected to extend until either the functor is removed or the <a class="el" href="classlibMesh_1_1DofMap.html" title="Manages the degrees of freedom (DOFs) in a simulation. ">DofMap</a> is destructed.</p>
<p>When <code>to_mesh</code> is true, the <code>coupling_functor</code> is also added to our associated mesh, to ensure that evaluable elements do not get lost during mesh distribution. (if evaluable elements were <em>already</em> lost there's no getting them back after the fact, sorry)</p>
<p>If <code>to_mesh</code> is false, no change to mesh ghosting is made; the <a class="el" href="classlibMesh_1_1Mesh.html" title="Manages a collection of Nodes and Elems. ">Mesh</a> must already have ghosting functor(s) specifying a superset of <code>evaluable_functor</code> or this is a horrible bug. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01829">1829</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01605">_algebraic_ghosting_functors</a>, <a class="el" href="dof__map_8h_source.html#l01518">_mesh</a>, and <a class="el" href="mesh__base_8h_source.html#l00823">libMesh::MeshBase::add_ghosting_functor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01800">add_default_ghosting()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, and <a class="el" href="dof__map_8C_source.html#l00130">DofMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;{</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.insert(&amp;evaluable_functor);</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="keywordflow">if</span> (to_mesh)</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ace4f8cf8f3c150cd6c5203e593fd26b3">add_ghosting_functor</a>(evaluable_functor);</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01605">dof_map.h:1605</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01518">dof_map.h:1518</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ace4f8cf8f3c150cd6c5203e593fd26b3"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ace4f8cf8f3c150cd6c5203e593fd26b3">libMesh::MeshBase::add_ghosting_functor</a></div><div class="ttdeci">void add_ghosting_functor(GhostingFunctor &amp;ghosting_functor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00823">mesh_base.h:823</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ada019c02054ed5945504a6c5fc856d69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada019c02054ed5945504a6c5fc856d69">&#9670;&nbsp;</a></span>add_constraint_row() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_constraint_row </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;&#160;</td>
          <td class="paramname"><em>constraint_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&#160;</td>
          <td class="paramname"><em>constraint_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>forbid_constraint_overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side for the constraint equation. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01350">1350</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00894">add_constraint_row()</a>.</p>
<div class="fragment"><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;{</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="comment">// Optionally allow the user to overwrite constraints.  Defaults to false.</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keywordflow">if</span> (forbid_constraint_overwrite)</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(dof_number))</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;ERROR: DOF &quot;</span> &lt;&lt; dof_number &lt;&lt; <span class="stringliteral">&quot; was already constrained!&quot;</span>);</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="comment">// We don&#39;t get insert_or_assign until C++17 so we make do.</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  std::pair&lt;DofConstraints::iterator, bool&gt; it =</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.insert(std::make_pair(dof_number, constraint_row));</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="keywordflow">if</span> (!it.second)</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    it.first-&gt;second = constraint_row;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  std::pair&lt;DofConstraintValueMap::iterator, bool&gt; rhs_it =</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.insert(std::make_pair(dof_number, constraint_rhs));</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keywordflow">if</span> (!rhs_it.second)</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    rhs_it.first-&gt;second = constraint_rhs;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84adefac2c57cc5a76ceae26ef7f9472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84adefac2c57cc5a76ceae26ef7f9472">&#9670;&nbsp;</a></span>add_constraint_row() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_constraint_row </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;&#160;</td>
          <td class="paramname"><em>constraint_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>forbid_constraint_overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adds a copy of the user-defined row to the constraint matrix, using a homogeneous right-hand-side for the constraint equation. By default, produces an error if the DOF was already constrained. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00894">894</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map__constraints_8C_source.html#l01350">add_constraint_row()</a>.</p>
<div class="fragment"><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">add_constraint_row</a>(dof_number, constraint_row, 0., forbid_constraint_overwrite); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ada019c02054ed5945504a6c5fc856d69"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">libMesh::DofMap::add_constraint_row</a></div><div class="ttdeci">void add_constraint_row(const dof_id_type dof_number, const DofConstraintRow &amp;constraint_row, const Number constraint_rhs, const bool forbid_constraint_overwrite)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01350">dof_map_constraints.C:1350</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0783b9a05a297be8f1c3e630301e0604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0783b9a05a297be8f1c3e630301e0604">&#9670;&nbsp;</a></span>add_constraints_to_send_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_constraints_to_send_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adds entries to the <code>_send_list</code> vector corresponding to DoFs which are dependencies for constraint equations on the current processor. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04163">4163</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;{</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;  parallel_object_only();</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;  <span class="comment">// Return immediately if there&#39;s nothing to gather</span></div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>() == 1)</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;  <span class="comment">// We might get to return immediately if none of the processors</span></div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;  <span class="comment">// found any constraints</span></div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> has_constraints = !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty();</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(has_constraints);</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;  <span class="keywordflow">if</span> (!has_constraints)</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    {</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;      <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_dof = i.first;</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;      <span class="comment">// We only need the dependencies of our own constrained dofs</span></div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(constrained_dof))</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = i.second;</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : constraint_row)</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        {</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraint_dependency = j.first;</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;          <span class="comment">// No point in adding one of our own dofs to the send_list</span></div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(constraint_dependency))</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;          <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(constraint_dependency);</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;        }</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    }</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae17b27f47b3731f6ce72312edd957bf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae17b27f47b3731f6ce72312edd957bf7">&#9670;&nbsp;</a></span>add_coupling_functor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_coupling_functor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;&#160;</td>
          <td class="paramname"><em>coupling_functor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_mesh</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a functor which can specify coupling requirements for creation of sparse matrices. Degree of freedom pairs which match the elements and variables returned by these functors will be added to the sparsity pattern, and the degrees of freedom which live on other processors will be added to the send_list for use on ghosted vectors, and the elements which live on other processors will be ghosted on a distributed mesh.</p>
<p><a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> memory must be managed by the code which calls this function; the <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> lifetime is expected to extend until either the functor is removed or the <a class="el" href="classlibMesh_1_1DofMap.html" title="Manages the degrees of freedom (DOFs) in a simulation. ">DofMap</a> is destructed.</p>
<p>When <code>to_mesh</code> is true, the <code>coupling_functor</code> is also added to our associated mesh, to ensure that coupled elements do not get lost during mesh distribution. (if coupled elements were <em>already</em> lost there's no getting them back after the fact, sorry)</p>
<p>If <code>to_mesh</code> is false, no change to mesh ghosting is made; the <a class="el" href="classlibMesh_1_1Mesh.html" title="Manages a collection of Nodes and Elems. ">Mesh</a> must already have ghosting functor(s) specifying a superset of <code>coupling_functor</code> or this is a horrible bug. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01809">1809</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01618">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01518">_mesh</a>, and <a class="el" href="mesh__base_8h_source.html#l00823">libMesh::MeshBase::add_ghosting_functor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01800">add_default_ghosting()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, and <a class="el" href="dof__map_8C_source.html#l00130">DofMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;{</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.insert(&amp;coupling_functor);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="keywordflow">if</span> (to_mesh)</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ace4f8cf8f3c150cd6c5203e593fd26b3">add_ghosting_functor</a>(coupling_functor);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01618">dof_map.h:1618</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01518">dof_map.h:1518</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ace4f8cf8f3c150cd6c5203e593fd26b3"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ace4f8cf8f3c150cd6c5203e593fd26b3">libMesh::MeshBase::add_ghosting_functor</a></div><div class="ttdeci">void add_ghosting_functor(GhostingFunctor &amp;ghosting_functor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00823">mesh_base.h:823</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71555fd980f9337928ae75bc36a1bd4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71555fd980f9337928ae75bc36a1bd4e">&#9670;&nbsp;</a></span>add_default_ghosting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_default_ghosting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the default functor(s) for coupling and algebraic ghosting. User-added ghosting functors will be unaffected. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01800">1800</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8C_source.html#l01829">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01809">add_coupling_functor()</a>, <a class="el" href="dof__map_8h_source.html#l00379">default_algebraic_ghosting()</a>, and <a class="el" href="dof__map_8h_source.html#l00329">default_coupling()</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00322">libMesh::EquationSystems::enable_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;{</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">default_coupling</a>());</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">default_algebraic_ghosting</a>());</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aa387f2af29a1998bc1236a20a9870b64"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">libMesh::DofMap::default_coupling</a></div><div class="ttdeci">DefaultCoupling &amp; default_coupling()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00329">dof_map.h:329</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac341c27edd859113d774716d5ad18d9f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">libMesh::DofMap::default_algebraic_ghosting</a></div><div class="ttdeci">DefaultCoupling &amp; default_algebraic_ghosting()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00379">dof_map.h:379</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae17b27f47b3731f6ce72312edd957bf7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">libMesh::DofMap::add_coupling_functor</a></div><div class="ttdeci">void add_coupling_functor(GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01809">dof_map.C:1809</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9a0c5eeda42bc54bb3ae1c2d05ec5227"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">libMesh::DofMap::add_algebraic_ghosting_functor</a></div><div class="ttdeci">void add_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01829">dof_map.C:1829</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a47b7566f3cf2608d913792fd3e963b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b7566f3cf2608d913792fd3e963b5d">&#9670;&nbsp;</a></span>add_dirichlet_boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a copy of the specified Dirichlet boundary to the system. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04273">4273</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="diff__system_8C_source.html#l00227">libMesh::DifferentiableSystem::add_dot_var_dirichlet_bcs()</a>.</p>
<div class="fragment"><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;{</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;push_back(<span class="keyword">new</span> <a class="code" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a>(dirichlet_boundary));</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01721">dof_map.h:1721</a></div></div>
<div class="ttc" id="classlibMesh_1_1DirichletBoundary_html"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundary.html">libMesh::DirichletBoundary</a></div><div class="ttdoc">Class for specifying Dirichlet boundary conditions as constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00089">dirichlet_boundaries.h:89</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aed8eba054300e64164af4a8257bae8d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed8eba054300e64164af4a8257bae8d8">&#9670;&nbsp;</a></span>add_neighbors_to_send_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_neighbors_to_send_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adds entries to the <code>_send_list</code> vector corresponding to DoFs on elements neighboring the current processor. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01499">1499</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01547">_send_list</a>, <a class="el" href="dof__map_8h_source.html#l00367">algebraic_ghosting_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00373">algebraic_ghosting_functors_end()</a>, <a class="el" href="dof__map_8h_source.html#l00317">coupling_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00323">coupling_functors_end()</a>, <a class="el" href="dof__map_8C_source.html#l01930">dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l00738">local_index()</a>, <a class="el" href="dof__map_8C_source.html#l01432">merge_ghost_functor_outputs()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__map_8h_source.html#l00541">n_variables()</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, and <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;{</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;add_neighbors_to_send_list()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>();</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  MeshBase::const_element_iterator       local_elem_it</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_elements_begin();</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="keyword">const</span> MeshBase::const_element_iterator local_elem_end</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_elements_end();</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <a class="code" href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">GhostingFunctor::map_type</a> elements_to_send;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">// Man, I wish we had guaranteed unique_ptr availability...</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  std::set&lt;CouplingMatrix *&gt; temporary_coupling_matrices;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="comment">// We need to add dofs to the send list if they&#39;ve been directly</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="comment">// requested by an algebraic ghosting functor or they&#39;ve been</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="comment">// indirectly requested by a coupling functor.</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af63ec595dadc28f2b6673499641a1683">merge_ghost_functor_outputs</a>(elements_to_send,</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                                    temporary_coupling_matrices,</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1ed266bbf799984810031a7c7693ac10">algebraic_ghosting_functors_begin</a>(),</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a59b52496e0c72a29d73d87e499bb7993">algebraic_ghosting_functors_end</a>(),</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                                    local_elem_it, local_elem_end, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.processor_id());</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af63ec595dadc28f2b6673499641a1683">merge_ghost_functor_outputs</a>(elements_to_send,</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                                    temporary_coupling_matrices,</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#acd64cdbcb7af43bb9d35f4e2266ff0b3">coupling_functors_begin</a>(),</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6e35c4e14684a92a817a75e5b29cddd8">coupling_functors_end</a>(),</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                    local_elem_it, local_elem_end, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.processor_id());</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="comment">// Making a list of non-zero coupling matrix columns is an</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="comment">// O(N_var^2) operation.  We cache it so we only have to do it once</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">// per CouplingMatrix and not once per element.</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  std::map&lt;const CouplingMatrix *, std::vector&lt;unsigned int&gt;&gt;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    column_variable_lists;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pr : elements_to_send)</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    {</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="keyword">const</span> Elem * <span class="keyword">const</span> partner = pr.first;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <span class="comment">// We asked ghosting functors not to give us local elements</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      libmesh_assert_not_equal_to</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        (partner-&gt;processor_id(), this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>());</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="keyword">const</span> CouplingMatrix * ghost_coupling = pr.second;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="comment">// Loop over any present coupling matrix column variables if we</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="comment">// have a coupling matrix, or just add all variables to</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="comment">// send_list if not.</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="keywordflow">if</span> (ghost_coupling)</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        {</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;          libmesh_assert_equal_to (ghost_coupling-&gt;size(), n_var);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;          <span class="comment">// Try to find a cached list of column variables.</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;          std::map&lt;const CouplingMatrix *, std::vector&lt;unsigned int&gt;&gt;::const_iterator</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            column_variable_list = column_variable_lists.find(ghost_coupling);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;          <span class="comment">// If we didn&#39;t find it, then we need to create it.</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;          <span class="keywordflow">if</span> (column_variable_list == column_variable_lists.end())</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            {</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;              std::pair&lt;std::map&lt;const CouplingMatrix *, std::vector&lt;unsigned int&gt;&gt;::iterator, <span class="keywordtype">bool</span>&gt;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                inserted_variable_list_pair = column_variable_lists.insert(std::make_pair(ghost_coupling,</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                                                                          std::vector&lt;unsigned int&gt;()));</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;              column_variable_list = inserted_variable_list_pair.first;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;              std::vector&lt;unsigned int&gt; &amp; new_variable_list =</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                inserted_variable_list_pair.first-&gt;second;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;              std::vector&lt;unsigned char&gt; has_variable(n_var, <span class="keyword">false</span>);</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vi = 0; vi != n_var; ++vi)</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                {</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                  ConstCouplingRow ccr(vi, *ghost_coupling);</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; vj : ccr)</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                    has_variable[vj] = <span class="keyword">true</span>;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vj = 0; vj != n_var; ++vj)</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                {</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                  <span class="keywordflow">if</span> (has_variable[vj])</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                    new_variable_list.push_back(vj);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            }</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;          <span class="keyword">const</span> std::vector&lt;unsigned int&gt; &amp; variable_list =</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            column_variable_list-&gt;second;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; vj : variable_list)</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            {</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;              std::vector&lt;dof_id_type&gt; di;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a> (partner, di, vj);</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;              <span class="comment">// Insert the remote DOF indices into the send list</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : di)</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(d))</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                  <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(d);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            }</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        }</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        {</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          std::vector&lt;dof_id_type&gt; di;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a> (partner, di);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;          <span class="comment">// Insert the remote DOF indices into the send list</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : di)</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(dof))</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(dof);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        }</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    }</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">// We&#39;re now done with any merged coupling matrices we had to create.</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; mat : temporary_coupling_matrices)</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keyword">delete</span> mat;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="comment">// Our coupling functors added dofs from neighboring elements to the</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="comment">// send list, but we may still need to add non-local dofs from local</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="comment">// elements.</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="comment">// Loop over the active local elements, adding all active elements</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="comment">// that neighbor an active local element to the send list.</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="keywordflow">for</span> ( ; local_elem_it != local_elem_end; ++local_elem_it)</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    {</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="keyword">const</span> Elem * elem = *local_elem_it;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      std::vector&lt;dof_id_type&gt; di;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a> (elem, di);</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="comment">// Insert the remote DOF indices into the send list</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : di)</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(dof))</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;          <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(dof);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    }</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_acd64cdbcb7af43bb9d35f4e2266ff0b3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#acd64cdbcb7af43bb9d35f4e2266ff0b3">libMesh::DofMap::coupling_functors_begin</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_begin() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00317">dof_map.h:317</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3962af7f276a08be8f22bffd304bdab7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01930">dof_map.C:1930</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a25b3182cbf57ead72821d826275512b0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00541">dof_map.h:541</a></div></div>
<div class="ttc" id="classlibMesh_1_1GhostingFunctor_html_a3c27b499ef3153d8aaaa2088beba4480"><div class="ttname"><a href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">libMesh::GhostingFunctor::map_type</a></div><div class="ttdeci">std::unordered_map&lt; const Elem *, const CouplingMatrix * &gt; map_type</div><div class="ttdef"><b>Definition:</b> <a href="ghosting__functor_8h_source.html#l00154">ghosting_functor.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a59b52496e0c72a29d73d87e499bb7993"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a59b52496e0c72a29d73d87e499bb7993">libMesh::DofMap::algebraic_ghosting_functors_end</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator algebraic_ghosting_functors_end() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00373">dof_map.h:373</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6e35c4e14684a92a817a75e5b29cddd8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6e35c4e14684a92a817a75e5b29cddd8">libMesh::DofMap::coupling_functors_end</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_end() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00323">dof_map.h:323</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1ed266bbf799984810031a7c7693ac10"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1ed266bbf799984810031a7c7693ac10">libMesh::DofMap::algebraic_ghosting_functors_begin</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator algebraic_ghosting_functors_begin() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00367">dof_map.h:367</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af63ec595dadc28f2b6673499641a1683"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af63ec595dadc28f2b6673499641a1683">libMesh::DofMap::merge_ghost_functor_outputs</a></div><div class="ttdeci">static void merge_ghost_functor_outputs(GhostingFunctor::map_type &amp;elements_to_ghost, std::set&lt; CouplingMatrix *&gt; &amp;temporary_coupling_matrices, const std::set&lt; GhostingFunctor *&gt;::iterator &amp;gf_begin, const std::set&lt; GhostingFunctor *&gt;::iterator &amp;gf_end, const MeshBase::const_element_iterator &amp;elems_begin, const MeshBase::const_element_iterator &amp;elems_end, processor_id_type p)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01432">dof_map.C:1432</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ade407291cc858bb97e3476cd47259702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade407291cc858bb97e3476cd47259702">&#9670;&nbsp;</a></span>add_periodic_boundary() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_periodic_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;&#160;</td>
          <td class="paramname"><em>periodic_boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a copy of the specified periodic boundary to the system. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04393">4393</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone()</a>, <a class="el" href="periodic__boundary__base_8C_source.html#l00059">libMesh::PeriodicBoundaryBase::merge()</a>, <a class="el" href="periodic__boundary__base_8h_source.html#l00059">libMesh::PeriodicBoundaryBase::myboundary</a>, and <a class="el" href="periodic__boundary__base_8h_source.html#l00059">libMesh::PeriodicBoundaryBase::pairedboundary</a>.</p>
<div class="fragment"><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;{</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;  <span class="comment">// See if we already have a periodic boundary associated myboundary...</span></div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;  <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * existing_boundary = <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;boundary(periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>);</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;  <span class="keywordflow">if</span> (existing_boundary == <span class="keyword">nullptr</span>)</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    {</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;      <span class="comment">// ...if not, clone the input (and its inverse) and add them to the PeriodicBoundaries object</span></div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;      <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * boundary = periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>().release();</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;      <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * inverse_boundary = periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>(<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a0d7044909251be42051d019cfd3e8dc7a4340508bb4bc47cb649a5f4716407a31">PeriodicBoundaryBase::INVERSE</a>).release();</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      <span class="comment">// _periodic_boundaries takes ownership of the pointers</span></div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;insert(std::make_pair(boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, boundary));</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;insert(std::make_pair(inverse_boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, inverse_boundary));</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    }</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    {</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      <span class="comment">// ...otherwise, merge this object&#39;s variable IDs with the existing boundary object&#39;s.</span></div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      existing_boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae5706185efc36bd840b9ecbd38e74ecc">merge</a>(periodic_boundary);</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      <span class="comment">// Do the same merging process for the inverse boundary.  Note: the inverse better already exist!</span></div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;      <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * inverse_boundary = <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;boundary(periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">pairedboundary</a>);</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;      libmesh_assert(inverse_boundary);</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;      inverse_boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae5706185efc36bd840b9ecbd38e74ecc">merge</a>(periodic_boundary);</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    }</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_ae13b4c2ab5ee3d245de1f0147adf0518"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">libMesh::PeriodicBoundaryBase::pairedboundary</a></div><div class="ttdeci">boundary_id_type pairedboundary</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00059">periodic_boundary_base.h:59</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_ae5706185efc36bd840b9ecbd38e74ecc"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#ae5706185efc36bd840b9ecbd38e74ecc">libMesh::PeriodicBoundaryBase::merge</a></div><div class="ttdeci">void merge(const PeriodicBoundaryBase &amp;pb)</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8C_source.html#l00059">periodic_boundary_base.C:59</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a8a4f08f0de1b7be3dadb7f03a72e3c0e"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">libMesh::PeriodicBoundaryBase::myboundary</a></div><div class="ttdeci">boundary_id_type myboundary</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00059">periodic_boundary_base.h:59</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a658208e4484e7d10ae3f9a46a0461bcc"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone</a></div><div class="ttdeci">virtual std::unique_ptr&lt; PeriodicBoundaryBase &gt; clone(TransformationType t=FORWARD) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01707">dof_map.h:1707</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html">libMesh::PeriodicBoundaryBase</a></div><div class="ttdoc">Base class for all PeriodicBoundary implementations. </div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00049">periodic_boundary_base.h:49</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a0d7044909251be42051d019cfd3e8dc7a4340508bb4bc47cb649a5f4716407a31"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a0d7044909251be42051d019cfd3e8dc7a4340508bb4bc47cb649a5f4716407a31">libMesh::PeriodicBoundaryBase::INVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00054">periodic_boundary_base.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a724af7741f2b45c26cf950b2f3b6d146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a724af7741f2b45c26cf950b2f3b6d146">&#9670;&nbsp;</a></span>add_periodic_boundary() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_periodic_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;&#160;</td>
          <td class="paramname"><em>inverse_boundary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a periodic boundary pair</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>- primary boundary </td></tr>
    <tr><td class="paramname">inverse_boundary</td><td>- inverse boundary </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04423">4423</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone()</a>, <a class="el" href="periodic__boundary__base_8h_source.html#l00059">libMesh::PeriodicBoundaryBase::myboundary</a>, and <a class="el" href="periodic__boundary__base_8h_source.html#l00059">libMesh::PeriodicBoundaryBase::pairedboundary</a>.</p>
<div class="fragment"><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;{</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  libmesh_assert_equal_to (boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, inverse_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">pairedboundary</a>);</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;  libmesh_assert_equal_to (boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">pairedboundary</a>, inverse_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>);</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  <span class="comment">// Allocate copies on the heap.  The _periodic_boundaries object will manage this memory.</span></div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;  <span class="comment">// Note: this also means that the copy constructor for the PeriodicBoundary (or user class</span></div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;  <span class="comment">// derived therefrom) must be implemented!</span></div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  <span class="comment">// PeriodicBoundary * p_boundary = new PeriodicBoundary(boundary);</span></div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;  <span class="comment">// PeriodicBoundary * p_inverse_boundary = new PeriodicBoundary(inverse_boundary);</span></div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  <span class="comment">// We can&#39;t use normal copy construction since this leads to slicing with derived classes.</span></div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;  <span class="comment">// Use clone() &quot;virtual constructor&quot; instead.  But, this *requires* user to override the clone()</span></div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  <span class="comment">// method.  Note also that clone() allocates memory.  In this case, the _periodic_boundaries object</span></div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;  <span class="comment">// takes responsibility for cleanup.</span></div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;  <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * p_boundary = boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>().release();</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;  <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * p_inverse_boundary = inverse_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>().release();</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;  <span class="comment">// Add the periodic boundary and its inverse to the PeriodicBoundaries data structure.  The</span></div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;  <span class="comment">// PeriodicBoundaries data structure takes ownership of the pointers.</span></div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;insert(std::make_pair(p_boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, p_boundary));</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;insert(std::make_pair(p_inverse_boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, p_inverse_boundary));</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_ae13b4c2ab5ee3d245de1f0147adf0518"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">libMesh::PeriodicBoundaryBase::pairedboundary</a></div><div class="ttdeci">boundary_id_type pairedboundary</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00059">periodic_boundary_base.h:59</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a8a4f08f0de1b7be3dadb7f03a72e3c0e"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">libMesh::PeriodicBoundaryBase::myboundary</a></div><div class="ttdeci">boundary_id_type myboundary</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00059">periodic_boundary_base.h:59</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a658208e4484e7d10ae3f9a46a0461bcc"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone</a></div><div class="ttdeci">virtual std::unique_ptr&lt; PeriodicBoundaryBase &gt; clone(TransformationType t=FORWARD) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01707">dof_map.h:1707</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html">libMesh::PeriodicBoundaryBase</a></div><div class="ttdoc">Base class for all PeriodicBoundary implementations. </div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00049">periodic_boundary_base.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4133d7ac625a4524f438c6b4589de0f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4133d7ac625a4524f438c6b4589de0f3">&#9670;&nbsp;</a></span>add_variable_group()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_variable_group </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &amp;&#160;</td>
          <td class="paramname"><em>var_group</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add an unknown of order <code>order</code> and finite element type <code>type</code> to the system of equations. Add a group of unknowns of order <code>order</code> and finite element type <code>type</code> to the system of equations. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00245">245</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01508">_variable_group_numbers</a>, <a class="el" href="dof__map_8h_source.html#l01503">_variable_groups</a>, <a class="el" href="dof__map_8h_source.html#l01498">_variables</a>, and <a class="el" href="variable_8h_source.html#l00217">libMesh::VariableGroup::n_variables()</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg = cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.push_back(var_group);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  VariableGroup &amp; new_var_group = <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.back();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> var=0; var&lt;new_var_group.n_variables(); var++)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.push_back (new_var_group(var));</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>.push_back (vg);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01503">dof_map.h:1503</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01498">dof_map.h:1498</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01508">dof_map.h:1508</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ed266bbf799984810031a7c7693ac10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed266bbf799984810031a7c7693ac10">&#9670;&nbsp;</a></span>algebraic_ghosting_functors_begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::const_iterator libMesh::DofMap::algebraic_ghosting_functors_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Beginning of range of algebraic ghosting functors </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00367">367</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01605">_algebraic_ghosting_functors</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.begin(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01605">dof_map.h:1605</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59b52496e0c72a29d73d87e499bb7993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b52496e0c72a29d73d87e499bb7993">&#9670;&nbsp;</a></span>algebraic_ghosting_functors_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::const_iterator libMesh::DofMap::algebraic_ghosting_functors_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>End of range of algebraic ghosting functors </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00373">373</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01605">_algebraic_ghosting_functors</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.end(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01605">dof_map.h:1605</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a23e77e8156c618833437ebb0f3984aa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e77e8156c618833437ebb0f3984aa4">&#9670;&nbsp;</a></span>all_semilocal_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::all_semilocal_indices </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if all degree of freedom indices in <code>dof_indices</code> are either local indices or in the <code>send_list</code>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is an O(logN) operation for a send_list of size N; we don't cache enough information for O(1) right now. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02400">2400</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8C_source.html#l02384">semilocal_index()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l02413">is_evaluable()</a>.</p>
<div class="fragment"><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;{</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <span class="comment">// We&#39;re all semilocal unless we find a counterexample</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; di : dof_indices_in)</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8374de5322b20e3e4719c5c04b038291">semilocal_index</a>(di))</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a8374de5322b20e3e4719c5c04b038291"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8374de5322b20e3e4719c5c04b038291">libMesh::DofMap::semilocal_index</a></div><div class="ttdeci">bool semilocal_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02384">dof_map.C:2384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a21fda1ca99f13ac340a05a8e41ecc8e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21fda1ca99f13ac340a05a8e41ecc8e9">&#9670;&nbsp;</a></span>allgather_recursive_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::allgather_recursive_constraints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gathers constraint equation dependencies from other processors </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02595">2595</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">libMesh::MeshBase::active_not_local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">libMesh::MeshBase::active_not_local_elements_end()</a>, <a class="el" href="simple__range_8h_source.html#l00057">libMesh::as_range()</a>, <a class="el" href="variant__filter__iterator_8h_source.html#l00337">data</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="int__range_8h_source.html#l00104">libMesh::index_range()</a>, <a class="el" href="mesh__base_8h_source.html#l00154">libMesh::MeshBase::is_serial()</a>, <a class="el" href="libmesh__common_8h_source.html#l00172">libMesh::libmesh_isnan()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__object_8h_source.html#l00803">libMesh::DofObject::n_comp()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="tecplot__io_8C_source.html#l00069">n_vars</a>, <a class="el" href="dof__object_8h_source.html#l00768">libMesh::DofObject::n_vars()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">libMesh::MeshBase::node_ptr()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="parallel__sync_8h_source.html#l00472">libMesh::Parallel::pull_parallel_vector_data()</a>, <a class="el" href="parallel__sync_8h_source.html#l00239">libMesh::Parallel::push_parallel_vector_data()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, <a class="el" href="type__vector_8h_source.html#l00901">libMesh::TypeVector&lt; T &gt;::size()</a>, and <a class="el" href="request_8C_source.html#l00213">libMesh::Parallel::wait()</a>.</p>
<div class="fragment"><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;{</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;  parallel_object_only();</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="comment">// Return immediately if there&#39;s nothing to gather</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>() == 1)</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="comment">// We might get to return immediately if none of the processors</span></div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  <span class="comment">// found any constraints</span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> has_constraints = !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty()</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    || !<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.empty()</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    ;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(has_constraints);</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="keywordflow">if</span> (!has_constraints)</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <span class="comment">// If we have heterogenous adjoint constraints we need to</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  <span class="comment">// communicate those too.</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_qoi_num =</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.empty() ?</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    0 : <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.rbegin()-&gt;first;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  <span class="comment">// We might have calculated constraints for constrained dofs</span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;  <span class="comment">// which have support on other processors.</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;  <span class="comment">// Push these out first.</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  {</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_ids;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_node_ids;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="comment">// Collect the constraints to push to each processor</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">as_range</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">active_not_local_elements_begin</a>(),</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                                <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">active_not_local_elements_end</a>()))</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      {</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = elem-&gt;n_nodes();</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <span class="comment">// Just checking dof_indices on the foreign element isn&#39;t</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="comment">// enough.  Consider a central hanging node between a coarse</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        <span class="comment">// Q2/Q1 element and its finer neighbors on a higher-ranked</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        <span class="comment">// processor.  The coarse element&#39;s processor will own the node,</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;        <span class="comment">// and will thereby own the pressure dof on that node, despite</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        <span class="comment">// the fact that that pressure dof doesn&#39;t directly exist on the</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        <span class="comment">// coarse element!</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <span class="comment">// So, we loop through dofs manually.</span></div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        {</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = elem-&gt;n_vars(sys_num);</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; ++v)</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            {</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = elem-&gt;n_comp(sys_num,v);</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c != n_comp; ++c)</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                {</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> =</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                    elem-&gt;dof_number(sys_num,v,c);</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(<span class="keywordtype">id</span>))</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                    pushed_ids[elem-&gt;processor_id()].insert(<span class="keywordtype">id</span>);</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                }</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;            }</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        }</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> n = 0; n != <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; ++n)</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;          {</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> &amp; node = elem-&gt;node_ref(n);</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = node.<a class="code" href="classlibMesh_1_1DofObject.html#ad6d0f2187ecac68bc6753440afcc42cc">n_vars</a>(sys_num);</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; ++v)</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;              {</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node.<a class="code" href="classlibMesh_1_1DofObject.html#a1fb8ad13b6e0913f35c843d331909f66">n_comp</a>(sys_num,v);</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c != n_comp; ++c)</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                  {</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> =</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                      node.<a class="code" href="classlibMesh_1_1DofObject.html#a4e8bf039eb9c13b7eb3aaf96afc8c8b8">dof_number</a>(sys_num,v,c);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(<span class="keywordtype">id</span>))</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                      pushed_ids[elem-&gt;processor_id()].insert(<span class="keywordtype">id</span>);</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                  }</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;              }</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;          }</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> n = 0; n != <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; ++n)</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad7a9aeffe76edfe89cc65a16035b864e">is_constrained_node</a>(elem-&gt;node_ptr(n)))</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            pushed_node_ids[elem-&gt;processor_id()].insert(elem-&gt;node_id(n));</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      }</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="comment">// Rewrite those id sets as vectors for sending and receiving,</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="comment">// then find the corresponding data for each id, then push it all.</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      pushed_id_vecs, received_id_vecs;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_ids)</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      pushed_id_vecs[p.first].assign(p.second.begin(), p.second.end());</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt;&gt;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      pushed_keys_vals, received_keys_vals;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;std::vector&lt;Number&gt;&gt;&gt; pushed_rhss, received_rhss;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_id_vecs)</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;      {</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;        <span class="keyword">auto</span> &amp; keys_vals = pushed_keys_vals[p.first];</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        keys_vals.reserve(p.second.size());</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        <span class="keyword">auto</span> &amp; rhss = pushed_rhss[p.first];</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        rhss.reserve(p.second.size());</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pushed_id : p.second)</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;          {</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[pushed_id];</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            keys_vals.emplace_back(row.begin(), row.end());</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;            rhss.push_back(std::vector&lt;Number&gt;(max_qoi_num+1));</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            std::vector&lt;Number&gt; &amp; rhs = rhss.back();</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;            DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(pushed_id);</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;            rhs[max_qoi_num] =</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;              (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;              0 : rhsit-&gt;second;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;            for (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;              {</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                AdjointDofConstraintValues::const_iterator adjoint_map_it =</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                  <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                  adjoint_map_it-&gt;second;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                DofConstraintValueMap::const_iterator adj_rhsit =</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                  constraint_map.find(pushed_id);</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                rhs[q] =</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                  (adj_rhsit == constraint_map.end()) ?</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                  0 : adj_rhsit-&gt;second;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;              }</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;          }</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      }</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="keyword">auto</span> ids_action_functor =</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      [&amp; received_id_vecs]</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;       <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      {</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        received_id_vecs[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      };</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_id_vecs, ids_action_functor);</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <span class="keyword">auto</span> keys_vals_action_functor =</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      [&amp; received_keys_vals]</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      {</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        received_keys_vals[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      };</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_keys_vals, keys_vals_action_functor);</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keyword">auto</span> rhss_action_functor =</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      [&amp; received_rhss]</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::vector&lt;Number&gt;&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      {</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        received_rhss[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      };</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_rhss, rhss_action_functor);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <span class="comment">// Now we have all the DofConstraint rows and rhs values received</span></div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="comment">// from others, so add the DoF constraints that we&#39;ve been sent</span></div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      pushed_node_id_vecs, received_node_id_vecs;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_node_ids)</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      pushed_node_id_vecs[p.first].assign(p.second.begin(), p.second.end());</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt;&gt;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      pushed_node_keys_vals, received_node_keys_vals;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;Point&gt;&gt; pushed_offsets, received_offsets;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_node_id_vecs)</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      {</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        <span class="keyword">auto</span> &amp; node_keys_vals = pushed_node_keys_vals[p.first];</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        node_keys_vals.reserve(p.second.size());</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <span class="keyword">auto</span> &amp; offsets = pushed_offsets[p.first];</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        offsets.reserve(p.second.size());</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pushed_node_id : p.second)</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;          {</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;            <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(pushed_node_id);</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;            <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[node].first;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;            <span class="keyword">const</span> std::size_t row_size = row.size();</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;            node_keys_vals.push_back</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;              (std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;());</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;            std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt; &amp; this_node_kv =</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;              node_keys_vals.back();</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            this_node_kv.reserve(row_size);</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;              this_node_kv.push_back</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                (std::make_pair(j.first-&gt;id(), j.second));</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            offsets.push_back(<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[node].second);</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;          }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      }</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="keyword">auto</span> node_ids_action_functor =</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      [&amp; received_node_id_vecs]</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;       <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      {</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        received_node_id_vecs[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      };</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_node_id_vecs, node_ids_action_functor);</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="keyword">auto</span> node_keys_vals_action_functor =</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      [&amp; received_node_keys_vals]</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      {</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        received_node_keys_vals[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      };</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_node_keys_vals,</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;       node_keys_vals_action_functor);</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keyword">auto</span> node_offsets_action_functor =</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      [&amp; received_offsets]</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;      (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;       <span class="keyword">const</span> std::vector&lt;Point&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      {</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        received_offsets[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      };</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_offsets, node_offsets_action_functor);</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    <span class="comment">// Add all the dof constraints that I&#39;ve been sent</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : received_id_vecs)</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      {</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = p.first;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_ids_to_me = p.second;</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        libmesh_assert(received_keys_vals.count(pid));</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        libmesh_assert(received_rhss.count(pid));</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_keys_vals_to_me = received_keys_vals.at(pid);</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_rhss_to_me = received_rhss.at(pid);</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        libmesh_assert_equal_to (pushed_ids_to_me.size(),</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                                 pushed_keys_vals_to_me.size());</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        libmesh_assert_equal_to (pushed_ids_to_me.size(),</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                                 pushed_rhss_to_me.size());</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(pushed_ids_to_me))</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;          {</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;            <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = pushed_ids_to_me[i];</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;            <span class="comment">// If we don&#39;t already have a constraint for this dof,</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;            <span class="comment">// add the one we were sent</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(constrained))</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;              {</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; kv : pushed_keys_vals_to_me[i])</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                  row[kv.first] = kv.second;</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> primal_rhs = pushed_rhss_to_me[i][max_qoi_num];</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh.html#a5e09b0d6841d128904914c0d40b02700">libmesh_isnan</a>(primal_rhs))</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;                  libmesh_assert(pushed_keys_vals_to_me[i].empty());</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                <span class="keywordflow">if</span> (primal_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[constrained] = primal_rhs;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(constrained);</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                  {</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                    AdjointDofConstraintValues::iterator adjoint_map_it =</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                      <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> adj_rhs = pushed_rhss_to_me[i][q];</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                    <span class="keywordflow">if</span> ((adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end()) &amp;&amp;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                        adj_rhs == <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                    <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                      adjoint_map_it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.insert</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                        (std::make_pair(q,<a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a>())).first;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                    <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                      adjoint_map_it-&gt;second;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                    <span class="keywordflow">if</span> (adj_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                      constraint_map[constrained] = adj_rhs;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                      constraint_map.erase(constrained);</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                  }</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;              }</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;          }</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      }</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    <span class="comment">// Add all the node constraints that I&#39;ve been sent</span></div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : received_node_id_vecs)</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = p.first;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_node_ids_to_me = p.second;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;        libmesh_assert(received_node_keys_vals.count(pid));</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;        libmesh_assert(received_offsets.count(pid));</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_node_keys_vals_to_me = received_node_keys_vals.at(pid);</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_offsets_to_me = received_offsets.at(pid);</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        libmesh_assert_equal_to (pushed_node_ids_to_me.size(),</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                                 pushed_node_keys_vals_to_me.size());</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        libmesh_assert_equal_to (pushed_node_ids_to_me.size(),</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                                 pushed_offsets_to_me.size());</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(pushed_node_ids_to_me))</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          {</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;            <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = pushed_node_ids_to_me[i];</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;            <span class="comment">// If we don&#39;t already have a constraint for this node,</span></div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;            <span class="comment">// add the one we were sent</span></div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;            <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(constrained_id);</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad7a9aeffe76edfe89cc65a16035b864e">is_constrained_node</a>(constrained))</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;              {</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].first;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; kv : pushed_node_keys_vals_to_me[i])</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                  {</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * key_node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(kv.first);</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                    libmesh_assert(key_node);</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                    row[key_node] = kv.second;</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                  }</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].second = pushed_offsets_to_me[i];</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;              }</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          }</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      }</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;  }</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  <span class="comment">// Now start checking for any other constraints we need</span></div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;  <span class="comment">// to know about, requesting them recursively.</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;  <span class="comment">// Create sets containing the DOFs and nodes we already depend on</span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; DoF_RCSet;</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  DoF_RCSet unexpanded_dofs;</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    unexpanded_dofs.insert(i.first);</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  <span class="comment">// Gather all the dof constraints we need</span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">gather_constraints</a>(mesh, unexpanded_dofs, <span class="keyword">false</span>);</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  <span class="comment">// Gather all the node constraints we need</span></div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;  <span class="keyword">typedef</span> std::set&lt;const Node *&gt; Node_RCSet;</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  Node_RCSet unexpanded_nodes;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    unexpanded_nodes.insert(i.first);</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  <span class="comment">// We have to keep recursing while the unexpanded set is</span></div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  <span class="comment">// nonempty on *any* processor</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  <span class="keywordtype">bool</span> unexpanded_set_nonempty = !unexpanded_nodes.empty();</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(unexpanded_set_nonempty);</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;  <span class="comment">// We may be receiving packed_range sends out of order with</span></div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;  <span class="comment">// parallel_sync tags, so make sure they&#39;re received correctly.</span></div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;  <a class="code" href="classlibMesh_1_1Parallel_1_1MessageTag.html">Parallel::MessageTag</a> range_tag = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">get_unique_tag</a>(14142);</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;  <span class="keywordflow">while</span> (unexpanded_set_nonempty)</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    {</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <span class="comment">// Let&#39;s make sure we don&#39;t lose sync in this loop.</span></div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      parallel_object_only();</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      <span class="comment">// Request sets</span></div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      Node_RCSet node_request_set;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      <span class="comment">// Request sets to send to each processor</span></div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        requested_node_ids;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      <span class="comment">// And the sizes of each</span></div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      std::map&lt;processor_id_type, dof_id_type&gt; node_ids_on_proc;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      <span class="comment">// Fill (and thereby sort and uniq!) the main request sets</span></div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : unexpanded_nodes)</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        {</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;          <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[i].first;</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;            {</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;              <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * <span class="keyword">const</span> node = j.first;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;              libmesh_assert(node);</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;              <span class="comment">// If it&#39;s non-local and we haven&#39;t already got a</span></div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;              <span class="comment">// constraint for it, we might need to ask for one</span></div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;              <span class="keywordflow">if</span> ((node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()) &amp;&amp;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                  !_node_constraints.count(node))</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                node_request_set.insert(node);</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            }</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        }</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <span class="comment">// Clear the unexpanded constraint sets; we&#39;re about to expand</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <span class="comment">// them</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      unexpanded_nodes.clear();</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="comment">// Count requests by processor</span></div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; node : node_request_set)</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        {</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;          libmesh_assert(node);</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;          libmesh_assert_less (node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>(), this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>());</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;          node_ids_on_proc[node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>()]++;</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        }</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p = 0; p != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>(); ++p)</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        <span class="keywordflow">if</span> (node_ids_on_proc.count(p))</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;          requested_node_ids[p].reserve(node_ids_on_proc[p]);</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      <span class="comment">// Prepare each processor&#39;s request set</span></div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; node : node_request_set)</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        requested_node_ids[node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>()].push_back(node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">id</a>());</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      <span class="keyword">typedef</span> std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt; row_datum;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      <span class="comment">// We may need to send nodes ahead of data about them</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      std::vector&lt;Parallel::Request&gt; packed_range_sends;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      <span class="keyword">auto</span> node_row_gather_functor =</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        [<span class="keyword">this</span>,</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;         &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>,</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;         &amp; packed_range_sends,</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;         &amp; range_tag]</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;         std::vector&lt;row_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        {</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;          <span class="comment">// Do we need to keep track of requested nodes to send</span></div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;          <span class="comment">// later?</span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span> dist_mesh = !<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>();</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;          <span class="comment">// FIXME - this could be an unordered set, given a</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;          <span class="comment">// hash&lt;pointers&gt; specialization</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;          std::set&lt;const Node *&gt; nodes_requested;</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;          <span class="comment">// Fill those requests</span></div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;          <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>.resize(query_size);</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;            {</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;              <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained_node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(constrained_id);</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.count(constrained_node))</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                {</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained_node].first;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                  std::size_t row_size = row.size();</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                  <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].reserve(row_size);</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                    {</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * node = j.first;</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                      <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].push_back(std::make_pair(node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">id</a>(), j.second));</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                      <span class="comment">// If we&#39;re not sure whether our send</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                      <span class="comment">// destination already has this node, let&#39;s give</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                      <span class="comment">// it a copy.</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                      <span class="keywordflow">if</span> (node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != pid &amp;&amp; dist_mesh)</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                        nodes_requested.insert(node);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                      <span class="comment">// We can have 0 nodal constraint</span></div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                      <span class="comment">// coefficients, where no Lagrange constraint</span></div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                      <span class="comment">// exists but non-Lagrange basis constraints</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                      <span class="comment">// might.</span></div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                      <span class="comment">// libmesh_assert(j.second);</span></div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                    }</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                }</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                {</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                  <span class="comment">// We have to distinguish &quot;constraint with no</span></div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                  <span class="comment">// constraining nodes&quot; (e.g. due to user node</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                  <span class="comment">// constraint equations) from &quot;no constraint&quot;.</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                  <span class="comment">// We&#39;ll use invalid_id for the latter.</span></div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                  <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].push_back</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                    (std::make_pair(<a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>, <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>(0)));</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                }</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;            }</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;          <span class="comment">// Constraining nodes might not even exist on our</span></div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;          <span class="comment">// correspondant&#39;s subset of a distributed mesh, so let&#39;s</span></div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;          <span class="comment">// make them exist.</span></div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;          <span class="keywordflow">if</span> (dist_mesh)</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            {</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;              packed_range_sends.push_back(<a class="code" href="classlibMesh_1_1Parallel_1_1Request.html">Parallel::Request</a>());</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;              this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a74c8d3e50dde49ce417d58e7a3037f1c">send_packed_range</a></div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                (pid, &amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, nodes_requested.begin(), nodes_requested.end(),</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                 packed_range_sends.back(), range_tag);</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;            }</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        };</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      <span class="keyword">typedef</span> <a class="code" href="classlibMesh_1_1Point.html">Point</a> node_rhs_datum;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      <span class="keyword">auto</span> node_rhs_gather_functor =</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;        [<span class="keyword">this</span>,</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;         &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>]</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;         std::vector&lt;node_rhs_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        {</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;          <span class="comment">// Fill those requests</span></div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.<a class="code" href="classlibMesh_1_1TypeVector.html#a176e13abd7aa4c31ec18ce82087f2972">size</a>();</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;          <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>.resize(query_size);</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;            {</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;              <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained_node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(constrained_id);</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.count(constrained_node))</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;                <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i] = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained_node].second;</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;                <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i](0) = std::numeric_limits&lt;Real&gt;::quiet_NaN();</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;            }</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        };</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      <span class="keyword">auto</span> node_row_action_functor =</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        [<span class="keyword">this</span>,</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;         &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>,</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;         &amp; range_tag,</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;         &amp; unexpanded_nodes]</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;         <span class="keyword">const</span> std::vector&lt;row_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        {</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;          <span class="comment">// Before we act on any new constraint rows, we may need to</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;          <span class="comment">// make sure we have all the nodes involved!</span></div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>())</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;            this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3be3c4a2df02a610cc7234e3029164d8">receive_packed_range</a></div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;              (pid, &amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, <a class="code" href="structlibMesh_1_1mesh__inserter__iterator.html">mesh_inserter_iterator&lt;Node&gt;</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>),</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;               (<a class="code" href="classlibMesh_1_1Node.html">Node</a>**)<span class="keyword">nullptr</span>, range_tag);</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;          <span class="comment">// Add any new constraint rows we&#39;ve found</span></div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;            {</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;              <span class="comment">// An empty row is an constraint with an empty row; for</span></div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;              <span class="comment">// no constraint we use a &quot;no row&quot; placeholder</span></div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].empty())</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                {</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained_node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(constrained_id);</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                  <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained_node].first;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;                  row.clear();</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                }</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][0].first != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                {</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained_node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(constrained_id);</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                  <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained_node].first;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;                  row.clear();</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i])</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                    {</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * key_node =</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;                        <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(pair.first);</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;                      libmesh_assert(key_node);</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;                      row[key_node] = pair.second;</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;                    }</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;                  <span class="comment">// And prepare to check for more recursive constraints</span></div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                  unexpanded_nodes.insert(constrained_node);</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                }</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;            }</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        };</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      <span class="keyword">auto</span> node_rhs_action_functor =</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;        [<span class="keyword">this</span>,</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;         &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>]</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;         <span class="keyword">const</span> std::vector&lt;node_rhs_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        {</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;          <span class="comment">// Add rhs data for any new node constraint rows we&#39;ve found</span></div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;            {</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;              <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained_node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(constrained_id);</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="namespacelibMesh.html#a5e09b0d6841d128904914c0d40b02700">libmesh_isnan</a>(<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i](0)))</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained_node].second = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i];</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.erase(constrained_node);</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;            }</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        };</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;      <span class="comment">// Now request node constraint rows from other processors</span></div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      row_datum * node_row_ex = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <a class="code" href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">Parallel::pull_parallel_vector_data</a></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), requested_node_ids, node_row_gather_functor,</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;         node_row_action_functor, node_row_ex);</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      <span class="comment">// And request node constraint right hand sides from other procesors</span></div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      node_rhs_datum * node_rhs_ex = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      <a class="code" href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">Parallel::pull_parallel_vector_data</a></div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), requested_node_ids, node_rhs_gather_functor,</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;         node_rhs_action_functor, node_rhs_ex);</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      <a class="code" href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">Parallel::wait</a>(packed_range_sends);</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      <span class="comment">// We have to keep recursing while the unexpanded set is</span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      <span class="comment">// nonempty on *any* processor</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      unexpanded_set_nonempty = !unexpanded_nodes.empty();</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(unexpanded_set_nonempty);</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    }</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;}</div><div class="ttc" id="namespacelibMesh_1_1Parallel_html_aea5278a91928fa4f33b74aa0786f3592"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">libMesh::Parallel::wait</a></div><div class="ttdeci">void wait(std::vector&lt; Request &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="request_8C_source.html#l00213">request.C:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad7a9aeffe76edfe89cc65a16035b864e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad7a9aeffe76edfe89cc65a16035b864e">libMesh::DofMap::is_constrained_node</a></div><div class="ttdeci">bool is_constrained_node(const Node *node) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01812">dof_map.h:1812</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a4e8bf039eb9c13b7eb3aaf96afc8c8b8"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a4e8bf039eb9c13b7eb3aaf96afc8c8b8">libMesh::DofObject::dof_number</a></div><div class="ttdeci">dof_id_type dof_number(const unsigned int s, const unsigned int var, const unsigned int comp) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00833">dof_object.h:833</a></div></div>
<div class="ttc" id="classlibMesh_1_1Node_html"><div class="ttname"><a href="classlibMesh_1_1Node.html">libMesh::Node</a></div><div class="ttdoc">A geometric point in (x,y,z) space associated with a DOF. </div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00052">node.h:52</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a1fb8ad13b6e0913f35c843d331909f66"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a1fb8ad13b6e0913f35c843d331909f66">libMesh::DofObject::n_comp</a></div><div class="ttdeci">unsigned int n_comp(const unsigned int s, const unsigned int var) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00803">dof_object.h:803</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a74c8d3e50dde49ce417d58e7a3037f1c"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a74c8d3e50dde49ce417d58e7a3037f1c">libMesh::Parallel::Communicator::send_packed_range</a></div><div class="ttdeci">void send_packed_range(const unsigned int dest_processor_id, const Context *context, Iter range_begin, const Iter range_end, const MessageTag &amp;tag=no_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00562">parallel_implementation.h:562</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2ad8b64590135362f5ac09c581f828bf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">libMesh::DofMap::gather_constraints</a></div><div class="ttdeci">void gather_constraints(MeshBase &amp;mesh, std::set&lt; dof_id_type &gt; &amp;unexpanded_dofs, bool look_for_constrainees)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03871">dof_map_constraints.C:3871</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab64fa61b4505bc7554e508972dfaecd5"><div class="ttname"><a href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">libMesh::index_range</a></div><div class="ttdeci">IntRange&lt; std::size_t &gt; index_range(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00104">int_range.h:104</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3be3c4a2df02a610cc7234e3029164d8"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3be3c4a2df02a610cc7234e3029164d8">libMesh::Parallel::Communicator::receive_packed_range</a></div><div class="ttdeci">void receive_packed_range(const unsigned int dest_processor_id, Context *context, OutputIter out, const T *output_type, const MessageTag &amp;tag=any_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l01060">parallel_implementation.h:1060</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac865c9ea66f0b31884d53f156ce474ad"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">libMesh::Parallel::Communicator::get_unique_tag</a></div><div class="ttdeci">MessageTag get_unique_tag(int tagvalue) const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8C_source.html#l00201">communicator.C:201</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00069">tecplot_io.C:69</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0629d79c85d44523e4e11624aa96cd85"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">libMesh::MeshBase::is_serial</a></div><div class="ttdeci">virtual bool is_serial() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00154">mesh_base.h:154</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_ab95f1d0641d5b5591a97e1a11b57164d"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">libMesh::DofObject::id</a></div><div class="ttdeci">dof_id_type id() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00655">dof_object.h:655</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a21797734483c801c09fa26822455d989"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">libMesh::Parallel::pull_parallel_vector_data</a></div><div class="ttdeci">void pull_parallel_vector_data(const Communicator &amp;comm, const MapToVectors &amp;queries, RequestContainer &amp;reqs, GatherFunctor &amp;gather_data, ActionFunctor &amp;act_on_data, const datum *example)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__sync_8h_source.html#l00472">parallel_sync.h:472</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_ad6d0f2187ecac68bc6753440afcc42cc"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#ad6d0f2187ecac68bc6753440afcc42cc">libMesh::DofObject::n_vars</a></div><div class="ttdeci">unsigned int n_vars(const unsigned int s, const unsigned int vg) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00768">dof_object.h:768</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1MessageTag_html"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1MessageTag.html">libMesh::Parallel::MessageTag</a></div><div class="ttdef"><b>Definition:</b> <a href="message__tag_8h_source.html#l00047">message_tag.h:47</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a977361a82b7a9e7ad8e50ae1cae40d20"><div class="ttname"><a href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">libMesh::as_range</a></div><div class="ttdeci">SimpleRange&lt; I &gt; as_range(const std::pair&lt; I, I &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="simple__range_8h_source.html#l00057">simple_range.h:57</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="structlibMesh_1_1mesh__inserter__iterator_html"><div class="ttname"><a href="structlibMesh_1_1mesh__inserter__iterator.html">libMesh::mesh_inserter_iterator</a></div><div class="ttdoc">An output iterator for use with packed_range functions. </div><div class="ttdef"><b>Definition:</b> <a href="mesh__inserter__iterator_8h_source.html#l00046">mesh_inserter_iterator.h:46</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00117">dof_map.h:117</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a81252a490defae08c5fd39ffac034333"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">libMesh::MeshBase::active_not_local_elements_end</a></div><div class="ttdeci">virtual element_iterator active_not_local_elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Request_html"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Request.html">libMesh::Parallel::Request</a></div><div class="ttdef"><b>Definition:</b> <a href="request_8h_source.html#l00063">request.h:63</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5e09b0d6841d128904914c0d40b02700"><div class="ttname"><a href="namespacelibMesh.html#a5e09b0d6841d128904914c0d40b02700">libMesh::libmesh_isnan</a></div><div class="ttdeci">bool libmesh_isnan(float a)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00172">libmesh_common.h:172</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac68163904060c11860cd46b0fd9e4003"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">libMesh::MeshBase::active_not_local_elements_begin</a></div><div class="ttdeci">virtual element_iterator active_not_local_elements_begin()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00145">dof_map.h:145</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a2840c544bef5845992c918f1cb4669f1"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">libMesh::Parallel::push_parallel_vector_data</a></div><div class="ttdeci">void push_parallel_vector_data(const Communicator &amp;comm, const MapToVectors &amp;data, RequestContainer &amp;reqs, ActionFunctor &amp;act_on_data)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__sync_8h_source.html#l00239">parallel_sync.h:239</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a3464f722394258d66e04720e221f07ff"><div class="ttname"><a href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a></div><div class="ttdeci">IterBase * data</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00337">variant_filter_iterator.h:337</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_abc2fd76e7bf6c200f5e8849dfca9cd03"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">libMesh::MeshBase::node_ptr</a></div><div class="ttdeci">virtual const Node * node_ptr(const dof_id_type i) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="classlibMesh_1_1TypeVector_html_a176e13abd7aa4c31ec18ce82087f2972"><div class="ttname"><a href="classlibMesh_1_1TypeVector.html#a176e13abd7aa4c31ec18ce82087f2972">libMesh::TypeVector::size</a></div><div class="ttdeci">Real size() const</div><div class="ttdef"><b>Definition:</b> <a href="type__vector_8h_source.html#l00901">type_vector.h:901</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a754f2866ec9d8a49a02a68a32e7aa518"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">libMesh::DofObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00717">dof_object.h:717</a></div></div>
<div class="ttc" id="classlibMesh_1_1Point_html"><div class="ttname"><a href="classlibMesh_1_1Point.html">libMesh::Point</a></div><div class="ttdoc">A geometric point in (x,y,z) space. </div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00038">point.h:38</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36f672b01ab7060eb641b946abeff74b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36f672b01ab7060eb641b946abeff74b">&#9670;&nbsp;</a></span>attach_extra_send_list_function()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_send_list_function </td>
          <td>(</td>
          <td class="paramtype">void(*)(std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *)&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attach a function pointer to use as a callback to populate the send_list with extra entries. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00429">429</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01579">_extra_send_list_context</a>, and <a class="el" href="dof__map_8h_source.html#l01574">_extra_send_list_function</a>.</p>
<div class="fragment"><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">_extra_send_list_function</a> = func; <a class="code" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a> = context; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a6c450ba54bc8caffac28eed88a98a17d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">libMesh::DofMap::_extra_send_list_context</a></div><div class="ttdeci">void * _extra_send_list_context</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01579">dof_map.h:1579</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad61a1aecc00b716b0cf00f68c68e7c80"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">libMesh::DofMap::_extra_send_list_function</a></div><div class="ttdeci">void(* _extra_send_list_function)(std::vector&lt; dof_id_type &gt; &amp;, void *)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01574">dof_map.h:1574</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae50b05ef1b5ff63ad103626f5622729d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae50b05ef1b5ff63ad103626f5622729d">&#9670;&nbsp;</a></span>attach_extra_send_list_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_send_list_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">DofMap::AugmentSendList</a> &amp;&#160;</td>
          <td class="paramname"><em>asl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attach an object to populate the send_list with extra entries. This should only add to the send list, but no checking is done to enforce this behavior.</p>
<p>This is an advanced function... use at your own peril! </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00420">420</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01569">_augment_send_list</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a> = &amp;asl;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a409a5dccf85edf7260f6186482cb9c9c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">libMesh::DofMap::_augment_send_list</a></div><div class="ttdeci">AugmentSendList * _augment_send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01569">dof_map.h:1569</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5058fffef0da9dcdc175a0ee63f587d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5058fffef0da9dcdc175a0ee63f587d8">&#9670;&nbsp;</a></span>attach_extra_sparsity_function()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_sparsity_function </td>
          <td>(</td>
          <td class="paramtype">void(*)(<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;sparsity, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *)&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attach a function pointer to use as a callback to populate the sparsity pattern with extra entries.</p>
<p>Care must be taken that when adding entries they are sorted into the Rows</p>
<p>Further, you <em>must</em> modify n_nz and n_oz properly!</p>
<p>This is an advanced function... use at your own peril! </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00406">406</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01564">_extra_sparsity_context</a>, and <a class="el" href="dof__map_8h_source.html#l01557">_extra_sparsity_function</a>.</p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">_extra_sparsity_function</a> = func; <a class="code" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a> = context; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a283ce213140aa281498b56e138ee8de2"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">libMesh::DofMap::_extra_sparsity_context</a></div><div class="ttdeci">void * _extra_sparsity_context</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01564">dof_map.h:1564</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a727fc57aa0deeee20ce64711b56ccf65"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">libMesh::DofMap::_extra_sparsity_function</a></div><div class="ttdeci">void(* _extra_sparsity_function)(SparsityPattern::Graph &amp;, std::vector&lt; dof_id_type &gt; &amp;n_nz, std::vector&lt; dof_id_type &gt; &amp;n_oz, void *)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01557">dof_map.h:1557</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0b0f23dac6f24ce69e7aa1d2077d3b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0b0f23dac6f24ce69e7aa1d2077d3b8">&#9670;&nbsp;</a></span>attach_extra_sparsity_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_sparsity_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html">DofMap::AugmentSparsityPattern</a> &amp;&#160;</td>
          <td class="paramname"><em>asp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attach an object to use to populate the sparsity pattern with extra entries.</p>
<p>Care must be taken that when adding entries they are sorted into the Rows</p>
<p>Further, you <em>must</em> modify n_nz and n_oz properly!</p>
<p>This is an advanced function... use at your own peril! </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00391">391</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01552">_augment_sparsity_pattern</a>.</p>
<div class="fragment"><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">_augment_sparsity_pattern</a> = &amp;asp;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab5f0ce99b32ad1a22d5e78161d27ad3b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">libMesh::DofMap::_augment_sparsity_pattern</a></div><div class="ttdeci">AugmentSparsityPattern * _augment_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01552">dof_map.h:1552</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa10200782a0f8fe0c4d3f7bdf10cedc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10200782a0f8fe0c4d3f7bdf10cedc6">&#9670;&nbsp;</a></span>attach_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Additional matrices may be handled with this <code><a class="el" href="classlibMesh_1_1DofMap.html" title="Manages the degrees of freedom (DOFs) in a simulation. ">DofMap</a></code>. They are initialized to the same sparsity structure as the major matrix. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00262">262</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01525">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01638">_n_nz</a>, <a class="el" href="dof__map_8h_source.html#l01644">_n_oz</a>, <a class="el" href="dof__map_8h_source.html#l01630">_sp</a>, <a class="el" href="sparse__matrix_8h_source.html#l00109">libMesh::SparseMatrix&lt; T &gt;::attach_dof_map()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="sparse__matrix_8h_source.html#l00121">libMesh::SparseMatrix&lt; T &gt;::need_full_sparsity_pattern()</a>, <a class="el" href="dof__map_8h_source.html#l01624">need_full_sparsity_pattern</a>, and <a class="el" href="sparse__matrix_8h_source.html#l00129">libMesh::SparseMatrix&lt; T &gt;::update_sparsity_pattern()</a>.</p>

<p class="reference">Referenced by <a class="el" href="eigen__system_8C_source.html#l00135">libMesh::EigenSystem::init_matrices()</a>, and <a class="el" href="implicit__system_8C_source.html#l00106">libMesh::ImplicitSystem::init_matrices()</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;{</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// We shouldn&#39;t be trying to re-attach the same matrices repeatedly</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  libmesh_assert (std::find(<a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end(),</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                            &amp;matrix) == <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end());</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.push_back(&amp;matrix);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  matrix.<a class="code" href="classlibMesh_1_1SparseMatrix.html#a327789280fc9e054844455b212d143b4">attach_dof_map</a> (*<span class="keyword">this</span>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// If we&#39;ve already computed sparsity, then it&#39;s too late</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// to wait for &quot;compute_sparsity&quot; to help with sparse matrix</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// initialization, and we need to handle this matrix individually</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">bool</span> computed_sparsity_already =</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    ((<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a> &amp;&amp; !<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>-&gt;empty()) ||</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     (<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a> &amp;&amp; !<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>-&gt;empty()));</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(computed_sparsity_already);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">if</span> (computed_sparsity_already &amp;&amp;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1SparseMatrix.html#add6ac91fac193d4a9096332dcb02d06a">need_full_sparsity_pattern</a>())</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">// We&#39;d better have already computed the full sparsity pattern</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="comment">// if we need it here</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.get());</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1SparseMatrix.html#a06b61220d6f442caedbe46f5f0ed2482">update_sparsity_pattern</a> (<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;sparsity_pattern);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">if</span> (matrix.<a class="code" href="classlibMesh_1_1SparseMatrix.html#add6ac91fac193d4a9096332dcb02d06a">need_full_sparsity_pattern</a>())</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01630">dof_map.h:1630</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a15dc47f3b7fdd20f9ec062de8e842561"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">libMesh::DofMap::_n_nz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_nz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01638">dof_map.h:1638</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a446ebcd42da6b4edbe58238cb4c12b7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">libMesh::DofMap::_n_oz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_oz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01644">dof_map.h:1644</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01624">dof_map.h:1624</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; *&gt; _matrices</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01525">dof_map.h:1525</a></div></div>
<div class="ttc" id="classlibMesh_1_1SparseMatrix_html_a327789280fc9e054844455b212d143b4"><div class="ttname"><a href="classlibMesh_1_1SparseMatrix.html#a327789280fc9e054844455b212d143b4">libMesh::SparseMatrix::attach_dof_map</a></div><div class="ttdeci">void attach_dof_map(const DofMap &amp;dof_map)</div><div class="ttdef"><b>Definition:</b> <a href="sparse__matrix_8h_source.html#l00109">sparse_matrix.h:109</a></div></div>
<div class="ttc" id="classlibMesh_1_1SparseMatrix_html_add6ac91fac193d4a9096332dcb02d06a"><div class="ttname"><a href="classlibMesh_1_1SparseMatrix.html#add6ac91fac193d4a9096332dcb02d06a">libMesh::SparseMatrix::need_full_sparsity_pattern</a></div><div class="ttdeci">virtual bool need_full_sparsity_pattern() const</div><div class="ttdef"><b>Definition:</b> <a href="sparse__matrix_8h_source.html#l00121">sparse_matrix.h:121</a></div></div>
<div class="ttc" id="classlibMesh_1_1SparseMatrix_html_a06b61220d6f442caedbe46f5f0ed2482"><div class="ttname"><a href="classlibMesh_1_1SparseMatrix.html#a06b61220d6f442caedbe46f5f0ed2482">libMesh::SparseMatrix::update_sparsity_pattern</a></div><div class="ttdeci">virtual void update_sparsity_pattern(const SparsityPattern::Graph &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="sparse__matrix_8h_source.html#l00129">sparse_matrix.h:129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a919e7fba5895d6a5a7857874605c58b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919e7fba5895d6a5a7857874605c58b1">&#9670;&nbsp;</a></span>block_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::block_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The block size, if the variables are amenable to block storage. Otherwise 1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00562">562</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l00549">has_blocked_representation()</a>, and <a class="el" href="dof__map_8h_source.html#l00541">n_variables()</a>.</p>
<div class="fragment"><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_BLOCKED_STORAGE</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">return</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#abe1b4047e5c1f2c0503d06e364173321">has_blocked_representation</a>() ? this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>() : 1);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a25b3182cbf57ead72821d826275512b0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00541">dof_map.h:541</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abe1b4047e5c1f2c0503d06e364173321"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abe1b4047e5c1f2c0503d06e364173321">libMesh::DofMap::has_blocked_representation</a></div><div class="ttdeci">bool has_blocked_representation() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00549">dof_map.h:549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a599877e0ae2c03dccbd5e8e9750d7fb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a599877e0ae2c03dccbd5e8e9750d7fb3">&#9670;&nbsp;</a></span>build_constraint_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::build_constraint_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>called_recursively</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Build the constraint matrix C associated with the element degree of freedom indices elem_dofs. The optional parameter <code>called_recursively</code> should be left at the default value <code>false</code>. This is used to handle the special case of an element's degrees of freedom being constrained in terms of other, local degrees of freedom. The usual case is for an elements DOFs to be constrained by some other, external DOFs. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02346">2346</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__matrix_8h_source.html#l00792">libMesh::DenseMatrix&lt; T &gt;::resize()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00213">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>.</p>
<div class="fragment"><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;{</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  LOG_SCOPE_IF(<span class="stringliteral">&quot;build_constraint_matrix()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>, !called_recursively);</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  RCSet dof_set;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <span class="keywordtype">bool</span> we_have_constraints = <span class="keyword">false</span>;</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <span class="comment">// Next insert any other dofs the current dofs might be constrained</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  <span class="comment">// in terms of.  Note that in this case we may not be done: Those</span></div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  <span class="comment">// may in turn depend on others.  So, we need to repeat this process</span></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="comment">// in that case until the system depends only on unconstrained</span></div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <span class="comment">// degrees of freedom.</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(dof))</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      {</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        we_have_constraints = <span class="keyword">true</span>;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        DofConstraints::const_iterator</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;          pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof);</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        <span class="comment">// Constraint rows in p refinement may be empty</span></div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        <span class="comment">//libmesh_assert (!constraint_row.empty());</span></div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;          dof_set.insert (item.first);</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      }</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="comment">// May be safe to return at this point</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="comment">// (but remember to stop the perflog)</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <span class="keywordflow">if</span> (!we_have_constraints)</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    dof_set.erase (dof);</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="comment">// If we added any DOFS then we need to do this recursively.</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="comment">// It is possible that we just added a DOF that is also</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="comment">// constrained!</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="comment">// Also, we need to handle the special case of an element having DOFs</span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  <span class="comment">// constrained in terms of other, local DOFs</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <span class="keywordflow">if</span> (!dof_set.empty() ||  <span class="comment">// case 1: constrained in terms of other DOFs</span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      !called_recursively) <span class="comment">// case 2: constrained in terms of our own DOFs</span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    {</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size =</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      <span class="comment">// Add new dependency dofs to the end of the current dof set</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      elem_dofs.insert(elem_dofs.end(),</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                       dof_set.begin(), dof_set.end());</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      <span class="comment">// Now we can build the constraint matrix.</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      <span class="comment">// Note that resize also zeros for a DenseMatrix&lt;Number&gt;.</span></div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">resize</a> (old_size,</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                cast_int&lt;unsigned int&gt;(elem_dofs.size()));</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      <span class="comment">// Create the C constraint matrix.</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != old_size; i++)</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(elem_dofs[i]))</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;          {</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            DofConstraints::const_iterator</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;              pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;            libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <span class="comment">// p refinement creates empty constraint rows</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            <span class="comment">//    libmesh_assert (!constraint_row.empty());</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0,</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                   n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                   j != n_elem_dofs; j++)</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                  C(i,j) = item.second;</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;          }</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;          {</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;            C(i,i) = 1.;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;          }</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      <span class="comment">// May need to do this recursively.  It is possible</span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      <span class="comment">// that we just replaced a constrained DOF with another</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      <span class="comment">// constrained DOF.</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> Cnew;</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (Cnew, elem_dofs, <span class="keyword">true</span>);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>()) &amp;&amp;</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;          (Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == elem_dofs.size())) <span class="comment">// If the constraint matrix</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">right_multiply</a>(Cnew);           <span class="comment">// is constrained...</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(), elem_dofs.size());</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    }</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a711bdbc0ff2222b7e609e760ef903930"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) override</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00213">dense_matrix_impl.h:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a83503e0038a23688676a69008aaabf5c"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">libMesh::DenseMatrix::resize</a></div><div class="ttdeci">void resize(const unsigned int new_m, const unsigned int new_n)</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix_8h_source.html#l00792">dense_matrix.h:792</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7b5749fe8231535dfd67985c6a5858e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7b5749fe8231535dfd67985c6a5858e">&#9670;&nbsp;</a></span>build_constraint_matrix_and_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::build_constraint_matrix_and_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>called_recursively</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Build the constraint matrix C and the forcing vector H associated with the element degree of freedom indices elem_dofs. The optional parameter <code>called_recursively</code> should be left at the default value <code>false</code>. This is used to handle the special case of an element's degrees of freedom being constrained in terms of other, local degrees of freedom. The usual case is for an elements DOFs to be constrained by some other, external DOFs and/or Dirichlet conditions.</p>
<p>The forcing vector will depend on which solution's heterogenous constraints are being applied. For the default <code>qoi_index</code> this will be the primal solution; for <code>qoi_index</code> &gt;= 0 the corresponding adjoint solution's constraints will be used. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02456">2456</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00355">libMesh::DenseVector&lt; T &gt;::resize()</a>, <a class="el" href="dense__matrix_8h_source.html#l00792">libMesh::DenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00213">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00511">libMesh::DenseMatrix&lt; T &gt;::vector_mult_add()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01848">extract_local_vector()</a>.</p>
<div class="fragment"><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;{</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  LOG_SCOPE_IF(<span class="stringliteral">&quot;build_constraint_matrix_and_vector()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>, !called_recursively);</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  RCSet dof_set;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <span class="keywordtype">bool</span> we_have_constraints = <span class="keyword">false</span>;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <span class="comment">// Next insert any other dofs the current dofs might be constrained</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  <span class="comment">// in terms of.  Note that in this case we may not be done: Those</span></div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="comment">// may in turn depend on others.  So, we need to repeat this process</span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <span class="comment">// in that case until the system depends only on unconstrained</span></div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;  <span class="comment">// degrees of freedom.</span></div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(dof))</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      {</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        we_have_constraints = <span class="keyword">true</span>;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        DofConstraints::const_iterator</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;          pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="comment">// Constraint rows in p refinement may be empty</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        <span class="comment">//libmesh_assert (!constraint_row.empty());</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;          dof_set.insert (item.first);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;      }</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;  <span class="comment">// May be safe to return at this point</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  <span class="comment">// (but remember to stop the perflog)</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  <span class="keywordflow">if</span> (!we_have_constraints)</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    dof_set.erase (dof);</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <span class="comment">// If we added any DOFS then we need to do this recursively.</span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;  <span class="comment">// It is possible that we just added a DOF that is also</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;  <span class="comment">// constrained!</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="comment">// Also, we need to handle the special case of an element having DOFs</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;  <span class="comment">// constrained in terms of other, local DOFs</span></div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <span class="keywordflow">if</span> (!dof_set.empty() ||  <span class="comment">// case 1: constrained in terms of other DOFs</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      !called_recursively) <span class="comment">// case 2: constrained in terms of our own DOFs</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    {</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * rhs_values = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="keywordflow">if</span> (qoi_index &lt; 0)</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        rhs_values = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        {</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;          <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;          <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            rhs_values = &amp;it-&gt;second;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        }</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size =</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      <span class="comment">// Add new dependency dofs to the end of the current dof set</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      elem_dofs.insert(elem_dofs.end(),</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                       dof_set.begin(), dof_set.end());</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <span class="comment">// Now we can build the constraint matrix and vector.</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="comment">// Note that resize also zeros for a DenseMatrix and DenseVector</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">resize</a> (old_size,</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                cast_int&lt;unsigned int&gt;(elem_dofs.size()));</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      H.<a class="code" href="classlibMesh_1_1DenseVector.html#a08430ae781094632e8272cbb825d4f44">resize</a> (old_size);</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="comment">// Create the C constraint matrix.</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != old_size; i++)</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(elem_dofs[i]))</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;          {</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            DofConstraints::const_iterator</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;              pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            <span class="comment">// p refinement creates empty constraint rows</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;            <span class="comment">//    libmesh_assert (!constraint_row.empty());</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0,</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                   n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                   j != n_elem_dofs; j++)</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                  C(i,j) = item.second;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            <span class="keywordflow">if</span> (rhs_values)</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;              {</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                  rhs_values-&gt;find(elem_dofs[i]);</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                <span class="keywordflow">if</span> (rhsit != rhs_values-&gt;end())</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                  H(i) = rhsit-&gt;second;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;              }</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;          }</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;          {</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;            C(i,i) = 1.;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;          }</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      <span class="comment">// May need to do this recursively.  It is possible</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="comment">// that we just replaced a constrained DOF with another</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="comment">// constrained DOF.</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> Cnew;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> Hnew;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">build_constraint_matrix_and_vector</a> (Cnew, Hnew, elem_dofs,</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                                                qoi_index, <span class="keyword">true</span>);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>()) &amp;&amp;          <span class="comment">// If the constraint matrix</span></div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;          (Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == elem_dofs.size())) <span class="comment">// is constrained...</span></div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        {</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;          <span class="comment">// If x = Cy + h and y = Dz + g</span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;          <span class="comment">// Then x = (CD)z + (Cg + h)</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;          C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aefdfb31eb4eb8e1dc51bd4390fb1ffc5">vector_mult_add</a>(H, 1, Hnew);</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;          C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">right_multiply</a>(Cnew);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        }</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(), elem_dofs.size());</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    }</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad7b5749fe8231535dfd67985c6a5858e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02456">dof_map_constraints.C:2456</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a08430ae781094632e8272cbb825d4f44"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a08430ae781094632e8272cbb825d4f44">libMesh::DenseVector::resize</a></div><div class="ttdeci">void resize(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00355">dense_vector.h:355</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aefdfb31eb4eb8e1dc51bd4390fb1ffc5"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aefdfb31eb4eb8e1dc51bd4390fb1ffc5">libMesh::DenseMatrix::vector_mult_add</a></div><div class="ttdeci">void vector_mult_add(DenseVector&lt; T &gt; &amp;dest, const T factor, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00511">dense_matrix_impl.h:511</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a711bdbc0ff2222b7e609e760ef903930"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) override</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00213">dense_matrix_impl.h:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00117">dof_map.h:117</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a83503e0038a23688676a69008aaabf5c"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">libMesh::DenseMatrix::resize</a></div><div class="ttdeci">void resize(const unsigned int new_m, const unsigned int new_n)</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix_8h_source.html#l00792">dense_matrix.h:792</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7146774c15f7b99381e2a1d7895eb1de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7146774c15f7b99381e2a1d7895eb1de">&#9670;&nbsp;</a></span>build_sparsity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a> &gt; libMesh::DofMap::build_sparsity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Builds a sparsity pattern </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00058">58</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01552">_augment_sparsity_pattern</a>, <a class="el" href="dof__map_8h_source.html#l01618">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01319">_dof_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01564">_extra_sparsity_context</a>, <a class="el" href="dof__map_8h_source.html#l01557">_extra_sparsity_function</a>, <a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html#a1ff40e05e1fb575f27ddc94bedffd714">libMesh::DofMap::AugmentSparsityPattern::augment_sparsity_pattern()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__map_8h_source.html#l00590">n_dofs_on_processor()</a>, <a class="el" href="dof__map_8h_source.html#l01624">need_full_sparsity_pattern</a>, <a class="el" href="libmesh__common_8h_source.html#l00228">libMesh::out</a>, <a class="el" href="threads__none_8h_source.html#l00101">libMesh::Threads::parallel_reduce()</a>, and <a class="el" href="dof__map_8C_source.html#l01682">use_coupled_neighbor_dofs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01739">compute_sparsity()</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  libmesh_assert (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.is_prepared());</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;build_sparsity()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// Compute the sparsity structure of the global matrix.  This can be</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// fed into a PetscMatrix to allocate exactly the number of nonzeros</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">// necessary to store the matrix.  This algorithm should be linear</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// in the (# of elements)*(# nodes per element)</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// We can be more efficient in the threaded sparsity pattern assembly</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// if we don&#39;t need the exact pattern.  For some sparse matrix formats</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// a good upper bound will suffice.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// See if we need to include sparsity pattern entries for coupling</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// between neighbor dofs</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">bool</span> implicit_neighbor_dofs = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1bf72ada83076ab80eb67d568189f462">use_coupled_neighbor_dofs</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// We can compute the sparsity pattern in parallel on multiple</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// threads.  The goal is for each thread to compute the full sparsity</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// pattern for a subset of elements.  These sparsity patterns can</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// be efficiently merged in the SparsityPattern::Build::join()</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// method, especially if there is not too much overlap between them.</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// Even better, if the full sparsity pattern is not needed then</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// the number of nonzeros per row can be estimated from the</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// sparsity patterns created on each thread.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  std::unique_ptr&lt;SparsityPattern::Build&gt; sp</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    (<span class="keyword">new</span> SparsityPattern::Build (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                 *<span class="keyword">this</span>,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                 this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                 this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                 implicit_neighbor_dofs,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                 <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>));</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="namespacelibMesh_1_1Threads.html#a8295c6919b44a664d2fe13288cd334e5">Threads::parallel_reduce</a> (<a class="code" href="namespacelibMesh.html#a2c62e678c8ac27e51286fa5c38b0f3c9">ConstElemRange</a> (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_elements_begin(),</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                            <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_elements_end()), *sp);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  sp-&gt;parallel_sync();</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// Avoid declaring these variables unless asserts are enabled.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc_id        = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.processor_id();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_dofs_on_proc = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17864ba577f0016a69d81d472655047">n_dofs_on_processor</a>(proc_id);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  libmesh_assert_equal_to (sp-&gt;sparsity_pattern.size(), n_dofs_on_proc);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// Check to see if we have any extra stuff to add to the sparsity_pattern</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">_extra_sparsity_function</a>)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">_augment_sparsity_pattern</a>)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          libmesh_here();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;WARNING:  You have specified both an extra sparsity function and object.\n&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;          Are you sure this is what you meant to do??&quot;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                       &lt;&lt; std::endl;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">_extra_sparsity_function</a></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        (sp-&gt;sparsity_pattern, sp-&gt;n_nz,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         sp-&gt;n_oz, <a class="code" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">_augment_sparsity_pattern</a>)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">_augment_sparsity_pattern</a>-&gt;<a class="code" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html#a1ff40e05e1fb575f27ddc94bedffd714">augment_sparsity_pattern</a></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      (sp-&gt;sparsity_pattern, sp-&gt;n_nz, sp-&gt;n_oz);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">return</span> std::unique_ptr&lt;SparsityPattern::Build&gt;(sp.release());</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ae17864ba577f0016a69d81d472655047"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17864ba577f0016a69d81d472655047">libMesh::DofMap::n_dofs_on_processor</a></div><div class="ttdeci">dof_id_type n_dofs_on_processor(const processor_id_type proc) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00590">dof_map.h:590</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a283ce213140aa281498b56e138ee8de2"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">libMesh::DofMap::_extra_sparsity_context</a></div><div class="ttdeci">void * _extra_sparsity_context</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01564">dof_map.h:1564</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab5f0ce99b32ad1a22d5e78161d27ad3b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab5f0ce99b32ad1a22d5e78161d27ad3b">libMesh::DofMap::_augment_sparsity_pattern</a></div><div class="ttdeci">AugmentSparsityPattern * _augment_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01552">dof_map.h:1552</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1bf72ada83076ab80eb67d568189f462"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1bf72ada83076ab80eb67d568189f462">libMesh::DofMap::use_coupled_neighbor_dofs</a></div><div class="ttdeci">bool use_coupled_neighbor_dofs(const MeshBase &amp;mesh) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01682">dof_map.C:1682</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2c62e678c8ac27e51286fa5c38b0f3c9"><div class="ttname"><a href="namespacelibMesh.html#a2c62e678c8ac27e51286fa5c38b0f3c9">libMesh::ConstElemRange</a></div><div class="ttdeci">StoredRange&lt; MeshBase::const_element_iterator, const Elem * &gt; ConstElemRange</div><div class="ttdef"><b>Definition:</b> <a href="elem__range_8h_source.html#l00034">elem_range.h:34</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01624">dof_map.h:1624</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a727fc57aa0deeee20ce64711b56ccf65"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a727fc57aa0deeee20ce64711b56ccf65">libMesh::DofMap::_extra_sparsity_function</a></div><div class="ttdeci">void(* _extra_sparsity_function)(SparsityPattern::Graph &amp;, std::vector&lt; dof_id_type &gt; &amp;n_nz, std::vector&lt; dof_id_type &gt; &amp;n_oz, void *)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01557">dof_map.h:1557</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01319">dof_map.h:1319</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern_html_a1ff40e05e1fb575f27ddc94bedffd714"><div class="ttname"><a href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html#a1ff40e05e1fb575f27ddc94bedffd714">libMesh::DofMap::AugmentSparsityPattern::augment_sparsity_pattern</a></div><div class="ttdeci">virtual void augment_sparsity_pattern(SparsityPattern::Graph &amp;sparsity, std::vector&lt; dof_id_type &gt; &amp;n_nz, std::vector&lt; dof_id_type &gt; &amp;n_oz)=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_a8295c6919b44a664d2fe13288cd334e5"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#a8295c6919b44a664d2fe13288cd334e5">libMesh::Threads::parallel_reduce</a></div><div class="ttdeci">void parallel_reduce(const Range &amp;range, Body &amp;body)</div><div class="ttdef"><b>Definition:</b> <a href="threads__none_8h_source.html#l00101">threads_none.h:101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01618">dof_map.h:1618</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a63e3c3158308e2184c12b55ab9ea9a35"><div class="ttname"><a href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></div><div class="ttdeci">OStreamProxy out(std::cout)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00228">libmesh_common.h:228</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28c15409067d14ae53d7523b2b9c3076"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c15409067d14ae53d7523b2b9c3076">&#9670;&nbsp;</a></span>check_dirichlet_bcid_consistency()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::check_dirichlet_bcid_consistency </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check that all the ids in dirichlet_bcids are actually present in the mesh. If not, this will throw an error. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04362">4362</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dirichlet__boundaries_8h_source.html#l00174">libMesh::DirichletBoundary::b</a>, <a class="el" href="xdr__io_8C_source.html#l00051">bc_id</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="boundary__info_8h_source.html#l00781">libMesh::BoundaryInfo::get_boundary_ids()</a>, <a class="el" href="mesh__base_8h_source.html#l00131">libMesh::MeshBase::get_boundary_info()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, and <a class="el" href="parallel__implementation_8h_source.html#l01928">libMesh::Parallel::Communicator::verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;{</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;  <span class="keyword">const</span> std::set&lt;boundary_id_type&gt;&amp; mesh_bcids = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a640865bf6d6c35628d6c56703dc51834">get_boundary_info</a>().<a class="code" href="classlibMesh_1_1BoundaryInfo.html#aa14a865b4127b3803675333216eef20b">get_boundary_ids</a>();</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;  <span class="keyword">const</span> std::set&lt;boundary_id_type&gt;&amp; dbc_bcids = boundary.<a class="code" href="classlibMesh_1_1DirichletBoundary.html#a9375f30ebf033684e24bc0418872d022">b</a>;</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;  <span class="comment">// DirichletBoundary id sets should be consistent across all ranks</span></div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;  libmesh_assert(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#aaa64d157da7003e39404ad0d794e4d4f">verify</a>(dbc_bcids.size()));</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <a class="code" href="xdr__io_8C.html#a7b966a996f9a3159d0be57a9c2e55df3">bc_id</a> : dbc_bcids)</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    {</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;      <span class="comment">// DirichletBoundary id sets should be consistent across all ranks</span></div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;      libmesh_assert(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#aaa64d157da7003e39404ad0d794e4d4f">verify</a>(<a class="code" href="xdr__io_8C.html#a7b966a996f9a3159d0be57a9c2e55df3">bc_id</a>));</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;      <span class="keywordtype">bool</span> found_bcid = (mesh_bcids.find(<a class="code" href="xdr__io_8C.html#a7b966a996f9a3159d0be57a9c2e55df3">bc_id</a>) != mesh_bcids.end());</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;      <span class="comment">// On a distributed mesh, boundary id sets may *not* be</span></div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;      <span class="comment">// consistent across all ranks, since not all ranks see all</span></div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;      <span class="comment">// boundaries</span></div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;      <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(found_bcid);</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;      <span class="keywordflow">if</span> (!found_bcid)</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        libmesh_error_msg(<span class="stringliteral">&quot;Could not find Dirichlet boundary id &quot;</span> &lt;&lt; <a class="code" href="xdr__io_8C.html#a7b966a996f9a3159d0be57a9c2e55df3">bc_id</a> &lt;&lt; <span class="stringliteral">&quot; in mesh!&quot;</span>);</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    }</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a640865bf6d6c35628d6c56703dc51834"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a640865bf6d6c35628d6c56703dc51834">libMesh::MeshBase::get_boundary_info</a></div><div class="ttdeci">const BoundaryInfo &amp; get_boundary_info() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00131">mesh_base.h:131</a></div></div>
<div class="ttc" id="xdr__io_8C_html_a7b966a996f9a3159d0be57a9c2e55df3"><div class="ttname"><a href="xdr__io_8C.html#a7b966a996f9a3159d0be57a9c2e55df3">bc_id</a></div><div class="ttdeci">boundary_id_type bc_id</div><div class="ttdef"><b>Definition:</b> <a href="xdr__io_8C_source.html#l00051">xdr_io.C:51</a></div></div>
<div class="ttc" id="classlibMesh_1_1BoundaryInfo_html_aa14a865b4127b3803675333216eef20b"><div class="ttname"><a href="classlibMesh_1_1BoundaryInfo.html#aa14a865b4127b3803675333216eef20b">libMesh::BoundaryInfo::get_boundary_ids</a></div><div class="ttdeci">const std::set&lt; boundary_id_type &gt; &amp; get_boundary_ids() const</div><div class="ttdef"><b>Definition:</b> <a href="boundary__info_8h_source.html#l00781">boundary_info.h:781</a></div></div>
<div class="ttc" id="classlibMesh_1_1DirichletBoundary_html_a9375f30ebf033684e24bc0418872d022"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundary.html#a9375f30ebf033684e24bc0418872d022">libMesh::DirichletBoundary::b</a></div><div class="ttdeci">std::set&lt; boundary_id_type &gt; b</div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00174">dirichlet_boundaries.h:174</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_aaa64d157da7003e39404ad0d794e4d4f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#aaa64d157da7003e39404ad0d794e4d4f">libMesh::Parallel::Communicator::verify</a></div><div class="ttdeci">bool verify(const T &amp;r) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l01928">parallel_implementation.h:1928</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30a6ab4b65749be311da80b48f312fd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a6ab4b65749be311da80b48f312fd3">&#9670;&nbsp;</a></span>check_for_cyclic_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::check_for_cyclic_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Throw an error if we detect and cyclic constraints, since these are not supported by <a class="el" href="namespacelibMesh.html">libMesh</a> and give erroneous results if they are present. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l03334">3334</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>.</p>
<div class="fragment"><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;{</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  RCSet unexpanded_set;</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;  <span class="comment">// Use dof_constraints_copy in this method so that we don&#39;t</span></div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  <span class="comment">// mess with _dof_constraints.</span></div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  <a class="code" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a> dof_constraints_copy = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>;</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : dof_constraints_copy)</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;    unexpanded_set.insert(i.first);</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;  <span class="keywordflow">while</span> (!unexpanded_set.empty())</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    <span class="keywordflow">for</span> (RCSet::iterator i = unexpanded_set.begin();</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;         i != unexpanded_set.end(); <span class="comment">/* nothing */</span>)</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;      {</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        DofConstraints::iterator</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;          pos = dof_constraints_copy.find(*i);</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        libmesh_assert (pos != dof_constraints_copy.end());</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        <span class="comment">// Comment out &quot;rhs&quot; parts of this method copied from process_constraints</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        <span class="comment">// DofConstraintValueMap::iterator rhsit =</span></div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        <span class="comment">//   _primal_constraint_values.find(*i);</span></div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;        <span class="comment">// Number constraint_rhs = (rhsit == _primal_constraint_values.end()) ?</span></div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        <span class="comment">//   0 : rhsit-&gt;second;</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        std::vector&lt;dof_id_type&gt; constraints_to_expand;</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;          <span class="keywordflow">if</span> (item.first != *i &amp;&amp; this-&gt;is_constrained_dof(item.first))</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;            {</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;              unexpanded_set.insert(item.first);</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;              constraints_to_expand.push_back(item.first);</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            }</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; expandable : constraints_to_expand)</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;          {</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> this_coef = constraint_row[expandable];</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;            DofConstraints::const_iterator</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;              subpos = dof_constraints_copy.find(expandable);</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;            libmesh_assert (subpos != dof_constraints_copy.end());</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; subconstraint_row = subpos-&gt;second;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : subconstraint_row)</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;              {</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                <span class="keywordflow">if</span> (item.first == expandable)</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                  libmesh_error_msg(<span class="stringliteral">&quot;Cyclic constraint detected&quot;</span>);</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                constraint_row[item.first] += item.second * this_coef;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;              }</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;            <span class="comment">// Comment out &quot;rhs&quot; parts of this method copied from process_constraints</span></div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;            <span class="comment">// DofConstraintValueMap::const_iterator subrhsit =</span></div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            <span class="comment">//   _primal_constraint_values.find(expandable);</span></div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            <span class="comment">// if (subrhsit != _primal_constraint_values.end())</span></div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;            <span class="comment">//   constraint_rhs += subrhsit-&gt;second * this_coef;</span></div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;            constraint_row.erase(expandable);</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;          }</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        <span class="comment">// Comment out &quot;rhs&quot; parts of this method copied from process_constraints</span></div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        <span class="comment">// if (rhsit == _primal_constraint_values.end())</span></div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;        <span class="comment">//   {</span></div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        <span class="comment">//     if (constraint_rhs != Number(0))</span></div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        <span class="comment">//       _primal_constraint_values[*i] = constraint_rhs;</span></div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        <span class="comment">//     else</span></div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;        <span class="comment">//       _primal_constraint_values.erase(*i);</span></div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        <span class="comment">//   }</span></div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        <span class="comment">// else</span></div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;        <span class="comment">//   {</span></div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        <span class="comment">//     if (constraint_rhs != Number(0))</span></div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        <span class="comment">//       rhsit-&gt;second = constraint_rhs;</span></div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        <span class="comment">//     else</span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        <span class="comment">//       _primal_constraint_values.erase(rhsit);</span></div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;        <span class="comment">//   }</span></div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;        <span class="keywordflow">if</span> (constraints_to_expand.empty())</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;          i = unexpanded_set.erase(i);</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;          ++i;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      }</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraints_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraints.html">libMesh::DofConstraints</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00105">dof_map.h:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a480f80bc9234a5586711833b87a89784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a480f80bc9234a5586711833b87a89784">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all new memory associated with the object, but restore its original state, with the mesh pointer and any default ghosting. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00828">828</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01691">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l01605">_algebraic_ghosting_functors</a>, <a class="el" href="dof__map_8h_source.html#l01618">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01587">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01595">_default_evaluating</a>, <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01319">_dof_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01535">_end_df</a>, <a class="el" href="dof__map_8h_source.html#l01672">_end_old_df</a>, <a class="el" href="dof__map_8h_source.html#l01530">_first_df</a>, <a class="el" href="dof__map_8h_source.html#l01667">_first_old_df</a>, <a class="el" href="dof__map_8h_source.html#l01678">_first_old_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01541">_first_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01525">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01518">_mesh</a>, <a class="el" href="dof__map_8h_source.html#l01649">_n_dfs</a>, <a class="el" href="dof__map_8h_source.html#l01662">_n_old_dfs</a>, <a class="el" href="dof__map_8h_source.html#l01689">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l01547">_send_list</a>, <a class="el" href="dof__map_8h_source.html#l01687">_stashed_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01508">_variable_group_numbers</a>, <a class="el" href="dof__map_8h_source.html#l01503">_variable_groups</a>, <a class="el" href="dof__map_8h_source.html#l01498">_variables</a>, <a class="el" href="dof__map_8C_source.html#l01829">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01809">add_coupling_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01771">clear_sparsity()</a>, <a class="el" href="dof__map_8h_source.html#l01624">need_full_sparsity_pattern</a>, <a class="el" href="mesh__base_8C_source.html#l00281">libMesh::MeshBase::remove_ghosting_functor()</a>, and <a class="el" href="dof__map_8C_source.html#l01682">use_coupled_neighbor_dofs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00201">~DofMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;{</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">// we don&#39;t want to clear</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">// the coupling matrix!</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment">// It should not change...</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">//_dof_coupling-&gt;clear();</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// But it would be inconsistent to leave our coupling settings</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// through a clear()...</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">// Reset ghosting functor statuses</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        libmesh_assert(gf);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">remove_ghosting_functor</a>(*gf);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    this-&gt;_coupling_functors.clear();</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">// Go back to default coupling</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_dof_coupling(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_n_levels(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1bf72ada83076ab80eb67d568189f462">use_coupled_neighbor_dofs</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>));</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        libmesh_assert(gf);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">remove_ghosting_functor</a>(*gf);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    this-&gt;_algebraic_ghosting_functors.clear();</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// Go back to default send_list generation</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// _default_evaluating-&gt;set_dof_coupling(this-&gt;_dof_coupling);</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_n_levels(1);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.clear();</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.clear();</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>.clear();</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.clear();</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.clear();</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>.clear();</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.clear();</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6481536ea3c70d31fb18fa35bfc88e33">clear_sparsity</a>();</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.clear();</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>.clear();</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.clear();</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.clear();</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a> = 0;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>.clear();</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>.clear();</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a>.clear();</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.clear();</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a> = 0;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01503">dof_map.h:1503</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a617b958e22a85c29f02af80867367daa"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">libMesh::MeshBase::remove_ghosting_functor</a></div><div class="ttdeci">void remove_ghosting_functor(GhostingFunctor &amp;ghosting_functor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00281">mesh_base.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01605">dof_map.h:1605</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01672">dof_map.h:1672</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1bf72ada83076ab80eb67d568189f462"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1bf72ada83076ab80eb67d568189f462">libMesh::DofMap::use_coupled_neighbor_dofs</a></div><div class="ttdeci">bool use_coupled_neighbor_dofs(const MeshBase &amp;mesh) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01682">dof_map.C:1682</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae17b27f47b3731f6ce72312edd957bf7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">libMesh::DofMap::add_coupling_functor</a></div><div class="ttdeci">void add_coupling_functor(GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01809">dof_map.C:1809</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01667">dof_map.h:1667</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01541">dof_map.h:1541</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01624">dof_map.h:1624</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01678">dof_map.h:1678</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01319">dof_map.h:1319</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; *&gt; _matrices</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01525">dof_map.h:1525</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01587">dof_map.h:1587</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01498">dof_map.h:1498</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01662">dof_map.h:1662</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6481536ea3c70d31fb18fa35bfc88e33"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6481536ea3c70d31fb18fa35bfc88e33">libMesh::DofMap::clear_sparsity</a></div><div class="ttdeci">void clear_sparsity()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01771">dof_map.C:1771</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01618">dof_map.h:1618</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01530">dof_map.h:1530</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01518">dof_map.h:1518</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01595">dof_map.h:1595</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01508">dof_map.h:1508</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9a0c5eeda42bc54bb3ae1c2d05ec5227"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">libMesh::DofMap::add_algebraic_ghosting_functor</a></div><div class="ttdeci">void add_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01829">dof_map.C:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01649">dof_map.h:1649</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6481536ea3c70d31fb18fa35bfc88e33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6481536ea3c70d31fb18fa35bfc88e33">&#9670;&nbsp;</a></span>clear_sparsity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::clear_sparsity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clears the sparsity pattern </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01771">1771</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01638">_n_nz</a>, <a class="el" href="dof__map_8h_source.html#l01644">_n_oz</a>, <a class="el" href="dof__map_8h_source.html#l01630">_sp</a>, and <a class="el" href="dof__map_8h_source.html#l01624">need_full_sparsity_pattern</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="eigen__system_8C_source.html#l00165">libMesh::EigenSystem::reinit()</a>, and <a class="el" href="implicit__system_8C_source.html#l00150">libMesh::ImplicitSystem::reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;{</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>)</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    {</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.get());</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      libmesh_assert(!<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a> || <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a> == &amp;<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;n_nz);</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      libmesh_assert(!<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a> || <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a> == &amp;<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;n_oz);</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.reset();</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    {</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      libmesh_assert(!<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.get());</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    }</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01630">dof_map.h:1630</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a15dc47f3b7fdd20f9ec062de8e842561"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">libMesh::DofMap::_n_nz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_nz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01638">dof_map.h:1638</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a446ebcd42da6b4edbe58238cb4c12b7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">libMesh::DofMap::_n_oz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_oz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01644">dof_map.h:1644</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01624">dof_map.h:1624</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4dfeba78f759a8e42683bb559ce1e9fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dfeba78f759a8e42683bb559ce1e9fa">&#9670;&nbsp;</a></span>comm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a>&amp; libMesh::ParallelObject::comm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A reference to the <code><a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a></code> object used by this mesh. </dd></dl>

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00089">89</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00107">libMesh::ParallelObject::_communicator</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__diff__solver_8C_source.html#l00132">libMesh::__libmesh_petsc_diff_solver_jacobian()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00043">libMesh::__libmesh_petsc_diff_solver_monitor()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00086">libMesh::__libmesh_petsc_diff_solver_residual()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00205">libMesh::__libmesh_tao_equality_constraints()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00257">libMesh::__libmesh_tao_equality_constraints_jacobian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00097">libMesh::__libmesh_tao_gradient()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00148">libMesh::__libmesh_tao_hessian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00306">libMesh::__libmesh_tao_inequality_constraints()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00358">libMesh::__libmesh_tao_inequality_constraints_jacobian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00049">libMesh::__libmesh_tao_objective()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01335">libMesh::MeshRefinement::_coarsen_elements()</a>, <a class="el" href="exact__solution_8C_source.html#l00455">libMesh::ExactSolution::_compute_error()</a>, <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="boundary__info_8C_source.html#l02412">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="slepc__eigen__solver_8C_source.html#l00889">libMesh::SlepcEigenSolver&lt; T &gt;::_petsc_shell_matrix_get_diagonal()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01781">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_get_diagonal()</a>, <a class="el" href="slepc__eigen__solver_8C_source.html#l00864">libMesh::SlepcEigenSolver&lt; T &gt;::_petsc_shell_matrix_mult()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01727">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_mult()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01751">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_mult_add()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00143">libMesh::EquationSystems::_read_impl()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01461">libMesh::MeshRefinement::_refine_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01592">libMesh::MeshRefinement::_smooth_flags()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00407">libMesh::PetscDMWrapper::add_dofs_helper()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00340">libMesh::PetscDMWrapper::add_dofs_to_section()</a>, <a class="el" href="implicit__system_8C_source.html#l00203">libMesh::ImplicitSystem::add_matrix()</a>, <a class="el" href="system_8C_source.html#l00661">libMesh::System::add_vector()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00969">libMesh::UnstructuredMesh::all_second_order()</a>, <a class="el" href="mesh__modification_8C_source.html#l00271">libMesh::MeshTools::Modification::all_tri()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00261">libMesh::LaplaceMeshSmoother::allgather_graph()</a>, <a class="el" href="fem__system_8C_source.html#l01121">libMesh::FEMSystem::assemble_qoi()</a>, <a class="el" href="mesh__communication__global__indices_8C_source.html#l00168">libMesh::MeshCommunication::assign_global_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00262">attach_matrix()</a>, <a class="el" href="mesh__generation_8C_source.html#l01992">libMesh::MeshTools::Generation::build_extrusion()</a>, <a class="el" href="boundary__info_8C_source.html#l01779">libMesh::BoundaryInfo::build_node_list_from_side_list()</a>, <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="equation__systems_8C_source.html#l00600">libMesh::EquationSystems::build_parallel_solution_vector()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00098">libMesh::PetscDMWrapper::build_section()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00163">libMesh::PetscDMWrapper::build_sf()</a>, <a class="el" href="mesh__base_8C_source.html#l00574">libMesh::MeshBase::cache_elem_dims()</a>, <a class="el" href="system_8C_source.html#l01400">libMesh::System::calculate_norm()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04362">check_dirichlet_bcid_consistency()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00440">libMesh::PetscDMWrapper::check_section_n_dofs()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01595">libMesh::Nemesis_IO_Helper::compute_num_global_elem_blocks()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01484">libMesh::Nemesis_IO_Helper::compute_num_global_nodesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01391">libMesh::Nemesis_IO_Helper::compute_num_global_sidesets()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00095">libMesh::Problem_Interface::computeF()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00153">libMesh::Problem_Interface::computeJacobian()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00215">libMesh::Problem_Interface::computePreconditioner()</a>, <a class="el" href="exodusII__io_8C_source.html#l00513">libMesh::ExodusII_IO::copy_elemental_solution()</a>, <a class="el" href="mesh__tools_8C_source.html#l02259">libMesh::MeshTools::correct_node_proc_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l00386">libMesh::MeshTools::create_bounding_box()</a>, <a class="el" href="mesh__tools_8C_source.html#l00411">libMesh::MeshTools::create_nodal_bounding_box()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00219">libMesh::MeshRefinement::create_parent_error_vector()</a>, <a class="el" href="mesh__tools_8C_source.html#l00477">libMesh::MeshTools::create_processor_bounding_box()</a>, <a class="el" href="mesh__tools_8C_source.html#l00529">libMesh::MeshTools::create_subdomain_bounding_box()</a>, <a class="el" href="mesh__communication_8C_source.html#l01844">libMesh::MeshCommunication::delete_remote_elements()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00782">DMlibMeshFunction()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00852">DMlibMeshJacobian()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00089">DMlibMeshSetSystem_libMesh()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00945">DMVariableBounds_libMesh()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00380">libMesh::MeshRefinement::eliminate_unrefined_patches()</a>, <a class="el" href="trilinos__epetra__vector_8h_source.html#l00477">libMesh::EpetraVector&lt; T &gt;::EpetraVector()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00055">libMesh::WeightedPatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00153">libMesh::PatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00053">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">libMesh::MeshRefinement::flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">libMesh::MeshRefinement::flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">libMesh::MeshRefinement::flag_elements_by_nelem_target()</a>, <a class="el" href="condensed__eigen__system_8C_source.html#l00174">libMesh::CondensedEigenSystem::get_eigenpair()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, <a class="el" href="implicit__system_8C_source.html#l01395">libMesh::ImplicitSystem::get_linear_solver()</a>, <a class="el" href="location__maps_8C_source.html#l00046">libMesh::LocationMap&lt; T &gt;::init()</a>, <a class="el" href="time__solver_8C_source.html#l00064">libMesh::TimeSolver::init()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00054">libMesh::PetscDMWrapper::init_and_attach_petscdm()</a>, <a class="el" href="eigen__system_8C_source.html#l00116">libMesh::EigenSystem::init_data()</a>, <a class="el" href="eigen__system_8C_source.html#l00135">libMesh::EigenSystem::init_matrices()</a>, <a class="el" href="optimization__system_8C_source.html#l00091">libMesh::OptimizationSystem::initialize_equality_constraints_storage()</a>, <a class="el" href="optimization__system_8C_source.html#l00127">libMesh::OptimizationSystem::initialize_inequality_constraints_storage()</a>, <a class="el" href="mesh__tools_8C_source.html#l01671">libMesh::MeshTools::libmesh_assert_consistent_distributed()</a>, <a class="el" href="mesh__tools_8C_source.html#l01701">libMesh::MeshTools::libmesh_assert_consistent_distributed_nodes()</a>, <a class="el" href="mesh__tools_8C_source.html#l01598">libMesh::MeshTools::libmesh_assert_contiguous_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01877">libMesh::MeshTools::libmesh_assert_parallel_consistent_new_node_procids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01777">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01915">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01826">libMesh::MeshTools::libmesh_assert_topology_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01401">libMesh::MeshTools::libmesh_assert_valid_boundary_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01571">libMesh::MeshTools::libmesh_assert_valid_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l02068">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00931">libMesh::DistributedMesh::libmesh_assert_valid_parallel_flags()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00844">libMesh::DistributedMesh::libmesh_assert_valid_parallel_object_ids()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00908">libMesh::DistributedMesh::libmesh_assert_valid_parallel_p_levels()</a>, <a class="el" href="mesh__tools_8C_source.html#l01985">libMesh::MeshTools::libmesh_assert_valid_refinement_flags()</a>, <a class="el" href="mesh__tools_8C_source.html#l01641">libMesh::MeshTools::libmesh_assert_valid_unique_ids()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00201">libMesh::libmesh_petsc_snes_fd_residual()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00288">libMesh::libmesh_petsc_snes_jacobian()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00238">libMesh::libmesh_petsc_snes_mffd_residual()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00425">libMesh::libmesh_petsc_snes_postcheck()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00150">libMesh::libmesh_petsc_snes_residual()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00064">libMesh::libmesh_petsc_snes_residual_helper()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00126">libMesh::MeshRefinement::limit_level_mismatch_at_edge()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">libMesh::MeshRefinement::limit_level_mismatch_at_node()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00255">libMesh::MeshRefinement::limit_overrefined_boundary()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00316">libMesh::MeshRefinement::limit_underrefined_boundary()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">libMesh::MeshRefinement::make_coarsening_compatible()</a>, <a class="el" href="mesh__communication_8C_source.html#l01505">libMesh::MeshCommunication::make_elems_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">libMesh::MeshRefinement::make_flags_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01685">libMesh::MeshCommunication::make_new_node_proc_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01805">libMesh::MeshCommunication::make_new_nodes_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01452">libMesh::MeshCommunication::make_node_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01656">libMesh::MeshCommunication::make_node_proc_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01481">libMesh::MeshCommunication::make_node_unique_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01763">libMesh::MeshCommunication::make_nodes_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01529">libMesh::MeshCommunication::make_p_levels_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">libMesh::MeshRefinement::make_refinement_compatible()</a>, <a class="el" href="fem__system_8C_source.html#l01061">libMesh::FEMSystem::mesh_position_set()</a>, <a class="el" href="distributed__mesh_8C_source.html#l01317">libMesh::DistributedMesh::n_active_elem()</a>, <a class="el" href="mesh__tools_8C_source.html#l00623">libMesh::MeshTools::n_active_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01646">libMesh::BoundaryInfo::n_boundary_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01667">libMesh::BoundaryInfo::n_edge_conds()</a>, <a class="el" href="condensed__eigen__system_8C_source.html#l00071">libMesh::CondensedEigenSystem::n_global_non_condensed_dofs()</a>, <a class="el" href="mesh__tools_8C_source.html#l00653">libMesh::MeshTools::n_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01711">libMesh::BoundaryInfo::n_nodeset_conds()</a>, <a class="el" href="mesh__tools_8C_source.html#l00718">libMesh::MeshTools::n_p_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01689">libMesh::BoundaryInfo::n_shellface_conds()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00182">libMesh::DistributedMesh::parallel_max_elem_id()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00240">libMesh::DistributedMesh::parallel_max_node_id()</a>, <a class="el" href="replicated__mesh_8C_source.html#l00592">libMesh::ReplicatedMesh::parallel_max_unique_id()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00213">libMesh::DistributedMesh::parallel_max_unique_id()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00169">libMesh::DistributedMesh::parallel_n_elem()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00227">libMesh::DistributedMesh::parallel_n_nodes()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00443">libMesh::SparsityPattern::Build::parallel_sync()</a>, <a class="el" href="mesh__tools_8C_source.html#l00677">libMesh::MeshTools::paranoid_n_levels()</a>, <a class="el" href="petsc__auto__fieldsplit_8C_source.html#l00058">libMesh::petsc_auto_fieldsplit()</a>, <a class="el" href="system_8C_source.html#l02100">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02220">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01993">libMesh::System::point_value()</a>, <a class="el" href="mesh__base_8C_source.html#l00152">libMesh::MeshBase::prepare_for_use()</a>, <a class="el" href="nemesis__io_8C_source.html#l00148">libMesh::Nemesis_IO::read()</a>, <a class="el" href="xdr__io_8C_source.html#l01250">libMesh::XdrIO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00830">libMesh::CheckpointIO::read_header()</a>, <a class="el" href="xdr__io_8C_source.html#l01380">libMesh::XdrIO::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00115">libMesh::System::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00310">libMesh::System::read_legacy_data()</a>, <a class="el" href="system__io_8C_source.html#l01121">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l02061">libMesh::XdrIO::read_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l01841">libMesh::XdrIO::read_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l00811">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l01504">libMesh::XdrIO::read_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l01690">libMesh::XdrIO::read_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01974">libMesh::XdrIO::read_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l01442">libMesh::XdrIO::read_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l01168">libMesh::System::read_serialized_vector()</a>, <a class="el" href="mesh__base_8C_source.html#l00458">libMesh::MeshBase::recalculate_n_partitions()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">libMesh::MeshRefinement::refine_and_coarsen_elements()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00961">libMesh::DistributedMesh::renumber_dof_objects()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00186">libMesh::CheckpointIO::select_split_config()</a>, <a class="el" href="dof__map_8C_source.html#l00321">set_nonlocal_dof_objects()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00337">libMesh::PetscDiffSolver::setup_petsc_data()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00045">libMesh::LaplaceMeshSmoother::smooth()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00134">libMesh::split_mesh()</a>, <a class="el" href="mesh__base_8C_source.html#l00288">libMesh::MeshBase::subdomain_ids()</a>, <a class="el" href="boundary__info_8C_source.html#l00163">libMesh::BoundaryInfo::sync()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00352">libMesh::MeshRefinement::test_level_one()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00427">libMesh::MeshRefinement::test_unflagged()</a>, <a class="el" href="mesh__tools_8C_source.html#l00210">libMesh::MeshTools::total_weight()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">libMesh::MeshRefinement::uniformly_coarsen()</a>, <a class="el" href="namebased__io_8C_source.html#l00276">libMesh::NameBasedIO::write()</a>, <a class="el" href="xdr__io_8C_source.html#l00168">libMesh::XdrIO::write()</a>, <a class="el" href="system__io_8C_source.html#l02101">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l00993">libMesh::XdrIO::write_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l01815">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00351">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l00710">libMesh::XdrIO::write_serialized_nodes()</a>, and <a class="el" href="xdr__io_8C_source.html#l01136">libMesh::XdrIO::write_serialized_nodesets()</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>; }</div><div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00107">parallel_object.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a49379ce3a542eab41a8f8e44d0f154c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49379ce3a542eab41a8f8e44d0f154c2">&#9670;&nbsp;</a></span>compute_sparsity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::compute_sparsity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the sparsity pattern for the matrices corresponding to <code>proc_id</code> and sends that data to Linear Algebra packages for preallocation of sparse matrices. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01739">1739</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01525">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01638">_n_nz</a>, <a class="el" href="dof__map_8h_source.html#l01644">_n_oz</a>, <a class="el" href="dof__map_8h_source.html#l01630">_sp</a>, <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>, and <a class="el" href="dof__map_8h_source.html#l01624">need_full_sparsity_pattern</a>.</p>

<p class="reference">Referenced by <a class="el" href="eigen__system_8C_source.html#l00135">libMesh::EigenSystem::init_matrices()</a>, <a class="el" href="implicit__system_8C_source.html#l00106">libMesh::ImplicitSystem::init_matrices()</a>, <a class="el" href="eigen__system_8C_source.html#l00165">libMesh::EigenSystem::reinit()</a>, and <a class="el" href="implicit__system_8C_source.html#l00150">libMesh::ImplicitSystem::reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;{</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a> = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7146774c15f7b99381e2a1d7895eb1de">build_sparsity</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="comment">// It is possible that some \p SparseMatrix implementations want to</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="comment">// see the sparsity pattern before we throw it away.  If so, we</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="comment">// share a view of its arrays, and we pass it in to the matrices.</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>)</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    {</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a> = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;n_nz;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a> = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;n_oz;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; mat : <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>)</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        mat-&gt;update_sparsity_pattern (<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;sparsity_pattern);</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    }</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">// If we don&#39;t need the full sparsity pattern anymore, steal the</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <span class="comment">// arrays we do need and free the rest of the memory</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    {</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>)</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a> = <span class="keyword">new</span> std::vector&lt;dof_id_type&gt;();</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>-&gt;swap(<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;n_nz);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>)</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a> = <span class="keyword">new</span> std::vector&lt;dof_id_type&gt;();</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>-&gt;swap(<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;n_oz);</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.reset();</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    }</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01630">dof_map.h:1630</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a15dc47f3b7fdd20f9ec062de8e842561"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">libMesh::DofMap::_n_nz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_nz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01638">dof_map.h:1638</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a446ebcd42da6b4edbe58238cb4c12b7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">libMesh::DofMap::_n_oz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_oz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01644">dof_map.h:1644</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01624">dof_map.h:1624</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7146774c15f7b99381e2a1d7895eb1de"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7146774c15f7b99381e2a1d7895eb1de">libMesh::DofMap::build_sparsity</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; build_sparsity(const MeshBase &amp;mesh) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00058">dof_map.C:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; *&gt; _matrices</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01525">dof_map.h:1525</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abac4d315f9e2eddc22fae37311d26b96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abac4d315f9e2eddc22fae37311d26b96">&#9670;&nbsp;</a></span>constrain_element_dyad_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_dyad_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constrains a dyadic element matrix B = v w'. This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02012">2012</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00092">libMesh::DenseVector&lt; T &gt;::size()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00441">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;{</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  libmesh_assert_equal_to (v.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>(), row_dofs.size());</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  libmesh_assert_equal_to (w.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>(), row_dofs.size());</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="comment">// The constrained RHS is built up as R^T F.</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (R, row_dofs);</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;cnstrn_elem_dyad_mat()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="comment">// It is possible that the vector is not constrained at all.</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="keywordflow">if</span> ((R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == v.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>()) &amp;&amp;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      (R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == row_dofs.size())) <span class="comment">// if the RHS is constrained</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    {</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <span class="comment">// Compute the matrix-vector products</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_v(v);</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_w(w);</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <span class="comment">// compute matrix/vector product</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      R.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">vector_mult_transpose</a>(v, old_v);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      R.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">vector_mult_transpose</a>(w, old_w);</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      libmesh_assert_equal_to (row_dofs.size(), v.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>());</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      libmesh_assert_equal_to (row_dofs.size(), w.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>());</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <span class="comment">/* Constrain only v, not w.  */</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;           n_row_dofs = cast_int&lt;unsigned int&gt;(row_dofs.size());</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;           i != n_row_dofs; i++)</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(row_dofs[i]))</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;          {</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;            <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;            libmesh_assert (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(row_dofs[i]) != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            v(i) = 0;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          }</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    } <span class="comment">// end if the RHS is constrained.</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseVector_html_a70f094c13f827ea1d9b384bb0aea785a"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const override</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00092">dense_vector.h:92</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aa61db76abed0e9d72220bd73b16f9d62"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00441">dense_matrix_impl.h:441</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a61a0468c8fbc8d9995356028c00a2014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61a0468c8fbc8d9995356028c00a2014">&#9670;&nbsp;</a></span>constrain_element_matrix() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constrains the element matrix. This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order.</p>
<p>If <code>asymmetric_constraint_rows</code> is set to true (as it is by default), constraint row equations will be reinforced in a way which breaks matrix symmetry but makes inexact linear solver solutions more likely to satisfy hanging node constraints. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01545">1545</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dense__matrix__impl_8h_source.html#l00088">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00213">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>.</p>
<div class="fragment"><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;{</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>());</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (C, elem_dofs);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;constrain_elem_matrix()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>()) &amp;&amp;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    {</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="comment">// Compute the matrix-matrix-matrix product C^T K C</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (C);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">right_multiply</a> (C);</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), elem_dofs.size());</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(), elem_dofs.size());</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;           i != n_elem_dofs; i++)</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(elem_dofs[i]))</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(); j++)</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;              matrix(i,j) = 0.;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            matrix(i,i) = 1.;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              {</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                DofConstraints::const_iterator</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                  pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                <span class="comment">// This is an overzealous assertion in the presence of</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                <span class="comment">// heterogenous constraints: we now can constrain &quot;u_i = c&quot;</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                <span class="comment">// with no other u_j terms involved.</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                <span class="comment">// libmesh_assert (!constraint_row.empty());</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != n_elem_dofs; j++)</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                    <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                      matrix(i,j) = -item.second;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;              }</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;          }</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    } <span class="comment">// end if is constrained...</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a711bdbc0ff2222b7e609e760ef903930"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) override</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00213">dense_matrix_impl.h:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00088">dense_matrix_impl.h:88</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7594c80a87b0691ac2d28884ec102249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7594c80a87b0691ac2d28884ec102249">&#9670;&nbsp;</a></span>constrain_element_matrix() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>col_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constrains the element matrix. This method allows the element matrix to be non-square, in which case the row_dofs and col_dofs may be of different size and correspond to variables approximated in different spaces. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01878">1878</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dense__matrix__impl_8h_source.html#l00088">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00213">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>.</p>
<div class="fragment"><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;{</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  libmesh_assert_equal_to (row_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>());</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  libmesh_assert_equal_to (col_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="comment">// The constrained matrix is built up as R^T K C.</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="comment">// Safeguard against the user passing us the same</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="comment">// object for row_dofs and col_dofs.  If that is done</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="comment">// the calls to build_matrix would fail</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  std::vector&lt;dof_id_type&gt; orig_row_dofs(row_dofs);</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  std::vector&lt;dof_id_type&gt; orig_col_dofs(col_dofs);</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (R, orig_row_dofs);</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (C, orig_col_dofs);</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;constrain_elem_matrix()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  row_dofs = orig_row_dofs;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  col_dofs = orig_col_dofs;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <span class="keywordtype">bool</span> constraint_found = <span class="keyword">false</span>;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="comment">// K_constrained = R^T K C</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <span class="keywordflow">if</span> ((R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>()) &amp;&amp;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      (R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == row_dofs.size()))</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    {</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (R);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      constraint_found = <span class="keyword">true</span>;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    }</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>()) &amp;&amp;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == col_dofs.size()))</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    {</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">right_multiply</a> (C);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      constraint_found = <span class="keyword">true</span>;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    }</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <span class="keywordflow">if</span> (constraint_found)</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    {</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), row_dofs.size());</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(), col_dofs.size());</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;           n_row_dofs = cast_int&lt;unsigned int&gt;(row_dofs.size());</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;           i != n_row_dofs; i++)</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(row_dofs[i]))</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;          {</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(); j++)</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;              {</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                <span class="keywordflow">if</span> (row_dofs[i] != col_dofs[j])</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                  matrix(i,j) = 0.;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                <span class="keywordflow">else</span> <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                  matrix(i,j) = 1.;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;              }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;              {</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                DofConstraints::const_iterator</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                  pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(row_dofs[i]);</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                libmesh_assert (!constraint_row.empty());</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0,</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                       n_col_dofs = cast_int&lt;unsigned int&gt;(col_dofs.size());</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                       j != n_col_dofs; j++)</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                    <span class="keywordflow">if</span> (col_dofs[j] == item.first)</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                      matrix(i,j) = -item.second;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;              }</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;          }</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    } <span class="comment">// end if is constrained...</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a711bdbc0ff2222b7e609e760ef903930"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) override</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00213">dense_matrix_impl.h:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00088">dense_matrix_impl.h:88</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af26a2e86c6d46ef12e0e7d03f4c17c3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af26a2e86c6d46ef12e0e7d03f4c17c3c">&#9670;&nbsp;</a></span>constrain_element_matrix_and_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_matrix_and_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constrains the element matrix and vector. This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01615">1615</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dense__matrix__impl_8h_source.html#l00088">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00213">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>, <a class="el" href="dense__vector_8h_source.html#l00092">libMesh::DenseVector&lt; T &gt;::size()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00441">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;{</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>());</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>());</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T F</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (C, elem_dofs);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;cnstrn_elem_mat_vec()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>()) &amp;&amp;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="comment">// Compute the matrix-matrix-matrix product C^T K C</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (C);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">right_multiply</a> (C);</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), elem_dofs.size());</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(), elem_dofs.size());</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;           i != n_elem_dofs; i++)</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(elem_dofs[i]))</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;          {</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(); j++)</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;              matrix(i,j) = 0.;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            matrix(i,i) = 1.;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="comment">// row to ensure that the linear system produces the</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="comment">// correct value for the constrained DOF.</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;              {</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                DofConstraints::const_iterator</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                  pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                <span class="comment">// p refinement creates empty constraint rows</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                <span class="comment">//    libmesh_assert (!constraint_row.empty());</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != n_elem_dofs; j++)</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                    <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                      matrix(i,j) = -item.second;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;              }</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;          }</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="comment">// Compute the matrix-vector product C^T F</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_rhs(rhs);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="comment">// compute matrix/vector product</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">vector_mult_transpose</a>(rhs, old_rhs);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    } <span class="comment">// end if is constrained...</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseVector_html_a70f094c13f827ea1d9b384bb0aea785a"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const override</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00092">dense_vector.h:92</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aa61db76abed0e9d72220bd73b16f9d62"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00441">dense_matrix_impl.h:441</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a711bdbc0ff2222b7e609e760ef903930"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) override</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00213">dense_matrix_impl.h:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00088">dense_matrix_impl.h:88</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a985d73544c865d9ab1a7afd9bdd1d61a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a985d73544c865d9ab1a7afd9bdd1d61a">&#9670;&nbsp;</a></span>constrain_element_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constrains the element vector. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01970">1970</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00092">libMesh::DenseVector&lt; T &gt;::size()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00441">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;{</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  libmesh_assert_equal_to (rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>(), row_dofs.size());</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="comment">// The constrained RHS is built up as R^T F.</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (R, row_dofs);</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;constrain_elem_vector()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="comment">// It is possible that the vector is not constrained at all.</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="keywordflow">if</span> ((R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>()) &amp;&amp;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      (R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == row_dofs.size())) <span class="comment">// if the RHS is constrained</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    {</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="comment">// Compute the matrix-vector product</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_rhs(rhs);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      R.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">vector_mult_transpose</a>(rhs, old_rhs);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      libmesh_assert_equal_to (row_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>());</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;           n_row_dofs = cast_int&lt;unsigned int&gt;(row_dofs.size());</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;           i != n_row_dofs; i++)</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(row_dofs[i]))</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;          {</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            libmesh_assert (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(row_dofs[i]) != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            rhs(i) = 0;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;          }</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    } <span class="comment">// end if the RHS is constrained.</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseVector_html_a70f094c13f827ea1d9b384bb0aea785a"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const override</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00092">dense_vector.h:92</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aa61db76abed0e9d72220bd73b16f9d62"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00441">dense_matrix_impl.h:441</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84bdea16d50899fd9a94e9e4cc3210b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84bdea16d50899fd9a94e9e4cc3210b3">&#9670;&nbsp;</a></span>constrain_nothing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_nothing </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dofs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Does not actually constrain anything, but modifies <code>dofs</code> in the same way as any of the constrain functions would do, i.e. adds those dofs in terms of which any of the existing dofs is constrained. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02063">2063</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;{</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="comment">// All the work is done by \p build_constraint_matrix.  We just need</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="comment">// a dummy matrix.</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (R, dofs);</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c8e17a57f38de4ae0060311b5497989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c8e17a57f38de4ae0060311b5497989">&#9670;&nbsp;</a></span>constrain_p_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_p_dofs </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constrains degrees of freedom on side <code>s</code> of element <code>elem</code> which correspond to variable number <code>var</code> and to p refinement levels above <code>p</code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04208">4208</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1Elem.html#a90a7ca1f28a92f659ab6f8cdef91d806">libMesh::Elem::dim()</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="classlibMesh_1_1Elem.html#a095386c4644b0478229289f281f2f8e4">libMesh::Elem::is_node_on_side()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ac56e382d9871ff243a781940ee13ed87">libMesh::Elem::is_vertex()</a>, <a class="el" href="dof__object_8h_source.html#l00803">libMesh::DofObject::n_comp()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ae376bfa6ac14723330e07a97992b56c9">libMesh::Elem::n_sides()</a>, <a class="el" href="elem_8h_source.html#l01979">libMesh::Elem::node_ref()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="threads_8C_source.html#l00029">libMesh::Threads::spin_mtx</a>, and <a class="el" href="classlibMesh_1_1Elem.html#ad06f8ac22978144723179eed42d10bae">libMesh::Elem::type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fe__base_8C_source.html#l01650">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_periodic_constraints()</a>, and <a class="el" href="fe__base_8C_source.html#l01366">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_proj_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;{</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;  <span class="comment">// We&#39;re constraining dofs on elem which correspond to p refinement</span></div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;  <span class="comment">// levels above p - this only makes sense if elem&#39;s p refinement</span></div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  <span class="comment">// level is above p.</span></div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;  libmesh_assert_greater (elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ae56030fa3191b481afc2fdd4c8f36869">p_level</a>(), p);</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;  libmesh_assert_less (s, elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ae376bfa6ac14723330e07a97992b56c9">n_sides</a>());</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a90a7ca1f28a92f659ab6f8cdef91d806">dim</a>();</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;  <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">ElemType</a> type = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ad06f8ac22978144723179eed42d10bae">type</a>();</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;  <a class="code" href="classlibMesh_1_1FEType.html">FEType</a> low_p_fe_type = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">variable_type</a>(var);</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;  <a class="code" href="classlibMesh_1_1FEType.html">FEType</a> high_p_fe_type = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">variable_type</a>(var);</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;  low_p_fe_type.<a class="code" href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">order</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a><span class="keyword">&gt;</span>(low_p_fe_type.<a class="code" href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">order</a> + p);</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;  high_p_fe_type.<a class="code" href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">order</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a><span class="keyword">&gt;</span>(high_p_fe_type.<a class="code" href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">order</a> +</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                                            elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ae56030fa3191b481afc2fdd4c8f36869">p_level</a>());</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>();</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n != <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; ++n)</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;    <span class="keywordflow">if</span> (elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a095386c4644b0478229289f281f2f8e4">is_node_on_side</a>(n, s))</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      {</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> &amp; node = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a30f42f08e1695d2db051064346c2a654">node_ref</a>(n);</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> low_nc =</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;          <a class="code" href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">FEInterface::n_dofs_at_node</a> (dim, low_p_fe_type, type, n);</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> high_nc =</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;          <a class="code" href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">FEInterface::n_dofs_at_node</a> (dim, high_p_fe_type, type, n);</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;        <span class="comment">// since we may be running this method concurrently</span></div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        <span class="comment">// on multiple threads we need to acquire a lock</span></div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;        <span class="comment">// before modifying the _dof_constraints object.</span></div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        Threads::spin_mutex::scoped_lock lock(<a class="code" href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">Threads::spin_mtx</a>);</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        <span class="keywordflow">if</span> (elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ac56e382d9871ff243a781940ee13ed87">is_vertex</a>(n))</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;          {</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;            <span class="comment">// Add &quot;this is zero&quot; constraint rows for high p vertex</span></div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;            <span class="comment">// dofs</span></div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = low_nc; i != high_nc; ++i)</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;              {</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[node.<a class="code" href="classlibMesh_1_1DofObject.html#a4e8bf039eb9c13b7eb3aaf96afc8c8b8">dof_number</a>(sys_num,var,i)].clear();</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(node.<a class="code" href="classlibMesh_1_1DofObject.html#a4e8bf039eb9c13b7eb3aaf96afc8c8b8">dof_number</a>(sys_num,var,i));</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;              }</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;          }</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;          {</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> total_dofs = node.<a class="code" href="classlibMesh_1_1DofObject.html#a1fb8ad13b6e0913f35c843d331909f66">n_comp</a>(sys_num, var);</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;            libmesh_assert_greater_equal (total_dofs, high_nc);</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;            <span class="comment">// Add &quot;this is zero&quot; constraint rows for high p</span></div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;            <span class="comment">// non-vertex dofs, which are numbered in reverse</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = low_nc; j != high_nc; ++j)</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;              {</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = total_dofs - j - 1;</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[node.<a class="code" href="classlibMesh_1_1DofObject.html#a4e8bf039eb9c13b7eb3aaf96afc8c8b8">dof_number</a>(sys_num,var,i)].clear();</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(node.<a class="code" href="classlibMesh_1_1DofObject.html#a4e8bf039eb9c13b7eb3aaf96afc8c8b8">dof_number</a>(sys_num,var,i));</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;              }</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;          }</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;      }</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1FEType_html"><div class="ttname"><a href="classlibMesh_1_1FEType.html">libMesh::FEType</a></div><div class="ttdoc">Manages the family, order, etc. parameters for a given FE. </div><div class="ttdef"><b>Definition:</b> <a href="fe__type_8h_source.html#l00179">fe_type.h:179</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a3f482b3acb4beb528f0ce89f161ff967"><div class="ttname"><a href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">libMesh::ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition:</b> <a href="enum__elem__type_8h_source.html#l00033">enum_elem_type.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a4e8bf039eb9c13b7eb3aaf96afc8c8b8"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a4e8bf039eb9c13b7eb3aaf96afc8c8b8">libMesh::DofObject::dof_number</a></div><div class="ttdeci">dof_id_type dof_number(const unsigned int s, const unsigned int var, const unsigned int comp) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00833">dof_object.h:833</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af3eb3e8751995b944fc135ea53b09da2"><div class="ttname"><a href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">libMesh::Order</a></div><div class="ttdeci">Order</div><div class="ttdef"><b>Definition:</b> <a href="enum__order_8h_source.html#l00040">enum_order.h:40</a></div></div>
<div class="ttc" id="classlibMesh_1_1Node_html"><div class="ttname"><a href="classlibMesh_1_1Node.html">libMesh::Node</a></div><div class="ttdoc">A geometric point in (x,y,z) space associated with a DOF. </div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00052">node.h:52</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a1fb8ad13b6e0913f35c843d331909f66"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a1fb8ad13b6e0913f35c843d331909f66">libMesh::DofObject::n_comp</a></div><div class="ttdeci">unsigned int n_comp(const unsigned int s, const unsigned int var) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00803">dof_object.h:803</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9b731b2150d70797262acdbfaf1b53e8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">libMesh::DofMap::variable_type</a></div><div class="ttdeci">const FEType &amp; variable_type(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01792">dof_map.h:1792</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a095386c4644b0478229289f281f2f8e4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a095386c4644b0478229289f281f2f8e4">libMesh::Elem::is_node_on_side</a></div><div class="ttdeci">virtual bool is_node_on_side(const unsigned int n, const unsigned int s) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_ae56030fa3191b481afc2fdd4c8f36869"><div class="ttname"><a href="classlibMesh_1_1Elem.html#ae56030fa3191b481afc2fdd4c8f36869">libMesh::Elem::p_level</a></div><div class="ttdeci">unsigned int p_level() const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02555">elem.h:2555</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEType_html_a8a4f7c664bddf007599e8087871c6785"><div class="ttname"><a href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">libMesh::FEType::order</a></div><div class="ttdeci">OrderWrapper order</div><div class="ttdef"><b>Definition:</b> <a href="fe__type_8h_source.html#l00198">fe_type.h:198</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_aba1ae5c24686d2cd2fc7ccdc9537c4f5"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">libMesh::Threads::spin_mtx</a></div><div class="ttdeci">spin_mutex spin_mtx</div><div class="ttdef"><b>Definition:</b> <a href="threads_8C_source.html#l00029">threads.C:29</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a30f42f08e1695d2db051064346c2a654"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a30f42f08e1695d2db051064346c2a654">libMesh::Elem::node_ref</a></div><div class="ttdeci">const Node &amp; node_ref(const unsigned int i) const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01979">elem.h:1979</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a3a1e00b1906b0f6cf0cc1760c9a7da1f"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes</a></div><div class="ttdeci">virtual unsigned int n_nodes() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a9d448e5766ac099a401541d191439d0b"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">libMesh::FEInterface::n_dofs_at_node</a></div><div class="ttdeci">static unsigned int n_dofs_at_node(const unsigned int dim, const FEType &amp;fe_t, const ElemType t, const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00473">fe_interface.C:473</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_ae376bfa6ac14723330e07a97992b56c9"><div class="ttname"><a href="classlibMesh_1_1Elem.html#ae376bfa6ac14723330e07a97992b56c9">libMesh::Elem::n_sides</a></div><div class="ttdeci">virtual unsigned int n_sides() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a90a7ca1f28a92f659ab6f8cdef91d806"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a90a7ca1f28a92f659ab6f8cdef91d806">libMesh::Elem::dim</a></div><div class="ttdeci">virtual unsigned short dim() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_ac56e382d9871ff243a781940ee13ed87"><div class="ttname"><a href="classlibMesh_1_1Elem.html#ac56e382d9871ff243a781940ee13ed87">libMesh::Elem::is_vertex</a></div><div class="ttdeci">virtual bool is_vertex(const unsigned int i) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_ad06f8ac22978144723179eed42d10bae"><div class="ttname"><a href="classlibMesh_1_1Elem.html#ad06f8ac22978144723179eed42d10bae">libMesh::Elem::type</a></div><div class="ttdeci">virtual ElemType type() const =0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a10228d8fb61396223cce22a2f129b749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10228d8fb61396223cce22a2f129b749">&#9670;&nbsp;</a></span>constraint_rows_begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DofConstraints::const_iterator libMesh::DofMap::constraint_rows_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>An iterator pointing to the first DoF constraint row. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00902">902</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.begin(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad98041b12294b87501a840c09bbb99d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad98041b12294b87501a840c09bbb99d2">&#9670;&nbsp;</a></span>constraint_rows_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DofConstraints::const_iterator libMesh::DofMap::constraint_rows_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>An iterator pointing just past the last DoF constraint row. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00908">908</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd64cdbcb7af43bb9d35f4e2266ff0b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd64cdbcb7af43bb9d35f4e2266ff0b3">&#9670;&nbsp;</a></span>coupling_functors_begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::const_iterator libMesh::DofMap::coupling_functors_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Beginning of range of coupling functors </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00317">317</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01618">_coupling_functors</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, and <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.begin(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01618">dof_map.h:1618</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e35c4e14684a92a817a75e5b29cddd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e35c4e14684a92a817a75e5b29cddd8">&#9670;&nbsp;</a></span>coupling_functors_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::const_iterator libMesh::DofMap::coupling_functors_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>End of range of coupling functors </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00323">323</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01618">_coupling_functors</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, and <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.end(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01618">dof_map.h:1618</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7892d89bda5e4d39308dcb4e9a982bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7892d89bda5e4d39308dcb4e9a982bfc">&#9670;&nbsp;</a></span>create_dof_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::create_dof_constraints </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>time</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rebuilds the raw degree of freedom and <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> constraints. A time is specified for use in building time-dependent Dirichlet constraints. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01194">1194</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="stored__range_8h_source.html#l00301">libMesh::StoredRange&lt; iterator_type, object_type &gt;::empty()</a>, <a class="el" href="mesh__base_8h_source.html#l00147">libMesh::MeshBase::is_prepared()</a>, <a class="el" href="mesh__base_8h_source.html#l00154">libMesh::MeshBase::is_serial()</a>, <a class="el" href="mesh__tools_8C_source.html#l01401">libMesh::MeshTools::libmesh_assert_valid_boundary_ids()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">libMesh::MeshBase::local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">libMesh::MeshBase::local_elements_end()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="mesh__base_8C_source.html#l00126">libMesh::MeshBase::mesh_dimension()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a190e556d3be87f5ccd8d4fc98d1779d3">libMesh::MeshBase::n_elem()</a>, <a class="el" href="threads__none_8h_source.html#l00073">libMesh::Threads::parallel_for()</a>, <a class="el" href="stored__range_8h_source.html#l00222">libMesh::StoredRange&lt; iterator_type, object_type &gt;::reset()</a>, and <a class="el" href="mesh__base_8C_source.html#l00496">libMesh::MeshBase::sub_point_locator()</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_8C_source.html#l00397">libMesh::System::reinit_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;{</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  parallel_object_only();</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;create_dof_constraints()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  libmesh_assert (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a11863902c0b1c34e7cfa8bde8ced3807">is_prepared</a>());</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">// The user might have set boundary conditions after the mesh was</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">// prepared; we should double-check that those boundary conditions</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="comment">// are still consistent.</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <a class="code" href="namespacelibMesh_1_1MeshTools.html#a476a638ff65585743af92b95078df8ce">MeshTools::libmesh_assert_valid_boundary_ids</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="comment">// We might get constraint equations from AMR hanging nodes in 2D/3D</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">// or from boundary conditions in any dimension</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> possible_local_constraints = <span class="keyword">false</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    || !<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a190e556d3be87f5ccd8d4fc98d1779d3">n_elem</a>()</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    || <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a169bc3297f1070065f9380ff54eb0400">mesh_dimension</a>() &gt; 1</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    || !<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;empty()</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_DIRICHLET</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    || !<a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;empty()</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    ;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <span class="comment">// Even if we don&#39;t have constraints, another processor might.</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordtype">bool</span> possible_global_constraints = possible_local_constraints;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">#if defined(LIBMESH_ENABLE_PERIODIC) || defined(LIBMESH_ENABLE_DIRICHLET) || defined(LIBMESH_ENABLE_AMR)</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().verify(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>()));</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(possible_global_constraints);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">if</span> (!possible_global_constraints)</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="comment">// Clear out any old constraints; maybe the user just deleted</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="comment">// their last remaining dirichlet/periodic/user constraint?</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.clear();</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>.clear();</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.clear();</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.clear();</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.clear();</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="comment">// Here we build the hanging node constraints.  This is done</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="comment">// by enforcing the condition u_a = u_b along hanging sides.</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// u_a = u_b is collocated at the nodes of side a, which gives</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="comment">// one row of the constraint matrix.</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="comment">// Processors only compute their local constraints</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <a class="code" href="classlibMesh_1_1StoredRange.html">ConstElemRange</a> range (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">local_elements_begin</a>(),</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                        <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">local_elements_end</a>());</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="comment">// Global computation fails if we&#39;re using a FEMFunctionBase BC on a</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="comment">// ReplicatedMesh in parallel</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="comment">// ConstElemRange range (mesh.elements_begin(),</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">//                       mesh.elements_end());</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// compute_periodic_constraints requires a point_locator() from our</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="comment">// Mesh, but point_locator() construction is parallel and threaded.</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">// Rather than nest threads within threads we&#39;ll make sure it&#39;s</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="comment">// preconstructed.</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordtype">bool</span> need_point_locator = !<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;empty() &amp;&amp; !range.empty();</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(need_point_locator);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">if</span> (need_point_locator)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">sub_point_locator</a>();</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="comment">// recalculate node constraints from scratch</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.clear();</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a> (range,</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                         ComputeNodeConstraints (<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>,</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;#ifdef LIBMESH_ENABLE_PERIODIC</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                                 *<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>,</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;#endif</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                                 <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>));</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// recalculate dof constraints from scratch</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.clear();</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>.clear();</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.clear();</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.clear();</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="comment">// Look at all the variables in the system.  Reset the element</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// range at each iteration -- there is no need to reconstruct it.</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> variable_number=0; variable_number&lt;this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>();</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;       ++variable_number, range.reset())</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a> (range,</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                           ComputeConstraints (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>,</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                               *<span class="keyword">this</span>,</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;#ifdef LIBMESH_ENABLE_PERIODIC</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                               *<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>,</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;#endif</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                               <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>,</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                               variable_number));</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_DIRICHLET</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keywordflow">for</span> (DirichletBoundaries::iterator</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         i = <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;begin();</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;       i != <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;end(); ++i, range.reset())</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    {</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="comment">// Sanity check that the boundary ids associated with the DirichletBoundary</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="comment">// objects are actually present in the mesh</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a28c15409067d14ae53d7523b2b9c3076">check_dirichlet_bcid_consistency</a>(mesh,**i);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        (range,</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;         ConstrainDirichlet(*<span class="keyword">this</span>, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, time, **i,</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                            AddPrimalConstraint(*<span class="keyword">this</span>))</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;         );</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    }</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qoi_index = 0,</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;       n_qois = cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.size());</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;       qoi_index != n_qois; ++qoi_index)</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keywordflow">for</span> (DirichletBoundaries::iterator</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;             i = <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;begin();</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;           i != <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;end();</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;           ++i, range.reset())</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;          <span class="comment">// Sanity check that the boundary ids associated with the DirichletBoundary</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          <span class="comment">// objects are actually present in the mesh</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a28c15409067d14ae53d7523b2b9c3076">check_dirichlet_bcid_consistency</a>(mesh,**i);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            (range,</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;             ConstrainDirichlet(*<span class="keyword">this</span>, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, time, **i,</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                AddAdjointConstraint(*<span class="keyword">this</span>, qoi_index))</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;             );</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        }</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_DIRICHLET</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a28c15409067d14ae53d7523b2b9c3076"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a28c15409067d14ae53d7523b2b9c3076">libMesh::DofMap::check_dirichlet_bcid_consistency</a></div><div class="ttdeci">void check_dirichlet_bcid_consistency(const MeshBase &amp;mesh, const DirichletBoundary &amp;boundary) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l04362">dof_map_constraints.C:4362</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a11863902c0b1c34e7cfa8bde8ced3807"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a11863902c0b1c34e7cfa8bde8ced3807">libMesh::MeshBase::is_prepared</a></div><div class="ttdeci">bool is_prepared() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00147">mesh_base.h:147</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ad5bb1bebf75049eb42e511b6ae5f2b7e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">libMesh::MeshBase::sub_point_locator</a></div><div class="ttdeci">std::unique_ptr&lt; PointLocatorBase &gt; sub_point_locator() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00496">mesh_base.C:496</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_a97dcd01ff677ad850c3c9f6d8380dba2"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">libMesh::Threads::parallel_for</a></div><div class="ttdeci">void parallel_for(const Range &amp;range, const Body &amp;body)</div><div class="ttdef"><b>Definition:</b> <a href="threads__none_8h_source.html#l00073">threads_none.h:73</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5b67c2aa94e76310a6db3470cce8ef11"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">libMesh::MeshBase::local_elements_begin</a></div><div class="ttdeci">virtual element_iterator local_elements_begin()=0</div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a25b3182cbf57ead72821d826275512b0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00541">dof_map.h:541</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01721">dof_map.h:1721</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1StoredRange_html"><div class="ttname"><a href="classlibMesh_1_1StoredRange.html">libMesh::StoredRange</a></div><div class="ttdoc">Utility class for defining generic ranges for threading. </div><div class="ttdef"><b>Definition:</b> <a href="stored__range_8h_source.html#l00052">stored_range.h:52</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0629d79c85d44523e4e11624aa96cd85"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">libMesh::MeshBase::is_serial</a></div><div class="ttdeci">virtual bool is_serial() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00154">mesh_base.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ab8bd839216a1ef9c0912d523b68ae136"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">libMesh::MeshBase::local_elements_end</a></div><div class="ttdeci">virtual element_iterator local_elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_a476a638ff65585743af92b95078df8ce"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#a476a638ff65585743af92b95078df8ce">libMesh::MeshTools::libmesh_assert_valid_boundary_ids</a></div><div class="ttdeci">void libmesh_assert_valid_boundary_ids(const MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l01401">mesh_tools.C:1401</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01707">dof_map.h:1707</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a169bc3297f1070065f9380ff54eb0400"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a169bc3297f1070065f9380ff54eb0400">libMesh::MeshBase::mesh_dimension</a></div><div class="ttdeci">unsigned int mesh_dimension() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00126">mesh_base.C:126</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a190e556d3be87f5ccd8d4fc98d1779d3"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a190e556d3be87f5ccd8d4fc98d1779d3">libMesh::MeshBase::n_elem</a></div><div class="ttdeci">virtual dof_id_type n_elem() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac341c27edd859113d774716d5ad18d9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac341c27edd859113d774716d5ad18d9f">&#9670;&nbsp;</a></span>default_algebraic_ghosting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a>&amp; libMesh::DofMap::default_algebraic_ghosting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default algebraic ghosting functor </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00379">379</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01595">_default_evaluating</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01800">add_default_ghosting()</a>, and <a class="el" href="dof__map_8C_source.html#l01792">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01595">dof_map.h:1595</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa387f2af29a1998bc1236a20a9870b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa387f2af29a1998bc1236a20a9870b64">&#9670;&nbsp;</a></span>default_coupling()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a>&amp; libMesh::DofMap::default_coupling </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default coupling functor </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00329">329</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01587">_default_coupling</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01800">add_default_ghosting()</a>, and <a class="el" href="dof__map_8C_source.html#l01792">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01587">dof_map.h:1587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c0a2d3d3c531f9f069b0d623d4ace0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c0a2d3d3c531f9f069b0d623d4ace0f">&#9670;&nbsp;</a></span>disable_print_counter_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::disable_print_counter_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="reference__counter_8C_source.html#l00106">106</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p class="reference">References <a class="el" href="reference__counter_8h_source.html#l00141">libMesh::ReferenceCounter::_enable_print_counter</a>.</p>

<p class="reference">Referenced by <a class="el" href="libmesh_8C_source.html#l00329">libMesh::LibMeshInit::LibMeshInit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00141">reference_counter.h:141</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab986eb7bbf9bbb5119a49a145306a980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab986eb7bbf9bbb5119a49a145306a980">&#9670;&nbsp;</a></span>distribute_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::distribute_dofs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Distribute dofs on the current mesh. Also builds the send list for processor <code>proc_id</code>, which defaults to 0 for ease of use in serial applications. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00902">902</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01605">_algebraic_ghosting_functors</a>, <a class="el" href="dof__map_8h_source.html#l01618">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01535">_end_df</a>, <a class="el" href="dof__map_8h_source.html#l01672">_end_old_df</a>, <a class="el" href="dof__map_8h_source.html#l01530">_first_df</a>, <a class="el" href="dof__map_8h_source.html#l01667">_first_old_df</a>, <a class="el" href="dof__map_8h_source.html#l01678">_first_old_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01541">_first_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01649">_n_dfs</a>, <a class="el" href="dof__map_8h_source.html#l01662">_n_old_dfs</a>, <a class="el" href="dof__map_8h_source.html#l01547">_send_list</a>, <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, <a class="el" href="parallel__implementation_8h_source.html#l02746">libMesh::Parallel::Communicator::allgather()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="dof__map_8C_source.html#l01163">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="dof__map_8C_source.html#l00313">elem_ptr()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00644">end_dof()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="dof__map_8h_source.html#l00602">first_dof()</a>, <a class="el" href="fe__type_8h_source.html#l00078">libMesh::OrderWrapper::get_order()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8C_source.html#l00813">invalidate_dofs()</a>, <a class="el" href="mesh__tools_8C_source.html#l01571">libMesh::MeshTools::libmesh_assert_valid_dof_ids()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__object_8h_source.html#l00803">libMesh::DofObject::n_comp()</a>, <a class="el" href="dof__map_8h_source.html#l00574">n_dofs()</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="dof__map_8h_source.html#l00579">n_SCALAR_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00541">n_variables()</a>, <a class="el" href="dof__object_8h_source.html#l00768">libMesh::DofObject::n_vars()</a>, <a class="el" href="dof__map_8C_source.html#l00306">node_ptr()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">libMesh::MeshBase::nodes_begin()</a>, <a class="el" href="libmesh_8C_source.html#l00876">libMesh::on_command_line()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__map_8C_source.html#l00321">set_nonlocal_dof_objects()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, and <a class="el" href="dof__map_8h_source.html#l01762">variable()</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00284">libMesh::EquationSystems::allgather()</a>, and <a class="el" href="equation__systems_8C_source.html#l00133">libMesh::EquationSystems::reinit_solutions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// Log how long it takes to distribute the degrees of freedom</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;distribute_dofs()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  libmesh_assert (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.is_prepared());</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc_id = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>();</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> n_proc  = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>();</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">//  libmesh_assert_greater (this-&gt;n_variables(), 0);</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  libmesh_assert_less (proc_id, n_proc);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="comment">// re-init in case the mesh has changed</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#abf4ed8e608b51a7a4e95935bf42ebbb1">reinit</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">// By default distribute variables in a</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">// var-major fashion, but allow run-time</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="comment">// specification</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordtype">bool</span> node_major_dofs = <a class="code" href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a> (<span class="stringliteral">&quot;--node-major-dofs&quot;</span>);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">// The DOF counter, will be incremented as we encounter</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// new degrees of freedom</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> next_free_dof = 0;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// Clear the send list before we rebuild it</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.clear();</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// Set temporary DOF indices on this processor</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">if</span> (node_major_dofs)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">distribute_local_dofs_node_major</a> (next_free_dof, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">distribute_local_dofs_var_major</a> (next_free_dof, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">// Get DOF counts on all processors</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  std::vector&lt;dof_id_type&gt; dofs_on_proc(n_proc, 0);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a9784f116118938b9260753a6b4b9fc3f">allgather</a>(next_free_dof, dofs_on_proc);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">// Resize and fill the _first_df and _end_df arrays</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a> = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a> = <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.resize(n_proc);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.resize (n_proc);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// Get DOF offsets</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[0] = 0;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> i=1; i &lt; n_proc; ++i)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[i] = <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[i-1] = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[i-1] + dofs_on_proc[i-1];</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[n_proc-1] = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[n_proc-1] + dofs_on_proc[n_proc-1];</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">// Clear all the current DOF indices</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="comment">// (distribute_dofs expects them cleared!)</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afd8f3f26dfcdeaa8d024516ea750127c">invalidate_dofs</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  next_free_dof = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[proc_id];</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// Set permanent DOF indices on this processor</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">if</span> (node_major_dofs)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">distribute_local_dofs_node_major</a> (next_free_dof, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">distribute_local_dofs_var_major</a> (next_free_dof, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  libmesh_assert_equal_to (next_free_dof, <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc_id]);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// At this point, all n_comp and dof_number values on local</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// DofObjects should be correct, but a DistributedMesh might have</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// incorrect values on non-local DofObjects.  Let&#39;s request the</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="comment">// correct values from each other processor.</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>() &gt; 1)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">set_nonlocal_dof_objects</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.nodes_begin(),</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                     <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.nodes_end(),</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                     <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, &amp;<a class="code" href="classlibMesh_1_1DofMap.html#adddf429ac3d11389582986155f4d2d72">DofMap::node_ptr</a>);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">set_nonlocal_dof_objects</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.elements_begin(),</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                     <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.elements_end(),</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                                     <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, &amp;<a class="code" href="classlibMesh_1_1DofMap.html#ade6a304637b5e23e58dc33e0849443d0">DofMap::elem_ptr</a>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// Processors should all agree on DoF ids for the newly numbered</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// system.</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="namespacelibMesh_1_1MeshTools.html#a4bbb76e0674aab8a9797c70238b58ded">MeshTools::libmesh_assert_valid_dof_ids</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, sys_num);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">// DoF processor ids should match DofObject processor ids</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.node_ptr_range())</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        DofObject <span class="keyword">const</span> * <span class="keyword">const</span> dofobj = node;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> obj_proc_id = dofobj-&gt;processor_id();</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != dofobj-&gt;n_vars(sys_num); ++v)</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c != dofobj-&gt;n_comp(sys_num,v); ++c)</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dofid = dofobj-&gt;dof_number(sys_num,v,c);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;              libmesh_assert_greater_equal (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">first_dof</a>(obj_proc_id));</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;              libmesh_assert_less (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">end_dof</a>(obj_proc_id));</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            }</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      }</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.element_ptr_range())</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      {</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        DofObject <span class="keyword">const</span> * <span class="keyword">const</span> dofobj = elem;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> obj_proc_id = dofobj-&gt;processor_id();</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != dofobj-&gt;n_vars(sys_num); ++v)</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c != dofobj-&gt;n_comp(sys_num,v); ++c)</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dofid = dofobj-&gt;dof_number(sys_num,v,c);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;              libmesh_assert_greater_equal (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">first_dof</a>(obj_proc_id));</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;              libmesh_assert_less (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">end_dof</a>(obj_proc_id));</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      }</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// Set the total number of degrees of freedom, then start finding</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// SCALAR degrees of freedom</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a> = <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a> = <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a> = <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[n_proc-1];</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>.clear();</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>.resize(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>(), <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> current_SCALAR_dof_index = <a class="code" href="classlibMesh_1_1DofMap.html#a1e989f4bcf03847736e84ff054e41111">n_dofs</a>() - <a class="code" href="classlibMesh_1_1DofMap.html#af31c7dfd8d972d20ca28e945565a5526">n_SCALAR_dofs</a>();</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="comment">// Calculate and cache the initial DoF indices for SCALAR variables.</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="comment">// This is an O(N_vars) calculation so we want to do it once per</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">// renumbering rather than once per SCALAR_dof_indices() call</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>(); v++)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">variable</a>(v).<a class="code" href="classlibMesh_1_1Variable.html#aa7797f0c1f213275a78839e86bcda3c8">type</a>().<a class="code" href="classlibMesh_1_1FEType.html#ac437ba9b0a5253d6bf6f07ad277b9978">family</a> == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>[v] = current_SCALAR_dof_index;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        current_SCALAR_dof_index += this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">variable</a>(v).<a class="code" href="classlibMesh_1_1Variable.html#aa7797f0c1f213275a78839e86bcda3c8">type</a>().<a class="code" href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">order</a>.<a class="code" href="classlibMesh_1_1OrderWrapper.html#af61af3996f36c55351b90b820ea9fb3e">get_order</a>();</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="comment">// Allow our GhostingFunctor objects to reinit if necessary</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    {</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      libmesh_assert(gf);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      gf-&gt;dofmap_reinit();</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>)</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      libmesh_assert(gf);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      gf-&gt;dofmap_reinit();</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="comment">// Note that in the add_neighbors_to_send_list nodes on processor</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="comment">// boundaries that are shared by multiple elements are added for</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="comment">// each element.</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">add_neighbors_to_send_list</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">// Here we used to clean up that data structure; now System and</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="comment">// EquationSystems call that for us, after we&#39;ve added constraint</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="comment">// dependencies to the send_list too.</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="comment">// this-&gt;sort_send_list ();</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1FEType_html_ac437ba9b0a5253d6bf6f07ad277b9978"><div class="ttname"><a href="classlibMesh_1_1FEType.html#ac437ba9b0a5253d6bf6f07ad277b9978">libMesh::FEType::family</a></div><div class="ttdeci">FEFamily family</div><div class="ttdef"><b>Definition:</b> <a href="fe__type_8h_source.html#l00204">fe_type.h:204</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5fa08b142ac3e34a8213017252b96d30"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">libMesh::DofMap::distribute_local_dofs_node_major</a></div><div class="ttdeci">void distribute_local_dofs_node_major(dof_id_type &amp;next_free_dof, MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01163">dof_map.C:1163</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af31c7dfd8d972d20ca28e945565a5526"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af31c7dfd8d972d20ca28e945565a5526">libMesh::DofMap::n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type n_SCALAR_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00579">dof_map.h:579</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a9784f116118938b9260753a6b4b9fc3f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a9784f116118938b9260753a6b4b9fc3f">libMesh::Parallel::Communicator::allgather</a></div><div class="ttdeci">void allgather(const T &amp;send, std::vector&lt; T, A &gt; &amp;recv) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l02746">parallel_implementation.h:2746</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a25b3182cbf57ead72821d826275512b0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00541">dof_map.h:541</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01605">dof_map.h:1605</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01672">dof_map.h:1672</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEType_html_a8a4f7c664bddf007599e8087871c6785"><div class="ttname"><a href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">libMesh::FEType::order</a></div><div class="ttdeci">OrderWrapper order</div><div class="ttdef"><b>Definition:</b> <a href="fe__type_8h_source.html#l00198">fe_type.h:198</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01667">dof_map.h:1667</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01541">dof_map.h:1541</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1e989f4bcf03847736e84ff054e41111"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1e989f4bcf03847736e84ff054e41111">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00574">dof_map.h:574</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aed8eba054300e64164af4a8257bae8d8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">libMesh::DofMap::add_neighbors_to_send_list</a></div><div class="ttdeci">void add_neighbors_to_send_list(MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01499">dof_map.C:1499</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01678">dof_map.h:1678</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a46ed397847e6a1c3be2236e2faf622ec"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">libMesh::DofMap::variable</a></div><div class="ttdeci">const Variable &amp; variable(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01762">dof_map.h:1762</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_a4bbb76e0674aab8a9797c70238b58ded"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#a4bbb76e0674aab8a9797c70238b58ded">libMesh::MeshTools::libmesh_assert_valid_dof_ids</a></div><div class="ttdeci">void libmesh_assert_valid_dof_ids(const MeshBase &amp;mesh, unsigned int sysnum)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l01571">mesh_tools.C:1571</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7bad83b3b5e37a8afe4ea251d72df300"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">libMesh::DofMap::set_nonlocal_dof_objects</a></div><div class="ttdeci">void set_nonlocal_dof_objects(iterator_type objects_begin, iterator_type objects_end, MeshBase &amp;mesh, dofobject_accessor objects)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00321">dof_map.C:321</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abf4ed8e608b51a7a4e95935bf42ebbb1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abf4ed8e608b51a7a4e95935bf42ebbb1">libMesh::DofMap::reinit</a></div><div class="ttdeci">void reinit(MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00474">dof_map.C:474</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a08c13836ca9040d9ebfd511549e4da94"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00644">dof_map.h:644</a></div></div>
<div class="ttc" id="classlibMesh_1_1OrderWrapper_html_af61af3996f36c55351b90b820ea9fb3e"><div class="ttname"><a href="classlibMesh_1_1OrderWrapper.html#af61af3996f36c55351b90b820ea9fb3e">libMesh::OrderWrapper::get_order</a></div><div class="ttdeci">int get_order() const</div><div class="ttdef"><b>Definition:</b> <a href="fe__type_8h_source.html#l00078">fe_type.h:78</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ade6a304637b5e23e58dc33e0849443d0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ade6a304637b5e23e58dc33e0849443d0">libMesh::DofMap::elem_ptr</a></div><div class="ttdeci">DofObject * elem_ptr(MeshBase &amp;mesh, dof_id_type i) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00313">dof_map.C:313</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_afd8f3f26dfcdeaa8d024516ea750127c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#afd8f3f26dfcdeaa8d024516ea750127c">libMesh::DofMap::invalidate_dofs</a></div><div class="ttdeci">void invalidate_dofs(MeshBase &amp;mesh) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00813">dof_map.C:813</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a94601bbfdd0675c7259adebea917cd13"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00602">dof_map.h:602</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01662">dof_map.h:1662</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01618">dof_map.h:1618</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01530">dof_map.h:1530</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_adddf429ac3d11389582986155f4d2d72"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#adddf429ac3d11389582986155f4d2d72">libMesh::DofMap::node_ptr</a></div><div class="ttdeci">DofObject * node_ptr(MeshBase &amp;mesh, dof_id_type i) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00306">dof_map.C:306</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adc9fb0dafe70b50cd0848a8142cf57c0"><div class="ttname"><a href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a></div><div class="ttdeci">bool on_command_line(std::string arg)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00876">libmesh.C:876</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af781ec4ff23b34cd4332a357f1647fdd"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">libMesh::DofMap::distribute_local_dofs_var_major</a></div><div class="ttdeci">void distribute_local_dofs_var_major(dof_id_type &amp;next_free_dof, MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01302">dof_map.C:1302</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01649">dof_map.h:1649</a></div></div>
<div class="ttc" id="classlibMesh_1_1Variable_html_aa7797f0c1f213275a78839e86bcda3c8"><div class="ttname"><a href="classlibMesh_1_1Variable.html#aa7797f0c1f213275a78839e86bcda3c8">libMesh::Variable::type</a></div><div class="ttdeci">const FEType &amp; type() const</div><div class="ttdef"><b>Definition:</b> <a href="variable_8h_source.html#l00119">variable.h:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fa08b142ac3e34a8213017252b96d30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fa08b142ac3e34a8213017252b96d30">&#9670;&nbsp;</a></span>distribute_local_dofs_node_major()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::distribute_local_dofs_node_major </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;&#160;</td>
          <td class="paramname"><em>next_free_dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Distributes the global degrees of freedom for dofs on this processor. In this format all the degrees of freedom at a node/element are in contiguous blocks. Starts at index <code>next_free_dof</code>, and increments it to the post-final index. If <code>build_send_list</code> is <code>true</code>, builds the send list. If <code>false</code>, clears and reserves the send list.</p>
<dl class="section note"><dt>Note</dt><dd>The degrees of freedom for a given variable are not in contiguous blocks, as in the case of <code>distribute_local_dofs_var_major</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01163">1163</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01655">_n_SCALAR_dofs</a>, <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="fe__type_8h_source.html#l00078">libMesh::OrderWrapper::get_order()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00217">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__object_8h_source.html#l00960">libMesh::DofObject::set_vg_dof_base()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>, and <a class="el" href="dof__object_8h_source.html#l00980">libMesh::DofObject::vg_dof_base()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;{</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num       = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">// Our numbering here must be kept consistent with the numbering</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">// scheme assumed by DofMap::local_variable_indices!</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">// First count and assign temporary numbers to local dofs</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_element_ptr_range())</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    {</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="comment">// Only number dofs connected to active</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="comment">// elements on this processor.</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = elem-&gt;n_nodes();</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="comment">// First number the nodal DOFS</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;<a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; n++)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          Node &amp; node = elem-&gt;node_ref(n);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;              <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg));</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;              <span class="keywordflow">if</span> ((vg_description.type().family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>) &amp;&amp;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                  (vg_description.active_on_subdomain(elem-&gt;subdomain_id())))</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                  <span class="comment">// assign dof numbers (all at once) if this is</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                  <span class="comment">// our node and if they aren&#39;t already there</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                  <span class="keywordflow">if</span> ((node.n_comp_group(sys_num,vg) &gt; 0) &amp;&amp;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                      (node.processor_id() == this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()) &amp;&amp;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                      (node.vg_dof_base(sys_num,vg) ==</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                       <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>))</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                    {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                      node.set_vg_dof_base(sys_num, vg,</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                           next_free_dof);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                      next_free_dof += (vg_description.n_variables()*</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                        node.n_comp_group(sys_num,vg));</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                      <span class="comment">//node.debug_buffer();</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                }</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            }</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="comment">// Now number the element DOFS</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;          <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg));</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;          <span class="keywordflow">if</span> ((vg_description.type().family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>) &amp;&amp;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;              (vg_description.active_on_subdomain(elem-&gt;subdomain_id())))</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            <span class="keywordflow">if</span> (elem-&gt;n_comp_group(sys_num,vg) &gt; 0)</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;              {</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                libmesh_assert_equal_to (elem-&gt;vg_dof_base(sys_num,vg),</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                         <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                elem-&gt;set_vg_dof_base(sys_num,</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                      vg,</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                      next_free_dof);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                next_free_dof += (vg_description.n_variables()*</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                  elem-&gt;n_comp(sys_num,vg));</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;              }</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    } <span class="comment">// done looping over elements</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="comment">// we may have missed assigning DOFs to nodes that we own</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="comment">// but to which we have no connected elements matching our</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="comment">// variable restriction criterion.  this will happen, for example,</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment">// if variable V is restricted to subdomain S.  We may not own</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">// any elements which live in S, but we may own nodes which are</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="comment">// *connected* to elements which do.  in this scenario these nodes</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="comment">// will presently have unnumbered DOFs. we need to take care of</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="comment">// them here since we own them and no other processor will touch them.</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.local_node_ptr_range())</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      {</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg));</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="keywordflow">if</span> (node-&gt;n_comp_group(sys_num,vg))</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          <span class="keywordflow">if</span> (node-&gt;vg_dof_base(sys_num,vg) == <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;              node-&gt;set_vg_dof_base (sys_num,</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                     vg,</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                     next_free_dof);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;              next_free_dof += (vg_description.n_variables()*</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                node-&gt;n_comp(sys_num,vg));</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            }</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="comment">// Finally, count up the SCALAR dofs</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> = 0;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    {</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg));</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">if</span> (vg_description.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        {</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> += (vg_description.n_variables()*</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                                   vg_description.type().order.get_order());</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        }</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    }</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">// Only increment next_free_dof if we&#39;re on the processor</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="comment">// that holds this SCALAR variable</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>() == (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>()-1))</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    next_free_dof += <a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a>;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">// libMesh::out &lt;&lt; &quot;next_free_dof=&quot; &lt;&lt; next_free_dof &lt;&lt; std::endl</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">//       &lt;&lt; &quot;_n_SCALAR_dofs=&quot; &lt;&lt; _n_SCALAR_dofs &lt;&lt; std::endl;</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">// Make sure we didn&#39;t miss any nodes</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    MeshTools::libmesh_assert_valid_procids&lt;Node&gt;(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.local_node_ptr_range())</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_g = node-&gt;n_var_groups(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>());</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg != n_var_g; ++vg)</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          {</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp_g =</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;              node-&gt;n_comp_group(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(), vg);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = n_comp_g ?</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;              node-&gt;vg_dof_base(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(), vg) : 0;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          }</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      }</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  }</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="preprocessor">#endif // DEBUG</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01655">dof_map.h:1655</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af781ec4ff23b34cd4332a357f1647fdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af781ec4ff23b34cd4332a357f1647fdd">&#9670;&nbsp;</a></span>distribute_local_dofs_var_major()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::distribute_local_dofs_var_major </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;&#160;</td>
          <td class="paramname"><em>next_free_dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Distributes the global degrees of freedom, for dofs on this processor. In this format the local degrees of freedom are in a contiguous block for each variable in the system. Starts at index next_free_dof, and increments it to the post-final index. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01302">1302</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01655">_n_SCALAR_dofs</a>, <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="fe__type_8h_source.html#l00078">libMesh::OrderWrapper::get_order()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00217">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__object_8h_source.html#l00960">libMesh::DofObject::set_vg_dof_base()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>, and <a class="el" href="dof__object_8h_source.html#l00980">libMesh::DofObject::vg_dof_base()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;{</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="comment">// Our numbering here must be kept consistent with the numbering</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">// scheme assumed by DofMap::local_variable_indices!</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="comment">// First count and assign temporary numbers to local dofs</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    {</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg));</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vars_in_group = vg_description.n_variables();</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="comment">// Skip the SCALAR dofs</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="keywordflow">if</span> (vg_description.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_element_ptr_range())</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        {</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;          <span class="comment">// Only number dofs connected to active elements on this</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;          <span class="comment">// processor and only variables which are active on on this</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          <span class="comment">// element&#39;s subdomain.</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          <span class="keywordflow">if</span> (!vg_description.active_on_subdomain(elem-&gt;subdomain_id()))</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = elem-&gt;n_nodes();</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;          <span class="comment">// First number the nodal DOFS</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;<a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; n++)</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            {</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;              Node &amp; node = elem-&gt;node_ref(n);</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;              <span class="comment">// assign dof numbers (all at once) if this is</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;              <span class="comment">// our node and if they aren&#39;t already there</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;              <span class="keywordflow">if</span> ((node.n_comp_group(sys_num,vg) &gt; 0) &amp;&amp;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                  (node.processor_id() == this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()) &amp;&amp;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                  (node.vg_dof_base(sys_num,vg) ==</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                   <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>))</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                  node.set_vg_dof_base(sys_num, vg, next_free_dof);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                  next_free_dof += (n_vars_in_group*</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                    node.n_comp_group(sys_num,vg));</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          <span class="comment">// Now number the element DOFS</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;n_comp_group(sys_num,vg) &gt; 0)</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            {</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;              libmesh_assert_equal_to (elem-&gt;vg_dof_base(sys_num,vg),</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                       <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;              elem-&gt;set_vg_dof_base(sys_num,</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                    vg,</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                    next_free_dof);</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;              next_free_dof += (n_vars_in_group*</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                elem-&gt;n_comp_group(sys_num,vg));</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            }</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        } <span class="comment">// end loop on elements</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="comment">// we may have missed assigning DOFs to nodes that we own</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="comment">// but to which we have no connected elements matching our</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">// variable restriction criterion.  this will happen, for example,</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="comment">// if variable V is restricted to subdomain S.  We may not own</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="comment">// any elements which live in S, but we may own nodes which are</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="comment">// *connected* to elements which do.  in this scenario these nodes</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="comment">// will presently have unnumbered DOFs. we need to take care of</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="comment">// them here since we own them and no other processor will touch them.</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.local_node_ptr_range())</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keywordflow">if</span> (node-&gt;n_comp_group(sys_num,vg))</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;          <span class="keywordflow">if</span> (node-&gt;vg_dof_base(sys_num,vg) == <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;              node-&gt;set_vg_dof_base (sys_num,</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                     vg,</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                     next_free_dof);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;              next_free_dof += (n_vars_in_group*</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                node-&gt;n_comp_group(sys_num,vg));</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            }</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    } <span class="comment">// end loop on variable groups</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="comment">// Finally, count up the SCALAR dofs</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> = 0;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    {</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg));</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keywordflow">if</span> (vg_description.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> += (vg_description.n_variables()*</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                                   vg_description.type().order.get_order());</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        }</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    }</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="comment">// Only increment next_free_dof if we&#39;re on the processor</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="comment">// that holds this SCALAR variable</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>() == (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>()-1))</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    next_free_dof += <a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a>;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">// Make sure we didn&#39;t miss any nodes</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    MeshTools::libmesh_assert_valid_procids&lt;Node&gt;(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.local_node_ptr_range())</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      {</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_g = node-&gt;n_var_groups(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>());</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg != n_var_g; ++vg)</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          {</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp_g =</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;              node-&gt;n_comp_group(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(), vg);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = n_comp_g ?</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;              node-&gt;vg_dof_base(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(), vg) : 0;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          }</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      }</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  }</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="preprocessor">#endif // DEBUG</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01655">dof_map.h:1655</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3962af7f276a08be8f22bffd304bdab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3962af7f276a08be8f22bffd304bdab7">&#9670;&nbsp;</a></span>dof_indices() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *const&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the vector <code>di</code> with the global degree of freedom indices for the element. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01930">1930</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8C_source.html#l02209">_dof_indices()</a>, <a class="el" href="elem_8h_source.html#l02390">libMesh::Elem::active()</a>, <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="mesh__subdivision__support_8C_source.html#l00031">libMesh::MeshTools::Subdivision::find_one_ring()</a>, <a class="el" href="elem_8h_source.html#l01949">libMesh::Elem::get_nodes()</a>, <a class="el" href="face__tri3__subdivision_8h_source.html#l00116">libMesh::Tri3Subdivision::is_ghost()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00217">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="variable_8h_source.html#l00255">libMesh::VariableGroup::number()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>, <a class="el" href="elem_8h_source.html#l02034">libMesh::Elem::subdomain_id()</a>, <a class="el" href="enum__elem__type_8h_source.html#l00069">libMesh::TRI3SUBDIVISION</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ad06f8ac22978144723179eed42d10bae">libMesh::Elem::type()</a>, and <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>.</p>

<p class="reference">Referenced by <a class="el" href="exact__solution_8C_source.html#l00455">libMesh::ExactSolution::_compute_error()</a>, <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, <a class="el" href="hp__coarsentest_8C_source.html#l00047">libMesh::HPCoarsenTest::add_projection()</a>, <a class="el" href="equation__systems_8C_source.html#l01055">libMesh::EquationSystems::build_discontinuous_solution_vector()</a>, <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="equation__systems_8C_source.html#l00600">libMesh::EquationSystems::build_parallel_solution_vector()</a>, <a class="el" href="system_8C_source.html#l01400">libMesh::System::calculate_norm()</a>, <a class="el" href="fe__base_8C_source.html#l00791">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::coarsened_dof_values()</a>, <a class="el" href="fe__base_8C_source.html#l01650">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_periodic_constraints()</a>, <a class="el" href="fe__base_8C_source.html#l01366">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_proj_constraints()</a>, <a class="el" href="mesh__function_8C_source.html#l00517">libMesh::MeshFunction::discontinuous_gradient()</a>, <a class="el" href="mesh__function_8C_source.html#l00343">libMesh::MeshFunction::discontinuous_value()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00374">DMCreateDomainDecomposition_libMesh()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00267">DMCreateFieldDecomposition_libMesh()</a>, <a class="el" href="dof__map_8C_source.html#l02163">dof_indices()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="mesh__function_8C_source.html#l00431">libMesh::MeshFunction::gradient()</a>, <a class="el" href="mesh__function_8C_source.html#l00597">libMesh::MeshFunction::hessian()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="dof__map_8C_source.html#l02413">is_evaluable()</a>, <a class="el" href="system_8C_source.html#l01277">libMesh::System::local_dof_indices()</a>, <a class="el" href="dg__fem__context_8C_source.html#l00086">libMesh::DGFEMContext::neighbor_side_fe_reinit()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00112">libMesh::WeightedPatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00210">libMesh::PatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="mesh__function_8C_source.html#l00243">libMesh::MeshFunction::operator()()</a>, <a class="el" href="system__projection_8C_source.html#l01182">libMesh::BoundaryProjectSolution::operator()()</a>, <a class="el" href="error__vector_8C_source.html#l00210">libMesh::ErrorVector::plot_error()</a>, <a class="el" href="system_8C_source.html#l02154">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02273">libMesh::System::point_hessian()</a>, <a class="el" href="fem__context_8C_source.html#l01552">libMesh::FEMContext::pre_fe_reinit()</a>, <a class="el" href="hp__coarsentest_8C_source.html#l00140">libMesh::HPCoarsenTest::select_refinement()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00083">libMesh::SparsityPattern::Build::sorted_connected_dofs()</a>, <a class="el" href="ensight__io_8C_source.html#l00337">libMesh::EnsightIO::write_scalar_ascii()</a>, and <a class="el" href="ensight__io_8C_source.html#l00408">libMesh::EnsightIO::write_vector_ascii()</a>.</p>
<div class="fragment"><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;{</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="comment">// We now allow elem==nullptr to request just SCALAR dofs</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="comment">// If we are asking for current indices on an element, it ought to</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="comment">// be an active element (or a Side proxy, which also thinks it&#39;s</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="comment">// active)</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  libmesh_assert(!elem || elem-&gt;active());</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  di.clear();</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="comment">// Check that sizes match in DEBUG mode</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  std::size_t tot_size = 0;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">if</span> (elem &amp;&amp; elem-&gt;type() == <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049">TRI3SUBDIVISION</a>)</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    {</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="comment">// Subdivision surface FE require the 1-ring around elem</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keyword">const</span> Tri3Subdivision * sd_elem = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>Tri3Subdivision *<span class="keyword">&gt;</span>(elem);</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="comment">// Ghost subdivision elements have no real dofs</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="keywordflow">if</span> (!sd_elem-&gt;is_ghost())</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        {</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;          <span class="comment">// Determine the nodes contributing to element elem</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;          std::vector&lt;const Node *&gt; elem_nodes;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;          <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Subdivision.html#a8cb6430d3673fa7eff27467e17a94505">MeshTools::Subdivision::find_one_ring</a>(sd_elem, elem_nodes);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          <span class="comment">// Get the dof numbers</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            {</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;              <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;              <span class="keywordflow">if</span> (var.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a> &amp;&amp;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                  var.active_on_subdomain(elem-&gt;subdomain_id()))</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                {</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                    {</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                      tot_size += var.type().order;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                      std::vector&lt;dof_id_type&gt; di_new;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a>(di_new,var.number(vig));</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                      di.insert( di.end(), di_new.begin(), di_new.end());</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                    }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                }</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                  {</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#ad1d420cf89d32c1853354a324ded2317">_dof_indices</a>(*elem, elem-&gt;p_level(), di, vg, vig,</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                                 elem_nodes.data(),</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                                 cast_int&lt;unsigned int&gt;(elem_nodes.size())</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;#ifdef DEBUG</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                 , var.number(vig), tot_size</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                                 );</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                  }</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            }</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        }</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <span class="comment">// Get the dof numbers for each variable</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = elem ? elem-&gt;n_nodes() : 0;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    {</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="keywordflow">if</span> (var.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a> &amp;&amp;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;          (!elem ||</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;           var.active_on_subdomain(elem-&gt;subdomain_id())))</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        {</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            {</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;              tot_size += var.type().order;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;              std::vector&lt;dof_id_type&gt; di_new;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;              this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a>(di_new,var.number(vig));</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;              di.insert( di.end(), di_new.begin(), di_new.end());</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            }</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        }</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem)</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;          {</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#ad1d420cf89d32c1853354a324ded2317">_dof_indices</a>(*elem, elem-&gt;p_level(), di, vg, vig,</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                         elem-&gt;get_nodes(), <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                         , var.number(vig), tot_size</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                     );</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;          }</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    }</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  libmesh_assert_equal_to (tot_size, di.size());</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad1d420cf89d32c1853354a324ded2317"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad1d420cf89d32c1853354a324ded2317">libMesh::DofMap::_dof_indices</a></div><div class="ttdeci">void _dof_indices(const Elem &amp;elem, int p_level, std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vg, const unsigned int vig, const Node *const *nodes, unsigned int n_nodes #ifdef DEBUG, const unsigned int v, std::size_t &amp;tot_size #endif) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02209">dof_map.C:2209</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ef75ddf2020ea30f1200cd317c0126"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02348">dof_map.C:2348</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_1_1Subdivision_html_a8cb6430d3673fa7eff27467e17a94505"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools_1_1Subdivision.html#a8cb6430d3673fa7eff27467e17a94505">libMesh::MeshTools::Subdivision::find_one_ring</a></div><div class="ttdeci">void find_one_ring(const Tri3Subdivision *elem, std::vector&lt; const Node *&gt; &amp;nodes)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__subdivision__support_8C_source.html#l00031">mesh_subdivision_support.C:31</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049"><div class="ttname"><a href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049">libMesh::TRI3SUBDIVISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__elem__type_8h_source.html#l00069">enum_elem_type.h:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac46bb224192bd1d99d434c2176cd9f14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46bb224192bd1d99d434c2176cd9f14">&#9670;&nbsp;</a></span>dof_indices() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *const&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p_level</em> = <code>-12345</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the vector <code>di</code> with the global degree of freedom indices for the element. For one variable, and potentially for a non-default element p refinement level </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02040">2040</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8C_source.html#l02209">_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l01508">_variable_group_numbers</a>, <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="mesh__subdivision__support_8C_source.html#l00031">libMesh::MeshTools::Subdivision::find_one_ring()</a>, <a class="el" href="elem_8h_source.html#l01949">libMesh::Elem::get_nodes()</a>, <a class="el" href="face__tri3__subdivision_8h_source.html#l00116">libMesh::Tri3Subdivision::is_ghost()</a>, <a class="el" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes()</a>, <a class="el" href="variable_8h_source.html#l00255">libMesh::VariableGroup::number()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>, <a class="el" href="elem_8h_source.html#l02034">libMesh::Elem::subdomain_id()</a>, <a class="el" href="enum__elem__type_8h_source.html#l00069">libMesh::TRI3SUBDIVISION</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ad06f8ac22978144723179eed42d10bae">libMesh::Elem::type()</a>, and <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;{</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">// We now allow elem==nullptr to request just SCALAR dofs</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  di.clear();</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="comment">// Use the default p refinement level?</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="keywordflow">if</span> (p_level == -12345)</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    p_level = elem ? elem-&gt;p_level() : 0;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>[vn];</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig = vn - var.number();</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  <span class="comment">// Check that sizes match in DEBUG mode</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  std::size_t tot_size = 0;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="keywordflow">if</span> (elem &amp;&amp; elem-&gt;type() == <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049">TRI3SUBDIVISION</a>)</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    {</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="comment">// Subdivision surface FE require the 1-ring around elem</span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <span class="keyword">const</span> Tri3Subdivision * sd_elem = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>Tri3Subdivision *<span class="keyword">&gt;</span>(elem);</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="comment">// Ghost subdivision elements have no real dofs</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="keywordflow">if</span> (!sd_elem-&gt;is_ghost())</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        {</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;          <span class="comment">// Determine the nodes contributing to element elem</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;          std::vector&lt;const Node *&gt; elem_nodes;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;          <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Subdivision.html#a8cb6430d3673fa7eff27467e17a94505">MeshTools::Subdivision::find_one_ring</a>(sd_elem, elem_nodes);</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;          <a class="code" href="classlibMesh_1_1DofMap.html#ad1d420cf89d32c1853354a324ded2317">_dof_indices</a>(*elem, p_level, di, vg, vig, elem_nodes.data(),</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                       cast_int&lt;unsigned int&gt;(elem_nodes.size())</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;#ifdef DEBUG</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                       , vn, tot_size</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;#endif</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                       );</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        }</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    }</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="comment">// Get the dof numbers</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordflow">if</span> (var.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a> &amp;&amp;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      (!elem ||</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;       var.active_on_subdomain(elem-&gt;subdomain_id())))</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    {</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      tot_size += var.type().order;</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      std::vector&lt;dof_id_type&gt; di_new;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a>(di_new,vn);</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      di.insert( di.end(), di_new.begin(), di_new.end());</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    }</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem)</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ad1d420cf89d32c1853354a324ded2317">_dof_indices</a>(*elem, p_level, di, vg, vig, elem-&gt;get_nodes(),</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                 elem-&gt;n_nodes()</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                 , vn, tot_size</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                 );</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  libmesh_assert_equal_to (tot_size, di.size());</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad1d420cf89d32c1853354a324ded2317"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad1d420cf89d32c1853354a324ded2317">libMesh::DofMap::_dof_indices</a></div><div class="ttdeci">void _dof_indices(const Elem &amp;elem, int p_level, std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vg, const unsigned int vig, const Node *const *nodes, unsigned int n_nodes #ifdef DEBUG, const unsigned int v, std::size_t &amp;tot_size #endif) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02209">dof_map.C:2209</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ef75ddf2020ea30f1200cd317c0126"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02348">dof_map.C:2348</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_1_1Subdivision_html_a8cb6430d3673fa7eff27467e17a94505"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools_1_1Subdivision.html#a8cb6430d3673fa7eff27467e17a94505">libMesh::MeshTools::Subdivision::find_one_ring</a></div><div class="ttdeci">void find_one_ring(const Tri3Subdivision *elem, std::vector&lt; const Node *&gt; &amp;nodes)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__subdivision__support_8C_source.html#l00031">mesh_subdivision_support.C:31</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01508">dof_map.h:1508</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049"><div class="ttname"><a href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049">libMesh::TRI3SUBDIVISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__elem__type_8h_source.html#l00069">enum_elem_type.h:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afac2a12aa327e27b445818bf0eb87fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afac2a12aa327e27b445818bf0eb87fc8">&#9670;&nbsp;</a></span>dof_indices() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *const&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the vector <code>di</code> with the global degree of freedom indices for the node. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02115">2115</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00217">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="variable_8h_source.html#l00255">libMesh::VariableGroup::number()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, and <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;{</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="comment">// We allow node==nullptr to request just SCALAR dofs</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices(Node)&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  di.clear();</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="comment">// Get the dof numbers</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    {</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <span class="keywordflow">if</span> (var.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        {</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;            {</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;              std::vector&lt;dof_id_type&gt; di_new;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;              this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a>(di_new,var.number(vig));</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;              di.insert( di.end(), di_new.begin(), di_new.end());</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            }</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        {</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> n_comp = node-&gt;n_comp_group(sys_num,vg);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            {</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i != n_comp; ++i)</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                {</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                    node-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                  libmesh_assert_not_equal_to</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                    (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                  di.push_back(d);</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                }</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            }</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        }</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    }</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ef75ddf2020ea30f1200cd317c0126"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02348">dof_map.C:2348</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9db06d7650334c564ba1b7b3a6e5c1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9db06d7650334c564ba1b7b3a6e5c1f">&#9670;&nbsp;</a></span>dof_indices() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *const&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the vector <code>di</code> with the global degree of freedom indices for the node. For one variable <code>vn</code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02163">2163</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01508">_variable_group_numbers</a>, <a class="el" href="dof__map_8C_source.html#l01930">dof_indices()</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="variable_8h_source.html#l00255">libMesh::VariableGroup::number()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, and <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;{</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keywordflow">if</span> (vn == <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    {</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a>(node, di);</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    }</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="comment">// We allow node==nullptr to request just SCALAR dofs</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices(Node)&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  di.clear();</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="comment">// Get the dof numbers</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>[vn];</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <span class="keywordflow">if</span> (var.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    {</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      std::vector&lt;dof_id_type&gt; di_new;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a>(di_new,vn);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      di.insert( di.end(), di_new.begin(), di_new.end());</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    }</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    {</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig = vn - var.number();</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> n_comp = node-&gt;n_comp_group(sys_num,vg);</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i != n_comp; ++i)</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        {</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            node-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;          libmesh_assert_not_equal_to</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;          di.push_back(d);</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        }</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    }</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;}</div><div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3962af7f276a08be8f22bffd304bdab7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01930">dof_map.C:1930</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ef75ddf2020ea30f1200cd317c0126"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02348">dof_map.C:2348</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01508">dof_map.h:1508</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a123a56fff4389e347b6f40a591859eef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a123a56fff4389e347b6f40a591859eef">&#9670;&nbsp;</a></span>dof_owner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libMesh::DofMap::dof_owner </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The processor id that owns the dof index <code>dof</code> </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00650">650</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01535">_end_df</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__dm__wrapper_8C_source.html#l00163">libMesh::PetscDMWrapper::build_sf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  { std::vector&lt;dof_id_type&gt;::const_iterator ub =</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      std::upper_bound(<a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.end(), dof);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    libmesh_assert (ub != <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.end());</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(ub - <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.begin());</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ade6a304637b5e23e58dc33e0849443d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade6a304637b5e23e58dc33e0849443d0">&#9670;&nbsp;</a></span>elem_ptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> * libMesh::DofMap::elem_ptr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The <a class="el" href="classlibMesh_1_1Elem.html" title="The base class for all geometric element types. ">Elem</a> pointer with index <code>i</code> from the <code>mesh</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00313">313</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.elem_ptr(i);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div><div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86837c50216b2ddb800b3836d2a08c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86837c50216b2ddb800b3836d2a08c09">&#9670;&nbsp;</a></span>enable_print_counter_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::enable_print_counter_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Methods to enable/disable the reference counter output from <a class="el" href="classlibMesh_1_1DofMap.html#ac72dbf3012e202aa431d33287c6e3216">print_info()</a> </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8C_source.html#l00100">100</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p class="reference">References <a class="el" href="reference__counter_8h_source.html#l00141">libMesh::ReferenceCounter::_enable_print_counter</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00141">reference_counter.h:141</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6bba480fbe9bd4364e5ff8545ea0d38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6bba480fbe9bd4364e5ff8545ea0d38">&#9670;&nbsp;</a></span>end_dof() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The first dof index that is after all indices local to processor <code>proc</code>.</dd></dl>
<p>Analogous to the <a class="el" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end()</a> member function of STL containers. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00641">641</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01535">_end_df</a>.</p>

<p class="reference">Referenced by <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00374">DMCreateDomainDecomposition_libMesh()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00267">DMCreateFieldDecomposition_libMesh()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00098">libMesh::SparsityPattern::Build::handle_vi_vj()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="condensed__eigen__system_8C_source.html#l00047">libMesh::CondensedEigenSystem::initialize_condensed_dofs()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00341">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="system_8C_source.html#l01277">libMesh::System::local_dof_indices()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>, and <a class="el" href="sparsity__pattern_8C_source.html#l00443">libMesh::SparsityPattern::Build::parallel_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc]; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08c13836ca9040d9ebfd511549e4da94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08c13836ca9040d9ebfd511549e4da94">&#9670;&nbsp;</a></span>end_dof() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00644">644</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8h_source.html#l00738">local_index()</a>.</p>
<div class="fragment"><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">end_dof</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a08c13836ca9040d9ebfd511549e4da94"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00644">dof_map.h:644</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b14cac6dcf52d987a0fbc598edfe470"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b14cac6dcf52d987a0fbc598edfe470">&#9670;&nbsp;</a></span>end_old_dof() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_old_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The first old dof index that is after all indices local to processor <code>proc</code>.</dd></dl>
<p>Analogous to the <a class="el" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end()</a> member function of STL containers. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00664">664</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01672">_end_old_df</a>.</p>

<p class="reference">Referenced by <a class="el" href="system__projection_8C_source.html#l01075">libMesh::BuildProjectionList::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>[proc]; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01672">dof_map.h:1672</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98aac498dd6a690e8152c5f23d40e1c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98aac498dd6a690e8152c5f23d40e1c3">&#9670;&nbsp;</a></span>end_old_dof() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_old_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00667">667</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a98aac498dd6a690e8152c5f23d40e1c3">end_old_dof</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a98aac498dd6a690e8152c5f23d40e1c3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a98aac498dd6a690e8152c5f23d40e1c3">libMesh::DofMap::end_old_dof</a></div><div class="ttdeci">dof_id_type end_old_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00667">dof_map.h:667</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae37d0a3e61ea6274b3116bbeaa8ee02c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae37d0a3e61ea6274b3116bbeaa8ee02c">&#9670;&nbsp;</a></span>enforce_adjoint_constraints_exactly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::enforce_adjoint_constraints_exactly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Heterogenously constrains the numeric vector <code>v</code>, which represents an adjoint solution defined on the mesh for quantity fo interest <code>q</code>. For homogeneous constraints, use <code>enforce_constraints_exactly</code> instead </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02170">2170</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector&lt; T &gt;::close()</a>, <a class="el" href="numeric__vector_8h_source.html#l00165">libMesh::NumericVector&lt; T &gt;::closed()</a>, <a class="el" href="numeric__vector_8h_source.html#l00806">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="enum__parallel__type_8h_source.html#l00037">libMesh::GHOSTED</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector&lt; T &gt;::localize()</a>, <a class="el" href="enum__parallel__type_8h_source.html#l00036">libMesh::PARALLEL</a>, <a class="el" href="enum__parallel__type_8h_source.html#l00035">libMesh::SERIAL</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector&lt; T &gt;::set()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a>, and <a class="el" href="numeric__vector_8h_source.html#l00154">libMesh::NumericVector&lt; T &gt;::type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="implicit__system_8C_source.html#l00372">libMesh::ImplicitSystem::adjoint_solve()</a>, and <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;{</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  parallel_object_only();</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a376da0a998e9cbd79b82bda6582ecf94">n_constrained_dofs</a>())</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;enforce_adjoint_constraints_exactly()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_local  = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_global = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt; v_built;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">SERIAL</a>)</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    {</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>());</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      v_built-&gt;init(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1e989f4bcf03847736e84ff054e41111">n_dofs</a>(), this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2879bd4cc7db35e8d94ffd3355c143fd">n_local_dofs</a>(), <span class="keyword">true</span>, <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f">PARALLEL</a>);</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      v_built-&gt;close();</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i=v_built-&gt;first_local_index();</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;           i&lt;v_built-&gt;last_local_index(); i++)</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        v_built-&gt;set(i, v(i));</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      v_built-&gt;close();</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      v_global = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a0a56cd3b94566f25b4cf3e18a7440a08">get</a>();</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      v_local = &amp;v;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      libmesh_assert (v_local-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#aa5a7c59975d4092320edd574697b04d5">closed</a>());</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    }</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f">PARALLEL</a>)</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    {</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>());</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      v_built-&gt;init (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>(), v.<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>(), <span class="keyword">true</span>, <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">SERIAL</a>);</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      v.<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a>(*v_built);</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      v_built-&gt;close();</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      v_local = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a0a56cd3b94566f25b4cf3e18a7440a08">get</a>();</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      v_global = &amp;v;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    }</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa7ad89a14059d5c662d16a35675f8370d">GHOSTED</a>)</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    {</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      v_local = &amp;v;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      v_global = &amp;v;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    }</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// unknown v.type()</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Unknown v.type() == &quot;</span> &lt;&lt; v.<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>());</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="comment">// We should never hit these asserts because we should error-out in</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="comment">// else clause above.  Just to be sure we don&#39;t try to use v_local</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="comment">// and v_global uninitialized...</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  libmesh_assert(v_local);</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  libmesh_assert(v_global);</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="comment">// Do we have any non_homogeneous constraints?</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    adjoint_constraint_map_it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * constraint_map =</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    (adjoint_constraint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end()) ?</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keyword">nullptr</span> : &amp;adjoint_constraint_map_it-&gt;second;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    {</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_dof = pr.first;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(constrained_dof))</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> constraint_row = pr.second;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> exact_value = 0;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      <span class="keywordflow">if</span> (constraint_map)</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        {</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;          <span class="keyword">const</span> DofConstraintValueMap::const_iterator</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            adjoint_constraint_it =</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            constraint_map-&gt;find(constrained_dof);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;          <span class="keywordflow">if</span> (adjoint_constraint_it != constraint_map-&gt;end())</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            exact_value = adjoint_constraint_it-&gt;second;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        }</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : constraint_row)</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        exact_value += j.second * (*v_local)(j.first);</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">set</a>(constrained_dof, exact_value);</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    }</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  <span class="comment">// If the old vector was serial, we probably need to send our values</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  <span class="comment">// to other processors</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">SERIAL</a>)</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    {</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a> (v);</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    }</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  v.<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2879bd4cc7db35e8d94ffd3355c143fd"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2879bd4cc7db35e8d94ffd3355c143fd">libMesh::DofMap::n_local_dofs</a></div><div class="ttdeci">dof_id_type n_local_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00584">dof_map.h:584</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f"><div class="ttname"><a href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f">libMesh::PARALLEL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__parallel__type_8h_source.html#l00036">enum_parallel_type.h:36</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a0a56cd3b94566f25b4cf3e18a7440a08"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a0a56cd3b94566f25b4cf3e18a7440a08">libMesh::NumericVector::get</a></div><div class="ttdeci">virtual void get(const std::vector&lt; numeric_index_type &gt; &amp;index, T *values) const</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00806">numeric_vector.h:806</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a90f2918648bb3c65d88978bd5d0a19bf"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector::size</a></div><div class="ttdeci">virtual numeric_index_type size() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f"><div class="ttname"><a href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">libMesh::SERIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__parallel__type_8h_source.html#l00035">enum_parallel_type.h:35</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1e989f4bcf03847736e84ff054e41111"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1e989f4bcf03847736e84ff054e41111">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00574">dof_map.h:574</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2f87e215292aa3e352afd4f8f14c3d7fa7ad89a14059d5c662d16a35675f8370d"><div class="ttname"><a href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa7ad89a14059d5c662d16a35675f8370d">libMesh::GHOSTED</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__parallel__type_8h_source.html#l00037">enum_parallel_type.h:37</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a42ea91bba70b3e7b27dad2a636ad31ae"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adba4a30965537656bb3b0c6f924ff040"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">libMesh::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package())</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00048">numeric_vector.C:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00117">dof_map.h:117</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_aa5a7c59975d4092320edd574697b04d5"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#aa5a7c59975d4092320edd574697b04d5">libMesh::NumericVector::closed</a></div><div class="ttdeci">virtual bool closed() const</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00165">numeric_vector.h:165</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a204e65f06ed7c66291c04cd95dfe85e9"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00154">numeric_vector.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376da0a998e9cbd79b82bda6582ecf94"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376da0a998e9cbd79b82bda6582ecf94">libMesh::DofMap::n_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_constrained_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01172">dof_map_constraints.C:1172</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a083d7b5e0efa633986bcd2b38bc0b053"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector::set</a></div><div class="ttdeci">virtual void set(const numeric_index_type i, const T value)=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a7348b5b027adf716016354847e0df0b6"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector::localize</a></div><div class="ttdeci">virtual void localize(std::vector&lt; T &gt; &amp;v_local) const =0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa10a1b7c2c61c9b155d897fef566bebe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10a1b7c2c61c9b155d897fef566bebe">&#9670;&nbsp;</a></span>enforce_constraints_exactly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::enforce_constraints_exactly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>v</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constrains the numeric vector <code>v</code>, which represents a solution defined on the mesh. This may need to be used after a linear solve, if your linear solver's solutions do not satisfy your DoF constraints to a tight enough tolerance.</p>
<p>If <code>v</code> == nullptr, the system solution vector is constrained</p>
<p>If <code>homogeneous</code> == true, heterogeneous constraints are enforced as if they were homogeneous. This might be appropriate for e.g. a vector representing a difference between two heterogeneously-constrained solutions. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02077">2077</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector&lt; T &gt;::close()</a>, <a class="el" href="numeric__vector_8h_source.html#l00165">libMesh::NumericVector&lt; T &gt;::closed()</a>, <a class="el" href="numeric__vector_8h_source.html#l00806">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="system_8h_source.html#l02049">libMesh::System::get_dof_map()</a>, <a class="el" href="enum__parallel__type_8h_source.html#l00037">libMesh::GHOSTED</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector&lt; T &gt;::localize()</a>, <a class="el" href="enum__parallel__type_8h_source.html#l00036">libMesh::PARALLEL</a>, <a class="el" href="enum__parallel__type_8h_source.html#l00035">libMesh::SERIAL</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector&lt; T &gt;::set()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a>, <a class="el" href="system_8h_source.html#l01523">libMesh::System::solution</a>, and <a class="el" href="numeric__vector_8h_source.html#l00154">libMesh::NumericVector&lt; T &gt;::type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__diff__solver_8C_source.html#l00132">libMesh::__libmesh_petsc_diff_solver_jacobian()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00086">libMesh::__libmesh_petsc_diff_solver_residual()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00095">libMesh::Problem_Interface::computeF()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00153">libMesh::Problem_Interface::computeJacobian()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00215">libMesh::Problem_Interface::computePreconditioner()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00782">DMlibMeshFunction()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00852">DMlibMeshJacobian()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00288">libMesh::libmesh_petsc_snes_jacobian()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00425">libMesh::libmesh_petsc_snes_postcheck()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00064">libMesh::libmesh_petsc_snes_residual_helper()</a>, <a class="el" href="implicit__system_8C_source.html#l00314">libMesh::ImplicitSystem::sensitivity_solve()</a>, <a class="el" href="newton__solver_8C_source.html#l00282">libMesh::NewtonSolver::solve()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00300">libMesh::PetscDiffSolver::solve()</a>, <a class="el" href="implicit__system_8C_source.html#l00425">libMesh::ImplicitSystem::weighted_sensitivity_adjoint_solve()</a>, and <a class="el" href="implicit__system_8C_source.html#l00571">libMesh::ImplicitSystem::weighted_sensitivity_solve()</a>.</p>
<div class="fragment"><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;{</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  parallel_object_only();</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a376da0a998e9cbd79b82bda6582ecf94">n_constrained_dofs</a>())</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;enforce_constraints_exactly()&quot;</span>,<span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">if</span> (!v)</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    v = system.<a class="code" href="classlibMesh_1_1System.html#aa07e1093c49fa5f0877488d3351f4c86">solution</a>.get();</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_local  = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_global = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt; v_built;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">SERIAL</a>)</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    {</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>());</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      v_built-&gt;init(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1e989f4bcf03847736e84ff054e41111">n_dofs</a>(), this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2879bd4cc7db35e8d94ffd3355c143fd">n_local_dofs</a>(), <span class="keyword">true</span>, <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f">PARALLEL</a>);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      v_built-&gt;close();</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i=v_built-&gt;first_local_index();</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;           i&lt;v_built-&gt;last_local_index(); i++)</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        v_built-&gt;set(i, (*v)(i));</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      v_built-&gt;close();</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      v_global = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a0a56cd3b94566f25b4cf3e18a7440a08">get</a>();</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      v_local = v;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      libmesh_assert (v_local-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#aa5a7c59975d4092320edd574697b04d5">closed</a>());</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    }</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f">PARALLEL</a>)</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    {</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>());</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      v_built-&gt;init (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>(), v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>(), <span class="keyword">true</span>, <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">SERIAL</a>);</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a>(*v_built);</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      v_built-&gt;close();</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      v_local = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a0a56cd3b94566f25b4cf3e18a7440a08">get</a>();</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      v_global = v;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    }</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa7ad89a14059d5c662d16a35675f8370d">GHOSTED</a>)</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    {</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      v_local = v;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      v_global = v;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    }</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// unknown v-&gt;type()</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Unknown v-&gt;type() == &quot;</span> &lt;&lt; v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>());</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="comment">// We should never hit these asserts because we should error-out in</span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="comment">// else clause above.  Just to be sure we don&#39;t try to use v_local</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="comment">// and v_global uninitialized...</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  libmesh_assert(v_local);</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  libmesh_assert(v_global);</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  libmesh_assert_equal_to (<span class="keyword">this</span>, &amp;(system.<a class="code" href="classlibMesh_1_1System.html#ae7fa429ad93ac9a193ac287076588252">get_dof_map</a>()));</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    {</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_dof = pr.first;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(constrained_dof))</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> constraint_row = pr.second;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> exact_value = 0;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;      <span class="keywordflow">if</span> (!homogeneous)</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        {</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;          DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(constrained_dof);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;          <span class="keywordflow">if</span> (rhsit != <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            exact_value = rhsit-&gt;second;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        }</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : constraint_row)</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        exact_value += j.second * (*v_local)(j.first);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">set</a>(constrained_dof, exact_value);</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    }</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="comment">// If the old vector was serial, we probably need to send our values</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="comment">// to other processors</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">type</a>() == <a class="code" href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">SERIAL</a>)</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    {</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a> (*v);</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    }</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2879bd4cc7db35e8d94ffd3355c143fd"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2879bd4cc7db35e8d94ffd3355c143fd">libMesh::DofMap::n_local_dofs</a></div><div class="ttdeci">dof_id_type n_local_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00584">dof_map.h:584</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f"><div class="ttname"><a href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fadd57c032a7a8399fb39de740c7572b1f">libMesh::PARALLEL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__parallel__type_8h_source.html#l00036">enum_parallel_type.h:36</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a0a56cd3b94566f25b4cf3e18a7440a08"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a0a56cd3b94566f25b4cf3e18a7440a08">libMesh::NumericVector::get</a></div><div class="ttdeci">virtual void get(const std::vector&lt; numeric_index_type &gt; &amp;index, T *values) const</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00806">numeric_vector.h:806</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a90f2918648bb3c65d88978bd5d0a19bf"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector::size</a></div><div class="ttdeci">virtual numeric_index_type size() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f"><div class="ttname"><a href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa538bc63becff09f368e6f930e423391f">libMesh::SERIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__parallel__type_8h_source.html#l00035">enum_parallel_type.h:35</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1e989f4bcf03847736e84ff054e41111"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1e989f4bcf03847736e84ff054e41111">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00574">dof_map.h:574</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2f87e215292aa3e352afd4f8f14c3d7fa7ad89a14059d5c662d16a35675f8370d"><div class="ttname"><a href="namespacelibMesh.html#a2f87e215292aa3e352afd4f8f14c3d7fa7ad89a14059d5c662d16a35675f8370d">libMesh::GHOSTED</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__parallel__type_8h_source.html#l00037">enum_parallel_type.h:37</a></div></div>
<div class="ttc" id="classlibMesh_1_1System_html_aa07e1093c49fa5f0877488d3351f4c86"><div class="ttname"><a href="classlibMesh_1_1System.html#aa07e1093c49fa5f0877488d3351f4c86">libMesh::System::solution</a></div><div class="ttdeci">std::unique_ptr&lt; NumericVector&lt; Number &gt; &gt; solution</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l01523">system.h:1523</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a42ea91bba70b3e7b27dad2a636ad31ae"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adba4a30965537656bb3b0c6f924ff040"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">libMesh::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package())</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00048">numeric_vector.C:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_aa5a7c59975d4092320edd574697b04d5"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#aa5a7c59975d4092320edd574697b04d5">libMesh::NumericVector::closed</a></div><div class="ttdeci">virtual bool closed() const</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00165">numeric_vector.h:165</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a204e65f06ed7c66291c04cd95dfe85e9"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a204e65f06ed7c66291c04cd95dfe85e9">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00154">numeric_vector.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376da0a998e9cbd79b82bda6582ecf94"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376da0a998e9cbd79b82bda6582ecf94">libMesh::DofMap::n_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_constrained_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01172">dof_map_constraints.C:1172</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a083d7b5e0efa633986bcd2b38bc0b053"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector::set</a></div><div class="ttdeci">virtual void set(const numeric_index_type i, const T value)=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="classlibMesh_1_1System_html_ae7fa429ad93ac9a193ac287076588252"><div class="ttname"><a href="classlibMesh_1_1System.html#ae7fa429ad93ac9a193ac287076588252">libMesh::System::get_dof_map</a></div><div class="ttdeci">const DofMap &amp; get_dof_map() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l02049">system.h:2049</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a7348b5b027adf716016354847e0df0b6"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector::localize</a></div><div class="ttdeci">virtual void localize(std::vector&lt; T &gt; &amp;v_local) const =0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d2cbc2df5723e1616de1581e878ddf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d2cbc2df5723e1616de1581e878ddf0">&#9670;&nbsp;</a></span>extract_local_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::extract_local_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Ug</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVectorBase.html">DenseVectorBase</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Ue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Builds the local element vector <code>Ue</code> from the global vector <code>Ug</code>, accounting for any constrained degrees of freedom. For an element without constrained degrees of freedom this is the trivial mapping <img class="formulaInl" alt="$ Ue[i] = Ug[dof_indices[i]] $" src="form_56.png"/></p>
<dl class="section note"><dt>Note</dt><dd>The user must ensure that the element vector <code>Ue</code> is properly sized when calling this method. This is because there is no <code>resize()</code> method in the <code>DenseVectorBase&lt;&gt;</code> class. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01848">1848</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map__constraints_8C_source.html#l02456">build_constraint_matrix_and_vector()</a>, <a class="el" href="classlibMesh_1_1DenseVectorBase.html#a35567e09039c62b9914def1fd063a73c">libMesh::DenseVectorBase&lt; T &gt;::el()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">libMesh::NumericVector&lt; T &gt;::first_local_index()</a>, <a class="el" href="dof__map_8h_source.html#l01829">is_constrained_dof()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">libMesh::NumericVector&lt; T &gt;::last_local_index()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="classlibMesh_1_1DenseVectorBase.html#a4ec1ad50c02f01beea21df4c29ed9736">libMesh::DenseVectorBase&lt; T &gt;::size()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a>, and <a class="el" href="classlibMesh_1_1DenseVectorBase.html#a0c6c65a9c9b15317741c781903f45f83">libMesh::DenseVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;{</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_original_dofs = dof_indices_in.size();</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <span class="comment">// Trivial mapping</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  libmesh_assert_equal_to (dof_indices_in.size(), Ue.size());</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="keywordtype">bool</span> has_constrained_dofs = <span class="keyword">false</span>;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il != n_original_dofs; ++il)</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    {</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> ig = dof_indices_in[il];</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a> (ig)) has_constrained_dofs = <span class="keyword">true</span>;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      libmesh_assert_less (ig, Ug.<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>());</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      Ue.el(il) = Ug(ig);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="comment">// If the element has any constrained DOFs then we need</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="comment">// to account for them in the mapping.  This will handle</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <span class="comment">// the case that the input vector is not constrained.</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="keywordflow">if</span> (has_constrained_dofs)</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    {</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      <span class="comment">// Copy the input DOF indices.</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      std::vector&lt;dof_id_type&gt; constrained_dof_indices(dof_indices_in);</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      DenseMatrix&lt;Number&gt; C;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      DenseVector&lt;Number&gt; H;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">build_constraint_matrix_and_vector</a> (C, H, constrained_dof_indices);</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      libmesh_assert_equal_to (dof_indices_in.size(), C.m());</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      libmesh_assert_equal_to (constrained_dof_indices.size(), C.n());</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="comment">// zero-out Ue</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      Ue.zero();</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <span class="comment">// compute Ue = C Ug, with proper mapping.</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != n_original_dofs; i++)</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        {</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;          Ue.el(i) = H(i);</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_constrained =</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            cast_int&lt;unsigned int&gt;(constrained_dof_indices.size());</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_constrained; j++)</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            {</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> jg = constrained_dof_indices[j];</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;              <span class="comment">//          If Ug is a serial or ghosted vector, then this assert is</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;              <span class="comment">//          overzealous.  If Ug is a parallel vector, then this assert</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;              <span class="comment">//          is redundant.</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;              <span class="comment">//    libmesh_assert ((jg &gt;= Ug.first_local_index()) &amp;&amp;</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;              <span class="comment">//    (jg &lt;  Ug.last_local_index()));</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;              Ue.el(i) += C(i,j)*Ug(jg);</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            }</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        }</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    }</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="comment">// Trivial mapping</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  libmesh_assert_equal_to (n_original_dofs, Ue.size());</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il&lt;n_original_dofs; il++)</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    {</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> ig = dof_indices_in[il];</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      libmesh_assert ((ig &gt;= Ug.<a class="code" href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">first_local_index</a>()) &amp;&amp; (ig &lt;  Ug.<a class="code" href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">last_local_index</a>()));</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      Ue.el(il) = Ug(ig);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    }</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad7b5749fe8231535dfd67985c6a5858e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02456">dof_map_constraints.C:2456</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a90f2918648bb3c65d88978bd5d0a19bf"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector::size</a></div><div class="ttdeci">virtual numeric_index_type size() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adb02fab0dbedac070aa31d587732c7ba"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">libMesh::NumericVector::first_local_index</a></div><div class="ttdeci">virtual numeric_index_type first_local_index() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a18d730bed9ae74b3fb5edc8261d83a96"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">libMesh::NumericVector::last_local_index</a></div><div class="ttdeci">virtual numeric_index_type last_local_index() const =0</div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0c68d975715b184edae6544c29d5d25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0c68d975715b184edae6544c29d5d25">&#9670;&nbsp;</a></span>find_connected_dof_objects()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::find_connected_dof_objects </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; const <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *&gt; &amp;&#160;</td>
          <td class="paramname"><em>objs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finds all the DofObjects associated with the set in <code>objs</code>. This will account for off-element couplings via hanging nodes. </p>

</div>
</div>
<a id="a3f5f8f1f45829f6b6fd9895ea00753b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f5f8f1f45829f6b6fd9895ea00753b7">&#9670;&nbsp;</a></span>find_connected_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::find_connected_dofs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finds all the DOFS associated with the element DOFs elem_dofs. This will account for off-element couplings via hanging nodes. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02633">2633</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>, and <a class="el" href="dof__map_8h_source.html#l01829">is_constrained_dof()</a>.</p>

<p class="reference">Referenced by <a class="el" href="sparsity__pattern_8C_source.html#l00083">libMesh::SparsityPattern::Build::sorted_connected_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;{</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <span class="comment">// First insert the DOFS we already depend on into the set.</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  RCSet dof_set (elem_dofs.begin(), elem_dofs.end());</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  <span class="keywordtype">bool</span> done = <span class="keyword">true</span>;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  <span class="comment">// Next insert any dofs those might be constrained in terms</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  <span class="comment">// of.  Note that in this case we may not be done:  Those may</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  <span class="comment">// in turn depend on others.  So, we need to repeat this process</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  <span class="comment">// in that case until the system depends only on unconstrained</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;  <span class="comment">// degrees of freedom.</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(dof))</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      {</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        DofConstraints::const_iterator</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;          pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof);</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="comment">// adaptive p refinement currently gives us lots of empty constraint</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <span class="comment">// rows - we should optimize those DoFs away in the future.  [RHS]</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="comment">//libmesh_assert (!constraint_row.empty());</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <span class="comment">// Add the DOFs this dof is constrained in terms of.</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        <span class="comment">// note that these dofs might also be constrained, so</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        <span class="comment">// we will need to call this function recursively.</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : constraint_row)</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;          <span class="keywordflow">if</span> (!dof_set.count (pr.first))</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            {</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;              dof_set.insert (pr.first);</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;              done = <span class="keyword">false</span>;</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;            }</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      }</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="comment">// If not done then we need to do more work</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  <span class="comment">// (obviously :-) )!</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  <span class="keywordflow">if</span> (!done)</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    {</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <span class="comment">// Fill the vector with the contents of the set</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      elem_dofs.clear();</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      elem_dofs.insert (elem_dofs.end(),</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                        dof_set.begin(), dof_set.end());</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="comment">// May need to do this recursively.  It is possible</span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      <span class="comment">// that we just replaced a constrained DOF with another</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      <span class="comment">// constrained DOF.</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3f5f8f1f45829f6b6fd9895ea00753b7">find_connected_dofs</a> (elem_dofs);</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    } <span class="comment">// end if (!done)</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a3f5f8f1f45829f6b6fd9895ea00753b7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3f5f8f1f45829f6b6fd9895ea00753b7">libMesh::DofMap::find_connected_dofs</a></div><div class="ttdeci">void find_connected_dofs(std::vector&lt; dof_id_type &gt; &amp;elem_dofs) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02633">dof_map.C:2633</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c3382a9c9fd8c1b92812cec779dee24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c3382a9c9fd8c1b92812cec779dee24">&#9670;&nbsp;</a></span>first_dof() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The first dof index that is local to partition <code>proc</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00599">599</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01530">_first_df</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__dm__wrapper_8C_source.html#l00163">libMesh::PetscDMWrapper::build_sf()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00374">DMCreateDomainDecomposition_libMesh()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00267">DMCreateFieldDecomposition_libMesh()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00098">libMesh::SparsityPattern::Build::handle_vi_vj()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00341">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="system_8C_source.html#l01277">libMesh::System::local_dof_indices()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>, and <a class="el" href="sparsity__pattern_8C_source.html#l00443">libMesh::SparsityPattern::Build::parallel_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[proc]; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01530">dof_map.h:1530</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94601bbfdd0675c7259adebea917cd13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94601bbfdd0675c7259adebea917cd13">&#9670;&nbsp;</a></span>first_dof() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00602">602</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8h_source.html#l00738">local_index()</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">first_dof</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a94601bbfdd0675c7259adebea917cd13"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00602">dof_map.h:602</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3fb0c1467e6e44d65c1bc6a181718892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fb0c1467e6e44d65c1bc6a181718892">&#9670;&nbsp;</a></span>first_old_dof() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_old_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The first old dof index that is local to partition <code>proc</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00609">609</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01667">_first_old_df</a>.</p>

<p class="reference">Referenced by <a class="el" href="system__projection_8C_source.html#l01075">libMesh::BuildProjectionList::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>[proc]; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01667">dof_map.h:1667</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a230e63e9bae81249d8b20267a7bb9c2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a230e63e9bae81249d8b20267a7bb9c2b">&#9670;&nbsp;</a></span>first_old_dof() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_old_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00612">612</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a230e63e9bae81249d8b20267a7bb9c2b">first_old_dof</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a230e63e9bae81249d8b20267a7bb9c2b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a230e63e9bae81249d8b20267a7bb9c2b">libMesh::DofMap::first_old_dof</a></div><div class="ttdeci">dof_id_type first_old_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00612">dof_map.h:612</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ad8b64590135362f5ac09c581f828bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ad8b64590135362f5ac09c581f828bf">&#9670;&nbsp;</a></span>gather_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::gather_constraints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unexpanded_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>look_for_constrainees</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function for querying about constraint equations on other processors. If any id in <code>requested_dof_ids</code> is constrained on another processor, its constraint will be added on this processor as well. If <code>look_for_constrainees</code> is true, then constraints will also be returned if the id appears as a constraining value not just if it appears as a constrained value.</p>
<p>This function operates recursively: if the constraint for a constrained dof is newly added locally, then any other dofs which constrain it are queried to see if they are in turn constrained, and so on. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l03871">3871</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="variant__filter__iterator_8h_source.html#l00337">data</a>, <a class="el" href="parallel__sync_8h_source.html#l00472">libMesh::Parallel::pull_parallel_vector_data()</a>, and <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>.</p>
<div class="fragment"><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;{</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; DoF_RCSet;</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  <span class="comment">// If we have heterogenous adjoint constraints we need to</span></div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  <span class="comment">// communicate those too.</span></div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_qoi_num =</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.empty() ?</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;    0 : <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.rbegin()-&gt;first;</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;  <span class="comment">// We have to keep recursing while the unexpanded set is</span></div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;  <span class="comment">// nonempty on *any* processor</span></div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;  <span class="keywordtype">bool</span> unexpanded_set_nonempty = !unexpanded_dofs.empty();</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(unexpanded_set_nonempty);</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;  <span class="keywordflow">while</span> (unexpanded_set_nonempty)</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    {</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      <span class="comment">// Let&#39;s make sure we don&#39;t lose sync in this loop.</span></div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;      parallel_object_only();</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <span class="comment">// Request sets</span></div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      DoF_RCSet   dof_request_set;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;      <span class="comment">// Request sets to send to each processor</span></div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;        requested_dof_ids;</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      <span class="comment">// And the sizes of each</span></div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      std::map&lt;processor_id_type, dof_id_type&gt;</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        dof_ids_on_proc;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;      <span class="comment">// Fill (and thereby sort and uniq!) the main request sets</span></div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; unexpanded_dof : unexpanded_dofs)</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        {</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;          DofConstraints::const_iterator</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;            pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(unexpanded_dof);</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;          <span class="comment">// If we were asked for a DoF and we don&#39;t already have a</span></div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;          <span class="comment">// constraint for it, then we need to check for one.</span></div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;          <span class="keywordflow">if</span> (pos == <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end())</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;            {</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;              <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(unexpanded_dof) &amp;&amp;</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                  !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(unexpanded_dof) )</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                dof_request_set.insert(unexpanded_dof);</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;            }</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;          <span class="comment">// If we were asked for a DoF and we already have a</span></div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;          <span class="comment">// constraint for it, then we need to check if the</span></div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;          <span class="comment">// constraint is recursive.</span></div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;            {</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = pos-&gt;second;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;                {</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining_dof = j.first;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;                  <span class="comment">// If it&#39;s non-local and we haven&#39;t already got a</span></div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;                  <span class="comment">// constraint for it, we might need to ask for one</span></div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;                  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(constraining_dof) &amp;&amp;</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;                      !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(constraining_dof))</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                    dof_request_set.insert(constraining_dof);</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                }</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;            }</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;        }</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;      <span class="comment">// Clear the unexpanded constraint set; we&#39;re about to expand it</span></div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;      unexpanded_dofs.clear();</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;      <span class="comment">// Count requests by processor</span></div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;      <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc_id = 0;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : dof_request_set)</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;        {</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;          <span class="keywordflow">while</span> (i &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc_id])</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;            proc_id++;</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;          dof_ids_on_proc[proc_id]++;</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;        }</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : dof_ids_on_proc)</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;        {</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;          requested_dof_ids[pair.first].reserve(pair.second);</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;        }</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;      <span class="comment">// Prepare each processor&#39;s request set</span></div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      proc_id = 0;</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : dof_request_set)</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;        {</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;          <span class="keywordflow">while</span> (i &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc_id])</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;            proc_id++;</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;          requested_dof_ids[proc_id].push_back(i);</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;        }</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;      <span class="keyword">typedef</span> std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt; row_datum;</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      <span class="keyword">typedef</span> std::vector&lt;Number&gt; rhss_datum;</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      <span class="keyword">auto</span> row_gather_functor =</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        [<span class="keyword">this</span>]</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;         std::vector&lt;row_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;        {</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;          <span class="comment">// Fill those requests</span></div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;          <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>.resize(query_size);</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;            {</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(constrained))</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;                {</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                  std::size_t row_size = row.size();</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                  <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].reserve(row_size);</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;                    {</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                      <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].push_back(j);</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                      <span class="comment">// We should never have an invalid constraining</span></div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                      <span class="comment">// dof id</span></div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                      libmesh_assert(j.first != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;                      <span class="comment">// We should never have a 0 constraint</span></div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;                      <span class="comment">// coefficient; that&#39;s implicit via sparse</span></div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;                      <span class="comment">// constraint storage</span></div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;                      <span class="comment">//</span></div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;                      <span class="comment">// But we can&#39;t easily control how users add</span></div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;                      <span class="comment">// constraints, so we can&#39;t safely assert that</span></div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;                      <span class="comment">// we&#39;re being efficient here.</span></div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;                      <span class="comment">//</span></div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;                      <span class="comment">// libmesh_assert(j.second);</span></div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;                    }</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;                }</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                {</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;                  <span class="comment">// We have to distinguish &quot;constraint with no</span></div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                  <span class="comment">// constraining dofs&quot; (e.g. due to Dirichlet</span></div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                  <span class="comment">// constraint equations) from &quot;no constraint&quot;.</span></div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                  <span class="comment">// We&#39;ll use invalid_id for the latter.</span></div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;                  <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].push_back</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;                    (std::make_pair(<a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>, <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>(0)));</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;                }</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;            }</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;        };</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      <span class="keyword">auto</span> rhss_gather_functor =</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        [<span class="keyword">this</span>,</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;         max_qoi_num]</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;         std::vector&lt;rhss_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        {</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;          <span class="comment">// Fill those requests</span></div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;          <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>.resize(query_size);</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;            {</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;              <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].clear();</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(constrained))</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                {</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;                  DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(constrained);</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;                  <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].push_back</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;                    ((rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;                     0 : rhsit-&gt;second);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;                    {</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;                      AdjointDofConstraintValues::const_iterator adjoint_map_it =</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;                        <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;                      <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;                        {</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;                          <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].push_back(0);</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;                        }</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                        adjoint_map_it-&gt;second;</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                      DofConstraintValueMap::const_iterator adj_rhsit =</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                        constraint_map.find(constrained);</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                      <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].push_back</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                        ((adj_rhsit == constraint_map.end()) ?</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;                         0 : adj_rhsit-&gt;second);</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;                    }</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;                }</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;            }</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;        };</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;      <span class="keyword">auto</span> row_action_functor =</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;        [<span class="keyword">this</span>,</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;         &amp; unexpanded_dofs]</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;         <span class="keyword">const</span> std::vector&lt;row_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;        {</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;          <span class="comment">// Add any new constraint rows we&#39;ve found</span></div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;            {</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;              <span class="comment">// An empty row is an constraint with an empty row; for</span></div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;              <span class="comment">// no constraint we use a &quot;no row&quot; placeholder</span></div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].empty())</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                {</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;                  row.clear();</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                }</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][0].first != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;                {</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;                  row.clear();</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i])</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;                    row[pair.first] = pair.second;</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;                  <span class="comment">// And prepare to check for more recursive constraints</span></div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                  unexpanded_dofs.insert(constrained);</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                }</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;            }</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;        };</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;      <span class="keyword">auto</span> rhss_action_functor =</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;        [<span class="keyword">this</span>,</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;         max_qoi_num]</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;        (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;         <span class="keyword">const</span> std::vector&lt;rhss_datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;        {</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;          <span class="comment">// Add rhs data for any new constraint rows we&#39;ve found</span></div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;            {</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i].empty())</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;                {</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;                  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][0] != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[constrained] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][0];</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(constrained);</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;                    {</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;                      AdjointDofConstraintValues::iterator adjoint_map_it =</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;                        <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;                      <span class="keywordflow">if</span> ((adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end()) &amp;&amp;</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;                          <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][q+1] == <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;                      <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                        adjoint_map_it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.insert</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;                          (std::make_pair(q,<a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a>())).first;</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;                      <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                        adjoint_map_it-&gt;second;</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][q+1] != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                        constraint_map[constrained] =</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                          <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][q+1];</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                      <span class="keywordflow">else</span></div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;                        constraint_map.erase(constrained);</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;                    }</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;                }</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;            }</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;        };</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;      <span class="comment">// Now request constraint rows from other processors</span></div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;      row_datum * row_ex = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;      <a class="code" href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">Parallel::pull_parallel_vector_data</a></div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;        (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), requested_dof_ids, row_gather_functor,</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;         row_action_functor, row_ex);</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;      <span class="comment">// And request constraint right hand sides from other procesors</span></div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;      rhss_datum * rhs_ex = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;      <a class="code" href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">Parallel::pull_parallel_vector_data</a></div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;        (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), requested_dof_ids, rhss_gather_functor,</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;         rhss_action_functor, rhs_ex);</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;      <span class="comment">// We have to keep recursing while the unexpanded set is</span></div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;      <span class="comment">// nonempty on *any* processor</span></div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;      unexpanded_set_nonempty = !unexpanded_dofs.empty();</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(unexpanded_set_nonempty);</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    }</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a21797734483c801c09fa26822455d989"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">libMesh::Parallel::pull_parallel_vector_data</a></div><div class="ttdeci">void pull_parallel_vector_data(const Communicator &amp;comm, const MapToVectors &amp;queries, RequestContainer &amp;reqs, GatherFunctor &amp;gather_data, ActionFunctor &amp;act_on_data, const datum *example)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__sync_8h_source.html#l00472">parallel_sync.h:472</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00117">dof_map.h:117</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a3464f722394258d66e04720e221f07ff"><div class="ttname"><a href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a></div><div class="ttdeci">IterBase * data</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00337">variant_filter_iterator.h:337</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b769c65fb3e949cd627fa4502b36bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b769c65fb3e949cd627fa4502b36bc0">&#9670;&nbsp;</a></span>get_adjoint_dirichlet_boundaries() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> * libMesh::DofMap::get_adjoint_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04302">4302</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;{</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;  libmesh_assert_greater(<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.size(),q);</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[q];</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8e870d5119711e35e9aecf9b487a4ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8e870d5119711e35e9aecf9b487a4ee">&#9670;&nbsp;</a></span>get_adjoint_dirichlet_boundaries() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> * libMesh::DofMap::get_adjoint_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04310">4310</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;{</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size = cast_int&lt;unsigned int&gt;</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    (<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.size());</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = old_size; i &lt;= q; ++i)</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.push_back(<span class="keyword">new</span> <a class="code" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>());</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[q];</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DirichletBoundaries_html"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundaries.html">libMesh::DirichletBoundaries</a></div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00194">dirichlet_boundaries.h:194</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a18524baa4b783871c63439ba69cb7430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18524baa4b783871c63439ba69cb7430">&#9670;&nbsp;</a></span>get_dirichlet_boundaries() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>* libMesh::DofMap::get_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01223">1223</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01721">_dirichlet_boundaries</a>.</p>

<p class="reference">Referenced by <a class="el" href="diff__system_8C_source.html#l00227">libMesh::DifferentiableSystem::add_dot_var_dirichlet_bcs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  {</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>.get();</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01721">dof_map.h:1721</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae079c07a133ed49ebf98cefbf348c197"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae079c07a133ed49ebf98cefbf348c197">&#9670;&nbsp;</a></span>get_dirichlet_boundaries() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>* libMesh::DofMap::get_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01228">1228</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01721">_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  {</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>.get();</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01721">dof_map.h:1721</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a103b37125ae9eaaadf6f7854df17faa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a103b37125ae9eaaadf6f7854df17faa2">&#9670;&nbsp;</a></span>get_info() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::ReferenceCounter::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gets a string containing the reference information. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8C_source.html#l00047">47</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p class="reference">References <a class="el" href="reference__counter_8h_source.html#l00122">libMesh::ReferenceCounter::_counts</a>, and <a class="el" href="elem__quality_8C_source.html#l00042">libMesh::Quality::name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="reference__counter_8C_source.html#l00087">libMesh::ReferenceCounter::print_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#if defined(LIBMESH_ENABLE_REFERENCE_COUNTING) &amp;&amp; defined(DEBUG)</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  std::ostringstream oss;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  oss &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;| Reference count information                                                |\n&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keyword">const</span> std::string <a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>(pr.first);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> creations    = pr.second.first;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> destructions = pr.second.second;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      oss &lt;&lt; <span class="stringliteral">&quot;| &quot;</span> &lt;&lt; <a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a> &lt;&lt; <span class="stringliteral">&quot; reference count information:\n&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;|  Creations:    &quot;</span> &lt;&lt; creations    &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;|  Destructions: &quot;</span> &lt;&lt; destructions &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  oss &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">return</span> oss.str();</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div><div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00042">elem_quality.C:42</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00122">reference_counter.h:122</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1a7473e230bd8db0b8196e92417f766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1a7473e230bd8db0b8196e92417f766">&#9670;&nbsp;</a></span>get_info() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::DofMap::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets summary info about the sparsity bandwidth and constraints. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02703">2703</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01525">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01638">_n_nz</a>, <a class="el" href="dof__map_8h_source.html#l01644">_n_oz</a>, <a class="el" href="dof__map_8h_source.html#l01698">_node_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01689">_primal_constraint_values</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="dof__map_8h_source.html#l00738">local_index()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="type__vector_8h_source.html#l00901">libMesh::TypeVector&lt; T &gt;::size()</a>, and <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">libMesh::Parallel::Communicator::sum()</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_8C_source.html#l01658">libMesh::System::get_info()</a>, and <a class="el" href="dof__map_8C_source.html#l02696">print_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;{</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;  std::ostringstream os;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  <span class="comment">// If we didn&#39;t calculate the exact sparsity pattern, the threaded</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  <span class="comment">// sparsity pattern assembly may have just given us an upper bound</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;  <span class="comment">// on sparsity.</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> * may_equal = <span class="stringliteral">&quot; &lt;= &quot;</span>;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="comment">// If we calculated the exact sparsity pattern, then we can report</span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  <span class="comment">// exact bandwidth figures:</span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; mat : <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>)</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordflow">if</span> (mat-&gt;need_full_sparsity_pattern())</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      may_equal = <span class="stringliteral">&quot; = &quot;</span>;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> max_n_nz = 0, max_n_oz = 0;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> avg_n_nz = 0, avg_n_oz = 0;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>)</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    {</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; val : *<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>)</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        {</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;          max_n_nz = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(max_n_nz, val);</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;          avg_n_nz += val;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        }</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      std::size_t n_nz_size = <a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>-&gt;size();</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(max_n_nz);</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(avg_n_nz);</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(n_nz_size);</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      avg_n_nz /= <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(n_nz_size,std::size_t(1));</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>);</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; val : *<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>)</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        {</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;          max_n_oz = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(max_n_oz, val);</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;          avg_n_oz += val;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        }</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      std::size_t n_oz_size = <a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>-&gt;size();</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(max_n_oz);</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(avg_n_oz);</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(n_oz_size);</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      avg_n_oz /= <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(n_oz_size,std::size_t(1));</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    }</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;    DofMap Sparsity\n      Average  On-Processor Bandwidth&quot;</span></div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;     &lt;&lt; may_equal &lt;&lt; avg_n_nz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;      Average Off-Processor Bandwidth&quot;</span></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;     &lt;&lt; may_equal &lt;&lt; avg_n_oz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;      Maximum  On-Processor Bandwidth&quot;</span></div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;     &lt;&lt; may_equal &lt;&lt; max_n_nz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;      Maximum Off-Processor Bandwidth&quot;</span></div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;     &lt;&lt; may_equal &lt;&lt; max_n_oz &lt;&lt; std::endl;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  std::size_t n_constraints = 0, max_constraint_length = 0,</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    n_rhss = 0;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> avg_constraint_length = 0.;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    {</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      <span class="comment">// Only count local constraints, then sum later</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_dof = pr.first;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(constrained_dof))</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = pr.second;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      std::size_t rowsize = row.size();</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      max_constraint_length = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(max_constraint_length,</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                                       rowsize);</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      avg_constraint_length += rowsize;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      n_constraints++;</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.count(constrained_dof))</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        n_rhss++;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    }</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(n_constraints);</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(n_rhss);</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(avg_constraint_length);</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(max_constraint_length);</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;    DofMap Constraints\n      Number of DoF Constraints = &quot;</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;     &lt;&lt; n_constraints;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;  <span class="keywordflow">if</span> (n_rhss)</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;      Number of Heterogenous Constraints= &quot;</span> &lt;&lt; n_rhss;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;  <span class="keywordflow">if</span> (n_constraints)</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    {</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      avg_constraint_length /= n_constraints;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;      Average DoF Constraint Length= &quot;</span> &lt;&lt; avg_constraint_length;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  std::size_t n_node_constraints = 0, max_node_constraint_length = 0,</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    n_node_rhss = 0;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> avg_node_constraint_length = 0.;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <span class="comment">// Only count local constraints, then sum later</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      <span class="keyword">const</span> Node * node = pr.first;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      <span class="keywordflow">if</span> (node-&gt;processor_id() != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = pr.second.first;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      std::size_t rowsize = row.size();</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      max_node_constraint_length = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(max_node_constraint_length,</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                                            rowsize);</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      avg_node_constraint_length += rowsize;</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      n_node_constraints++;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="keywordflow">if</span> (pr.second.second != Point(0))</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        n_node_rhss++;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    }</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(n_node_constraints);</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(n_node_rhss);</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(avg_node_constraint_length);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(max_node_constraint_length);</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n      Number of Node Constraints = &quot;</span> &lt;&lt; n_node_constraints;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <span class="keywordflow">if</span> (n_node_rhss)</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;      Number of Heterogenous Node Constraints= &quot;</span> &lt;&lt; n_node_rhss;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  <span class="keywordflow">if</span> (n_node_constraints)</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    {</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      avg_node_constraint_length /= n_node_constraints;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\n      Maximum Node Constraint Length= &quot;</span> &lt;&lt; max_node_constraint_length</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;         &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;      Average Node Constraint Length= &quot;</span> &lt;&lt; avg_node_constraint_length;</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    }</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  os &lt;&lt; std::endl;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_CONSTRAINTS</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <span class="keywordflow">return</span> os.str();</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a15dc47f3b7fdd20f9ec062de8e842561"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">libMesh::DofMap::_n_nz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_nz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01638">dof_map.h:1638</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a446ebcd42da6b4edbe58238cb4c12b7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">libMesh::DofMap::_n_oz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_oz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01644">dof_map.h:1644</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3f8b3675d745f7d586e93158aa951174"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">libMesh::Parallel::Communicator::sum</a></div><div class="ttdeci">void sum(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; *&gt; _matrices</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01525">dof_map.h:1525</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00145">dof_map.h:145</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af00f24f96d87b453b8c8233f5a828d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af00f24f96d87b453b8c8233f5a828d60">&#9670;&nbsp;</a></span>get_local_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::DofMap::get_local_constraints </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>print_nonlocal</em> = <code>false</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets a string reporting all DoF and <a class="el" href="classlibMesh_1_1Node.html" title="A geometric point in (x,y,z) space associated with a DOF. ">Node</a> constraints local to this processor. If <code>print_nonlocal</code> is true, then nonlocal constraints which are locally known are included. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01444">1444</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, and <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;{</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  std::ostringstream os;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keywordflow">if</span> (print_nonlocal)</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;All &quot;</span>;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Local &quot;</span>;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Node Constraints:&quot;</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;     &lt;&lt; std::endl;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * node = pr.first;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <span class="comment">// Skip non-local nodes if requested</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="keywordflow">if</span> (!print_nonlocal &amp;&amp;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = pr.second.first;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Point.html">Point</a> &amp; offset = pr.second.second;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Constraints for Node id &quot;</span> &lt;&lt; node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">id</a>()</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;: \t&quot;</span>;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : row)</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; item.first-&gt;id() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; item.second &lt;&lt; <span class="stringliteral">&quot;)\t&quot;</span>;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;rhs: &quot;</span> &lt;&lt; offset;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      os &lt;&lt; std::endl;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordflow">if</span> (print_nonlocal)</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;All &quot;</span>;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Local &quot;</span>;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;DoF Constraints:&quot;</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;     &lt;&lt; std::endl;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    {</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i = pr.first;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="comment">// Skip non-local dofs if requested</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="keywordflow">if</span> (!print_nonlocal &amp;&amp; !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(i))</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = pr.second;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(i);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> rhs = (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        0 : rhsit-&gt;second;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Constraints for DoF &quot;</span> &lt;&lt; i</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;: \t&quot;</span>;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : row)</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; item.first &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; item.second &lt;&lt; <span class="stringliteral">&quot;)\t&quot;</span>;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;rhs: &quot;</span> &lt;&lt; rhs;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      os &lt;&lt; std::endl;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    }</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qoi_index = 0,</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;       n_qois = cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.size());</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;       qoi_index != n_qois; ++qoi_index)</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    {</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Adjoint &quot;</span> &lt;&lt; qoi_index &lt;&lt; <span class="stringliteral">&quot; DoF rhs values:&quot;</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;         &lt;&lt; std::endl;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      AdjointDofConstraintValues::const_iterator adjoint_map_it =</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordflow">if</span> (adjoint_map_it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : adjoint_map_it-&gt;second)</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;          {</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i = pr.first;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <span class="comment">// Skip non-local dofs if requested</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="keywordflow">if</span> (!print_nonlocal &amp;&amp; !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(i))</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> rhs = pr.second;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot;RHS for DoF &quot;</span> &lt;&lt; i</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; rhs;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            os &lt;&lt; std::endl;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;          }</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">return</span> os.str();</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Node_html"><div class="ttname"><a href="classlibMesh_1_1Node.html">libMesh::Node</a></div><div class="ttdoc">A geometric point in (x,y,z) space associated with a DOF. </div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00052">node.h:52</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_ab95f1d0641d5b5591a97e1a11b57164d"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">libMesh::DofObject::id</a></div><div class="ttdeci">dof_id_type id() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00655">dof_object.h:655</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00145">dof_map.h:145</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a754f2866ec9d8a49a02a68a32e7aa518"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">libMesh::DofObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00717">dof_object.h:717</a></div></div>
<div class="ttc" id="classlibMesh_1_1Point_html"><div class="ttname"><a href="classlibMesh_1_1Point.html">libMesh::Point</a></div><div class="ttdoc">A geometric point in (x,y,z) space. </div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00038">point.h:38</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af18504bfd61cccfba4878a656b428e4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af18504bfd61cccfba4878a656b428e4a">&#9670;&nbsp;</a></span>get_n_nz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;&amp; libMesh::DofMap::get_n_nz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A constant reference to the <code>_n_nz</code> list for this processor.</dd></dl>
<p>The vector contains the bandwidth of the on-processor coupling for each row of the global matrix that the current processor owns. This information can be used to preallocate space for a parallel sparse matrix. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00459">459</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01638">_n_nz</a>.</p>
<div class="fragment"><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> *<a class="code" href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">_n_nz</a>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a15dc47f3b7fdd20f9ec062de8e842561"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a15dc47f3b7fdd20f9ec062de8e842561">libMesh::DofMap::_n_nz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_nz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01638">dof_map.h:1638</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8691c98219d905b8525a7dc5106f973c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8691c98219d905b8525a7dc5106f973c">&#9670;&nbsp;</a></span>get_n_oz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;&amp; libMesh::DofMap::get_n_oz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A constant reference to the <code>_n_oz</code> list for this processor.</dd></dl>
<p>The vector contains the bandwidth of the off-processor coupling for each row of the global matrix that the current processor owns. This information can be used to preallocate space for a parallel sparse matrix. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00472">472</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01644">_n_oz</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">return</span> *<a class="code" href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">_n_oz</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a446ebcd42da6b4edbe58238cb4c12b7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a446ebcd42da6b4edbe58238cb4c12b7c">libMesh::DofMap::_n_oz</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; * _n_oz</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01644">dof_map.h:1644</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8fbe12a80566efce1259ea93601dc2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8fbe12a80566efce1259ea93601dc2a">&#9670;&nbsp;</a></span>get_periodic_boundaries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a>* libMesh::DofMap::get_periodic_boundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01185">1185</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01707">_periodic_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>.get();</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01707">dof_map.h:1707</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b140935368fe85cf0ead6d5a0452c0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b140935368fe85cf0ead6d5a0452c0b">&#9670;&nbsp;</a></span>get_primal_constraint_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; libMesh::DofMap::get_primal_constraint_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A reference to the set of right-hand-side values in primal constraint equations </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01874">1874</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01689">_primal_constraint_values</a>.</p>
<div class="fragment"><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;{</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2b8f0990aae87c873d050e33792fe28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b8f0990aae87c873d050e33792fe28">&#9670;&nbsp;</a></span>get_send_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;&amp; libMesh::DofMap::get_send_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A constant reference to the <code>_send_list</code> for this processor.</dd></dl>
<p>The <code>_send_list</code> contains the global indices of all the variables in the global solution vector that influence the current processor. This information can be used for gathers at each solution step to retrieve solution values needed for computation. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00450">450</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01547">_send_list</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="unsteady__solver_8C_source.html#l00178">libMesh::UnsteadySolver::adjoint_advance_timestep()</a>, <a class="el" href="newmark__solver_8C_source.html#l00043">libMesh::NewmarkSolver::advance_timestep()</a>, <a class="el" href="unsteady__solver_8C_source.html#l00152">libMesh::UnsteadySolver::advance_timestep()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00163">libMesh::PetscDMWrapper::build_sf()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>, <a class="el" href="second__order__unsteady__solver_8C_source.html#l00042">libMesh::SecondOrderUnsteadySolver::init_data()</a>, <a class="el" href="unsteady__solver_8C_source.html#l00055">libMesh::UnsteadySolver::init_data()</a>, <a class="el" href="system_8C_source.html#l00429">libMesh::System::re_update()</a>, <a class="el" href="second__order__unsteady__solver_8C_source.html#l00060">libMesh::SecondOrderUnsteadySolver::reinit()</a>, <a class="el" href="unsteady__solver_8C_source.html#l00070">libMesh::UnsteadySolver::reinit()</a>, and <a class="el" href="unsteady__solver_8C_source.html#l00204">libMesh::UnsteadySolver::retrieve_timestep()</a>.</p>
<div class="fragment"><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab45010302963c18b5a31a32079f883a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab45010302963c18b5a31a32079f883a9">&#9670;&nbsp;</a></span>has_adjoint_dirichlet_boundaries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::has_adjoint_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04292">4292</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>, and <a class="el" href="implicit__system_8C_source.html#l00425">libMesh::ImplicitSystem::weighted_sensitivity_adjoint_solve()</a>.</p>
<div class="fragment"><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;{</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.size() &gt; q)</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe1b4047e5c1f2c0503d06e364173321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe1b4047e5c1f2c0503d06e364173321">&#9670;&nbsp;</a></span>has_blocked_representation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::has_blocked_representation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the variables are capable of being stored in a blocked form. Presently, this means that there can only be one variable group, and that the group has more than one variable. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00549">549</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, and <a class="el" href="dof__map_8h_source.html#l00541">n_variables()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00562">block_size()</a>.</p>
<div class="fragment"><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_BLOCKED_STORAGE</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">return</span> ((this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>() == 1) &amp;&amp; (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>() &gt; 1));</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a25b3182cbf57ead72821d826275512b0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00541">dof_map.h:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a568e5b1ec17eebb82ac45d537e375d2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a568e5b1ec17eebb82ac45d537e375d2c">&#9670;&nbsp;</a></span>has_heterogenous_adjoint_constraint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> libMesh::DofMap::has_heterogenous_adjoint_constraint </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The heterogeneous constraint value if the degree of freedom <code>dof</code> has a heterogenous constraint for adjoint solution <code>qoi_num</code>, zero otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01853">1853</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01691">_adjoint_constraint_values</a>.</p>
<div class="fragment"><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;{</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  AdjointDofConstraintValues::const_iterator it =</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_num);</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    {</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        it-&gt;second.find(dof);</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">if</span> (rhsit == it-&gt;second.end())</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">return</span> rhsit-&gt;second;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    }</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87c8a1c7e7552562359b4123efc58e14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87c8a1c7e7552562359b4123efc58e14">&#9670;&nbsp;</a></span>has_heterogenous_adjoint_constraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::has_heterogenous_adjoint_constraints </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_num</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the system has any heterogenous constraints for adjoint solution <code>qoi_num</code>, <code>false</code> otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01839">1839</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01691">_adjoint_constraint_values</a>.</p>
<div class="fragment"><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;{</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  AdjointDofConstraintValues::const_iterator it =</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_num);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="keywordflow">if</span> (it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordflow">if</span> (it-&gt;second.empty())</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5683e8943240f69888e3212bfb6533a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5683e8943240f69888e3212bfb6533a">&#9670;&nbsp;</a></span>heterogenously_constrain_element_matrix_and_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogenously_constrain_element_matrix_and_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constrains the element matrix and vector. This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order.</p>
<p>The heterogenous version of this method creates linear systems in which heterogenously constrained degrees of freedom will solve to their correct offset values, as would be appropriate for finding a solution to a linear problem in a single algebraic solve. The non-heterogenous version of this method creates linear systems in which even heterogenously constrained degrees of freedom are solved without offset values taken into account, as would be appropriate for finding linearized updates to a solution in which heterogenous constraints are already satisfied.</p>
<p>By default, the constraints for the primal solution of this system are used. If a non-negative <code>qoi_index</code> is passed in, then the constraints for the corresponding adjoint solution are used instead. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01694">1694</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="xdr__io_8C_source.html#l00049">dof_id</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00088">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00213">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>, <a class="el" href="dense__vector_8h_source.html#l00092">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00385">libMesh::DenseMatrix&lt; T &gt;::vector_mult()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00441">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;{</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>());</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>());</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T (F - K H)</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> H;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">build_constraint_matrix_and_vector</a> (C, H, elem_dofs, qoi_index);</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;hetero_cnstrn_elem_mat_vec()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>()) &amp;&amp;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    {</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="comment">// We may have rhs values to use later</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * rhs_values = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keywordflow">if</span> (qoi_index &lt; 0)</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        rhs_values = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;          <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;          <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            rhs_values = &amp;it-&gt;second;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        }</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      <span class="comment">// Compute matrix/vector product K H</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> KH;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a741afad2f7dca9e80a682384d5fcfde3">vector_mult</a>(KH, H);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      <span class="comment">// Compute the matrix-vector product C^T (F - KH)</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> F_minus_KH(rhs);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      F_minus_KH -= KH;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">vector_mult_transpose</a>(rhs, F_minus_KH);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="comment">// Compute the matrix-matrix-matrix product C^T K C</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (C);</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">right_multiply</a> (C);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), elem_dofs.size());</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(), elem_dofs.size());</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;           i != n_elem_dofs; i++)</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        {</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> <a class="code" href="xdr__io_8C.html#ab293a42ba7d22209a1801dd76b47aad6">dof_id</a> = elem_dofs[i];</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(dof_id))</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;            {</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(); j++)</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                matrix(i,j) = 0.;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;              <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;              matrix(i,i) = 1.;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;              <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;              <span class="comment">// row to ensure that the linear system produces the</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;              <span class="comment">// correct value for the constrained DOF.</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;              <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                {</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                  DofConstraints::const_iterator</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                    pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(<a class="code" href="xdr__io_8C.html#ab293a42ba7d22209a1801dd76b47aad6">dof_id</a>);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                  libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != n_elem_dofs; j++)</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                      <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                        matrix(i,j) = -item.second;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                  <span class="keywordflow">if</span> (rhs_values)</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                    {</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                      <span class="keyword">const</span> DofConstraintValueMap::const_iterator valpos =</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                        rhs_values-&gt;find(<a class="code" href="xdr__io_8C.html#ab293a42ba7d22209a1801dd76b47aad6">dof_id</a>);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                      rhs(i) = (valpos == rhs_values-&gt;end()) ?</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                        0 : valpos-&gt;second;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                    }</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                }</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                rhs(i) = 0.;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        }</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    } <span class="comment">// end if is constrained...</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseVector_html_a70f094c13f827ea1d9b384bb0aea785a"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const override</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00092">dense_vector.h:92</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad7b5749fe8231535dfd67985c6a5858e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02456">dof_map_constraints.C:2456</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="xdr__io_8C_html_ab293a42ba7d22209a1801dd76b47aad6"><div class="ttname"><a href="xdr__io_8C.html#ab293a42ba7d22209a1801dd76b47aad6">dof_id</a></div><div class="ttdeci">dof_id_type dof_id</div><div class="ttdef"><b>Definition:</b> <a href="xdr__io_8C_source.html#l00049">xdr_io.C:49</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aa61db76abed0e9d72220bd73b16f9d62"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00441">dense_matrix_impl.h:441</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a711bdbc0ff2222b7e609e760ef903930"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a711bdbc0ff2222b7e609e760ef903930">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) override</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00213">dense_matrix_impl.h:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00117">dof_map.h:117</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00088">dense_matrix_impl.h:88</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a741afad2f7dca9e80a682384d5fcfde3"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a741afad2f7dca9e80a682384d5fcfde3">libMesh::DenseMatrix::vector_mult</a></div><div class="ttdeci">void vector_mult(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00385">dense_matrix_impl.h:385</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aad15780d510bc235a3d71def13bb438d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad15780d510bc235a3d71def13bb438d">&#9670;&nbsp;</a></span>heterogenously_constrain_element_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogenously_constrain_element_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constrains the element vector. This method requires the element matrix to be square and not-yet-constrained, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix.</p>
<p>The heterogenous version of this method creates linear systems in which heterogenously constrained degrees of freedom will solve to their correct offset values, as would be appropriate for finding a solution to a linear problem in a single algebraic solve. The non-heterogenous version of this method creates linear systems in which even heterogenously constrained degrees of freedom are solved without offset values taken into account, as would be appropriate for finding linearized updates to a solution in which heterogenous constraints are already satisfied.</p>
<p>By default, the constraints for the primal solution of this system are used. If a non-negative <code>qoi_index</code> is passed in, then the constraints for the corresponding adjoint solution are used instead. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01800">1800</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="xdr__io_8C_source.html#l00049">dof_id</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00092">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00385">libMesh::DenseMatrix&lt; T &gt;::vector_mult()</a>, and <a class="el" href="dense__matrix__impl_8h_source.html#l00441">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;{</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>());</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>());</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">size</a>());</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="comment">// check for easy return</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T (F - K H)</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> H;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">build_constraint_matrix_and_vector</a> (C, H, elem_dofs, qoi_index);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;hetero_cnstrn_elem_vec()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>()) &amp;&amp;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    {</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="comment">// We may have rhs values to use later</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * rhs_values = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      <span class="keywordflow">if</span> (qoi_index &lt; 0)</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        rhs_values = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        {</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;          <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;          <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            rhs_values = &amp;it-&gt;second;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        }</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="comment">// Compute matrix/vector product K H</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> KH;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a741afad2f7dca9e80a682384d5fcfde3">vector_mult</a>(KH, H);</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <span class="comment">// Compute the matrix-vector product C^T (F - KH)</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> F_minus_KH(rhs);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      F_minus_KH -= KH;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">vector_mult_transpose</a>(rhs, F_minus_KH);</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;           i != n_elem_dofs; i++)</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        {</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> <a class="code" href="xdr__io_8C.html#ab293a42ba7d22209a1801dd76b47aad6">dof_id</a> = elem_dofs[i];</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(dof_id))</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            {</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;              <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;              <span class="comment">// row to ensure that the linear system produces the</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;              <span class="comment">// correct value for the constrained DOF.</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;              <span class="keywordflow">if</span> (asymmetric_constraint_rows &amp;&amp; rhs_values)</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                {</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                  <span class="keyword">const</span> DofConstraintValueMap::const_iterator valpos =</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                    rhs_values-&gt;find(<a class="code" href="xdr__io_8C.html#ab293a42ba7d22209a1801dd76b47aad6">dof_id</a>);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                  rhs(i) = (valpos == rhs_values-&gt;end()) ?</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                    0 : valpos-&gt;second;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                }</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                rhs(i) = 0.;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            }</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        }</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    } <span class="comment">// end if is constrained...</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DenseVector_html_a70f094c13f827ea1d9b384bb0aea785a"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a70f094c13f827ea1d9b384bb0aea785a">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const override</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00092">dense_vector.h:92</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad7b5749fe8231535dfd67985c6a5858e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad7b5749fe8231535dfd67985c6a5858e">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02456">dof_map_constraints.C:2456</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="xdr__io_8C_html_ab293a42ba7d22209a1801dd76b47aad6"><div class="ttname"><a href="xdr__io_8C.html#ab293a42ba7d22209a1801dd76b47aad6">dof_id</a></div><div class="ttdeci">dof_id_type dof_id</div><div class="ttdef"><b>Definition:</b> <a href="xdr__io_8C_source.html#l00049">xdr_io.C:49</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01691">dof_map.h:1691</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aa61db76abed0e9d72220bd73b16f9d62"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aa61db76abed0e9d72220bd73b16f9d62">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00441">dense_matrix_impl.h:441</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00117">dof_map.h:117</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a741afad2f7dca9e80a682384d5fcfde3"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a741afad2f7dca9e80a682384d5fcfde3">libMesh::DenseMatrix::vector_mult</a></div><div class="ttdeci">void vector_mult(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00385">dense_matrix_impl.h:385</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d69475c6ae8e441306e90e57d755ced"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d69475c6ae8e441306e90e57d755ced">&#9670;&nbsp;</a></span>increment_constructor_count()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::increment_constructor_count </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Increments the construction counter. Should be called in the constructor of any derived class that will be reference counted. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00181">181</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p class="reference">References <a class="el" href="reference__counter_8h_source.html#l00122">libMesh::ReferenceCounter::_counts</a>, <a class="el" href="elem__quality_8C_source.html#l00042">libMesh::Quality::name()</a>, and <a class="el" href="threads_8C_source.html#l00029">libMesh::Threads::spin_mtx</a>.</p>

<p class="reference">Referenced by <a class="el" href="reference__counted__object_8h_source.html#l00074">libMesh::ReferenceCountedObject&lt; RBParametrized &gt;::ReferenceCountedObject()</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  Threads::spin_mutex::scoped_lock lock(<a class="code" href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">Threads::spin_mtx</a>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  std::pair&lt;unsigned int, unsigned int&gt; &amp; p = <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>[<a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>];</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  p.first++;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00042">elem_quality.C:42</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_aba1ae5c24686d2cd2fc7ccdc9537c4f5"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">libMesh::Threads::spin_mtx</a></div><div class="ttdeci">spin_mutex spin_mtx</div><div class="ttdef"><b>Definition:</b> <a href="threads_8C_source.html#l00029">threads.C:29</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00122">reference_counter.h:122</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f8ca3935940b9b1a60f7645e856f2e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f8ca3935940b9b1a60f7645e856f2e4">&#9670;&nbsp;</a></span>increment_destructor_count()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::increment_destructor_count </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Increments the destruction counter. Should be called in the destructor of any derived class that will be reference counted. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00194">194</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p class="reference">References <a class="el" href="reference__counter_8h_source.html#l00122">libMesh::ReferenceCounter::_counts</a>, <a class="el" href="elem__quality_8C_source.html#l00042">libMesh::Quality::name()</a>, and <a class="el" href="threads_8C_source.html#l00029">libMesh::Threads::spin_mtx</a>.</p>

<p class="reference">Referenced by <a class="el" href="reference__counted__object_8h_source.html#l00127">libMesh::ReferenceCountedObject&lt; RBParametrized &gt;::~ReferenceCountedObject()</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  Threads::spin_mutex::scoped_lock lock(<a class="code" href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">Threads::spin_mtx</a>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  std::pair&lt;unsigned int, unsigned int&gt; &amp; p = <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>[<a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>];</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  p.second++;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00042">elem_quality.C:42</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_aba1ae5c24686d2cd2fc7ccdc9537c4f5"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">libMesh::Threads::spin_mtx</a></div><div class="ttdeci">spin_mutex spin_mtx</div><div class="ttdef"><b>Definition:</b> <a href="threads_8C_source.html#l00029">threads.C:29</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00122">reference_counter.h:122</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd8f3f26dfcdeaa8d024516ea750127c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd8f3f26dfcdeaa8d024516ea750127c">&#9670;&nbsp;</a></span>invalidate_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::invalidate_dofs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Invalidates all active <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> dofs for this system </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00813">813</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, and <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;{</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// All the nodes</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.node_ptr_range())</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    node-&gt;invalidate_dofs(sys_num);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">// All the active elements.</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_element_ptr_range())</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    elem-&gt;invalidate_dofs(sys_num);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div><div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a42a8ae63f7d7c5cfeb14b93bb78a3a3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42a8ae63f7d7c5cfeb14b93bb78a3a3f">&#9670;&nbsp;</a></span>is_attached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_attached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Matrices should not be attached more than once. We can test for an already-attached matrix if necessary using <code>is_attached</code> </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00298">298</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01525">_matrices</a>.</p>

<p class="reference">Referenced by <a class="el" href="implicit__system_8C_source.html#l00106">libMesh::ImplicitSystem::init_matrices()</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">return</span> (std::find(<a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end(),</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    &amp;matrix) != <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end());</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; *&gt; _matrices</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01525">dof_map.h:1525</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a3acc1d2a8ab28b00464406deb1d40f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3acc1d2a8ab28b00464406deb1d40f">&#9670;&nbsp;</a></span>is_constrained_dof()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_constrained_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the degree of freedom dof is constrained, <code>false</code> otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01829">1829</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>.</p>

<p class="reference">Referenced by <a class="el" href="fe__base_8C_source.html#l01650">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_periodic_constraints()</a>, <a class="el" href="fe__base_8C_source.html#l01366">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_proj_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l01848">extract_local_vector()</a>, <a class="el" href="dof__map_8C_source.html#l02633">find_connected_dofs()</a>, and <a class="el" href="condensed__eigen__system_8C_source.html#l00047">libMesh::CondensedEigenSystem::initialize_condensed_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;{</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(dof))</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7a9aeffe76edfe89cc65a16035b864e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7a9aeffe76edfe89cc65a16035b864e">&#9670;&nbsp;</a></span>is_constrained_node()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_constrained_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Node.html">Node</a> *&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the <a class="el" href="classlibMesh_1_1Node.html" title="A geometric point in (x,y,z) space associated with a DOF. ">Node</a> is constrained, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01812">1812</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01698">_node_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;{</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.count(node))</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b4f9eed9d208af06f1b0165451d17ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4f9eed9d208af06f1b0165451d17ed">&#9670;&nbsp;</a></span>is_evaluable()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DofObjectSubclass &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template bool libMesh::DofMap::is_evaluable&lt; <a class="el" href="classlibMesh_1_1Node.html">Node</a> &gt; </td>
          <td>(</td>
          <td class="paramtype">const DofObjectSubclass &amp;&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var_num</em> = <code><a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> iff our solutions can be locally evaluated on <code>obj</code> (which should be an <a class="el" href="classlibMesh_1_1Elem.html" title="The base class for all geometric element types. ">Elem</a> or a <a class="el" href="classlibMesh_1_1Node.html" title="A geometric point in (x,y,z) space associated with a DOF. ">Node</a>) for variable number <code>var_num</code> (for all variables, if <code>var_num</code> is invalid_uint) </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02413">2413</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8C_source.html#l02400">all_semilocal_indices()</a>, <a class="el" href="dof__map_8C_source.html#l01930">dof_indices()</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, and <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_8C_source.html#l02154">libMesh::System::point_gradient()</a>, and <a class="el" href="system_8C_source.html#l02273">libMesh::System::point_hessian()</a>.</p>
<div class="fragment"><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;{</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <span class="comment">// Everything is evaluable on a local object</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <span class="keywordflow">if</span> (obj.processor_id() == this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  std::vector&lt;dof_id_type&gt; di;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  <span class="keywordflow">if</span> (var_num == <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a>(&amp;obj, di);</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a>(&amp;obj, di, var_num);</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a23e77e8156c618833437ebb0f3984aa4">all_semilocal_indices</a>(di);</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;}</div><div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3962af7f276a08be8f22bffd304bdab7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01930">dof_map.C:1930</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a23e77e8156c618833437ebb0f3984aa4"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a23e77e8156c618833437ebb0f3984aa4">libMesh::DofMap::all_semilocal_indices</a></div><div class="ttdeci">bool all_semilocal_indices(const std::vector&lt; dof_id_type &gt; &amp;dof_indices) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02400">dof_map.C:2400</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6ea4cb428f8fbbc6ada2d2ee53a2c9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6ea4cb428f8fbbc6ada2d2ee53a2c9a">&#9670;&nbsp;</a></span>is_periodic_boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_periodic_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a3f4d8a52b5ef6ff6156ca209e12b5564">boundary_id_type</a>&#160;</td>
          <td class="paramname"><em>boundaryid</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the boundary given by <code>boundaryid</code> is periodic, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00219">219</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01707">_periodic_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;count(boundaryid) != 0)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01707">dof_map.h:1707</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a94100187d0c3a089801dc1ebe40d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a94100187d0c3a089801dc1ebe40d00">&#9670;&nbsp;</a></span>last_dof() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::last_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The last dof index that is local to processor <code>proc</code>.</dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000014">Deprecated:</a></b></dt><dd>This function returns nonsense in the rare case where <code>proc</code> has no local dof indices. Use <a class="el" href="classlibMesh_1_1DofMap.html#af6bba480fbe9bd4364e5ff8545ea0d38">end_dof()</a> instead. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00624">624</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01535">_end_df</a>.</p>
<div class="fragment"><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    libmesh_deprecated();</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.size());</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">return</span> cast_int&lt;dof_id_type&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc] - 1);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe087f3cbd7135bbbc1c007d2d27deea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe087f3cbd7135bbbc1c007d2d27deea">&#9670;&nbsp;</a></span>last_dof() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::last_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00631">631</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#abe087f3cbd7135bbbc1c007d2d27deea">last_dof</a>(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_abe087f3cbd7135bbbc1c007d2d27deea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abe087f3cbd7135bbbc1c007d2d27deea">libMesh::DofMap::last_dof</a></div><div class="ttdeci">dof_id_type last_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00631">dof_map.h:631</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e2c5542effbe52f997e0011218486ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e2c5542effbe52f997e0011218486ff">&#9670;&nbsp;</a></span>local_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::local_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if degree of freedom index <code>dof_index</code> is a local index. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00738">738</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l00644">end_dof()</a>, and <a class="el" href="dof__map_8h_source.html#l00602">first_dof()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, <a class="el" href="dof__map_8C_source.html#l01076">local_variable_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02384">semilocal_index()</a>, and <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>.</p>
<div class="fragment"><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  { <span class="keywordflow">return</span> (dof_index &gt;= this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">first_dof</a>()) &amp;&amp; (dof_index &lt; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">end_dof</a>()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a08c13836ca9040d9ebfd511549e4da94"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00644">dof_map.h:644</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a94601bbfdd0675c7259adebea917cd13"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00602">dof_map.h:602</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7ce6dda12c7c485f3766d7be119401c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7ce6dda12c7c485f3766d7be119401c">&#9670;&nbsp;</a></span>local_variable_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::local_variable_indices </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills an array of those dof indices which belong to the given variable number and live on the current processor. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01076">1076</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="mesh__generation_8C_source.html#l00070">libMesh::MeshTools::Generation::Private::idx()</a>, <a class="el" href="dof__map_8h_source.html#l00738">local_index()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__object_8h_source.html#l00803">libMesh::DofObject::n_comp()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="dof__map_8h_source.html#l01762">variable()</a>, and <a class="el" href="dof__map_8h_source.html#l01792">variable_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__auto__fieldsplit_8C_source.html#l00058">libMesh::petsc_auto_fieldsplit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;{</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="comment">// Count dofs in the *exact* order that distribute_dofs numbered</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="comment">// them, so that we can assume ascending indices and use push_back</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="comment">// instead of find+insert.</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num       = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="comment">// If this isn&#39;t a SCALAR variable, we need to find all its field</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">// dofs on the mesh</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">variable_type</a>(var_num).family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <span class="keyword">const</span> Variable &amp; var(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">variable</a>(var_num));</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_local_element_ptr_range())</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;          <span class="keywordflow">if</span> (!var.active_on_subdomain(elem-&gt;subdomain_id()))</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;          <span class="comment">// Only count dofs connected to active</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          <span class="comment">// elements on this processor.</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = elem-&gt;n_nodes();</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          <span class="comment">// First get any new nodal DOFS</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;<a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; n++)</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;              Node &amp; node = elem-&gt;node_ref(n);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;              <span class="keywordflow">if</span> (node.processor_id() &lt; this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node.n_comp(sys_num, var_num);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_comp; i++)</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> index = node.dof_number(sys_num,var_num,i);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                  libmesh_assert (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(index));</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.empty() || index &gt; <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.back())</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.push_back(index);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            }</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;          <span class="comment">// Next get any new element DOFS</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = elem-&gt;n_comp(sys_num, var_num);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_comp; i++)</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> index = elem-&gt;dof_number(sys_num,var_num,i);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.empty() || index &gt; <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.back())</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.push_back(index);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        } <span class="comment">// done looping over elements</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="comment">// we may have missed assigning DOFs to nodes that we own</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="comment">// but to which we have no connected elements matching our</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="comment">// variable restriction criterion.  this will happen, for example,</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="comment">// if variable V is restricted to subdomain S.  We may not own</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="comment">// any elements which live in S, but we may own nodes which are</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="comment">// *connected* to elements which do.  in this scenario these nodes</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="comment">// will presently have unnumbered DOFs. we need to take care of</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="comment">// them here since we own them and no other processor will touch them.</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.local_node_ptr_range())</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          libmesh_assert(node);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node-&gt;n_comp(sys_num, var_num);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_comp; i++)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> index = node-&gt;dof_number(sys_num,var_num,i);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.empty() || index &gt; <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.back())</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.push_back(index);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">// Otherwise, count up the SCALAR dofs, if we&#39;re on the processor</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="comment">// that holds this SCALAR variable</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>() == (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>()-1))</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      std::vector&lt;dof_id_type&gt; di_scalar;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a>(di_scalar,var_num);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.insert( <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>.end(), di_scalar.begin(), di_scalar.end());</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    }</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;}</div><div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9b731b2150d70797262acdbfaf1b53e8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">libMesh::DofMap::variable_type</a></div><div class="ttdeci">const FEType &amp; variable_type(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01792">dof_map.h:1792</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ef75ddf2020ea30f1200cd317c0126"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02348">dof_map.C:2348</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a46ed397847e6a1c3be2236e2faf622ec"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">libMesh::DofMap::variable</a></div><div class="ttdeci">const Variable &amp; variable(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01762">dof_map.h:1762</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private_html_acd3e3226af58784e414a3c242a3ef740"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">libMesh::MeshTools::Generation::Private::idx</a></div><div class="ttdeci">unsigned int idx(const ElemType type, const unsigned int nx, const unsigned int i, const unsigned int j)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__generation_8C_source.html#l00070">mesh_generation.C:70</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77f25fd7893ffeb88979a8f0f2898fdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77f25fd7893ffeb88979a8f0f2898fdd">&#9670;&nbsp;</a></span>max_constraint_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; libMesh::DofMap::max_constraint_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>v</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tests the constrained degrees of freedom on the numeric vector <code>v</code>, which represents a solution defined on the mesh, returning a pair whose first entry is the maximum absolute error on a constrained DoF and whose second entry is the maximum relative error. Useful for debugging purposes.</p>
<p>If <code>v</code> == nullptr, the system solution vector is tested. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l02268">2268</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00059">std::abs()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="numeric__vector_8h_source.html#l00165">libMesh::NumericVector&lt; T &gt;::closed()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">libMesh::NumericVector&lt; T &gt;::first_local_index()</a>, <a class="el" href="system_8h_source.html#l02049">libMesh::System::get_dof_map()</a>, <a class="el" href="system_8h_source.html#l02033">libMesh::System::get_mesh()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">libMesh::NumericVector&lt; T &gt;::last_local_index()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00102">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00107">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, and <a class="el" href="system_8h_source.html#l01523">libMesh::System::solution</a>.</p>
<div class="fragment"><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;{</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  <span class="keywordflow">if</span> (!v)</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    v = system.<a class="code" href="classlibMesh_1_1System.html#aa07e1093c49fa5f0877488d3351f4c86">solution</a>.get();</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> &amp; vec = *v;</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <span class="comment">// We&#39;ll assume the vector is closed</span></div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  libmesh_assert (vec.<a class="code" href="classlibMesh_1_1NumericVector.html#aa5a7c59975d4092320edd574697b04d5">closed</a>());</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> max_absolute_error = 0., max_relative_error = 0.;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a> = system.<a class="code" href="classlibMesh_1_1System.html#afae357030a705ceb108e5b74965562c1">get_mesh</a>();</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  libmesh_assert_equal_to (<span class="keyword">this</span>, &amp;(system.<a class="code" href="classlibMesh_1_1System.html#ae7fa429ad93ac9a193ac287076588252">get_dof_map</a>()));</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <span class="comment">// indices on each element</span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  std::vector&lt;dof_id_type&gt; local_dof_indices;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    {</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a>(elem, local_dof_indices);</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      std::vector&lt;dof_id_type&gt; raw_dof_indices = local_dof_indices;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="comment">// Constraint matrix for each element</span></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">build_constraint_matrix</a> (C, local_dof_indices);</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      <span class="comment">// Continue if the element is unconstrained</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      <span class="keywordflow">if</span> (!C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>())</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(), raw_dof_indices.size());</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(), local_dof_indices.size());</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i!=C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">m</a>(); ++i)</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        {</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;          <span class="comment">// Recalculate any constrained dof owned by this processor</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> global_dof = raw_dof_indices[i];</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(global_dof) &amp;&amp;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;              global_dof &gt;= vec.<a class="code" href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">first_local_index</a>() &amp;&amp;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;              global_dof &lt; vec.<a class="code" href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">last_local_index</a>())</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            {</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;              DofConstraints::const_iterator</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(global_dof);</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;              libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;              <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> exact_value = 0;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;              DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(global_dof);</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;              <span class="keywordflow">if</span> (rhsit != <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                exact_value = rhsit-&gt;second;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;              for (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j!=C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">n</a>(); ++j)</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                {</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                  <span class="keywordflow">if</span> (local_dof_indices[j] != global_dof)</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                    exact_value += C(i,j) *</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                      vec(local_dof_indices[j]);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                }</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;              max_absolute_error = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(max_absolute_error,</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                                            <a class="code" href="namespacestd.html#a267975f6c8fdf9f989e14d438036706a">std::abs</a>(vec(global_dof) - exact_value));</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;              max_relative_error = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(max_relative_error,</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                                            <a class="code" href="namespacestd.html#a267975f6c8fdf9f989e14d438036706a">std::abs</a>(vec(global_dof) - exact_value)</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                                            / <a class="code" href="namespacestd.html#a267975f6c8fdf9f989e14d438036706a">std::abs</a>(exact_value));</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            }</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        }</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    }</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  <span class="keywordflow">return</span> std::pair&lt;Real, Real&gt;(max_absolute_error, max_relative_error);</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;}</div><div class="ttc" id="namespacestd_html_a267975f6c8fdf9f989e14d438036706a"><div class="ttname"><a href="namespacestd.html#a267975f6c8fdf9f989e14d438036706a">std::abs</a></div><div class="ttdeci">double abs(double a)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00059">libmesh_augment_std_namespace.h:59</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3962af7f276a08be8f22bffd304bdab7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01930">dof_map.C:1930</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_abe1625249b1855f4c3b039989e1afcb2"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#abe1625249b1855f4c3b039989e1afcb2">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00102">dense_matrix_base.h:102</a></div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1System_html_afae357030a705ceb108e5b74965562c1"><div class="ttname"><a href="classlibMesh_1_1System.html#afae357030a705ceb108e5b74965562c1">libMesh::System::get_mesh</a></div><div class="ttdeci">const MeshBase &amp; get_mesh() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l02033">system.h:2033</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html">libMesh::MeshBase</a></div><div class="ttdoc">Base class for Mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00077">mesh_base.h:77</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1System_html_aa07e1093c49fa5f0877488d3351f4c86"><div class="ttname"><a href="classlibMesh_1_1System.html#aa07e1093c49fa5f0877488d3351f4c86">libMesh::System::solution</a></div><div class="ttdeci">std::unique_ptr&lt; NumericVector&lt; Number &gt; &gt; solution</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l01523">system.h:1523</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_aa5a7c59975d4092320edd574697b04d5"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#aa5a7c59975d4092320edd574697b04d5">libMesh::NumericVector::closed</a></div><div class="ttdeci">virtual bool closed() const</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00165">numeric_vector.h:165</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adb02fab0dbedac070aa31d587732c7ba"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">libMesh::NumericVector::first_local_index</a></div><div class="ttdeci">virtual numeric_index_type first_local_index() const =0</div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a599877e0ae2c03dccbd5e8e9750d7fb3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a599877e0ae2c03dccbd5e8e9750d7fb3">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02346">dof_map_constraints.C:2346</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a150fe83cd36754fe5740ba66a4341da1"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a150fe83cd36754fe5740ba66a4341da1">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00107">dense_matrix_base.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix&lt; Number &gt;</a></div></div>
<div class="ttc" id="classlibMesh_1_1System_html_ae7fa429ad93ac9a193ac287076588252"><div class="ttname"><a href="classlibMesh_1_1System.html#ae7fa429ad93ac9a193ac287076588252">libMesh::System::get_dof_map</a></div><div class="ttdeci">const DofMap &amp; get_dof_map() const</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l02049">system.h:2049</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a18d730bed9ae74b3fb5edc8261d83a96"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">libMesh::NumericVector::last_local_index</a></div><div class="ttdeci">virtual numeric_index_type last_local_index() const =0</div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af63ec595dadc28f2b6673499641a1683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af63ec595dadc28f2b6673499641a1683">&#9670;&nbsp;</a></span>merge_ghost_functor_outputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::merge_ghost_functor_outputs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">GhostingFunctor::map_type</a> &amp;&#160;</td>
          <td class="paramname"><em>elements_to_ghost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="classlibMesh_1_1CouplingMatrix.html">CouplingMatrix</a> *&gt; &amp;&#160;</td>
          <td class="paramname"><em>temporary_coupling_matrices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::iterator &amp;&#160;</td>
          <td class="paramname"><em>gf_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt;::iterator &amp;&#160;</td>
          <td class="paramname"><em>gf_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;&#160;</td>
          <td class="paramname"><em>elems_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;&#160;</td>
          <td class="paramname"><em>elems_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01432">1432</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="simple__range_8h_source.html#l00057">libMesh::as_range()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, and <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;{</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">as_range</a>(gf_begin, gf_end))</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    {</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <a class="code" href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">GhostingFunctor::map_type</a> more_elements_to_ghost;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      libmesh_assert(gf);</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      (*gf)(elems_begin, elems_end, p, more_elements_to_ghost);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : more_elements_to_ghost)</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        {</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          GhostingFunctor::map_type::iterator existing_it =</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            elements_to_ghost.find (pr.first);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;          <span class="keywordflow">if</span> (existing_it == elements_to_ghost.end())</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            elements_to_ghost.insert(pr);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            {</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;              <span class="keywordflow">if</span> (existing_it-&gt;second)</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                {</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                  <span class="keywordflow">if</span> (pr.second)</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                    {</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                      <span class="comment">// If this isn&#39;t already a temporary</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                      <span class="comment">// then we need to make one so we&#39;ll</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                      <span class="comment">// have a non-const matrix to merge</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                      <span class="keywordflow">if</span> (temporary_coupling_matrices.empty() ||</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                          temporary_coupling_matrices.find(const_cast&lt;CouplingMatrix *&gt;(existing_it-&gt;second)) == temporary_coupling_matrices.end())</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                        {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                          CouplingMatrix * cm = <span class="keyword">new</span> CouplingMatrix(*existing_it-&gt;second);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                          temporary_coupling_matrices.insert(cm);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                          existing_it-&gt;second = cm;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                        }</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                      <span class="keyword">const_cast&lt;</span>CouplingMatrix &amp;<span class="keyword">&gt;</span>(*existing_it-&gt;second) &amp;= *pr.second;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                    }</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                    {</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                      <span class="comment">// Any existing_it matrix merged with a full</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                      <span class="comment">// matrix (symbolized as nullptr) gives another</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                      <span class="comment">// full matrix (symbolizable as nullptr).</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                      <span class="comment">// So if existing_it-&gt;second is a temporary then</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                      <span class="comment">// we don&#39;t need it anymore; we might as well</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                      <span class="comment">// remove it to keep the set of temporaries</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                      <span class="comment">// small.</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                      std::set&lt;CouplingMatrix *&gt;::iterator temp_it =</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                        temporary_coupling_matrices.find(const_cast&lt;CouplingMatrix *&gt;(existing_it-&gt;second));</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                      <span class="keywordflow">if</span> (temp_it != temporary_coupling_matrices.end())</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                        temporary_coupling_matrices.erase(temp_it);</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                      existing_it-&gt;second = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    }</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;              <span class="comment">// else we have a nullptr already, then we have a full</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;              <span class="comment">// coupling matrix, already, and merging with anything</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;              <span class="comment">// else won&#39;t change that, so we&#39;re done.</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            }</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        }</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    }</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;}</div><div class="ttc" id="namespacelibMesh_html_a977361a82b7a9e7ad8e50ae1cae40d20"><div class="ttname"><a href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">libMesh::as_range</a></div><div class="ttdeci">SimpleRange&lt; I &gt; as_range(const std::pair&lt; I, I &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="simple__range_8h_source.html#l00057">simple_range.h:57</a></div></div>
<div class="ttc" id="classlibMesh_1_1GhostingFunctor_html_a3c27b499ef3153d8aaaa2088beba4480"><div class="ttname"><a href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">libMesh::GhostingFunctor::map_type</a></div><div class="ttdeci">std::unordered_map&lt; const Elem *, const CouplingMatrix * &gt; map_type</div><div class="ttdef"><b>Definition:</b> <a href="ghosting__functor_8h_source.html#l00154">ghosting_functor.h:154</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a376da0a998e9cbd79b82bda6582ecf94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a376da0a998e9cbd79b82bda6582ecf94">&#9670;&nbsp;</a></span>n_constrained_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_constrained_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The total number of constrained degrees of freedom in the problem. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01172">1172</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00425">libMesh::libmesh_petsc_snes_postcheck()</a>.</p>
<div class="fragment"><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;{</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  parallel_object_only();</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> nc_dofs = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab72a20ecabf2b79d288ca4b4cff8782f">n_local_constrained_dofs</a>();</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(nc_dofs);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">return</span> nc_dofs;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ab72a20ecabf2b79d288ca4b4cff8782f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72a20ecabf2b79d288ca4b4cff8782f">libMesh::DofMap::n_local_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_local_constrained_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01182">dof_map_constraints.C:1182</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3f8b3675d745f7d586e93158aa951174"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">libMesh::Parallel::Communicator::sum</a></div><div class="ttdeci">void sum(T &amp;r) const</div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f28e23df955b3a8c63af68b94be82d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f28e23df955b3a8c63af68b94be82d4">&#9670;&nbsp;</a></span>n_constrained_nodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_constrained_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The total number of constrained Nodes in the mesh. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00810">810</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01698">_node_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;dof_id_type&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.size()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e989f4bcf03847736e84ff054e41111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e989f4bcf03847736e84ff054e41111">&#9670;&nbsp;</a></span>n_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The total number of degrees of freedom in the problem. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00574">574</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01649">_n_dfs</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00341">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="unsteady__solver_8C_source.html#l00216">libMesh::UnsteadySolver::old_nonlinear_solution()</a>, <a class="el" href="second__order__unsteady__solver_8C_source.html#l00116">libMesh::SecondOrderUnsteadySolver::old_solution_accel()</a>, <a class="el" href="second__order__unsteady__solver_8C_source.html#l00107">libMesh::SecondOrderUnsteadySolver::old_solution_rate()</a>, and <a class="el" href="sparsity__pattern_8C_source.html#l00443">libMesh::SparsityPattern::Build::parallel_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a>; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01649">dof_map.h:1649</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae17864ba577f0016a69d81d472655047"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae17864ba577f0016a69d81d472655047">&#9670;&nbsp;</a></span>n_dofs_on_processor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_dofs_on_processor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of degrees of freedom on partition <code>proc</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00590">590</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01535">_end_df</a>, and <a class="el" href="dof__map_8h_source.html#l01530">_first_df</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00341">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="dof__map_8h_source.html#l00584">n_local_dofs()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>, and <a class="el" href="sparsity__pattern_8C_source.html#l00443">libMesh::SparsityPattern::Build::parallel_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.size());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span> cast_int&lt;dof_id_type&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc] - <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[proc]);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01530">dof_map.h:1530</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab72a20ecabf2b79d288ca4b4cff8782f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72a20ecabf2b79d288ca4b4cff8782f">&#9670;&nbsp;</a></span>n_local_constrained_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_local_constrained_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of constrained degrees of freedom on this processor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01182">1182</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;{</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keyword">const</span> DofConstraints::const_iterator lower =</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.lower_bound(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">first_dof</a>()),</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    upper =</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.upper_bound(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">end_dof</a>()-1);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">return</span> cast_int&lt;dof_id_type&gt;(std::distance(lower, upper));</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a08c13836ca9040d9ebfd511549e4da94"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a08c13836ca9040d9ebfd511549e4da94">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00644">dof_map.h:644</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a94601bbfdd0675c7259adebea917cd13"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a94601bbfdd0675c7259adebea917cd13">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00602">dof_map.h:602</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2879bd4cc7db35e8d94ffd3355c143fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2879bd4cc7db35e8d94ffd3355c143fd">&#9670;&nbsp;</a></span>n_local_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_local_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of degrees of freedom on this processor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00584">584</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l00590">n_dofs_on_processor()</a>, and <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__dm__wrapper_8C_source.html#l00163">libMesh::PetscDMWrapper::build_sf()</a>, and <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>.</p>
<div class="fragment"><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17864ba577f0016a69d81d472655047">n_dofs_on_processor</a> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ae17864ba577f0016a69d81d472655047"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17864ba577f0016a69d81d472655047">libMesh::DofMap::n_dofs_on_processor</a></div><div class="ttdeci">dof_id_type n_dofs_on_processor(const processor_id_type proc) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00590">dof_map.h:590</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50e74641afc6e2870c9e1ce412f8c44f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50e74641afc6e2870c9e1ce412f8c44f">&#9670;&nbsp;</a></span>n_objects()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int libMesh::ReferenceCounter::n_objects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints the number of outstanding (created, but not yet destroyed) objects. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00083">83</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p class="reference">References <a class="el" href="reference__counter_8h_source.html#l00130">libMesh::ReferenceCounter::_n_objects</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">_n_objects</a>; }</div><div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_ad2c30f0f71dcd00f00faa8e46aa3e043"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">libMesh::ReferenceCounter::_n_objects</a></div><div class="ttdeci">static Threads::atomic&lt; unsigned int &gt; _n_objects</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00130">reference_counter.h:130</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae68477b8c280a345eda62d7aa1c6bfc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae68477b8c280a345eda62d7aa1c6bfc1">&#9670;&nbsp;</a></span>n_old_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_old_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The total number of degrees of freedom on old_dof_objects </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01271">1271</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01662">_n_old_dfs</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a>; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01662">dof_map.h:1662</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6fe0cda2874d85c373ba4493822651c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6fe0cda2874d85c373ba4493822651c">&#9670;&nbsp;</a></span>n_processors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libMesh::ParallelObject::n_processors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of processors in the group. </dd></dl>

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00095">95</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00107">libMesh::ParallelObject::_communicator</a>, and <a class="el" href="communicator_8h_source.html#l00175">libMesh::Parallel::Communicator::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="boundary__info_8C_source.html#l02412">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00340">libMesh::PetscDMWrapper::add_dofs_to_section()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00385">libMesh::DistributedMesh::add_elem()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00596">libMesh::DistributedMesh::add_node()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00261">libMesh::LaplaceMeshSmoother::allgather_graph()</a>, <a class="el" href="fem__system_8C_source.html#l00854">libMesh::FEMSystem::assembly()</a>, <a class="el" href="trilinos__aztec__linear__solver_8C_source.html#l00041">libMesh::AztecLinearSolver&lt; T &gt;::AztecLinearSolver()</a>, <a class="el" href="boundary__info_8C_source.html#l01779">libMesh::BoundaryInfo::build_node_list_from_side_list()</a>, <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00764">libMesh::DistributedMesh::clear()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01846">libMesh::Nemesis_IO_Helper::compute_border_node_ids()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02648">libMesh::Nemesis_IO_Helper::construct_nemesis_filename()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00655">libMesh::UnstructuredMesh::create_pid_mesh()</a>, <a class="el" href="mesh__tools_8C_source.html#l00477">libMesh::MeshTools::create_processor_bounding_box()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01163">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">distribute_local_dofs_var_major()</a>, <a class="el" href="ensight__io_8C_source.html#l00064">libMesh::EnsightIO::EnsightIO()</a>, <a class="el" href="mesh__base_8C_source.html#l00378">libMesh::MeshBase::get_info()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00054">libMesh::PetscDMWrapper::init_and_attach_petscdm()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00763">libMesh::Nemesis_IO_Helper::initialize()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00481">libMesh::DistributedMesh::insert_elem()</a>, <a class="el" href="mesh__tools_8C_source.html#l01598">libMesh::MeshTools::libmesh_assert_contiguous_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01877">libMesh::MeshTools::libmesh_assert_parallel_consistent_new_node_procids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01777">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01915">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01826">libMesh::MeshTools::libmesh_assert_topology_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01401">libMesh::MeshTools::libmesh_assert_valid_boundary_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01571">libMesh::MeshTools::libmesh_assert_valid_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l02068">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="mesh__tools_8C_source.html#l01985">libMesh::MeshTools::libmesh_assert_valid_refinement_flags()</a>, <a class="el" href="dof__map_8C_source.html#l01076">local_variable_indices()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">libMesh::MeshRefinement::make_coarsening_compatible()</a>, <a class="el" href="mesh__base_8C_source.html#l00345">libMesh::MeshBase::n_active_elem_on_proc()</a>, <a class="el" href="mesh__base_8C_source.html#l00332">libMesh::MeshBase::n_elem_on_proc()</a>, <a class="el" href="mesh__base_8C_source.html#l00319">libMesh::MeshBase::n_nodes_on_proc()</a>, <a class="el" href="mesh__base_8h_source.html#l00749">libMesh::MeshBase::partition()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l00134">libMesh::PetscLinearSolver&lt; T &gt;::PetscLinearSolver()</a>, <a class="el" href="system_8C_source.html#l02100">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02220">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01993">libMesh::System::point_value()</a>, <a class="el" href="namebased__io_8C_source.html#l00059">libMesh::NameBasedIO::read()</a>, <a class="el" href="nemesis__io_8C_source.html#l00148">libMesh::Nemesis_IO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00750">libMesh::CheckpointIO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l01023">libMesh::CheckpointIO::read_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l01380">libMesh::XdrIO::read_header()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00950">libMesh::CheckpointIO::read_nodes()</a>, <a class="el" href="system__io_8C_source.html#l00493">libMesh::System::read_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l01121">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="system__io_8C_source.html#l00811">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="system__io_8C_source.html#l01168">libMesh::System::read_serialized_vector()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00961">libMesh::DistributedMesh::renumber_dof_objects()</a>, <a class="el" href="dof__map_8C_source.html#l00321">set_nonlocal_dof_objects()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">libMesh::MeshRefinement::uniformly_coarsen()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00127">libMesh::DistributedMesh::update_parallel_id_counts()</a>, <a class="el" href="gmv__io_8C_source.html#l01230">libMesh::GMVIO::write_binary()</a>, <a class="el" href="gmv__io_8C_source.html#l01551">libMesh::GMVIO::write_discontinuous_gmv()</a>, <a class="el" href="system__io_8C_source.html#l01504">libMesh::System::write_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l02101">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l00993">libMesh::XdrIO::write_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l01815">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00351">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l00710">libMesh::XdrIO::write_serialized_nodes()</a>, and <a class="el" href="xdr__io_8C_source.html#l01136">libMesh::XdrIO::write_serialized_nodesets()</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3fc3b57958613c0bddb53e77c9891ff1">size</a>()); }</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3fc3b57958613c0bddb53e77c9891ff1"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3fc3b57958613c0bddb53e77c9891ff1">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">processor_id_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8h_source.html#l00175">communicator.h:175</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00107">parallel_object.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af31c7dfd8d972d20ca28e945565a5526"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31c7dfd8d972d20ca28e945565a5526">&#9670;&nbsp;</a></span>n_SCALAR_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_SCALAR_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of SCALAR dofs. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00579">579</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01655">_n_SCALAR_dofs</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>, and <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>.</p>
<div class="fragment"><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a>; }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01655">dof_map.h:1655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a994ec3105079a55c9432a37e8bbcf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a994ec3105079a55c9432a37e8bbcf5">&#9670;&nbsp;</a></span>n_variable_groups()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::n_variable_groups </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of variables in the global solution vector. Defaults to 1, should be 1 for a scalar equation, 3 for 2D incompressible Navier Stokes (u,v,p), etc... </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00533">533</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01503">_variable_groups</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01163">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8C_source.html#l01930">dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l00549">has_blocked_representation()</a>, <a class="el" href="dof__map_8C_source.html#l02434">old_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>, and <a class="el" href="dof__map_8C_source.html#l00321">set_nonlocal_dof_objects()</a>.</p>
<div class="fragment"><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01503">dof_map.h:1503</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25b3182cbf57ead72821d826275512b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b3182cbf57ead72821d826275512b0">&#9670;&nbsp;</a></span>n_variables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::n_variables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of variables in the global solution vector. Defaults to 1, should be 1 for a scalar equation, 3 for 2D incompressible Navier Stokes (u,v,p), etc... </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00541">541</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01498">_variables</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00562">block_size()</a>, <a class="el" href="fe__base_8C_source.html#l01343">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::coarsened_dof_values()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00089">DMlibMeshSetSystem_libMesh()</a>, <a class="el" href="dof__map_8h_source.html#l00549">has_blocked_representation()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>, <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>, and <a class="el" href="dof__map_8C_source.html#l01682">use_coupled_neighbor_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size()); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01498">dof_map.h:1498</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aab813d5c9448a6e4cfd9703322195d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab813d5c9448a6e4cfd9703322195d57">&#9670;&nbsp;</a></span>node_constraint_rows_begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NodeConstraints::const_iterator libMesh::DofMap::node_constraint_rows_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>An iterator pointing to the first <a class="el" href="classlibMesh_1_1Node.html" title="A geometric point in (x,y,z) space associated with a DOF. ">Node</a> constraint row. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00927">927</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01698">_node_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.begin(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28da578251a8067b50276b006ed75c62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28da578251a8067b50276b006ed75c62">&#9670;&nbsp;</a></span>node_constraint_rows_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NodeConstraints::const_iterator libMesh::DofMap::node_constraint_rows_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>An iterator pointing just past the last <a class="el" href="classlibMesh_1_1Node.html" title="A geometric point in (x,y,z) space associated with a DOF. ">Node</a> constraint row. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00933">933</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01698">_node_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.end(); }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adddf429ac3d11389582986155f4d2d72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adddf429ac3d11389582986155f4d2d72">&#9670;&nbsp;</a></span>node_ptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> * libMesh::DofMap::node_ptr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The <a class="el" href="classlibMesh_1_1Node.html" title="A geometric point in (x,y,z) space associated with a DOF. ">Node</a> pointer with index <code>i</code> from the <code>mesh</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00306">306</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.node_ptr(i);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;}</div><div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d332950190e394616401c9b0df59330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d332950190e394616401c9b0df59330">&#9670;&nbsp;</a></span>old_dof_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::old_dof_indices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *const&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em> = <code><a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>After a mesh is refined and repartitioned it is possible that the <code>_send_list</code> will need to be augmented. This is the case when an element is refined and its children end up on different processors than the parent. These children will need values from the parent when projecting the solution onto the refined mesh, hence the parent's DOF indices need to be included in the <code>_send_list</code>. Fills the vector di with the global degree of freedom indices for the element using the <code>DofMap::old_dof_object</code>. If no variable number is specified then all variables are returned. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02434">2434</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="elem_8h_source.html#l02390">libMesh::Elem::active()</a>, <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="classlibMesh_1_1Elem.html#a90a7ca1f28a92f659ab6f8cdef91d806">libMesh::Elem::dim()</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="fe__interface_8C_source.html#l01412">libMesh::FEInterface::extra_hanging_dofs()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="mesh__subdivision__support_8C_source.html#l00031">libMesh::MeshTools::Subdivision::find_one_ring()</a>, <a class="el" href="elem_8h_source.html#l01949">libMesh::Elem::get_nodes()</a>, <a class="el" href="dof__object_8h_source.html#l00913">libMesh::DofObject::has_dofs()</a>, <a class="el" href="classlibMesh_1_1Elem.html#af5eecb2e1afee8bc7ebf8632da91e4ff">libMesh::Elem::infinite()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, <a class="el" href="classlibMesh_1_1Elem.html#ac56e382d9871ff243a781940ee13ed87">libMesh::Elem::is_vertex()</a>, <a class="el" href="elem_8h_source.html#l01202">libMesh::Elem::JUST_COARSENED</a>, <a class="el" href="elem_8h_source.html#l01201">libMesh::Elem::JUST_REFINED</a>, <a class="el" href="enum__fe__family_8h_source.html#l00036">libMesh::LAGRANGE</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="fe__interface_8C_source.html#l00473">libMesh::FEInterface::n_dofs_at_node()</a>, <a class="el" href="fe__interface_8C_source.html#l00493">libMesh::FEInterface::n_dofs_at_node_function()</a>, <a class="el" href="fe__interface_8C_source.html#l00504">libMesh::FEInterface::n_dofs_per_elem()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_nodes</a>, <a class="el" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes()</a>, <a class="el" href="dof__object_8h_source.html#l00749">libMesh::DofObject::n_systems()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00217">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="variable_8h_source.html#l00255">libMesh::VariableGroup::number()</a>, <a class="el" href="dof__object_8h_source.html#l00079">libMesh::DofObject::old_dof_object</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="elem_8h_source.html#l02654">libMesh::Elem::p_refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>, <a class="el" href="elem_8h_source.html#l02034">libMesh::Elem::subdomain_id()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="enum__elem__type_8h_source.html#l00069">libMesh::TRI3SUBDIVISION</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ad06f8ac22978144723179eed42d10bae">libMesh::Elem::type()</a>, and <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fe__base_8C_source.html#l00791">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::coarsened_dof_values()</a>, <a class="el" href="system__projection_8C_source.html#l01075">libMesh::BuildProjectionList::operator()()</a>, and <a class="el" href="fem__context_8C_source.html#l01552">libMesh::FEMContext::pre_fe_reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;{</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;old_dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  libmesh_assert(elem);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">ElemType</a> type              = elem-&gt;type();</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num       = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>();</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim           = elem-&gt;dim();</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> is_inf                = elem-&gt;infinite();</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">// If we have dof indices stored on the elem, and there&#39;s no chance</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">// that we only have those indices because we were just p refined,</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="comment">// then we should have old dof indices too.</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  libmesh_assert(!elem-&gt;has_dofs(sys_num) ||</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                 elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a> ||</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                 elem-&gt;old_dof_object);</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  <span class="comment">// Clear the DOF indices vector.</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  di.clear();</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <span class="comment">// Determine the nodes contributing to element elem</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  std::vector&lt;const Node *&gt; elem_nodes;</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <span class="keyword">const</span> Node * <span class="keyword">const</span> * nodes_ptr;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="keywordflow">if</span> (elem-&gt;type() == <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049">TRI3SUBDIVISION</a>)</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    {</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      <span class="comment">// Subdivision surface FE require the 1-ring around elem</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <span class="keyword">const</span> Tri3Subdivision * sd_elem = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>Tri3Subdivision *<span class="keyword">&gt;</span>(elem);</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Subdivision.html#a8cb6430d3673fa7eff27467e17a94505">MeshTools::Subdivision::find_one_ring</a>(sd_elem, elem_nodes);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      nodes_ptr = elem_nodes.data();</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = cast_int&lt;unsigned int&gt;(elem_nodes.size());</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    }</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    {</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="comment">// All other FE use only the nodes of elem itself</span></div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      nodes_ptr = elem-&gt;get_nodes();</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      <a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a> = elem-&gt;n_nodes();</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    }</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  <span class="comment">// Get the dof numbers</span></div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    {</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig&lt;vars_in_group; vig++)</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = var.number(vig);</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;          <span class="keywordflow">if</span> ((vn == v) || (vn == <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>))</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            {</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;              <span class="keywordflow">if</span> (var.type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a> &amp;&amp;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                  (!elem ||</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                   var.active_on_subdomain(elem-&gt;subdomain_id())))</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                {</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                  <span class="comment">// We asked for this variable, so add it to the vector.</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                  std::vector&lt;dof_id_type&gt; di_new;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">SCALAR_dof_indices</a>(di_new,v,<span class="keyword">true</span>);</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                  di.insert( di.end(), di_new.begin(), di_new.end());</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                <span class="keywordflow">if</span> (var.active_on_subdomain(elem-&gt;subdomain_id()))</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                  { <span class="comment">// Do this for all the variables if one was not specified</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                    <span class="comment">// or just for the specified variable</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                    <span class="comment">// Increase the polynomial order on p refined elements,</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                    <span class="comment">// but make sure you get the right polynomial order for</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                    <span class="comment">// the OLD degrees of freedom</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                    <span class="keywordtype">int</span> p_adjustment = 0;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                    <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>)</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                      {</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                        libmesh_assert_greater (elem-&gt;p_level(), 0);</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                        p_adjustment = -1;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                      }</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">Elem::JUST_COARSENED</a>)</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                      {</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                        p_adjustment = 1;</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                      }</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                    FEType fe_type = var.type();</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                    fe_type.order = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a><span class="keyword">&gt;</span>(fe_type.order +</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                                                       elem-&gt;p_level() +</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                                                       p_adjustment);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span> extra_hanging_dofs =</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                      <a class="code" href="classlibMesh_1_1FEInterface.html#ac0363b6fc2b8355ff0416ac65b522066">FEInterface::extra_hanging_dofs</a>(fe_type);</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1FEInterface.html#a78f9b38911ff4edec8d824d3272cc617">FEInterface::n_dofs_at_node_ptr</a> ndan =</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                      <a class="code" href="classlibMesh_1_1FEInterface.html#a580bf91fc4171dc3ae16441f9c03250d">FEInterface::n_dofs_at_node_function</a>(dim, fe_type);</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                    <span class="comment">// Get the node-based DOF numbers</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;<a class="code" href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a>; n++)</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                      {</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                        <span class="keyword">const</span> Node * node = nodes_ptr[n];</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                        <span class="keyword">const</span> DofObject * old_dof_obj = node-&gt;old_dof_object;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                        libmesh_assert(old_dof_obj);</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                        <span class="comment">// There is a potential problem with h refinement.  Imagine a</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                        <span class="comment">// quad9 that has a linear FE on it.  Then, on the hanging side,</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                        <span class="comment">// it can falsely identify a DOF at the mid-edge node. This is why</span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                        <span class="comment">// we call FEInterface instead of node-&gt;n_comp() directly.</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc =</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                          is_inf ?</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                          <a class="code" href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">FEInterface::n_dofs_at_node</a>(dim, fe_type, type, n) :</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;#endif</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                          ndan (type, fe_type.order, n);</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span> n_comp = old_dof_obj-&gt;n_comp_group(sys_num,vg);</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                        <span class="comment">// If this is a non-vertex on a hanging node with extra</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                        <span class="comment">// degrees of freedom, we use the non-vertex dofs (which</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                        <span class="comment">// come in reverse order starting from the end, to</span></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                        <span class="comment">// simplify p refinement)</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                        <span class="keywordflow">if</span> (extra_hanging_dofs &amp;&amp; !elem-&gt;is_vertex(n))</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                          {</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> dof_offset = n_comp - nc;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                            <span class="comment">// We should never have fewer dofs than necessary on a</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                            <span class="comment">// node unless we&#39;re getting indices on a parent element</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                            <span class="comment">// or a just-coarsened element</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;                            <span class="keywordflow">if</span> (dof_offset &lt; 0)</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                              {</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                                libmesh_assert(!elem-&gt;active() || elem-&gt;refinement_flag() ==</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                                               <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">Elem::JUST_COARSENED</a>);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                                di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                              }</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=n_comp-1; i&gt;=dof_offset; i--)</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                                {</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                                    old_dof_obj-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                                  libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                                  di.push_back(d);</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                                }</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                          }</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                        <span class="comment">// If this is a vertex or an element without extra hanging</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                        <span class="comment">// dofs, our dofs come in forward order coming from the</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                        <span class="comment">// beginning</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nc; i++)</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                            {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                                old_dof_obj-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                              libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                              di.push_back(d);</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                            }</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                      }</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                    <span class="comment">// If there are any element-based DOF numbers, get them</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc = <a class="code" href="classlibMesh_1_1FEInterface.html#aaf96d4ec7921d2f2a1d4cdbdbc63656a">FEInterface::n_dofs_per_elem</a>(dim,</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                                                                         fe_type,</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                                                                         type);</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                    <span class="comment">// We should never have fewer dofs than necessary on an</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                    <span class="comment">// element unless we&#39;re getting indices on a parent element</span></div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                    <span class="comment">// or a just-coarsened element</span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                    <span class="keywordflow">if</span> (nc != 0)</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                      {</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                        <span class="keyword">const</span> DofObject * old_dof_obj = elem-&gt;old_dof_object;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                        libmesh_assert(old_dof_obj);</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp =</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                          old_dof_obj-&gt;n_comp_group(sys_num,vg);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                        <span class="keywordflow">if</span> (old_dof_obj-&gt;n_systems() &gt; sys_num &amp;&amp;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                            nc &lt;= n_comp)</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                          {</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nc; i++)</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                              {</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                                  old_dof_obj-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                                di.push_back(d);</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                              }</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                          }</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                          {</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                            libmesh_assert(!elem-&gt;active() || fe_type.family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2da0b0bdaef8cef619acc3e552276abfe8f">LAGRANGE</a> ||</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                                           elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">Elem::JUST_COARSENED</a>);</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                            di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                          }</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                      }</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                  }</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            }</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        } <span class="comment">// end loop over variables within group</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    } <span class="comment">// end loop over variable groups</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1FEInterface_html_aaf96d4ec7921d2f2a1d4cdbdbc63656a"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#aaf96d4ec7921d2f2a1d4cdbdbc63656a">libMesh::FEInterface::n_dofs_per_elem</a></div><div class="ttdeci">static unsigned int n_dofs_per_elem(const unsigned int dim, const FEType &amp;fe_t, const ElemType t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00504">fe_interface.C:504</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2da0b0bdaef8cef619acc3e552276abfe8f"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2da0b0bdaef8cef619acc3e552276abfe8f">libMesh::LAGRANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00036">enum_fe_family.h:36</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a3f482b3acb4beb528f0ce89f161ff967"><div class="ttname"><a href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">libMesh::ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition:</b> <a href="enum__elem__type_8h_source.html#l00033">enum_elem_type.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af3eb3e8751995b944fc135ea53b09da2"><div class="ttname"><a href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">libMesh::Order</a></div><div class="ttdeci">Order</div><div class="ttdef"><b>Definition:</b> <a href="enum__order_8h_source.html#l00040">enum_order.h:40</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ef75ddf2020ea30f1200cd317c0126"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ef75ddf2020ea30f1200cd317c0126">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02348">dof_map.C:2348</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_1_1Subdivision_html_a8cb6430d3673fa7eff27467e17a94505"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools_1_1Subdivision.html#a8cb6430d3673fa7eff27467e17a94505">libMesh::MeshTools::Subdivision::find_one_ring</a></div><div class="ttdeci">void find_one_ring(const Tri3Subdivision *elem, std::vector&lt; const Node *&gt; &amp;nodes)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__subdivision__support_8C_source.html#l00031">mesh_subdivision_support.C:31</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ae4aba5fa8c8579c6576b4f087aefb091"><div class="ttname"><a href="tecplot__io_8C.html#ae4aba5fa8c8579c6576b4f087aefb091">n_nodes</a></div><div class="ttdeci">const dof_id_type n_nodes</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_ac0363b6fc2b8355ff0416ac65b522066"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#ac0363b6fc2b8355ff0416ac65b522066">libMesh::FEInterface::extra_hanging_dofs</a></div><div class="ttdeci">static bool extra_hanging_dofs(const FEType &amp;fe_t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l01412">fe_interface.C:1412</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">libMesh::Elem::JUST_COARSENED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01202">elem.h:1202</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a580bf91fc4171dc3ae16441f9c03250d"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a580bf91fc4171dc3ae16441f9c03250d">libMesh::FEInterface::n_dofs_at_node_function</a></div><div class="ttdeci">static n_dofs_at_node_ptr n_dofs_at_node_function(const unsigned int dim, const FEType &amp;fe_t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00493">fe_interface.C:493</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a9d448e5766ac099a401541d191439d0b"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">libMesh::FEInterface::n_dofs_at_node</a></div><div class="ttdeci">static unsigned int n_dofs_at_node(const unsigned int dim, const FEType &amp;fe_t, const ElemType t, const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00473">fe_interface.C:473</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a78f9b38911ff4edec8d824d3272cc617"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a78f9b38911ff4edec8d824d3272cc617">libMesh::FEInterface::n_dofs_at_node_ptr</a></div><div class="ttdeci">unsigned int(* n_dofs_at_node_ptr)(const ElemType, const Order, const unsigned int)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8h_source.html#l00114">fe_interface.h:114</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">libMesh::Elem::JUST_REFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01201">elem.h:1201</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049"><div class="ttname"><a href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967a2282f4f6c2d162a4196a2537a7946049">libMesh::TRI3SUBDIVISION</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__elem__type_8h_source.html#l00069">enum_elem_type.h:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a47865aeb6379c68169e926dd0ecc2b71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47865aeb6379c68169e926dd0ecc2b71">&#9670;&nbsp;</a></span>prepare_send_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::prepare_send_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Takes the <code>_send_list</code> vector (which may have duplicate entries) and sorts it. The duplicate entries are then removed, resulting in a sorted <code>_send_list</code> with unique entries. Also calls any user-provided methods for adding to the send list. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01639">1639</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01569">_augment_send_list</a>, <a class="el" href="dof__map_8h_source.html#l01579">_extra_send_list_context</a>, <a class="el" href="dof__map_8h_source.html#l01574">_extra_send_list_function</a>, <a class="el" href="dof__map_8h_source.html#l01547">_send_list</a>, <a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html#af71fdda1b5ff26602fd804381349d5ff">libMesh::DofMap::AugmentSendList::augment_send_list()</a>, <a class="el" href="libmesh__common_8h_source.html#l00228">libMesh::out</a>, and <a class="el" href="variant__filter__iterator_8h_source.html#l00478">swap()</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00284">libMesh::EquationSystems::allgather()</a>, and <a class="el" href="system_8C_source.html#l00397">libMesh::System::reinit_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;{</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;prepare_send_list()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="comment">// Check to see if we have any extra stuff to add to the send_list</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">_extra_send_list_function</a>)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    {</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>)</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        {</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;          libmesh_here();</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;          <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;WARNING:  You have specified both an extra send list function and object.\n&quot;</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;          Are you sure this is what you meant to do??&quot;</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                       &lt;&lt; std::endl;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">_extra_send_list_function</a>(<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>, <a class="code" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a>);</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    }</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>)</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>-&gt;<a class="code" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html#af71fdda1b5ff26602fd804381349d5ff">augment_send_list</a> (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>);</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="comment">// First sort the send list.  After this</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">// duplicated elements will be adjacent in the</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="comment">// vector</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  std::sort(<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.end());</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <span class="comment">// Now use std::unique to remove duplicate entries</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  std::vector&lt;dof_id_type&gt;::iterator new_end =</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    std::unique (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.end());</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">// Remove the end of the send_list.  Use the &quot;swap trick&quot;</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="comment">// from Effective STL</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  std::vector&lt;dof_id_type&gt; (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), new_end).<a class="code" href="variant__filter__iterator_8h.html#a8e84acf9c8e70b7fa0b00795c4209f19">swap</a> (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_1_1AugmentSendList_html_af71fdda1b5ff26602fd804381349d5ff"><div class="ttname"><a href="classlibMesh_1_1DofMap_1_1AugmentSendList.html#af71fdda1b5ff26602fd804381349d5ff">libMesh::DofMap::AugmentSendList::augment_send_list</a></div><div class="ttdeci">virtual void augment_send_list(std::vector&lt; dof_id_type &gt; &amp;send_list)=0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a409a5dccf85edf7260f6186482cb9c9c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">libMesh::DofMap::_augment_send_list</a></div><div class="ttdeci">AugmentSendList * _augment_send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01569">dof_map.h:1569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6c450ba54bc8caffac28eed88a98a17d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">libMesh::DofMap::_extra_send_list_context</a></div><div class="ttdeci">void * _extra_send_list_context</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01579">dof_map.h:1579</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a8e84acf9c8e70b7fa0b00795c4209f19"><div class="ttname"><a href="variant__filter__iterator_8h.html#a8e84acf9c8e70b7fa0b00795c4209f19">swap</a></div><div class="ttdeci">void swap(Iterator &amp;lhs, Iterator &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00478">variant_filter_iterator.h:478</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad61a1aecc00b716b0cf00f68c68e7c80"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad61a1aecc00b716b0cf00f68c68e7c80">libMesh::DofMap::_extra_send_list_function</a></div><div class="ttdeci">void(* _extra_send_list_function)(std::vector&lt; dof_id_type &gt; &amp;, void *)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01574">dof_map.h:1574</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a63e3c3158308e2184c12b55ab9ea9a35"><div class="ttname"><a href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></div><div class="ttdeci">OStreamProxy out(std::cout)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00228">libmesh_common.h:228</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6419529efffb5e240d7365c778daab8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6419529efffb5e240d7365c778daab8e">&#9670;&nbsp;</a></span>print_dof_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::print_dof_constraints </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code><a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>print_nonlocal</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prints (from processor 0) all DoF and <a class="el" href="classlibMesh_1_1Node.html" title="A geometric point in (x,y,z) space associated with a DOF. ">Node</a> constraints. If <code>print_nonlocal</code> is true, then each constraint is printed once for each processor that knows about it, which may be useful for <code><a class="el" href="classlibMesh_1_1DistributedMesh.html" title="Mesh data structure which is distributed across all processors. ">DistributedMesh</a></code> debugging. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l01418">1418</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>
<div class="fragment"><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;{</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  parallel_object_only();</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  std::string local_constraints =</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af00f24f96d87b453b8c8233f5a828d60">get_local_constraints</a>(print_nonlocal);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a9fa78572d83d7756fbe6bc2b2c6337d7">send</a>(0, local_constraints);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Processor 0:\n&quot;</span>;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      os &lt;&lt; local_constraints;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p=1, np=this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>(); p != np; ++p)</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        {</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a751fba5447d0593802384b58b2136364">receive</a>(p, local_constraints);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot;Processor &quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span>;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;          os &lt;&lt; local_constraints;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        }</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af00f24f96d87b453b8c8233f5a828d60"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af00f24f96d87b453b8c8233f5a828d60">libMesh::DofMap::get_local_constraints</a></div><div class="ttdeci">std::string get_local_constraints(bool print_nonlocal=false) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01444">dof_map_constraints.C:1444</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a9fa78572d83d7756fbe6bc2b2c6337d7"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a9fa78572d83d7756fbe6bc2b2c6337d7">libMesh::Parallel::Communicator::send</a></div><div class="ttdeci">void send(const unsigned int dest_processor_id, const T &amp;buf, const MessageTag &amp;tag=no_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00261">parallel_implementation.h:261</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a751fba5447d0593802384b58b2136364"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a751fba5447d0593802384b58b2136364">libMesh::Parallel::Communicator::receive</a></div><div class="ttdeci">Status receive(const unsigned int dest_processor_id, T &amp;buf, const MessageTag &amp;tag=any_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00771">parallel_implementation.h:771</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f46edb253f11a90bfc5f824b45ed596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f46edb253f11a90bfc5f824b45ed596">&#9670;&nbsp;</a></span>print_info() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::print_info </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em> = <code><a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints the reference information, by default to <code><a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></code>. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8C_source.html#l00087">87</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p class="reference">References <a class="el" href="reference__counter_8h_source.html#l00141">libMesh::ReferenceCounter::_enable_print_counter</a>, and <a class="el" href="reference__counter_8C_source.html#l00047">libMesh::ReferenceCounter::get_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a>)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    out_stream &lt;&lt; <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">ReferenceCounter::get_info</a>();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a103b37125ae9eaaadf6f7854df17faa2"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">libMesh::ReferenceCounter::get_info</a></div><div class="ttdeci">static std::string get_info()</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8C_source.html#l00047">reference_counter.C:47</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00141">reference_counter.h:141</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac72dbf3012e202aa431d33287c6e3216"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac72dbf3012e202aa431d33287c6e3216">&#9670;&nbsp;</a></span>print_info() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::print_info </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code><a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prints summary info about the sparsity bandwidth and constraints. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02696">2696</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;{</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  os &lt;&lt; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae1a7473e230bd8db0b8196e92417f766">get_info</a>();</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ae1a7473e230bd8db0b8196e92417f766"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae1a7473e230bd8db0b8196e92417f766">libMesh::DofMap::get_info</a></div><div class="ttdeci">std::string get_info() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02703">dof_map.C:2703</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae07a8531f8f6a082a473c2e4b17a9ea2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae07a8531f8f6a082a473c2e4b17a9ea2">&#9670;&nbsp;</a></span>process_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::process_constraints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Postprocesses any constrained degrees of freedom to be constrained only in terms of unconstrained dofs, then adds unconstrained dofs to the send_list and prepares that for use. This should be run after both system (create_dof_constraints) and user constraints have all been added. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l03227">3227</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, and <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_8C_source.html#l00397">libMesh::System::reinit_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;{</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;  <span class="comment">// We&#39;ve computed our local constraints, but they may depend on</span></div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;  <span class="comment">// non-local constraints that we&#39;ll need to take into account.</span></div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a21fda1ca99f13ac340a05a8e41ecc8e9">allgather_recursive_constraints</a>(mesh);</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1DofMap.html#a33e3d8408ce7a9125dd1c22d1428fd97">_error_on_cyclic_constraint</a>)</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  {</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    <span class="comment">// Optionally check for cyclic constraints and throw an error</span></div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <span class="comment">// if they&#39;re detected. We always do this check below in dbg/devel</span></div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="comment">// mode but here we optionally do it in opt mode as well.</span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a30a6ab4b65749be311da80b48f312fd3">check_for_cyclic_constraints</a>();</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  }</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  RCSet unexpanded_set;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    unexpanded_set.insert(i.first);</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  <span class="keywordflow">while</span> (!unexpanded_set.empty())</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <span class="keywordflow">for</span> (RCSet::iterator i = unexpanded_set.begin();</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;         i != unexpanded_set.end(); <span class="comment">/* nothing */</span>)</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      {</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        <span class="comment">// If the DOF is constrained</span></div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        DofConstraints::iterator</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;          pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(*i);</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;        libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;        <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;        DofConstraintValueMap::iterator rhsit =</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;          <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(*i);</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;        <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> constraint_rhs = (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;          0 : rhsit-&gt;second;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        std::vector&lt;dof_id_type&gt; constraints_to_expand;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;        for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;          <span class="keywordflow">if</span> (item.first != *i &amp;&amp; this-&gt;is_constrained_dof(item.first))</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;            {</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;              unexpanded_set.insert(item.first);</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;              constraints_to_expand.push_back(item.first);</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;            }</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; expandable : constraints_to_expand)</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;          {</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> this_coef = constraint_row[expandable];</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;            DofConstraints::const_iterator</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;              subpos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(expandable);</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;            libmesh_assert (subpos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; subconstraint_row = subpos-&gt;second;</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : subconstraint_row)</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;              {</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                <span class="comment">// Assert that the constraint is not cyclic.</span></div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                libmesh_assert(item.first != expandable);</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                constraint_row[item.first] += item.second * this_coef;</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;              }</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;            DofConstraintValueMap::const_iterator subrhsit =</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(expandable);</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;            <span class="keywordflow">if</span> (subrhsit != <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;              constraint_rhs += subrhsit-&gt;second * this_coef;</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            constraint_row.erase(expandable);</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;          }</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;        <span class="keywordflow">if</span> (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;          {</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;            <span class="keywordflow">if</span> (constraint_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[*i] = constraint_rhs;</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(*i);</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;          }</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;          {</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;            <span class="keywordflow">if</span> (constraint_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;              rhsit-&gt;second = constraint_rhs;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(rhsit);</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;          }</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;        <span class="keywordflow">if</span> (constraints_to_expand.empty())</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;          i = unexpanded_set.erase(i);</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;          ++i;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      }</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;  <span class="comment">// In parallel we can&#39;t guarantee that nodes/dofs which constrain</span></div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;  <span class="comment">// others are on processors which are aware of that constraint, yet</span></div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;  <span class="comment">// we need such awareness for sparsity pattern generation.  So send</span></div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  <span class="comment">// other processors any constraints they might need to know about.</span></div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3db4816e2bba5ce9617e7bee6329de19">scatter_constraints</a>(mesh);</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;  <span class="comment">// Now that we have our root constraint dependencies sorted out, add</span></div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;  <span class="comment">// them to the send_list</span></div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0783b9a05a297be8f1c3e630301e0604">add_constraints_to_send_list</a>();</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a33e3d8408ce7a9125dd1c22d1428fd97"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a33e3d8408ce7a9125dd1c22d1428fd97">libMesh::DofMap::_error_on_cyclic_constraint</a></div><div class="ttdeci">bool _error_on_cyclic_constraint</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01493">dof_map.h:1493</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3db4816e2bba5ce9617e7bee6329de19"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3db4816e2bba5ce9617e7bee6329de19">libMesh::DofMap::scatter_constraints</a></div><div class="ttdeci">void scatter_constraints(MeshBase &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03432">dof_map_constraints.C:3432</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a21fda1ca99f13ac340a05a8e41ecc8e9"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a21fda1ca99f13ac340a05a8e41ecc8e9">libMesh::DofMap::allgather_recursive_constraints</a></div><div class="ttdeci">void allgather_recursive_constraints(MeshBase &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02595">dof_map_constraints.C:2595</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0783b9a05a297be8f1c3e630301e0604"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0783b9a05a297be8f1c3e630301e0604">libMesh::DofMap::add_constraints_to_send_list</a></div><div class="ttdeci">void add_constraints_to_send_list()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l04163">dof_map_constraints.C:4163</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a30a6ab4b65749be311da80b48f312fd3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a30a6ab4b65749be311da80b48f312fd3">libMesh::DofMap::check_for_cyclic_constraints</a></div><div class="ttdeci">void check_for_cyclic_constraints()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03334">dof_map_constraints.C:3334</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62700690227d24d28c853ab62d38ebb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62700690227d24d28c853ab62d38ebb9">&#9670;&nbsp;</a></span>processor_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libMesh::ParallelObject::processor_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The rank of this processor in the group. </dd></dl>

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00101">101</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00107">libMesh::ParallelObject::_communicator</a>, and <a class="el" href="communicator_8h_source.html#l00173">libMesh::Parallel::Communicator::rank()</a>.</p>

<p class="reference">Referenced by <a class="el" href="boundary__info_8C_source.html#l02412">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00143">libMesh::EquationSystems::_read_impl()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00340">libMesh::PetscDMWrapper::add_dofs_to_section()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00385">libMesh::DistributedMesh::add_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l00347">libMesh::BoundaryInfo::add_elements()</a>, <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00596">libMesh::DistributedMesh::add_node()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00969">libMesh::UnstructuredMesh::all_second_order()</a>, <a class="el" href="mesh__modification_8C_source.html#l00271">libMesh::MeshTools::Modification::all_tri()</a>, <a class="el" href="fem__system_8C_source.html#l00854">libMesh::FEMSystem::assembly()</a>, <a class="el" href="equation__systems_8C_source.html#l01055">libMesh::EquationSystems::build_discontinuous_solution_vector()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01695">libMesh::Nemesis_IO_Helper::build_element_and_node_maps()</a>, <a class="el" href="inf__elem__builder_8C_source.html#l00041">libMesh::InfElemBuilder::build_inf_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l01779">libMesh::BoundaryInfo::build_node_list_from_side_list()</a>, <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00764">libMesh::DistributedMesh::clear()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00795">libMesh::ExodusII_IO_Helper::close()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01846">libMesh::Nemesis_IO_Helper::compute_border_node_ids()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01171">libMesh::Nemesis_IO_Helper::compute_communication_map_parameters()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01249">libMesh::Nemesis_IO_Helper::compute_internal_and_border_elems_and_internal_nodes()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01096">libMesh::Nemesis_IO_Helper::compute_node_communication_maps()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01595">libMesh::Nemesis_IO_Helper::compute_num_global_elem_blocks()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01484">libMesh::Nemesis_IO_Helper::compute_num_global_nodesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01391">libMesh::Nemesis_IO_Helper::compute_num_global_sidesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02648">libMesh::Nemesis_IO_Helper::construct_nemesis_filename()</a>, <a class="el" href="mesh__tools_8C_source.html#l02259">libMesh::MeshTools::correct_node_proc_ids()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01079">libMesh::ExodusII_IO_Helper::create()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00515">libMesh::DistributedMesh::delete_elem()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00700">libMesh::DistributedMesh::delete_node()</a>, <a class="el" href="mesh__communication_8C_source.html#l01844">libMesh::MeshCommunication::delete_remote_elements()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01163">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">distribute_local_dofs_var_major()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00035">libMesh::DistributedMesh::DistributedMesh()</a>, <a class="el" href="dof__map_8h_source.html#l00644">end_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00667">end_old_dof()</a>, <a class="el" href="ensight__io_8C_source.html#l00064">libMesh::EnsightIO::EnsightIO()</a>, <a class="el" href="mesh__function_8C_source.html#l00674">libMesh::MeshFunction::find_element()</a>, <a class="el" href="mesh__function_8C_source.html#l00718">libMesh::MeshFunction::find_elements()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00240">libMesh::UnstructuredMesh::find_neighbors()</a>, <a class="el" href="dof__map_8h_source.html#l00602">first_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00612">first_old_dof()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00322">libMesh::Nemesis_IO_Helper::get_cmap_params()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00176">libMesh::Nemesis_IO_Helper::get_eb_info_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00407">libMesh::Nemesis_IO_Helper::get_elem_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00254">libMesh::Nemesis_IO_Helper::get_elem_map()</a>, <a class="el" href="mesh__base_8C_source.html#l00378">libMesh::MeshBase::get_info()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00085">libMesh::Nemesis_IO_Helper::get_init_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00205">libMesh::Nemesis_IO_Helper::get_init_info()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00224">libMesh::Nemesis_IO_Helper::get_loadbal_param()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00365">libMesh::Nemesis_IO_Helper::get_node_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00285">libMesh::Nemesis_IO_Helper::get_node_map()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00144">libMesh::Nemesis_IO_Helper::get_ns_param_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00108">libMesh::Nemesis_IO_Helper::get_ss_param_global()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00098">libMesh::SparsityPattern::Build::handle_vi_vj()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01119">libMesh::ExodusII_IO_Helper::initialize()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01695">libMesh::ExodusII_IO_Helper::initialize_element_variables()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01788">libMesh::ExodusII_IO_Helper::initialize_global_variables()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01760">libMesh::ExodusII_IO_Helper::initialize_nodal_variables()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00481">libMesh::DistributedMesh::insert_elem()</a>, <a class="el" href="dof__map_8C_source.html#l02413">is_evaluable()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00341">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="dof__map_8h_source.html#l00631">last_dof()</a>, <a class="el" href="mesh__tools_8C_source.html#l01671">libMesh::MeshTools::libmesh_assert_consistent_distributed()</a>, <a class="el" href="mesh__tools_8C_source.html#l01701">libMesh::MeshTools::libmesh_assert_consistent_distributed_nodes()</a>, <a class="el" href="mesh__tools_8C_source.html#l01598">libMesh::MeshTools::libmesh_assert_contiguous_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01777">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l02068">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00844">libMesh::DistributedMesh::libmesh_assert_valid_parallel_object_ids()</a>, <a class="el" href="dof__map_8C_source.html#l01076">local_variable_indices()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">libMesh::MeshRefinement::make_coarsening_compatible()</a>, <a class="el" href="mesh__base_8h_source.html#l00403">libMesh::MeshBase::n_active_local_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l01646">libMesh::BoundaryInfo::n_boundary_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01667">libMesh::BoundaryInfo::n_edge_conds()</a>, <a class="el" href="dof__map_8h_source.html#l00584">n_local_dofs()</a>, <a class="el" href="system_8C_source.html#l00187">libMesh::System::n_local_dofs()</a>, <a class="el" href="mesh__base_8h_source.html#l00386">libMesh::MeshBase::n_local_elem()</a>, <a class="el" href="mesh__base_8h_source.html#l00286">libMesh::MeshBase::n_local_nodes()</a>, <a class="el" href="boundary__info_8C_source.html#l01711">libMesh::BoundaryInfo::n_nodeset_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01689">libMesh::BoundaryInfo::n_shellface_conds()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00582">libMesh::DistributedMesh::own_node()</a>, <a class="el" href="system_8C_source.html#l02100">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02220">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01993">libMesh::System::point_value()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00573">libMesh::Nemesis_IO_Helper::put_cmap_params()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00659">libMesh::Nemesis_IO_Helper::put_elem_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00680">libMesh::Nemesis_IO_Helper::put_elem_map()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00547">libMesh::Nemesis_IO_Helper::put_loadbal_param()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00597">libMesh::Nemesis_IO_Helper::put_node_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00642">libMesh::Nemesis_IO_Helper::put_node_map()</a>, <a class="el" href="namebased__io_8C_source.html#l00059">libMesh::NameBasedIO::read()</a>, <a class="el" href="nemesis__io_8C_source.html#l00148">libMesh::Nemesis_IO::read()</a>, <a class="el" href="xdr__io_8C_source.html#l01250">libMesh::XdrIO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00750">libMesh::CheckpointIO::read()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00639">libMesh::ExodusII_IO_Helper::read_elem_num_map()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l02031">libMesh::ExodusII_IO_Helper::read_global_values()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00830">libMesh::CheckpointIO::read_header()</a>, <a class="el" href="xdr__io_8C_source.html#l01380">libMesh::XdrIO::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00115">libMesh::System::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00310">libMesh::System::read_legacy_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00489">libMesh::ExodusII_IO_Helper::read_node_num_map()</a>, <a class="el" href="system__io_8C_source.html#l00493">libMesh::System::read_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l01121">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l02061">libMesh::XdrIO::read_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l01841">libMesh::XdrIO::read_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l00811">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l01504">libMesh::XdrIO::read_serialized_connectivity()</a>, <a class="el" href="system__io_8C_source.html#l00725">libMesh::System::read_serialized_data()</a>, <a class="el" href="xdr__io_8C_source.html#l01690">libMesh::XdrIO::read_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01974">libMesh::XdrIO::read_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l01442">libMesh::XdrIO::read_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l01168">libMesh::System::read_serialized_vector()</a>, <a class="el" href="system__io_8C_source.html#l02203">libMesh::System::read_serialized_vectors()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00961">libMesh::DistributedMesh::renumber_dof_objects()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00186">libMesh::CheckpointIO::select_split_config()</a>, <a class="el" href="dof__map_8C_source.html#l00321">set_nonlocal_dof_objects()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00045">libMesh::LaplaceMeshSmoother::smooth()</a>, <a class="el" href="mesh__tools_8C_source.html#l00210">libMesh::MeshTools::total_weight()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">libMesh::MeshRefinement::uniformly_coarsen()</a>, <a class="el" href="parallel__elem_8C_source.html#l00354">libMesh::Parallel::Packing&lt; T &gt;::unpack()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00127">libMesh::DistributedMesh::update_parallel_id_counts()</a>, <a class="el" href="namebased__io_8C_source.html#l00276">libMesh::NameBasedIO::write()</a>, <a class="el" href="xdr__io_8C_source.html#l00168">libMesh::XdrIO::write()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00270">libMesh::CheckpointIO::write()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00378">libMesh::EquationSystems::write()</a>, <a class="el" href="gmv__io_8C_source.html#l01551">libMesh::GMVIO::write_discontinuous_gmv()</a>, <a class="el" href="exodusII__io_8C_source.html#l00599">libMesh::ExodusII_IO::write_element_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01865">libMesh::ExodusII_IO_Helper::write_element_values()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01324">libMesh::ExodusII_IO_Helper::write_elements()</a>, <a class="el" href="exodusII__io_8C_source.html#l00809">libMesh::ExodusII_IO::write_global_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l02009">libMesh::ExodusII_IO_Helper::write_global_values()</a>, <a class="el" href="system__io_8C_source.html#l01299">libMesh::System::write_header()</a>, <a class="el" href="exodusII__io_8C_source.html#l00796">libMesh::ExodusII_IO::write_information_records()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01970">libMesh::ExodusII_IO_Helper::write_information_records()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01208">libMesh::ExodusII_IO_Helper::write_nodal_coordinates()</a>, <a class="el" href="ucd__io_8C_source.html#l00324">libMesh::UCDIO::write_nodal_data()</a>, <a class="el" href="exodusII__io_8C_source.html#l00700">libMesh::ExodusII_IO::write_nodal_data()</a>, <a class="el" href="exodusII__io_8C_source.html#l00912">libMesh::ExodusII_IO::write_nodal_data_discontinuous()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01948">libMesh::ExodusII_IO_Helper::write_nodal_values()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01965">libMesh::Nemesis_IO_Helper::write_nodesets()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01653">libMesh::ExodusII_IO_Helper::write_nodesets()</a>, <a class="el" href="system__io_8C_source.html#l01504">libMesh::System::write_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l02101">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l01210">libMesh::XdrIO::write_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l00993">libMesh::XdrIO::write_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l01815">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00351">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="system__io_8C_source.html#l01704">libMesh::System::write_serialized_data()</a>, <a class="el" href="xdr__io_8C_source.html#l00710">libMesh::XdrIO::write_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01136">libMesh::XdrIO::write_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l00313">libMesh::XdrIO::write_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l02156">libMesh::System::write_serialized_vector()</a>, <a class="el" href="system__io_8C_source.html#l02297">libMesh::System::write_serialized_vectors()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02116">libMesh::Nemesis_IO_Helper::write_sidesets()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01544">libMesh::ExodusII_IO_Helper::write_sidesets()</a>, <a class="el" href="exodusII__io_8C_source.html#l00862">libMesh::ExodusII_IO::write_timestep()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01843">libMesh::ExodusII_IO_Helper::write_timestep()</a>, and <a class="el" href="exodusII__io_8C_source.html#l00104">libMesh::ExodusII_IO::write_timestep_discontinuous()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a2d45839ac93774286a0f4e72295a3837">rank</a>()); }</div><div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00107">parallel_object.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a2d45839ac93774286a0f4e72295a3837"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a2d45839ac93774286a0f4e72295a3837">libMesh::Parallel::Communicator::rank</a></div><div class="ttdeci">processor_id_type rank() const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8h_source.html#l00173">communicator.h:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abf4ed8e608b51a7a4e95935bf42ebbb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf4ed8e608b51a7a4e95935bf42ebbb1">&#9670;&nbsp;</a></span>reinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::reinit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reinitialize the underlying data structures conformal to the current mesh. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00474">474</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01587">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01319">_dof_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01655">_n_SCALAR_dofs</a>, <a class="el" href="variable_8h_source.html#l00136">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="coupling__matrix_8h_source.html#l00631">libMesh::CouplingMatrix::empty()</a>, <a class="el" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">libMesh::Utility::enum_to_string()</a>, <a class="el" href="libmesh__common_8h_source.html#l00229">libMesh::err</a>, <a class="el" href="fe__interface_8C_source.html#l01412">libMesh::FEInterface::extra_hanging_dofs()</a>, <a class="el" href="fe__type_8h_source.html#l00204">libMesh::FEType::family</a>, <a class="el" href="fe__type_8h_source.html#l00078">libMesh::OrderWrapper::get_order()</a>, <a class="el" href="dof__object_8h_source.html#l00913">libMesh::DofObject::has_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l00813">invalidate_dofs()</a>, <a class="el" href="elem_8h_source.html#l01201">libMesh::Elem::JUST_REFINED</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="fe__interface_8C_source.html#l01039">libMesh::FEInterface::max_order()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="fe__interface_8C_source.html#l00473">libMesh::FEInterface::n_dofs_at_node()</a>, <a class="el" href="fe__interface_8C_source.html#l00504">libMesh::FEInterface::n_dofs_per_elem()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00217">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l00541">n_variables()</a>, <a class="el" href="dof__object_8h_source.html#l00079">libMesh::DofObject::old_dof_object</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="dof__object_8C_source.html#l00352">libMesh::DofObject::set_n_comp_group()</a>, <a class="el" href="dof__object_8C_source.html#l00150">libMesh::DofObject::set_old_dof_object()</a>, <a class="el" href="dof__object_8h_source.html#l00960">libMesh::DofObject::set_vg_dof_base()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, <a class="el" href="dof__map_8C_source.html#l01682">use_coupled_neighbor_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>, and <a class="el" href="dof__object_8h_source.html#l00980">libMesh::DofObject::vg_dof_base()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;{</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  libmesh_assert (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.is_prepared());</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;reinit()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// We ought to reconfigure our default coupling functor.</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// The user might have removed it from our coupling functors set,</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// but if so, who cares, this reconfiguration is cheap.</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// Avoid calling set_dof_coupling() with an empty/non-nullptr</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// _dof_coupling matrix which may happen when there are actually no</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// variables on the system.</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a> &amp;&amp; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>-&gt;<a class="code" href="classlibMesh_1_1CouplingMatrix.html#a2d960665657f5ad20c3eaec655daf9b9">empty</a>() &amp;&amp; !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>())</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a> = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_dof_coupling(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">// By default we may want 0 or 1 levels of coupling</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> standard_n_levels =</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1bf72ada83076ab80eb67d568189f462">use_coupled_neighbor_dofs</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_n_levels</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    (<a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;n_levels(), standard_n_levels));</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// But we *don&#39;t* want to restrict to a CouplingMatrix unless the</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// user does so manually; the original libMesh behavior was to put</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// ghost indices on the send_list regardless of variable.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">//_default_evaluating-&gt;set_dof_coupling(this-&gt;_dof_coupling);</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(),</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// The DofObjects need to know how many variable groups we have, and</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">// how many variables there are in each group.</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  std::vector&lt;unsigned int&gt; n_vars_per_group;  n_vars_per_group.reserve (n_var_groups);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    n_vars_per_group.push_back (this-&gt;variable_group(vg).n_variables());</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// Clear the old_dof_objects for all the nodes</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// and elements so that we can overwrite them</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.node_ptr_range())</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      node-&gt;clear_old_dof_object();</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      libmesh_assert (!node-&gt;old_dof_object);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.element_ptr_range())</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      elem-&gt;clear_old_dof_object();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      libmesh_assert (!elem-&gt;old_dof_object);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// Set the old_dof_objects for the elements that</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// weren&#39;t just created, if these old dof objects</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">// had variables</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.element_ptr_range())</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="comment">// Skip the elements that were just refined</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;elem-&gt;n_nodes(); n++)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          Node &amp; node = elem-&gt;node_ref(n);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <span class="keywordflow">if</span> (node.old_dof_object == <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="keywordflow">if</span> (node.has_dofs(sys_num))</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;              node.set_old_dof_object();</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      libmesh_assert (!elem-&gt;old_dof_object);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;has_dofs(sys_num))</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        elem-&gt;set_old_dof_object();</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">#endif // #ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// Then set the number of variables for each \p DofObject</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">// equal to n_variables() for this system.  This will</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// handle new \p DofObjects that may have just been created</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// All the nodes</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.node_ptr_range())</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    node-&gt;set_n_vars_per_group(sys_num, n_vars_per_group);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// All the elements</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.element_ptr_range())</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    elem-&gt;set_n_vars_per_group(sys_num, n_vars_per_group);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// Zero _n_SCALAR_dofs, it will be updated below.</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> = 0;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// Next allocate space for the DOF indices</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; vg_description = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">variable_group</a>(vg);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_in_group = vg_description.n_variables();</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keyword">const</span> FEType &amp; base_fe_type        = vg_description.type();</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="comment">// Don&#39;t need to loop over elements for a SCALAR variable</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="comment">// Just increment _n_SCALAR_dofs</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">if</span> (base_fe_type.family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> += base_fe_type.order.get_order()*n_var_in_group;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="comment">// This should be constant even on p-refined elements</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> extra_hanging_dofs =</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="classlibMesh_1_1FEInterface.html#ac0363b6fc2b8355ff0416ac65b522066">FEInterface::extra_hanging_dofs</a>(base_fe_type);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="comment">// For all the active elements, count vertex degrees of freedom.</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_element_ptr_range())</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          libmesh_assert(elem);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <span class="comment">// Skip the numbering if this variable is</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          <span class="comment">// not active on this element&#39;s subdomain</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          <span class="keywordflow">if</span> (!vg_description.active_on_subdomain(elem-&gt;subdomain_id()))</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">ElemType</a> type = elem-&gt;type();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = elem-&gt;dim();</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          FEType fe_type = base_fe_type;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="comment">// Make sure we haven&#39;t done more p refinement than we can</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          <span class="comment">// handle</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;p_level() + base_fe_type.order &gt;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;              <a class="code" href="classlibMesh_1_1FEInterface.html#aa931485d398b0b9a877e380444ed959c">FEInterface::max_order</a>(base_fe_type, type))</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;              libmesh_assert_less_msg(static_cast&lt;unsigned int&gt;(base_fe_type.order.get_order()),</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                      <a class="code" href="classlibMesh_1_1FEInterface.html#aa931485d398b0b9a877e380444ed959c">FEInterface::max_order</a>(base_fe_type,type),</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                      <span class="stringliteral">&quot;ERROR: Finite element &quot;</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                      &lt;&lt; <a class="code" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">Utility::enum_to_string</a>(base_fe_type.family)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot; on geometric element &quot;</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                      &lt;&lt; <a class="code" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">Utility::enum_to_string</a>(type)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;\nonly supports FEInterface::max_order = &quot;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                      &lt;&lt; <a class="code" href="classlibMesh_1_1FEInterface.html#aa931485d398b0b9a877e380444ed959c">FEInterface::max_order</a>(base_fe_type,type)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                      &lt;&lt; <span class="stringliteral">&quot;, not fe_type.order = &quot;</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                      &lt;&lt; base_fe_type.order);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">#  ifdef DEBUG</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;              <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Finite element &quot;</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                           &lt;&lt; <a class="code" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">Utility::enum_to_string</a>(base_fe_type.family)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; on geometric element &quot;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                           &lt;&lt; <a class="code" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">Utility::enum_to_string</a>(type) &lt;&lt; std::endl</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;could not be p refined past FEInterface::max_order = &quot;</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                           &lt;&lt; <a class="code" href="classlibMesh_1_1FEInterface.html#aa931485d398b0b9a877e380444ed959c">FEInterface::max_order</a>(base_fe_type,type)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                           &lt;&lt; std::endl;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;              elem-&gt;set_p_level(<a class="code" href="classlibMesh_1_1FEInterface.html#aa931485d398b0b9a877e380444ed959c">FEInterface::max_order</a>(base_fe_type,type)</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                - base_fe_type.order);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;          fe_type.order = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a><span class="keyword">&gt;</span>(fe_type.order +</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                             elem-&gt;p_level());</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          <span class="comment">// Allocate the vertex DOFs</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;elem-&gt;n_nodes(); n++)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              Node &amp; node = elem-&gt;node_ref(n);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;is_vertex(n))</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_node_dofs =</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    node.n_comp_group(sys_num, vg);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vertex_dofs =</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(<a class="code" href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">FEInterface::n_dofs_at_node</a>(dim, fe_type,</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                                         type, n),</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                             old_node_dofs);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                  <span class="comment">// Some discontinuous FEs have no vertex dofs</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                  <span class="keywordflow">if</span> (vertex_dofs &gt; old_node_dofs)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                      node.set_n_comp_group(sys_num, vg,</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                            vertex_dofs);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                      <span class="comment">// Abusing dof_number to set a &quot;this is a</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                      <span class="comment">// vertex&quot; flag</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                      node.set_vg_dof_base(sys_num, vg,</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                           vertex_dofs);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                      <span class="comment">// libMesh::out &lt;&lt; &quot;sys_num,vg,old_node_dofs,vertex_dofs=&quot;</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                      <span class="comment">//       &lt;&lt; sys_num &lt;&lt; &quot;,&quot;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                      <span class="comment">//       &lt;&lt; vg &lt;&lt; &quot;,&quot;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                      <span class="comment">//       &lt;&lt; old_node_dofs &lt;&lt; &quot;,&quot;</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                      <span class="comment">//       &lt;&lt; vertex_dofs &lt;&lt; &#39;\n&#39;,</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                      <span class="comment">// node.debug_buffer();</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                      <span class="comment">// libmesh_assert_equal_to (vertex_dofs, node.n_comp(sys_num, vg));</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                      <span class="comment">// libmesh_assert_equal_to (vertex_dofs, node.vg_dof_base(sys_num, vg));</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        } <span class="comment">// done counting vertex dofs</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="comment">// count edge &amp; face dofs next</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.active_element_ptr_range())</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          libmesh_assert(elem);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="comment">// Skip the numbering if this variable is</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          <span class="comment">// not active on this element&#39;s subdomain</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          <span class="keywordflow">if</span> (!vg_description.active_on_subdomain(elem-&gt;subdomain_id()))</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">ElemType</a> type = elem-&gt;type();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = elem-&gt;dim();</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          FEType fe_type = base_fe_type;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          fe_type.order = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a><span class="keyword">&gt;</span>(fe_type.order +</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                             elem-&gt;p_level());</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          <span class="comment">// Allocate the edge and face DOFs</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;elem-&gt;n_nodes(); n++)</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;              Node &amp; node = elem-&gt;node_ref(n);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_node_dofs =</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                node.n_comp_group(sys_num, vg);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vertex_dofs = old_node_dofs?</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                cast_int&lt;unsigned int&gt;(node.vg_dof_base (sys_num,vg)):0;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_node_dofs =</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <a class="code" href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">FEInterface::n_dofs_at_node</a>(dim, fe_type, type, n);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;              <span class="comment">// We&#39;ve already allocated vertex DOFs</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;is_vertex(n))</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                  libmesh_assert_greater_equal (old_node_dofs, vertex_dofs);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                  <span class="comment">// //if (vertex_dofs &lt; new_node_dofs)</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                  <span class="comment">//   libMesh::out &lt;&lt; &quot;sys_num,vg,old_node_dofs,vertex_dofs,new_node_dofs=&quot;</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                  <span class="comment">//                &lt;&lt; sys_num &lt;&lt; &quot;,&quot;</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                  <span class="comment">//                &lt;&lt; vg &lt;&lt; &quot;,&quot;</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                  <span class="comment">//                &lt;&lt; old_node_dofs &lt;&lt; &quot;,&quot;</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                  <span class="comment">//                &lt;&lt; vertex_dofs &lt;&lt; &quot;,&quot;</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                  <span class="comment">//                &lt;&lt; new_node_dofs &lt;&lt; &#39;\n&#39;,</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                  <span class="comment">//     node.debug_buffer();</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                  libmesh_assert_greater_equal (vertex_dofs,   new_node_dofs);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;              <span class="comment">// We need to allocate the rest</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                  <span class="comment">// If this has no dofs yet, it needs no vertex</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                  <span class="comment">// dofs, so we just give it edge or face dofs</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                  <span class="keywordflow">if</span> (!old_node_dofs)</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                      node.set_n_comp_group(sys_num, vg,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                            new_node_dofs);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                      <span class="comment">// Abusing dof_number to set a &quot;this has no</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                      <span class="comment">// vertex dofs&quot; flag</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        node.set_vg_dof_base(sys_num, vg, 0);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                  <span class="comment">// If this has dofs, but has no vertex dofs,</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                  <span class="comment">// it may still need more edge or face dofs if</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                  <span class="comment">// we&#39;re p-refined.</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vertex_dofs == 0)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs &gt; old_node_dofs)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                          node.set_n_comp_group(sys_num, vg,</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                                new_node_dofs);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                          node.set_vg_dof_base(sys_num, vg,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                               vertex_dofs);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                        }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                  <span class="comment">// If this is another element&#39;s vertex,</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                  <span class="comment">// add more (non-overlapping) edge/face dofs if</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                  <span class="comment">// necessary</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (extra_hanging_dofs)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                    {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs &gt; old_node_dofs - vertex_dofs)</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                        {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                          node.set_n_comp_group(sys_num, vg,</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                                vertex_dofs + new_node_dofs);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                          node.set_vg_dof_base(sys_num, vg,</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                               vertex_dofs);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                        }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                  <span class="comment">// If this is another element&#39;s vertex, add any</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                  <span class="comment">// (overlapping) edge/face dofs if necessary</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                      libmesh_assert_greater_equal (old_node_dofs, vertex_dofs);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs &gt; old_node_dofs)</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                          node.set_n_comp_group(sys_num, vg,</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                                new_node_dofs);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                          node.set_vg_dof_base (sys_num, vg,</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                                vertex_dofs);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                        }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          <span class="comment">// Allocate the element DOFs</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_elem =</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <a class="code" href="classlibMesh_1_1FEInterface.html#aaf96d4ec7921d2f2a1d4cdbdbc63656a">FEInterface::n_dofs_per_elem</a>(dim, fe_type,</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                         type);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          elem-&gt;set_n_comp_group(sys_num, vg, dofs_per_elem);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    } <span class="comment">// end loop over variable groups</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">// Calling DofMap::reinit() by itself makes little sense,</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">// so we won&#39;t bother with nonlocal DofObjects.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// Those will be fixed by distribute_dofs</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// Finally, clear all the current DOF indices</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// (distribute_dofs expects them cleared!)</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afd8f3f26dfcdeaa8d024516ea750127c">invalidate_dofs</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1FEInterface_html_aaf96d4ec7921d2f2a1d4cdbdbc63656a"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#aaf96d4ec7921d2f2a1d4cdbdbc63656a">libMesh::FEInterface::n_dofs_per_elem</a></div><div class="ttdeci">static unsigned int n_dofs_per_elem(const unsigned int dim, const FEType &amp;fe_t, const ElemType t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00504">fe_interface.C:504</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a3f482b3acb4beb528f0ce89f161ff967"><div class="ttname"><a href="namespacelibMesh.html#a3f482b3acb4beb528f0ce89f161ff967">libMesh::ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition:</b> <a href="enum__elem__type_8h_source.html#l00033">enum_elem_type.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af3eb3e8751995b944fc135ea53b09da2"><div class="ttname"><a href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">libMesh::Order</a></div><div class="ttdeci">Order</div><div class="ttdef"><b>Definition:</b> <a href="enum__order_8h_source.html#l00040">enum_order.h:40</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a25b3182cbf57ead72821d826275512b0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00541">dof_map.h:541</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1bf72ada83076ab80eb67d568189f462"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1bf72ada83076ab80eb67d568189f462">libMesh::DofMap::use_coupled_neighbor_dofs</a></div><div class="ttdeci">bool use_coupled_neighbor_dofs(const MeshBase &amp;mesh) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01682">dof_map.C:1682</a></div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_aa931485d398b0b9a877e380444ed959c"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#aa931485d398b0b9a877e380444ed959c">libMesh::FEInterface::max_order</a></div><div class="ttdeci">static unsigned int max_order(const FEType &amp;fe_t, const ElemType &amp;el_t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l01039">fe_interface.C:1039</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1CouplingMatrix_html_a2d960665657f5ad20c3eaec655daf9b9"><div class="ttname"><a href="classlibMesh_1_1CouplingMatrix.html#a2d960665657f5ad20c3eaec655daf9b9">libMesh::CouplingMatrix::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="coupling__matrix_8h_source.html#l00631">coupling_matrix.h:631</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01655">dof_map.h:1655</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_ac0363b6fc2b8355ff0416ac65b522066"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#ac0363b6fc2b8355ff0416ac65b522066">libMesh::FEInterface::extra_hanging_dofs</a></div><div class="ttdeci">static bool extra_hanging_dofs(const FEType &amp;fe_t)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l01412">fe_interface.C:1412</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7df4304dec439a5cabd1d7008a2e3e45"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7df4304dec439a5cabd1d7008a2e3e45">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01752">dof_map.h:1752</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01319">dof_map.h:1319</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a74e5bc8a72d210b3d87b0221b1f69db1"><div class="ttname"><a href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a></div><div class="ttdeci">OStreamProxy err(std::cerr)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00229">libmesh_common.h:229</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Utility_html_aa99a42a5efab878469e7f58e5c033335"><div class="ttname"><a href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">libMesh::Utility::enum_to_string</a></div><div class="ttdeci">std::string enum_to_string(const T e)</div></div>
<div class="ttc" id="classlibMesh_1_1FEInterface_html_a9d448e5766ac099a401541d191439d0b"><div class="ttname"><a href="classlibMesh_1_1FEInterface.html#a9d448e5766ac099a401541d191439d0b">libMesh::FEInterface::n_dofs_at_node</a></div><div class="ttdeci">static unsigned int n_dofs_at_node(const unsigned int dim, const FEType &amp;fe_t, const ElemType t, const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface_8C_source.html#l00473">fe_interface.C:473</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_afd8f3f26dfcdeaa8d024516ea750127c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#afd8f3f26dfcdeaa8d024516ea750127c">libMesh::DofMap::invalidate_dofs</a></div><div class="ttdeci">void invalidate_dofs(MeshBase &amp;mesh) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00813">dof_map.C:813</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01587">dof_map.h:1587</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">libMesh::Elem::JUST_REFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01201">elem.h:1201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b0fefa113360f285feebc78bd3d27f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b0fefa113360f285feebc78bd3d27f5">&#9670;&nbsp;</a></span>remove_adjoint_dirichlet_boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_adjoint_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes from the system the specified Dirichlet boundary for the adjoint equation defined by Quantity of interest index q </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04336">4336</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dirichlet__boundaries_8h_source.html#l00174">libMesh::DirichletBoundary::b</a>, <a class="el" href="variant__filter__iterator_8h_source.html#l00343">end</a>, and <a class="el" href="dirichlet__boundaries_8h_source.html#l00175">libMesh::DirichletBoundary::variables</a>.</p>
<div class="fragment"><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;{</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;  libmesh_assert_greater(<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>.size(),</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;                         qoi_index);</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  <span class="keyword">auto</span> lam = [&amp;boundary_to_remove](<span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> * bdy)</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    {<span class="keywordflow">return</span> bdy-&gt;b == boundary_to_remove.b &amp;&amp; bdy-&gt;variables == boundary_to_remove.variables;};</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;  <span class="keyword">auto</span> it = std::find_if(<a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;begin(),</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;                         <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;<a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>(),</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;                         lam);</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;  <span class="comment">// Delete it and remove it</span></div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  libmesh_assert (it != <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;<a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>());</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  <span class="keyword">delete</span> *it;</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;erase(it);</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DirichletBoundary_html"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundary.html">libMesh::DirichletBoundary</a></div><div class="ttdoc">Class for specifying Dirichlet boundary conditions as constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00089">dirichlet_boundaries.h:89</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a785f0bd261d7bd1918b031c5133da2b9"><div class="ttname"><a href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a></div><div class="ttdeci">IterBase * end</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00343">variant_filter_iterator.h:343</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7e77603adbd2d7c119334ff2ce82a877"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7e77603adbd2d7c119334ff2ce82a877">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; DirichletBoundaries * &gt; _adjoint_dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01727">dof_map.h:1727</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bf50c47e4d226197777f2aef750b47d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bf50c47e4d226197777f2aef750b47d">&#9670;&nbsp;</a></span>remove_algebraic_ghosting_functor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_algebraic_ghosting_functor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;&#160;</td>
          <td class="paramname"><em>evaluable_functor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes a functor which was previously added to the set of algebraic ghosting functors, from both this <a class="el" href="classlibMesh_1_1DofMap.html" title="Manages the degrees of freedom (DOFs) in a simulation. ">DofMap</a> and from the underlying mesh. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01840">1840</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01605">_algebraic_ghosting_functors</a>, <a class="el" href="dof__map_8h_source.html#l01518">_mesh</a>, and <a class="el" href="mesh__base_8C_source.html#l00281">libMesh::MeshBase::remove_ghosting_functor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01792">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;{</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.erase(&amp;evaluable_functor);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">remove_ghosting_functor</a>(evaluable_functor);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshBase_html_a617b958e22a85c29f02af80867367daa"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">libMesh::MeshBase::remove_ghosting_functor</a></div><div class="ttdeci">void remove_ghosting_functor(GhostingFunctor &amp;ghosting_functor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00281">mesh_base.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01605">dof_map.h:1605</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01518">dof_map.h:1518</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f8cd289185341279958ce2baaed3fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f8cd289185341279958ce2baaed3fc0">&#9670;&nbsp;</a></span>remove_coupling_functor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_coupling_functor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> &amp;&#160;</td>
          <td class="paramname"><em>coupling_functor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes a functor which was previously added to the set of coupling functors, from both this <a class="el" href="classlibMesh_1_1DofMap.html" title="Manages the degrees of freedom (DOFs) in a simulation. ">DofMap</a> and from the underlying mesh. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01820">1820</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01618">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01518">_mesh</a>, and <a class="el" href="mesh__base_8C_source.html#l00281">libMesh::MeshBase::remove_ghosting_functor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01792">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;{</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.erase(&amp;coupling_functor);</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">remove_ghosting_functor</a>(coupling_functor);</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshBase_html_a617b958e22a85c29f02af80867367daa"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a617b958e22a85c29f02af80867367daa">libMesh::MeshBase::remove_ghosting_functor</a></div><div class="ttdeci">void remove_ghosting_functor(GhostingFunctor &amp;ghosting_functor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00281">mesh_base.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01618">dof_map.h:1618</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01518">dof_map.h:1518</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02a5778a146177c6965d1bf997878ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02a5778a146177c6965d1bf997878ca4">&#9670;&nbsp;</a></span>remove_default_ghosting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_default_ghosting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove any default ghosting functor(s). User-added ghosting functors will be unaffected.</p>
<p>Unless user-added equivalent ghosting functors exist, removing the default coupling functor is only safe for explicit solves, and removing the default algebraic ghosting functor is only safe for codes where no evaluations on neighbor cells (e.g. no jump error estimators) are done.</p>
<p>Defaults can be restored manually via <a class="el" href="classlibMesh_1_1DofMap.html#a71555fd980f9337928ae75bc36a1bd4e">add_default_ghosting()</a>, or automatically if <a class="el" href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784">clear()</a> returns the <a class="el" href="classlibMesh_1_1DofMap.html" title="Manages the degrees of freedom (DOFs) in a simulation. ">DofMap</a> to a default state. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01792">1792</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l00379">default_algebraic_ghosting()</a>, <a class="el" href="dof__map_8h_source.html#l00329">default_coupling()</a>, <a class="el" href="dof__map_8C_source.html#l01840">remove_algebraic_ghosting_functor()</a>, and <a class="el" href="dof__map_8C_source.html#l01820">remove_coupling_functor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00322">libMesh::EquationSystems::enable_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;{</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2f8cd289185341279958ce2baaed3fc0">remove_coupling_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">default_coupling</a>());</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5bf50c47e4d226197777f2aef750b47d">remove_algebraic_ghosting_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">default_algebraic_ghosting</a>());</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aa387f2af29a1998bc1236a20a9870b64"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">libMesh::DofMap::default_coupling</a></div><div class="ttdeci">DefaultCoupling &amp; default_coupling()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00329">dof_map.h:329</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac341c27edd859113d774716d5ad18d9f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">libMesh::DofMap::default_algebraic_ghosting</a></div><div class="ttdeci">DefaultCoupling &amp; default_algebraic_ghosting()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00379">dof_map.h:379</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2f8cd289185341279958ce2baaed3fc0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2f8cd289185341279958ce2baaed3fc0">libMesh::DofMap::remove_coupling_functor</a></div><div class="ttdeci">void remove_coupling_functor(GhostingFunctor &amp;coupling_functor)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01820">dof_map.C:1820</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5bf50c47e4d226197777f2aef750b47d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5bf50c47e4d226197777f2aef750b47d">libMesh::DofMap::remove_algebraic_ghosting_functor</a></div><div class="ttdeci">void remove_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01840">dof_map.C:1840</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6183b4266a0562a8e53f898d685c689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6183b4266a0562a8e53f898d685c689">&#9670;&nbsp;</a></span>remove_dirichlet_boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes the specified Dirichlet boundary from the system. </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l04321">4321</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="dirichlet__boundaries_8h_source.html#l00174">libMesh::DirichletBoundary::b</a>, and <a class="el" href="dirichlet__boundaries_8h_source.html#l00175">libMesh::DirichletBoundary::variables</a>.</p>
<div class="fragment"><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;{</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;  <span class="comment">// Find a boundary condition matching the one to be removed</span></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;  <span class="keyword">auto</span> lam = [&amp;boundary_to_remove](<span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> * bdy)</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    {<span class="keywordflow">return</span> bdy-&gt;b == boundary_to_remove.b &amp;&amp; bdy-&gt;variables == boundary_to_remove.variables;};</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;  <span class="keyword">auto</span> it = std::find_if(<a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;end(), lam);</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;  <span class="comment">// Delete it and remove it</span></div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  libmesh_assert (it != <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;end());</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;  <span class="keyword">delete</span> *it;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;erase(it);</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01721">dof_map.h:1721</a></div></div>
<div class="ttc" id="classlibMesh_1_1DirichletBoundary_html"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundary.html">libMesh::DirichletBoundary</a></div><div class="ttdoc">Class for specifying Dirichlet boundary conditions as constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00089">dirichlet_boundaries.h:89</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6ef75ddf2020ea30f1200cd317c0126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6ef75ddf2020ea30f1200cd317c0126">&#9670;&nbsp;</a></span>SCALAR_dof_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::SCALAR_dof_indices </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>old_dofs</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the vector <code>di</code> with the global degree of freedom indices corresponding to the SCALAR variable vn. If old_dofs=true, the old SCALAR dof indices are returned.</p>
<dl class="section note"><dt>Note</dt><dd>We do not need to pass in an element since SCALARs are global variables. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02348">2348</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01678">_first_old_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01541">_first_scalar_df</a>, <a class="el" href="fe__type_8h_source.html#l00078">libMesh::OrderWrapper::get_order()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l01271">n_old_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00579">n_SCALAR_dofs()</a>, <a class="el" href="fe__type_8h_source.html#l00198">libMesh::FEType::order</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="variable_8h_source.html#l00119">libMesh::Variable::type()</a>, and <a class="el" href="dof__map_8h_source.html#l01762">variable()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01930">dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l01076">local_variable_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02434">old_dof_indices()</a>, <a class="el" href="system__projection_8C_source.html#l00877">libMesh::System::project_vector()</a>, <a class="el" href="system__projection_8C_source.html#l00730">libMesh::System::projection_matrix()</a>, <a class="el" href="system__io_8C_source.html#l00493">libMesh::System::read_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l01121">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="system__io_8C_source.html#l01504">libMesh::System::write_parallel_data()</a>, and <a class="el" href="system__io_8C_source.html#l02101">libMesh::System::write_SCALAR_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;{</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;SCALAR_dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">variable</a>(vn).type().family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <span class="comment">// If we&#39;re asking for old dofs then we&#39;d better have some</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="keywordflow">if</span> (old_dofs)</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    libmesh_assert_greater_equal(<a class="code" href="classlibMesh_1_1DofMap.html#ae68477b8c280a345eda62d7aa1c6bfc1">n_old_dofs</a>(), <a class="code" href="classlibMesh_1_1DofMap.html#af31c7dfd8d972d20ca28e945565a5526">n_SCALAR_dofs</a>());</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_idx = old_dofs ?</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a>[vn] : this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>[vn];</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_idx = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>[vn];</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  libmesh_assert_not_equal_to(my_idx, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="comment">// The number of SCALAR dofs comes from the variable order</span></div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> n_dofs_vn = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">variable</a>(vn).<a class="code" href="classlibMesh_1_1Variable.html#aa7797f0c1f213275a78839e86bcda3c8">type</a>().<a class="code" href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">order</a>.<a class="code" href="classlibMesh_1_1OrderWrapper.html#af61af3996f36c55351b90b820ea9fb3e">get_order</a>();</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  di.resize(n_dofs_vn);</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != n_dofs_vn; ++i)</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    di[i] = my_idx++;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af31c7dfd8d972d20ca28e945565a5526"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af31c7dfd8d972d20ca28e945565a5526">libMesh::DofMap::n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type n_SCALAR_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00579">dof_map.h:579</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEType_html_a8a4f7c664bddf007599e8087871c6785"><div class="ttname"><a href="classlibMesh_1_1FEType.html#a8a4f7c664bddf007599e8087871c6785">libMesh::FEType::order</a></div><div class="ttdeci">OrderWrapper order</div><div class="ttdef"><b>Definition:</b> <a href="fe__type_8h_source.html#l00198">fe_type.h:198</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae68477b8c280a345eda62d7aa1c6bfc1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae68477b8c280a345eda62d7aa1c6bfc1">libMesh::DofMap::n_old_dofs</a></div><div class="ttdeci">dof_id_type n_old_dofs() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01271">dof_map.h:1271</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01541">dof_map.h:1541</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01678">dof_map.h:1678</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a46ed397847e6a1c3be2236e2faf622ec"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a46ed397847e6a1c3be2236e2faf622ec">libMesh::DofMap::variable</a></div><div class="ttdeci">const Variable &amp; variable(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01762">dof_map.h:1762</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1OrderWrapper_html_af61af3996f36c55351b90b820ea9fb3e"><div class="ttname"><a href="classlibMesh_1_1OrderWrapper.html#af61af3996f36c55351b90b820ea9fb3e">libMesh::OrderWrapper::get_order</a></div><div class="ttdeci">int get_order() const</div><div class="ttdef"><b>Definition:</b> <a href="fe__type_8h_source.html#l00078">fe_type.h:78</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1Variable_html_aa7797f0c1f213275a78839e86bcda3c8"><div class="ttname"><a href="classlibMesh_1_1Variable.html#aa7797f0c1f213275a78839e86bcda3c8">libMesh::Variable::type</a></div><div class="ttdeci">const FEType &amp; type() const</div><div class="ttdef"><b>Definition:</b> <a href="variable_8h_source.html#l00119">variable.h:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3db4816e2bba5ce9617e7bee6329de19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3db4816e2bba5ce9617e7bee6329de19">&#9670;&nbsp;</a></span>scatter_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::scatter_constraints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sends constraint equations to constraining processors </p>

<p class="definition">Definition at line <a class="el" href="dof__map__constraints_8C_source.html#l03432">3432</a> of file <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1MeshBase.html#a99742bad0b034a29ccae8c5a90c6f4aa">libMesh::MeshBase::active_local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a2e27f54d33f7539c0c06b36adae36cda">libMesh::MeshBase::active_local_elements_end()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">libMesh::MeshBase::active_not_local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">libMesh::MeshBase::active_not_local_elements_end()</a>, <a class="el" href="simple__range_8h_source.html#l00057">libMesh::as_range()</a>, <a class="el" href="variant__filter__iterator_8h_source.html#l00337">data</a>, <a class="el" href="variant__filter__iterator_8h_source.html#l00343">end</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="int__range_8h_source.html#l00104">libMesh::index_range()</a>, <a class="el" href="mesh__base_8h_source.html#l00154">libMesh::MeshBase::is_serial()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">libMesh::MeshBase::node_ptr()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="parallel__sync_8h_source.html#l00239">libMesh::Parallel::push_parallel_vector_data()</a>, <a class="el" href="type__vector_8h_source.html#l00901">libMesh::TypeVector&lt; T &gt;::size()</a>, and <a class="el" href="request_8C_source.html#l00213">libMesh::Parallel::wait()</a>.</p>
<div class="fragment"><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;{</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  <span class="comment">// At this point each processor with a constrained node knows</span></div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;  <span class="comment">// the corresponding constraint row, but we also need each processor</span></div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;  <span class="comment">// with a constrainer node to know the corresponding row(s).</span></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;  parallel_object_only();</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  <span class="comment">// Return immediately if there&#39;s nothing to gather</span></div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>() == 1)</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;  <span class="comment">// We might get to return immediately if none of the processors</span></div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;  <span class="comment">// found any constraints</span></div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> has_constraints = !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty()</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    || !<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.empty()</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    ;</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(has_constraints);</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;  <span class="keywordflow">if</span> (!has_constraints)</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  <span class="comment">// We may be receiving packed_range sends out of order with</span></div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;  <span class="comment">// parallel_sync tags, so make sure they&#39;re received correctly.</span></div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  <a class="code" href="classlibMesh_1_1Parallel_1_1MessageTag.html">Parallel::MessageTag</a> range_tag = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">get_unique_tag</a>(1414);</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;  std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_node_ids;</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_ids;</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  <span class="comment">// Collect the dof constraints I need to push to each processor</span></div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_proc_id = 0;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    {</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = i.first;</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;      <span class="keywordflow">while</span> (constrained &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[constrained_proc_id])</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        constrained_proc_id++;</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;      <span class="keywordflow">if</span> (constrained_proc_id != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;      <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = i.second;</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        {</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining = j.first;</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;          <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> constraining_proc_id = 0;</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;          <span class="keywordflow">while</span> (constraining &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[constraining_proc_id])</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;            constraining_proc_id++;</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;          <span class="keywordflow">if</span> (constraining_proc_id != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>() &amp;&amp;</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;              constraining_proc_id != constrained_proc_id)</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            pushed_ids[constraining_proc_id].insert(constrained);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        }</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    }</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;  <span class="comment">// Pack the dof constraint rows and rhs&#39;s to push</span></div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;  std::map&lt;<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;          std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt;&gt;</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    pushed_keys_vals, pushed_keys_vals_to_me;</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;std::pair&lt;dof_id_type, Number&gt;&gt;&gt;</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    pushed_ids_rhss, pushed_ids_rhss_to_me;</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;  <span class="keyword">auto</span> gather_ids =</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    [<span class="keyword">this</span>,</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;     &amp; pushed_ids,</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;     &amp; pushed_keys_vals,</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;     &amp; pushed_ids_rhss]</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    ()</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    {</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pid_id_pair : pushed_ids)</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        {</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = pid_id_pair.first;</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;          <span class="keyword">const</span> std::set&lt;dof_id_type&gt;</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;            &amp; pid_ids = pid_id_pair.second;</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;          <span class="keyword">const</span> std::size_t ids_size = pid_ids.size();</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;          std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt; &amp;</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;            keys_vals = pushed_keys_vals[pid];</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;          std::vector&lt;std::pair&lt;dof_id_type,Number&gt;&gt; &amp;</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;            ids_rhss = pushed_ids_rhss[pid];</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;          keys_vals.resize(ids_size);</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;          ids_rhss.resize(ids_size);</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;          std::size_t push_i;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;          std::set&lt;dof_id_type&gt;::const_iterator it;</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;          <span class="keywordflow">for</span> (push_i = 0, it = pid_ids.begin();</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;               it != pid_ids.end(); ++push_i, ++it)</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;            {</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = *it;</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;              <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;              keys_vals[push_i].assign(row.begin(), row.end());</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;              DofConstraintValueMap::const_iterator rhsit =</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(constrained);</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;              ids_rhss[push_i].first = constrained;</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;              ids_rhss[push_i].second =</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                0 : rhsit-&gt;second;</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            }</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;        }</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    };</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;  gather_ids();</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;  <span class="keyword">auto</span> ids_rhss_action_functor =</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    [&amp; pushed_ids_rhss_to_me]</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, Number&gt;&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    {</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      pushed_ids_rhss_to_me[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    };</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;  <span class="keyword">auto</span> keys_vals_action_functor =</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    [&amp; pushed_keys_vals_to_me]</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    {</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      pushed_keys_vals_to_me[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    };</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;  <span class="comment">// Trade pushed dof constraint rows</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_ids_rhss, ids_rhss_action_functor);</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_keys_vals, keys_vals_action_functor);</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;  <span class="comment">// Now work on traded dof constraint rows</span></div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  <span class="keyword">auto</span> receive_dof_constraints =</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    [<span class="keyword">this</span>,</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;     &amp; pushed_ids_rhss_to_me,</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;     &amp; pushed_keys_vals_to_me]</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    ()</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    {</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pid_id_pair : pushed_ids_rhss_to_me)</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        {</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = pid_id_pair.first;</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> &amp; ids_rhss = pid_id_pair.second;</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> &amp; keys_vals = pushed_keys_vals_to_me[pid];</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;          libmesh_assert_equal_to</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;            (ids_rhss.size(), keys_vals.size());</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;          <span class="comment">// Add the dof constraints that I&#39;ve been sent</span></div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(ids_rhss))</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            {</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids_rhss[i].first;</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;              <span class="comment">// If we don&#39;t already have a constraint for this dof,</span></div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;              <span class="comment">// add the one we were sent</span></div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;              <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">is_constrained_dof</a>(constrained))</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                {</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; key_val : keys_vals[i])</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                    {</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                      row[key_val.first] = key_val.second;</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;                    }</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                  <span class="keywordflow">if</span> (ids_rhss[i].second != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[constrained] =</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                      ids_rhss[i].second;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(constrained);</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;                }</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            }</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;        }</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    };</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  receive_dof_constraints();</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;  <span class="comment">// Collect the node constraints to push to each processor</span></div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;    {</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained = i.first;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <span class="keywordflow">if</span> (constrained-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;      <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = i.second.first;</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;        {</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;          <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constraining = j.first;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;          <span class="keywordflow">if</span> (constraining-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>() &amp;&amp;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;              constraining-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != constrained-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>())</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;            pushed_node_ids[constraining-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>()].insert(constrained-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">id</a>());</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;        }</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    }</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;  <span class="comment">// Pack the node constraint rows and rhss to push</span></div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;  std::map&lt;<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;          std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt;&gt;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    pushed_node_keys_vals, pushed_node_keys_vals_to_me;</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;std::pair&lt;dof_id_type, Point&gt;&gt;&gt;</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    pushed_node_ids_offsets, pushed_node_ids_offsets_to_me;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  std::map&lt;processor_id_type, std::set&lt;const Node *&gt;&gt; pushed_nodes;</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pid_id_pair : pushed_node_ids)</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    {</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = pid_id_pair.first;</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;      <span class="keyword">const</span> std::set&lt;dof_id_type&gt;</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;        &amp; pid_ids = pid_id_pair.second;</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;      <span class="keyword">const</span> std::size_t ids_size = pid_ids.size();</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;      std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt; &amp;</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        keys_vals = pushed_node_keys_vals[pid];</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      std::vector&lt;std::pair&lt;dof_id_type, Point&gt;&gt; &amp;</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;        ids_offsets = pushed_node_ids_offsets[pid];</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;      keys_vals.resize(ids_size);</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      ids_offsets.resize(ids_size);</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      std::set&lt;const Node *&gt; &amp; nodes = pushed_nodes[pid];</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      std::size_t push_i;</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      std::set&lt;dof_id_type&gt;::const_iterator it;</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <span class="keywordflow">for</span> (push_i = 0, it = pid_ids.begin();</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;           it != pid_ids.end(); ++push_i, ++it)</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;        {</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;          <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(*it);</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;          <span class="keywordflow">if</span> (constrained-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != pid)</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;            nodes.insert(constrained);</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;          <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].first;</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;          std::size_t row_size = row.size();</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;          keys_vals[push_i].reserve(row_size);</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            {</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;              <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constraining = j.first;</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;              keys_vals[push_i].push_back</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;                (std::make_pair(constraining-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">id</a>(), j.second));</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;              <span class="keywordflow">if</span> (constraining-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() != pid)</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;                nodes.insert(constraining);</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;            }</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;          ids_offsets[push_i].first = *it;</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;          ids_offsets[push_i].second = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].second;</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;        }</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    }</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  <span class="keyword">auto</span> node_ids_offsets_action_functor =</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;    [&amp; pushed_node_ids_offsets_to_me]</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, Point&gt;&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    {</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;      pushed_node_ids_offsets_to_me[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    };</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;  <span class="keyword">auto</span> node_keys_vals_action_functor =</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    [&amp; pushed_node_keys_vals_to_me]</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid,</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    {</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      pushed_node_keys_vals_to_me[pid] = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>;</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    };</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  <span class="comment">// Trade pushed node constraint rows</span></div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_node_ids_offsets, node_ids_offsets_action_functor);</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_node_keys_vals, node_keys_vals_action_functor);</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  <span class="comment">// Constraining nodes might not even exist on our subset of a</span></div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;  <span class="comment">// distributed mesh, so let&#39;s make them exist.</span></div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;  std::vector&lt;Parallel::Request&gt; send_requests;</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>())</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    {</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pid_id_pair : pushed_node_ids_offsets)</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;        {</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = pid_id_pair.first;</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;          send_requests.push_back(<a class="code" href="classlibMesh_1_1Parallel_1_1Request.html">Parallel::Request</a>());</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a74c8d3e50dde49ce417d58e7a3037f1c">send_packed_range</a></div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;            (pid, &amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>,</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;             pushed_nodes[pid].begin(), pushed_nodes[pid].<a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>(),</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;             send_requests.back(), range_tag);</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;        }</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    }</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pid_id_pair : pushed_node_ids_offsets_to_me)</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    {</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = pid_id_pair.first;</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp; ids_offsets = pid_id_pair.second;</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp; keys_vals = pushed_node_keys_vals_to_me[pid];</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;      libmesh_assert_equal_to</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        (ids_offsets.size(), keys_vals.size());</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>())</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;        this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3be3c4a2df02a610cc7234e3029164d8">receive_packed_range</a></div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;          (pid, &amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, <a class="code" href="structlibMesh_1_1mesh__inserter__iterator.html">mesh_inserter_iterator&lt;Node&gt;</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>),</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;           (<a class="code" href="classlibMesh_1_1Node.html">Node</a>**)<span class="keyword">nullptr</span>, range_tag);</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      <span class="comment">// Add the node constraints that I&#39;ve been sent</span></div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(ids_offsets))</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;        {</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids_offsets[i].first;</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;          <span class="comment">// If we don&#39;t already have a constraint for this node,</span></div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;          <span class="comment">// add the one we were sent</span></div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;          <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * constrained = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(constrained_id);</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;          <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad7a9aeffe76edfe89cc65a16035b864e">is_constrained_node</a>(constrained))</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;            {</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;              <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].first;</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; key_val : keys_vals[i])</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;                {</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * key_node = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(key_val.first);</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;                  row[key_node] = key_val.second;</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;                }</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].second =</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;                ids_offsets[i].second;</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;            }</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        }</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    }</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">Parallel::wait</a>(send_requests);</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;  <span class="comment">// Next we need to push constraints to processors which don&#39;t own</span></div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;  <span class="comment">// the constrained dof, don&#39;t own the constraining dof, but own an</span></div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;  <span class="comment">// element supporting the constraining dof.</span></div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;  <span class="comment">// We need to be able to quickly look up constrained dof ids by what</span></div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;  <span class="comment">// constrains them, so that we can handle the case where we see a</span></div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;  <span class="comment">// foreign element containing one of our constraining DoF ids and we</span></div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;  <span class="comment">// need to push that constraint.</span></div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;  <span class="comment">// Getting distributed adaptive sparsity patterns right is hard.</span></div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;  <span class="keyword">typedef</span> std::map&lt;dof_id_type, std::set&lt;dof_id_type&gt;&gt; DofConstrainsMap;</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;  DofConstrainsMap dof_id_constrains;</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    {</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = i.first;</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = i.second;</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        {</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining = j.first;</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining_proc_id = 0;</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;          <span class="keywordflow">while</span> (constraining &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[constraining_proc_id])</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;            constraining_proc_id++;</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;          <span class="keywordflow">if</span> (constraining_proc_id == this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;            dof_id_constrains[constraining].insert(constrained);</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        }</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;    }</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;  <span class="comment">// Loop over all foreign elements, find any supporting our</span></div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;  <span class="comment">// constrained dof indices.</span></div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;  pushed_ids.clear();</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">as_range</a>(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">active_not_local_elements_begin</a>(),</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                                    <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">active_not_local_elements_end</a>()))</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;    {</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;      std::vector&lt;dof_id_type&gt; my_dof_indices;</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a> (elem, my_dof_indices);</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : my_dof_indices)</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        {</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;          DofConstrainsMap::const_iterator dcmi = dof_id_constrains.find(dof);</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;          <span class="keywordflow">if</span> (dcmi != dof_id_constrains.end())</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            {</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; constrained : dcmi-&gt;second)</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;                {</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> the_constrained_proc_id = 0;</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                  <span class="keywordflow">while</span> (constrained &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[the_constrained_proc_id])</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                    the_constrained_proc_id++;</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> elemproc = elem-&gt;processor_id();</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;                  <span class="keywordflow">if</span> (elemproc != the_constrained_proc_id)</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                    pushed_ids[elemproc].insert(constrained);</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                }</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;            }</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;        }</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    }</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  pushed_ids_rhss.clear();</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  pushed_ids_rhss_to_me.clear();</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;  pushed_keys_vals.clear();</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;  pushed_keys_vals_to_me.clear();</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;  gather_ids();</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;  <span class="comment">// Trade pushed dof constraint rows</span></div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_ids_rhss, ids_rhss_action_functor);</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">Parallel::push_parallel_vector_data</a></div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), pushed_keys_vals, keys_vals_action_functor);</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  receive_dof_constraints();</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;  <span class="comment">// Finally, we need to handle the case of remote dof coupling.  If a</span></div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;  <span class="comment">// processor&#39;s element is coupled to a ghost element, then the</span></div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  <span class="comment">// processor needs to know about all constraints which affect the</span></div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  <span class="comment">// dofs on that ghost element, so we&#39;ll have to query the ghost</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  <span class="comment">// element&#39;s owner.</span></div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;  <a class="code" href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">GhostingFunctor::map_type</a> elements_to_couple;</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  <span class="comment">// Man, I wish we had guaranteed unique_ptr availability...</span></div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  std::set&lt;CouplingMatrix*&gt; temporary_coupling_matrices;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af63ec595dadc28f2b6673499641a1683">merge_ghost_functor_outputs</a></div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;    (elements_to_couple,</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;     temporary_coupling_matrices,</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#acd64cdbcb7af43bb9d35f4e2266ff0b3">coupling_functors_begin</a>(),</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6e35c4e14684a92a817a75e5b29cddd8">coupling_functors_end</a>(),</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;     mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a99742bad0b034a29ccae8c5a90c6f4aa">active_local_elements_begin</a>(),</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;     <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a2e27f54d33f7539c0c06b36adae36cda">active_local_elements_end</a>(),</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;     this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>());</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;  <span class="comment">// Each ghost-coupled element&#39;s owner should get a request for its dofs</span></div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;  std::set&lt;dof_id_type&gt; requested_dofs;</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : elements_to_couple)</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    {</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = pr.first;</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <span class="comment">// FIXME - optimize for the non-fully-coupled case?</span></div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;      std::vector&lt;dof_id_type&gt; element_dofs;</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">dof_indices</a>(elem, element_dofs);</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> dof : element_dofs)</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;        requested_dofs.insert(dof);</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;    }</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">gather_constraints</a>(mesh, requested_dofs, <span class="keyword">false</span>);</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;}</div><div class="ttc" id="namespacelibMesh_1_1Parallel_html_aea5278a91928fa4f33b74aa0786f3592"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">libMesh::Parallel::wait</a></div><div class="ttdeci">void wait(std::vector&lt; Request &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="request_8C_source.html#l00213">request.C:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad7a9aeffe76edfe89cc65a16035b864e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad7a9aeffe76edfe89cc65a16035b864e">libMesh::DofMap::is_constrained_node</a></div><div class="ttdeci">bool is_constrained_node(const Node *node) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01812">dof_map.h:1812</a></div></div>
<div class="ttc" id="classlibMesh_1_1Node_html"><div class="ttname"><a href="classlibMesh_1_1Node.html">libMesh::Node</a></div><div class="ttdoc">A geometric point in (x,y,z) space associated with a DOF. </div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00052">node.h:52</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_acd64cdbcb7af43bb9d35f4e2266ff0b3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#acd64cdbcb7af43bb9d35f4e2266ff0b3">libMesh::DofMap::coupling_functors_begin</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_begin() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00317">dof_map.h:317</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3962af7f276a08be8f22bffd304bdab7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3962af7f276a08be8f22bffd304bdab7">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01930">dof_map.C:1930</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a74c8d3e50dde49ce417d58e7a3037f1c"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a74c8d3e50dde49ce417d58e7a3037f1c">libMesh::Parallel::Communicator::send_packed_range</a></div><div class="ttdeci">void send_packed_range(const unsigned int dest_processor_id, const Context *context, Iter range_begin, const Iter range_end, const MessageTag &amp;tag=no_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00562">parallel_implementation.h:562</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html"><div class="ttname"><a href="classlibMesh_1_1Elem.html">libMesh::Elem</a></div><div class="ttdoc">The base class for all geometric element types. </div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l00100">elem.h:100</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2ad8b64590135362f5ac09c581f828bf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">libMesh::DofMap::gather_constraints</a></div><div class="ttdeci">void gather_constraints(MeshBase &amp;mesh, std::set&lt; dof_id_type &gt; &amp;unexpanded_dofs, bool look_for_constrainees)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03871">dof_map_constraints.C:3871</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab64fa61b4505bc7554e508972dfaecd5"><div class="ttname"><a href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">libMesh::index_range</a></div><div class="ttdeci">IntRange&lt; std::size_t &gt; index_range(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00104">int_range.h:104</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3be3c4a2df02a610cc7234e3029164d8"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3be3c4a2df02a610cc7234e3029164d8">libMesh::Parallel::Communicator::receive_packed_range</a></div><div class="ttdeci">void receive_packed_range(const unsigned int dest_processor_id, Context *context, OutputIter out, const T *output_type, const MessageTag &amp;tag=any_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l01060">parallel_implementation.h:1060</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a785f0bd261d7bd1918b031c5133da2b9"><div class="ttname"><a href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a></div><div class="ttdeci">IterBase * end</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00343">variant_filter_iterator.h:343</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac865c9ea66f0b31884d53f156ce474ad"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">libMesh::Parallel::Communicator::get_unique_tag</a></div><div class="ttdeci">MessageTag get_unique_tag(int tagvalue) const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8C_source.html#l00201">communicator.C:201</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0629d79c85d44523e4e11624aa96cd85"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">libMesh::MeshBase::is_serial</a></div><div class="ttdeci">virtual bool is_serial() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00154">mesh_base.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_ab95f1d0641d5b5591a97e1a11b57164d"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#ab95f1d0641d5b5591a97e1a11b57164d">libMesh::DofObject::id</a></div><div class="ttdeci">dof_id_type id() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00655">dof_object.h:655</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a99742bad0b034a29ccae8c5a90c6f4aa"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a99742bad0b034a29ccae8c5a90c6f4aa">libMesh::MeshBase::active_local_elements_begin</a></div><div class="ttdeci">virtual element_iterator active_local_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1MessageTag_html"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1MessageTag.html">libMesh::Parallel::MessageTag</a></div><div class="ttdef"><b>Definition:</b> <a href="message__tag_8h_source.html#l00047">message_tag.h:47</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a977361a82b7a9e7ad8e50ae1cae40d20"><div class="ttname"><a href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">libMesh::as_range</a></div><div class="ttdeci">SimpleRange&lt; I &gt; as_range(const std::pair&lt; I, I &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="simple__range_8h_source.html#l00057">simple_range.h:57</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8a3acc1d2a8ab28b00464406deb1d40f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8a3acc1d2a8ab28b00464406deb1d40f">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01829">dof_map.h:1829</a></div></div>
<div class="ttc" id="classlibMesh_1_1GhostingFunctor_html_a3c27b499ef3153d8aaaa2088beba4480"><div class="ttname"><a href="classlibMesh_1_1GhostingFunctor.html#a3c27b499ef3153d8aaaa2088beba4480">libMesh::GhostingFunctor::map_type</a></div><div class="ttdeci">std::unordered_map&lt; const Elem *, const CouplingMatrix * &gt; map_type</div><div class="ttdef"><b>Definition:</b> <a href="ghosting__functor_8h_source.html#l00154">ghosting_functor.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="structlibMesh_1_1mesh__inserter__iterator_html"><div class="ttname"><a href="structlibMesh_1_1mesh__inserter__iterator.html">libMesh::mesh_inserter_iterator</a></div><div class="ttdoc">An output iterator for use with packed_range functions. </div><div class="ttdef"><b>Definition:</b> <a href="mesh__inserter__iterator_8h_source.html#l00046">mesh_inserter_iterator.h:46</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a81252a490defae08c5fd39ffac034333"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">libMesh::MeshBase::active_not_local_elements_end</a></div><div class="ttdeci">virtual element_iterator active_not_local_elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Request_html"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Request.html">libMesh::Parallel::Request</a></div><div class="ttdef"><b>Definition:</b> <a href="request_8h_source.html#l00063">request.h:63</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01689">dof_map.h:1689</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00097">dof_map.h:97</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01535">dof_map.h:1535</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac68163904060c11860cd46b0fd9e4003"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">libMesh::MeshBase::active_not_local_elements_begin</a></div><div class="ttdeci">virtual element_iterator active_not_local_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6e35c4e14684a92a817a75e5b29cddd8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6e35c4e14684a92a817a75e5b29cddd8">libMesh::DofMap::coupling_functors_end</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_end() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00323">dof_map.h:323</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00145">dof_map.h:145</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a2840c544bef5845992c918f1cb4669f1"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a2840c544bef5845992c918f1cb4669f1">libMesh::Parallel::push_parallel_vector_data</a></div><div class="ttdeci">void push_parallel_vector_data(const Communicator &amp;comm, const MapToVectors &amp;data, RequestContainer &amp;reqs, ActionFunctor &amp;act_on_data)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__sync_8h_source.html#l00239">parallel_sync.h:239</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00191">libmesh_common.h:191</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a3464f722394258d66e04720e221f07ff"><div class="ttname"><a href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a></div><div class="ttdeci">IterBase * data</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00337">variant_filter_iterator.h:337</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_abc2fd76e7bf6c200f5e8849dfca9cd03"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">libMesh::MeshBase::node_ptr</a></div><div class="ttdeci">virtual const Node * node_ptr(const dof_id_type i) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a754f2866ec9d8a49a02a68a32e7aa518"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">libMesh::DofObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00717">dof_object.h:717</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a2e27f54d33f7539c0c06b36adae36cda"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a2e27f54d33f7539c0c06b36adae36cda">libMesh::MeshBase::active_local_elements_end</a></div><div class="ttdeci">virtual element_iterator active_local_elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af63ec595dadc28f2b6673499641a1683"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af63ec595dadc28f2b6673499641a1683">libMesh::DofMap::merge_ghost_functor_outputs</a></div><div class="ttdeci">static void merge_ghost_functor_outputs(GhostingFunctor::map_type &amp;elements_to_ghost, std::set&lt; CouplingMatrix *&gt; &amp;temporary_coupling_matrices, const std::set&lt; GhostingFunctor *&gt;::iterator &amp;gf_begin, const std::set&lt; GhostingFunctor *&gt;::iterator &amp;gf_end, const MeshBase::const_element_iterator &amp;elems_begin, const MeshBase::const_element_iterator &amp;elems_end, processor_id_type p)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01432">dof_map.C:1432</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01698">dof_map.h:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8374de5322b20e3e4719c5c04b038291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8374de5322b20e3e4719c5c04b038291">&#9670;&nbsp;</a></span>semilocal_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::semilocal_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if degree of freedom index <code>dof_index</code> is either a local index or in the <code>send_list</code>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is an O(logN) operation for a send_list of size N; we don't cache enough information for O(1) right now. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l02384">2384</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01547">_send_list</a>, and <a class="el" href="dof__map_8h_source.html#l00738">local_index()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l02400">all_semilocal_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;{</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="comment">// If it&#39;s not in the local indices</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">local_index</a>(dof_index))</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    {</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      <span class="comment">// and if it&#39;s not in the ghost indices, then we&#39;re not</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="comment">// semilocal</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <span class="keywordflow">if</span> (!std::binary_search(<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.end(), dof_index))</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    }</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01547">dof_map.h:1547</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9e2c5542effbe52f997e0011218486ff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9e2c5542effbe52f997e0011218486ff">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00738">dof_map.h:738</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a694b0be4a4514f1d7f0775ddfec78d4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694b0be4a4514f1d7f0775ddfec78d4b">&#9670;&nbsp;</a></span>set_error_on_cyclic_constraint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_error_on_cyclic_constraint </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>error_on_cyclic_constraint</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Specify whether or not we perform an extra (opt-mode enabled) check for cyclic constraints. If a cyclic constraint is present then the system constraints are not valid, so if <code>error_on_cyclic_constraint</code> is true we will throw an error in this case. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00238">238</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01493">_error_on_cyclic_constraint</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a33e3d8408ce7a9125dd1c22d1428fd97">_error_on_cyclic_constraint</a> = error_on_cyclic_constraint;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a33e3d8408ce7a9125dd1c22d1428fd97"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a33e3d8408ce7a9125dd1c22d1428fd97">libMesh::DofMap::_error_on_cyclic_constraint</a></div><div class="ttdeci">bool _error_on_cyclic_constraint</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01493">dof_map.h:1493</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2eb44e4da2c8afcd039995ef239457da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb44e4da2c8afcd039995ef239457da">&#9670;&nbsp;</a></span>set_implicit_neighbor_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_implicit_neighbor_dofs </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>implicit_neighbor_dofs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allow the implicit_neighbor_dofs flag to be set programmatically. This overrides the &ndash;implicit_neighbor_dofs commandline option. We can use this to set the implicit neighbor dofs option differently for different systems, whereas the commandline option is the same for all systems. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01675">1675</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01737">_implicit_neighbor_dofs</a>, and <a class="el" href="dof__map_8h_source.html#l01736">_implicit_neighbor_dofs_initialized</a>.</p>
<div class="fragment"><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;{</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a> = implicit_neighbor_dofs;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ed76ce98cd73ed8339f505a5284fef"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">libMesh::DofMap::_implicit_neighbor_dofs_initialized</a></div><div class="ttdeci">bool _implicit_neighbor_dofs_initialized</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01736">dof_map.h:1736</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a09368a6dcd32c12d7a51dc00852982d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">libMesh::DofMap::_implicit_neighbor_dofs</a></div><div class="ttdeci">bool _implicit_neighbor_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01737">dof_map.h:1737</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7bad83b3b5e37a8afe4ea251d72df300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bad83b3b5e37a8afe4ea251d72df300">&#9670;&nbsp;</a></span>set_nonlocal_dof_objects()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename iterator_type &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_nonlocal_dof_objects </td>
          <td>(</td>
          <td class="paramtype">iterator_type&#160;</td>
          <td class="paramname"><em>objects_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">iterator_type&#160;</td>
          <td class="paramname"><em>objects_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DofMap.html#abbb34b303bc677ac3a1de56b2da3f8fc">dofobject_accessor</a>&#160;</td>
          <td class="paramname"><em>objects</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function for distributing dofs in parallel </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l00321">321</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="variant__filter__iterator_8h_source.html#l00337">data</a>, <a class="el" href="dof__object_8h_source.html#l00833">libMesh::DofObject::dof_number()</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="int__range_8h_source.html#l00104">libMesh::index_range()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__object_8h_source.html#l00358">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__object_8h_source.html#l00803">libMesh::DofObject::n_comp()</a>, <a class="el" href="dof__object_8h_source.html#l00816">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="dof__object_8h_source.html#l00758">libMesh::DofObject::n_var_groups()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="dof__object_8h_source.html#l00768">libMesh::DofObject::n_vars()</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="parallel__sync_8h_source.html#l00472">libMesh::Parallel::pull_parallel_vector_data()</a>, <a class="el" href="dof__object_8C_source.html#l00352">libMesh::DofObject::set_n_comp_group()</a>, <a class="el" href="dof__object_8h_source.html#l00960">libMesh::DofObject::set_vg_dof_base()</a>, <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>, and <a class="el" href="dof__object_8h_source.html#l00980">libMesh::DofObject::vg_dof_base()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// First, iterate over local objects to find out how many</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// are on each processor</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  std::unordered_map&lt;processor_id_type, dof_id_type&gt; ghost_objects_from_proc;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  iterator_type it  = objects_begin;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span> (; it != objects_end; ++it)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      DofObject * obj = *it;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">if</span> (obj)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> obj_procid = obj-&gt;processor_id();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          <span class="comment">// We&#39;d better be completely partitioned by now</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          libmesh_assert_not_equal_to (obj_procid, <a class="code" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          ghost_objects_from_proc[obj_procid]++;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">// Request sets to send to each processor</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    requested_ids;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// We know how many of our objects live on each processor, so</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// reserve() space for requests from each.</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keyword">auto</span> ghost_end = ghost_objects_from_proc.end();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p=0, np = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>(); p != np; ++p)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (p != this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keyword">auto</span> ghost_it = ghost_objects_from_proc.find(p);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">if</span> (ghost_it != ghost_end)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          requested_ids[p].reserve(ghost_it-&gt;second);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">for</span> (it = objects_begin; it != objects_end; ++it)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      DofObject * obj = *it;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">if</span> (obj-&gt;processor_id() != <a class="code" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a>)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        requested_ids[obj-&gt;processor_id()].push_back(obj-&gt;id());</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p=0, np = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>(); p != np; ++p)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">if</span> (ghost_objects_from_proc.count(p))</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        libmesh_assert_equal_to (requested_ids[p].size(), ghost_objects_from_proc[p]);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        libmesh_assert(!requested_ids.count(p));</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keyword">typedef</span> std::vector&lt;dof_id_type&gt; datum;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keyword">auto</span> gather_functor =</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    [<span class="keyword">this</span>, &amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, &amp;objects]</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;     std::vector&lt;datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="comment">// Fill those requests</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(),</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keyword">const</span> std::size_t query_size = ids.size();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>.resize(query_size);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; d : <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        d.resize(2 * n_var_groups);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          DofObject * requested = (this-&gt;*objects)(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, ids[i]);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          libmesh_assert(requested);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          libmesh_assert_equal_to (requested-&gt;processor_id(), this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>());</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          libmesh_assert_equal_to (requested-&gt;n_var_groups(sys_num), n_var_groups);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg != n_var_groups; ++vg)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp_g =</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                requested-&gt;n_comp_group(sys_num, vg);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;              <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][vg] = n_comp_g;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = n_comp_g ?</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                requested-&gt;vg_dof_base(sys_num, vg) : 0;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;              libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;              <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][n_var_groups+vg] = my_first_dof;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    };</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">auto</span> action_functor =</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    [<span class="keyword">this</span>, &amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, &amp;objects]</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libmesh_dbg_var(pid),</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;     <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;     <span class="keyword">const</span> std::vector&lt;datum&gt; &amp; <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(),</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">n_variable_groups</a>();</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="comment">// Copy the id changes we&#39;ve now been informed of</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(ids))</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          DofObject * requested = (this-&gt;*objects)(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, ids[i]);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          libmesh_assert(requested);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          libmesh_assert_equal_to (requested-&gt;processor_id(), pid);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg != n_var_groups; ++vg)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp_g =</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                cast_int&lt;unsigned int&gt;(<a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][vg]);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;              requested-&gt;set_n_comp_group(sys_num, vg, n_comp_g);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;              <span class="keywordflow">if</span> (n_comp_g)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = <a class="code" href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a>[i][n_var_groups+vg];</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                  libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                  requested-&gt;set_vg_dof_base</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    (sys_num, vg, my_first_dof);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    };</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  datum * ex = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">Parallel::pull_parallel_vector_data</a></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), requested_ids, gather_functor, action_functor, ex);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// Double check for invalid dofs</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">for</span> (it = objects_begin; it != objects_end; ++it)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      DofObject * obj = *it;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      libmesh_assert (obj);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_variables = obj-&gt;n_vars(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>());</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != num_variables; ++v)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp =</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            obj-&gt;n_comp(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(), v);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = n_comp ?</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            obj-&gt;dof_number(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">sys_number</a>(), v, 0) : 0;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a1a994ec3105079a55c9432a37e8bbcf5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a994ec3105079a55c9432a37e8bbcf5">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00533">dof_map.h:533</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab64fa61b4505bc7554e508972dfaecd5"><div class="ttname"><a href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">libMesh::index_range</a></div><div class="ttdeci">IntRange&lt; std::size_t &gt; index_range(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00104">int_range.h:104</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7da9fb24e48ff357df1bb82b0100f0d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7da9fb24e48ff357df1bb82b0100f0d5">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01744">dof_map.h:1744</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a21797734483c801c09fa26822455d989"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a21797734483c801c09fa26822455d989">libMesh::Parallel::pull_parallel_vector_data</a></div><div class="ttdeci">void pull_parallel_vector_data(const Communicator &amp;comm, const MapToVectors &amp;queries, RequestContainer &amp;reqs, GatherFunctor &amp;gather_data, ActionFunctor &amp;act_on_data, const datum *example)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__sync_8h_source.html#l00472">parallel_sync.h:472</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_aa65deab833c8b1802790cd43ab1b6ee4"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">libMesh::DofObject::invalid_processor_id</a></div><div class="ttdeci">static const processor_id_type invalid_processor_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00358">dof_object.h:358</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a3464f722394258d66e04720e221f07ff"><div class="ttname"><a href="variant__filter__iterator_8h.html#a3464f722394258d66e04720e221f07ff">data</a></div><div class="ttdeci">IterBase * data</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00337">variant_filter_iterator.h:337</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72f54b69e830ade14656c309586850f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72f54b69e830ade14656c309586850f8">&#9670;&nbsp;</a></span>stash_dof_constraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::stash_dof_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00911">911</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>, and <a class="el" href="dof__map_8h_source.html#l01687">_stashed_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>.empty());</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.swap(<a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7da9fb24e48ff357df1bb82b0100f0d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7da9fb24e48ff357df1bb82b0100f0d5">&#9670;&nbsp;</a></span>sys_number()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::sys_number </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of the system we are responsible for. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01744">1744</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01513">_sys_number</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l02209">_dof_indices()</a>, <a class="el" href="fe__base_8C_source.html#l01650">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_periodic_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01163">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8C_source.html#l02115">dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00813">invalidate_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01076">local_variable_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02434">old_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>, and <a class="el" href="dof__map_8C_source.html#l00321">set_nonlocal_dof_objects()</a>.</p>
<div class="fragment"><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;{</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">_sys_number</a>;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a32b9faf7127f48555386705a952460d6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">libMesh::DofMap::_sys_number</a></div><div class="ttdeci">const unsigned int _sys_number</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01513">dof_map.h:1513</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af08d2b93738109ef74741d685e063982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af08d2b93738109ef74741d685e063982">&#9670;&nbsp;</a></span>unstash_dof_constraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::unstash_dof_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l00917">917</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01687">_dof_constraints</a>, and <a class="el" href="dof__map_8h_source.html#l01687">_stashed_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty());</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.swap(<a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  }</div><div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01687">dof_map.h:1687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1bf72ada83076ab80eb67d568189f462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bf72ada83076ab80eb67d568189f462">&#9670;&nbsp;</a></span>use_coupled_neighbor_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::use_coupled_neighbor_dofs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tells other library functions whether or not this problem includes coupling between dofs in neighboring cells, as can currently be specified on the command line or inferred from the use of all discontinuous variables. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8C_source.html#l01682">1682</a> of file <a class="el" href="dof__map_8C_source.html">dof_map.C</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01737">_implicit_neighbor_dofs</a>, <a class="el" href="dof__map_8h_source.html#l01736">_implicit_neighbor_dofs_initialized</a>, <a class="el" href="fe__abstract_8C_source.html#l00071">libMesh::FEAbstract::build()</a>, <a class="el" href="libmesh_8C_source.html#l00941">libMesh::command_line_next()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00075">libMesh::DISCONTINUOUS</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="dof__map_8h_source.html#l00541">n_variables()</a>, <a class="el" href="libmesh_8C_source.html#l00876">libMesh::on_command_line()</a>, and <a class="el" href="dof__map_8h_source.html#l01792">variable_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, and <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;{</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="comment">// If we were asked on the command line, then we need to</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="comment">// include sensitivities between neighbor degrees of freedom</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keywordtype">bool</span> implicit_neighbor_dofs =</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a> (<span class="stringliteral">&quot;--implicit-neighbor-dofs&quot;</span>);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="comment">// If the user specifies --implicit-neighbor-dofs 0, then</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="comment">// presumably he knows what he is doing and we won&#39;t try to</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="comment">// automatically turn it on even when all the variables are</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="comment">// discontinuous.</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="keywordflow">if</span> (implicit_neighbor_dofs)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    {</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="comment">// No flag provided defaults to &#39;true&#39;</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <span class="keywordtype">int</span> flag = 1;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      flag = <a class="code" href="namespacelibMesh.html#a8ab2ecc9f7a7fda0f78121dd1ac34f50">libMesh::command_line_next</a> (<span class="stringliteral">&quot;--implicit-neighbor-dofs&quot;</span>, flag);</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordflow">if</span> (!flag)</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        {</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;          <span class="comment">// The user said --implicit-neighbor-dofs 0, so he knows</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;          <span class="comment">// what he is doing and really doesn&#39;t want it.</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        }</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    }</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="comment">// Possibly override the commandline option, if set_implicit_neighbor_dofs</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="comment">// has been called.</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a>)</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    {</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      implicit_neighbor_dofs = <a class="code" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a>;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="comment">// Again, if the user explicitly says implicit_neighbor_dofs = false,</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <span class="comment">// then we return here.</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <span class="keywordflow">if</span> (!implicit_neighbor_dofs)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    }</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="comment">// Look at all the variables in this system.  If every one is</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="comment">// discontinuous then the user must be doing DG/FVM, so be nice</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="comment">// and force implicit_neighbor_dofs=true.</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  {</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordtype">bool</span> all_discontinuous_dofs = <span class="keyword">true</span>;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> var=0; var&lt;this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">n_variables</a>(); var++)</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1FEAbstract.html#ad14dee2850b7fe3d63d8c69d4df018a4">FEAbstract::build</a> (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.mesh_dimension(),</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                             this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">variable_type</a>(var))-&gt;get_continuity() !=  <a class="code" href="namespacelibMesh.html#a09db0990f72f24f6b4f3f3a8df4dc97daefa1013fc8340a1ceff8bdcf6fb8ca81">DISCONTINUOUS</a>)</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        all_discontinuous_dofs = <span class="keyword">false</span>;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">if</span> (all_discontinuous_dofs)</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      implicit_neighbor_dofs = <span class="keyword">true</span>;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  }</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="keywordflow">return</span> implicit_neighbor_dofs;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ed76ce98cd73ed8339f505a5284fef"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">libMesh::DofMap::_implicit_neighbor_dofs_initialized</a></div><div class="ttdeci">bool _implicit_neighbor_dofs_initialized</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01736">dof_map.h:1736</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a09368a6dcd32c12d7a51dc00852982d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">libMesh::DofMap::_implicit_neighbor_dofs</a></div><div class="ttdeci">bool _implicit_neighbor_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01737">dof_map.h:1737</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9b731b2150d70797262acdbfaf1b53e8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9b731b2150d70797262acdbfaf1b53e8">libMesh::DofMap::variable_type</a></div><div class="ttdeci">const FEType &amp; variable_type(const unsigned int c) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01792">dof_map.h:1792</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a25b3182cbf57ead72821d826275512b0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a25b3182cbf57ead72821d826275512b0">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00541">dof_map.h:541</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a09db0990f72f24f6b4f3f3a8df4dc97daefa1013fc8340a1ceff8bdcf6fb8ca81"><div class="ttname"><a href="namespacelibMesh.html#a09db0990f72f24f6b4f3f3a8df4dc97daefa1013fc8340a1ceff8bdcf6fb8ca81">libMesh::DISCONTINUOUS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00075">enum_fe_family.h:75</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8ab2ecc9f7a7fda0f78121dd1ac34f50"><div class="ttname"><a href="namespacelibMesh.html#a8ab2ecc9f7a7fda0f78121dd1ac34f50">libMesh::command_line_next</a></div><div class="ttdeci">T command_line_next(std::string name, T value)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00941">libmesh.C:941</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEAbstract_html_ad14dee2850b7fe3d63d8c69d4df018a4"><div class="ttname"><a href="classlibMesh_1_1FEAbstract.html#ad14dee2850b7fe3d63d8c69d4df018a4">libMesh::FEAbstract::build</a></div><div class="ttdeci">static std::unique_ptr&lt; FEAbstract &gt; build(const unsigned int dim, const FEType &amp;type)</div><div class="ttdef"><b>Definition:</b> <a href="fe__abstract_8C_source.html#l00071">fe_abstract.C:71</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adc9fb0dafe70b50cd0848a8142cf57c0"><div class="ttname"><a href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a></div><div class="ttdeci">bool on_command_line(std::string arg)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00876">libmesh.C:876</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a46ed397847e6a1c3be2236e2faf622ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46ed397847e6a1c3be2236e2faf622ec">&#9670;&nbsp;</a></span>variable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Variable.html">Variable</a> &amp; libMesh::DofMap::variable </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The variable description object for variable <code>c</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01762">1762</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01498">_variables</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00089">DMlibMeshSetSystem_libMesh()</a>, <a class="el" href="dof__map_8C_source.html#l01076">local_variable_indices()</a>, <a class="el" href="generic__projector_8h_source.html#l00588">libMesh::GenericProjector&lt; FFunctor, GFunctor, FValue, ProjectionAction &gt;::operator()()</a>, <a class="el" href="system__projection_8C_source.html#l01182">libMesh::BoundaryProjectSolution::operator()()</a>, and <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;{</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  libmesh_assert_less (c, <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size());</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>[c];</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01498">dof_map.h:1498</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7df4304dec439a5cabd1d7008a2e3e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df4304dec439a5cabd1d7008a2e3e45">&#9670;&nbsp;</a></span>variable_group()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &amp; libMesh::DofMap::variable_group </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The <code><a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a></code> description object for group <code>g</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01752">1752</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01503">_variable_groups</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l02209">_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l01163">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8C_source.html#l01930">dof_indices()</a>, <a class="el" href="system_8C_source.html#l01658">libMesh::System::get_info()</a>, <a class="el" href="dof__map_8C_source.html#l02434">old_dof_indices()</a>, and <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;{</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  libmesh_assert_less (g, <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>[g];</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01503">dof_map.h:1503</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9032dff0b884e2a6951eaafdaa192f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9032dff0b884e2a6951eaafdaa192f0">&#9670;&nbsp;</a></span>variable_group_order()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a> libMesh::DofMap::variable_group_order </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vg</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The approximation order for <code><a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a></code> <code>vg</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01782">1782</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01503">_variable_groups</a>.</p>
<div class="fragment"><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;{</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  libmesh_assert_less (vg, <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>[vg].type().order;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01503">dof_map.h:1503</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87e2386689a26b75068e5bde44fc00b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87e2386689a26b75068e5bde44fc00b7">&#9670;&nbsp;</a></span>variable_group_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1FEType.html">FEType</a> &amp; libMesh::DofMap::variable_group_type </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vg</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The finite element type for <code><a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a></code> <code>vg</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01802">1802</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01503">_variable_groups</a>.</p>
<div class="fragment"><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;{</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  libmesh_assert_less (vg, <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>[vg].type();</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01503">dof_map.h:1503</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52dcf2c805ae5b8849eb760ae665a600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52dcf2c805ae5b8849eb760ae665a600">&#9670;&nbsp;</a></span>variable_order()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#af3eb3e8751995b944fc135ea53b09da2">Order</a> libMesh::DofMap::variable_order </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The approximation order for variable <code>c</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01772">1772</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01498">_variables</a>.</p>
<div class="fragment"><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;{</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  libmesh_assert_less (c, <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size());</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>[c].type().order;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01498">dof_map.h:1498</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b731b2150d70797262acdbfaf1b53e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b731b2150d70797262acdbfaf1b53e8">&#9670;&nbsp;</a></span>variable_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1FEType.html">FEType</a> &amp; libMesh::DofMap::variable_type </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The finite element type for variable <code>c</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01792">1792</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">References <a class="el" href="dof__map_8h_source.html#l01498">_variables</a>.</p>

<p class="reference">Referenced by <a class="el" href="exact__solution_8C_source.html#l00455">libMesh::ExactSolution::_compute_error()</a>, <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="hp__coarsentest_8C_source.html#l00047">libMesh::HPCoarsenTest::add_projection()</a>, <a class="el" href="system_8C_source.html#l01400">libMesh::System::calculate_norm()</a>, <a class="el" href="fe__base_8C_source.html#l00791">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::coarsened_dof_values()</a>, <a class="el" href="fe__interface_8C_source.html#l00873">libMesh::FEInterface::compute_constraints()</a>, <a class="el" href="fe__base_8C_source.html#l01650">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_periodic_constraints()</a>, <a class="el" href="fe__base_8C_source.html#l01366">libMesh::FEGenericBase&lt; FEOutputType&lt; T &gt;::type &gt;::compute_proj_constraints()</a>, <a class="el" href="mesh__function_8C_source.html#l00517">libMesh::MeshFunction::discontinuous_gradient()</a>, <a class="el" href="mesh__function_8C_source.html#l00343">libMesh::MeshFunction::discontinuous_value()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="mesh__function_8C_source.html#l00431">libMesh::MeshFunction::gradient()</a>, <a class="el" href="mesh__function_8C_source.html#l00597">libMesh::MeshFunction::hessian()</a>, <a class="el" href="dof__map_8C_source.html#l01076">local_variable_indices()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00112">libMesh::WeightedPatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00210">libMesh::PatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="mesh__function_8C_source.html#l00243">libMesh::MeshFunction::operator()()</a>, <a class="el" href="system_8C_source.html#l02154">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02273">libMesh::System::point_hessian()</a>, <a class="el" href="hp__coarsentest_8C_source.html#l00140">libMesh::HPCoarsenTest::select_refinement()</a>, and <a class="el" href="dof__map_8C_source.html#l01682">use_coupled_neighbor_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;{</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  libmesh_assert_less (c, <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size());</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>[c].type();</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01498">dof_map.h:1498</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a298e05b1935249e7045795d918f46d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298e05b1935249e7045795d918f46d70">&#9670;&nbsp;</a></span>SparsityPattern::Build</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01730">1730</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a89fdd1d933dc29089eabf3e07908374d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89fdd1d933dc29089eabf3e07908374d">&#9670;&nbsp;</a></span>_adjoint_constraint_values</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1AdjointDofConstraintValues.html">AdjointDofConstraintValues</a> libMesh::DofMap::_adjoint_constraint_values</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01691">1691</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l01853">has_heterogenous_adjoint_constraint()</a>, and <a class="el" href="dof__map_8h_source.html#l01839">has_heterogenous_adjoint_constraints()</a>.</p>

</div>
</div>
<a id="a7e77603adbd2d7c119334ff2ce82a877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e77603adbd2d7c119334ff2ce82a877">&#9670;&nbsp;</a></span>_adjoint_dirichlet_boundaries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&gt; libMesh::DofMap::_adjoint_dirichlet_boundaries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure containing Dirichlet functions. The ith entry is the constraint matrix row for boundaryid i. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01727">1727</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00201">~DofMap()</a>.</p>

</div>
</div>
<a id="a378d58f5e860f781a52adb61464c9378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a378d58f5e860f781a52adb61464c9378">&#9670;&nbsp;</a></span>_algebraic_ghosting_functors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt; libMesh::DofMap::_algebraic_ghosting_functors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The list of all <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> objects to be used when distributing ghosted vectors.</p>
<p>The library should automatically copy these functors to the <a class="el" href="classlibMesh_1_1MeshBase.html" title="Base class for Mesh. ">MeshBase</a>, too, so any algebraically ghosted dofs will live on geometrically ghosted elements. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01605">1605</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01829">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8h_source.html#l00367">algebraic_ghosting_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00373">algebraic_ghosting_functors_end()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l01840">remove_algebraic_ghosting_functor()</a>.</p>

</div>
</div>
<a id="a409a5dccf85edf7260f6186482cb9c9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409a5dccf85edf7260f6186482cb9c9c">&#9670;&nbsp;</a></span>_augment_send_list</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">AugmentSendList</a>* libMesh::DofMap::_augment_send_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function object to call to add extra entries to the send list </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01569">1569</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00420">attach_extra_send_list_object()</a>, and <a class="el" href="dof__map_8C_source.html#l01639">prepare_send_list()</a>.</p>

</div>
</div>
<a id="ab5f0ce99b32ad1a22d5e78161d27ad3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5f0ce99b32ad1a22d5e78161d27ad3b">&#9670;&nbsp;</a></span>_augment_sparsity_pattern</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html">AugmentSparsityPattern</a>* libMesh::DofMap::_augment_sparsity_pattern</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function object to call to add extra entries to the sparsity pattern </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01552">1552</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00391">attach_extra_sparsity_object()</a>, and <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>.</p>

</div>
</div>
<a id="a1ffb5b08919ab435109a302f94a7b3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ffb5b08919ab435109a302f94a7b3eb">&#9670;&nbsp;</a></span>_communicator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a>&amp; libMesh::ParallelObject::_communicator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00107">107</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="equation__systems_8C_source.html#l00600">libMesh::EquationSystems::build_parallel_solution_vector()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="parallel__object_8h_source.html#l00074">libMesh::ParallelObject::operator=()</a>, and <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>

</div>
</div>
<a id="a7c913252d05560f8bc7c75a63547c4c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c913252d05560f8bc7c75a63547c4c3">&#9670;&nbsp;</a></span>_counts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">ReferenceCounter::Counts</a> libMesh::ReferenceCounter::_counts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actually holds the data. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00122">122</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="reference__counter_8C_source.html#l00047">libMesh::ReferenceCounter::get_info()</a>, <a class="el" href="reference__counter_8h_source.html#l00181">libMesh::ReferenceCounter::increment_constructor_count()</a>, and <a class="el" href="reference__counter_8h_source.html#l00194">libMesh::ReferenceCounter::increment_destructor_count()</a>.</p>

</div>
</div>
<a id="aef1ebc9176a3f7ec9607ba4b26808991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef1ebc9176a3f7ec9607ba4b26808991">&#9670;&nbsp;</a></span>_coupling_functors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> *&gt; libMesh::DofMap::_coupling_functors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The list of all <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a> objects to be used when coupling degrees of freedom in matrix sparsity patterns.</p>
<p>These objects will <em>also</em> be used as algebraic ghosting functors, but not vice-versa.</p>
<p>The library should automatically copy these functors to the <a class="el" href="classlibMesh_1_1MeshBase.html" title="Base class for Mesh. ">MeshBase</a>, too, so any dofs coupled to local dofs will live on geometrically ghosted elements. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01618">1618</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01809">add_coupling_functor()</a>, <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00317">coupling_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00323">coupling_functors_end()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l01820">remove_coupling_functor()</a>.</p>

</div>
</div>
<a id="abb069d1433ad6f8eeb4d5ebf44ae4dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb069d1433ad6f8eeb4d5ebf44ae4dc8">&#9670;&nbsp;</a></span>_default_coupling</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a>&gt; libMesh::DofMap::_default_coupling</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The default coupling <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a>, used to implement standard <a class="el" href="namespacelibMesh.html">libMesh</a> sparsity pattern construction.</p>
<p>We use a std::unique_ptr here to reduce header dependencies. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01587">1587</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00329">default_coupling()</a>, <a class="el" href="dof__map_8C_source.html#l00130">DofMap()</a>, <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>, and <a class="el" href="dof__map_8C_source.html#l00201">~DofMap()</a>.</p>

</div>
</div>
<a id="a4eb9c9ed9c530781aac48df4fc0cf27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb9c9ed9c530781aac48df4fc0cf27b">&#9670;&nbsp;</a></span>_default_evaluating</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1DefaultCoupling.html">DefaultCoupling</a>&gt; libMesh::DofMap::_default_evaluating</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The default algebraic <a class="el" href="classlibMesh_1_1GhostingFunctor.html">GhostingFunctor</a>, used to implement standard <a class="el" href="namespacelibMesh.html">libMesh</a> send_list construction.</p>
<p>We use a std::unique_ptr here to reduce header dependencies. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01595">1595</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00379">default_algebraic_ghosting()</a>, <a class="el" href="dof__map_8C_source.html#l00130">DofMap()</a>, and <a class="el" href="dof__map_8C_source.html#l00201">~DofMap()</a>.</p>

</div>
</div>
<a id="a2e9be7e72291d4fd6e841ae7733a5ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9be7e72291d4fd6e841ae7733a5ff0">&#9670;&nbsp;</a></span>_dirichlet_boundaries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>&gt; libMesh::DofMap::_dirichlet_boundaries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure containing Dirichlet functions. The ith entry is the constraint matrix row for boundaryid i. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01721">1721</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l01223">get_dirichlet_boundaries()</a>.</p>

</div>
</div>
<a id="af7fe4d0cf13618e6dd04ff22fdaca0ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7fe4d0cf13618e6dd04ff22fdaca0ba">&#9670;&nbsp;</a></span>_dof_constraints</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a> libMesh::DofMap::_dof_constraints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure containing DOF constraints. The ith entry is the constraint matrix row for DOF i. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01687">1687</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00902">constraint_rows_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00908">constraint_rows_end()</a>, <a class="el" href="dof__map_8C_source.html#l02633">find_connected_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, <a class="el" href="dof__map_8h_source.html#l01829">is_constrained_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00911">stash_dof_constraints()</a>, and <a class="el" href="dof__map_8h_source.html#l00917">unstash_dof_constraints()</a>.</p>

</div>
</div>
<a id="ab276e172c5488ab3b387b235e28556cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab276e172c5488ab3b387b235e28556cf">&#9670;&nbsp;</a></span>_dof_coupling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1CouplingMatrix.html">CouplingMatrix</a>* libMesh::DofMap::_dof_coupling</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Degree of freedom coupling. If left empty each DOF couples to all others. Can be used to reduce memory requirements for sparse matrices. DOF 0 might only couple to itself, in which case <code>dof_coupling(0,0)</code> should be 1 and <code>dof_coupling(0,j)</code> = 0 for j not equal to 0.</p>
<p>This variable is named as though it were class private, but it is in the public interface. Also there are no public methods for accessing it... This typically means you should only use it if you know what you are doing. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01319">1319</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, and <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>.</p>

</div>
</div>
<a id="a8f75e8a4a280f2c41636f2ae1307a311"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f75e8a4a280f2c41636f2ae1307a311">&#9670;&nbsp;</a></span>_enable_print_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::ReferenceCounter::_enable_print_counter = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to control whether reference count information is printed when print_info is called. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00141">141</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="reference__counter_8C_source.html#l00106">libMesh::ReferenceCounter::disable_print_counter_info()</a>, <a class="el" href="reference__counter_8C_source.html#l00100">libMesh::ReferenceCounter::enable_print_counter_info()</a>, and <a class="el" href="reference__counter_8C_source.html#l00087">libMesh::ReferenceCounter::print_info()</a>.</p>

</div>
</div>
<a id="af43f96a9e11b3f4221306fdfd4511aaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af43f96a9e11b3f4221306fdfd4511aaa">&#9670;&nbsp;</a></span>_end_df</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_end_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Last DOF index (plus 1) on processor <code>p</code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01535">1535</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00650">dof_owner()</a>, <a class="el" href="dof__map_8h_source.html#l00641">end_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00624">last_dof()</a>, and <a class="el" href="dof__map_8h_source.html#l00590">n_dofs_on_processor()</a>.</p>

</div>
</div>
<a id="ab96f5b260e5925063553da996bb3b428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab96f5b260e5925063553da996bb3b428">&#9670;&nbsp;</a></span>_end_old_df</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_end_old_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Last old DOF index (plus 1) on processor <code>p</code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01672">1672</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8h_source.html#l00664">end_old_dof()</a>.</p>

</div>
</div>
<a id="a33e3d8408ce7a9125dd1c22d1428fd97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33e3d8408ce7a9125dd1c22d1428fd97">&#9670;&nbsp;</a></span>_error_on_cyclic_constraint</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_error_on_cyclic_constraint</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This flag indicates whether or not we do an opt-mode check for the presence of cyclic constraints. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01493">1493</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00238">set_error_on_cyclic_constraint()</a>.</p>

</div>
</div>
<a id="a6c450ba54bc8caffac28eed88a98a17d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c450ba54bc8caffac28eed88a98a17d">&#9670;&nbsp;</a></span>_extra_send_list_context</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* libMesh::DofMap::_extra_send_list_context</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A pointer associated with the extra send list that can optionally be passed in </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01579">1579</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00429">attach_extra_send_list_function()</a>, and <a class="el" href="dof__map_8C_source.html#l01639">prepare_send_list()</a>.</p>

</div>
</div>
<a id="ad61a1aecc00b716b0cf00f68c68e7c80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad61a1aecc00b716b0cf00f68c68e7c80">&#9670;&nbsp;</a></span>_extra_send_list_function</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void(* libMesh::DofMap::_extra_send_list_function) (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function pointer to a function to call to add extra entries to the send list </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01574">1574</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00429">attach_extra_send_list_function()</a>, and <a class="el" href="dof__map_8C_source.html#l01639">prepare_send_list()</a>.</p>

</div>
</div>
<a id="a283ce213140aa281498b56e138ee8de2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a283ce213140aa281498b56e138ee8de2">&#9670;&nbsp;</a></span>_extra_sparsity_context</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* libMesh::DofMap::_extra_sparsity_context</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A pointer associated with the extra sparsity that can optionally be passed in </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01564">1564</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00406">attach_extra_sparsity_function()</a>, and <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>.</p>

</div>
</div>
<a id="a727fc57aa0deeee20ce64711b56ccf65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a727fc57aa0deeee20ce64711b56ccf65">&#9670;&nbsp;</a></span>_extra_sparsity_function</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void(* libMesh::DofMap::_extra_sparsity_function) (<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function pointer to a function to call to add extra entries to the sparsity pattern </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01557">1557</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l00406">attach_extra_sparsity_function()</a>, and <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>.</p>

</div>
</div>
<a id="ab72062de06b72df985ac5bf16837a7da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72062de06b72df985ac5bf16837a7da">&#9670;&nbsp;</a></span>_first_df</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>First DOF index on processor <code>p</code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01530">1530</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00599">first_dof()</a>, and <a class="el" href="dof__map_8h_source.html#l00590">n_dofs_on_processor()</a>.</p>

</div>
</div>
<a id="ab91d708f5167f50c0392b2fd5dea2559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab91d708f5167f50c0392b2fd5dea2559">&#9670;&nbsp;</a></span>_first_old_df</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_old_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>First old DOF index on processor <code>p</code>. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01667">1667</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8h_source.html#l00609">first_old_dof()</a>.</p>

</div>
</div>
<a id="a92da14cf60e82ed600bfe67ca3422765"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92da14cf60e82ed600bfe67ca3422765">&#9670;&nbsp;</a></span>_first_old_scalar_df</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_old_scalar_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>First old DOF index for SCALAR variable v, or garbage for non-SCALAR variable v </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01678">1678</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>.</p>

</div>
</div>
<a id="af1fc10139391d71da470387d9e4adbb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1fc10139391d71da470387d9e4adbb5">&#9670;&nbsp;</a></span>_first_scalar_df</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_scalar_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>First DOF index for SCALAR variable v, or garbage for non-SCALAR variable v </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01541">1541</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l02348">SCALAR_dof_indices()</a>.</p>

</div>
</div>
<a id="a09368a6dcd32c12d7a51dc00852982d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09368a6dcd32c12d7a51dc00852982d5">&#9670;&nbsp;</a></span>_implicit_neighbor_dofs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_implicit_neighbor_dofs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01737">1737</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01675">set_implicit_neighbor_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l01682">use_coupled_neighbor_dofs()</a>.</p>

</div>
</div>
<a id="aa6ed76ce98cd73ed8339f505a5284fef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6ed76ce98cd73ed8339f505a5284fef">&#9670;&nbsp;</a></span>_implicit_neighbor_dofs_initialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_implicit_neighbor_dofs_initialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Bools to indicate if we override the &ndash;implicit_neighbor_dofs commandline options. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01736">1736</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01675">set_implicit_neighbor_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l01682">use_coupled_neighbor_dofs()</a>.</p>

</div>
</div>
<a id="aacf8838eb951b139f05e56e338ac2195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf8838eb951b139f05e56e338ac2195">&#9670;&nbsp;</a></span>_matrices</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt;<a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&gt; * &gt; libMesh::DofMap::_matrices</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Additional matrices handled by this object. These pointers do <em>not</em> handle the memory, instead, <code><a class="el" href="classlibMesh_1_1System.html" title="Manages consistently variables, degrees of freedom, and coefficient vectors. ">System</a></code>, who told <code><a class="el" href="classlibMesh_1_1DofMap.html" title="Manages the degrees of freedom (DOFs) in a simulation. ">DofMap</a></code> about them, owns them. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01525">1525</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00262">attach_matrix()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l01739">compute_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00130">DofMap()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, and <a class="el" href="dof__map_8C_source.html#l00298">is_attached()</a>.</p>

</div>
</div>
<a id="ac0f1617e6f28fc596497b370092bcc17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0f1617e6f28fc596497b370092bcc17">&#9670;&nbsp;</a></span>_mesh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a>&amp; libMesh::DofMap::_mesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The mesh that system uses. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01518">1518</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01829">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01809">add_coupling_functor()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00130">DofMap()</a>, <a class="el" href="dof__map_8C_source.html#l01840">remove_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01820">remove_coupling_functor()</a>, and <a class="el" href="dof__map_8C_source.html#l00201">~DofMap()</a>.</p>

</div>
</div>
<a id="abedbd3a4ce19686187449a8a0557b74b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abedbd3a4ce19686187449a8a0557b74b">&#9670;&nbsp;</a></span>_mutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Threads_1_1spin__mutex.html">Threads::spin_mutex</a> libMesh::ReferenceCounter::_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Mutual exclusion object to enable thread-safe reference counting. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00135">135</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

</div>
</div>
<a id="a0964620ae8054b969297d1d9087b7b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0964620ae8054b969297d1d9087b7b05">&#9670;&nbsp;</a></span>_n_dfs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::_n_dfs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Total number of degrees of freedom. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01649">1649</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8h_source.html#l00574">n_dofs()</a>.</p>

</div>
</div>
<a id="a15dc47f3b7fdd20f9ec062de8e842561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15dc47f3b7fdd20f9ec062de8e842561">&#9670;&nbsp;</a></span>_n_nz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;* libMesh::DofMap::_n_nz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of on-processor nonzeros in my portion of the global matrix. If need_full_sparsity_pattern is true, this will just be a pointer into the corresponding sparsity pattern vector. Otherwise we have to new/delete it ourselves. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01638">1638</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00262">attach_matrix()</a>, <a class="el" href="dof__map_8C_source.html#l01771">clear_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l01739">compute_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, and <a class="el" href="dof__map_8h_source.html#l00459">get_n_nz()</a>.</p>

</div>
</div>
<a id="ad2c30f0f71dcd00f00faa8e46aa3e043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c30f0f71dcd00f00faa8e46aa3e043">&#9670;&nbsp;</a></span>_n_objects</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Threads_1_1atomic.html">Threads::atomic</a>&lt; unsigned int &gt; libMesh::ReferenceCounter::_n_objects</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of objects. Print the reference count information when the number returns to 0. </p>

<p class="definition">Definition at line <a class="el" href="reference__counter_8h_source.html#l00130">130</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="reference__counter_8h_source.html#l00083">libMesh::ReferenceCounter::n_objects()</a>, <a class="el" href="reference__counter_8h_source.html#l00148">libMesh::ReferenceCounter::ReferenceCounter()</a>, and <a class="el" href="reference__counter_8h_source.html#l00169">libMesh::ReferenceCounter::~ReferenceCounter()</a>.</p>

</div>
</div>
<a id="abbca79dca4f02ab917e89aeac3113808"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbca79dca4f02ab917e89aeac3113808">&#9670;&nbsp;</a></span>_n_old_dfs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::_n_old_dfs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Total number of degrees of freedom on old dof objects </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01662">1662</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, and <a class="el" href="dof__map_8h_source.html#l01271">n_old_dofs()</a>.</p>

</div>
</div>
<a id="a446ebcd42da6b4edbe58238cb4c12b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a446ebcd42da6b4edbe58238cb4c12b7c">&#9670;&nbsp;</a></span>_n_oz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;* libMesh::DofMap::_n_oz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of off-processor nonzeros in my portion of the global matrix; allocated similar to _n_nz. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01644">1644</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00262">attach_matrix()</a>, <a class="el" href="dof__map_8C_source.html#l01771">clear_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l01739">compute_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, and <a class="el" href="dof__map_8h_source.html#l00472">get_n_oz()</a>.</p>

</div>
</div>
<a id="a8dbee781954d22ad785846b3a2a45193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dbee781954d22ad785846b3a2a45193">&#9670;&nbsp;</a></span>_n_SCALAR_dofs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::_n_SCALAR_dofs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The total number of SCALAR dofs associated to all SCALAR variables. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01655">1655</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01163">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8h_source.html#l00579">n_SCALAR_dofs()</a>, and <a class="el" href="dof__map_8C_source.html#l00474">reinit()</a>.</p>

</div>
</div>
<a id="a8856db766d722a0edaa9f5c5d94d40f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8856db766d722a0edaa9f5c5d94d40f7">&#9670;&nbsp;</a></span>_node_constraints</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1NodeConstraints.html">NodeConstraints</a> libMesh::DofMap::_node_constraints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure containing <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> constraints. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01698">1698</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, <a class="el" href="dof__map_8h_source.html#l01812">is_constrained_node()</a>, <a class="el" href="dof__map_8h_source.html#l00810">n_constrained_nodes()</a>, <a class="el" href="dof__map_8h_source.html#l00927">node_constraint_rows_begin()</a>, and <a class="el" href="dof__map_8h_source.html#l00933">node_constraint_rows_end()</a>.</p>

</div>
</div>
<a id="ab91693b08a22cfe1af7781287157ac8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab91693b08a22cfe1af7781287157ac8a">&#9670;&nbsp;</a></span>_periodic_boundaries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a>&gt; libMesh::DofMap::_periodic_boundaries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure containing periodic boundaries. The ith entry is the constraint matrix row for boundaryid i. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01707">1707</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00130">DofMap()</a>, <a class="el" href="dof__map_8h_source.html#l01185">get_periodic_boundaries()</a>, and <a class="el" href="dof__map_8C_source.html#l00219">is_periodic_boundary()</a>.</p>

</div>
</div>
<a id="a24e7c497429c2bd81a5cc39f71cfa6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24e7c497429c2bd81a5cc39f71cfa6e0">&#9670;&nbsp;</a></span>_primal_constraint_values</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> libMesh::DofMap::_primal_constraint_values</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01689">1689</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l02703">get_info()</a>, and <a class="el" href="dof__map_8h_source.html#l01874">get_primal_constraint_values()</a>.</p>

</div>
</div>
<a id="a2b3873478d701811b9562b514fc2c369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b3873478d701811b9562b514fc2c369">&#9670;&nbsp;</a></span>_send_list</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_send_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A list containing all the global DOF indices that affect the solution on my processor. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01547">1547</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l01499">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00902">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00450">get_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l01639">prepare_send_list()</a>, and <a class="el" href="dof__map_8C_source.html#l02384">semilocal_index()</a>.</p>

</div>
</div>
<a id="ab14c66a56c0815c857dc662bea96f124"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14c66a56c0815c857dc662bea96f124">&#9670;&nbsp;</a></span>_sp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a>&gt; libMesh::DofMap::_sp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The sparsity pattern of the global matrix, kept around if it might be needed by future additions of the same type of matrix. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01630">1630</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00262">attach_matrix()</a>, <a class="el" href="dof__map_8C_source.html#l01771">clear_sparsity()</a>, and <a class="el" href="dof__map_8C_source.html#l01739">compute_sparsity()</a>.</p>

</div>
</div>
<a id="af21470daae1a06d29df4bac4807a019c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af21470daae1a06d29df4bac4807a019c">&#9670;&nbsp;</a></span>_stashed_dof_constraints</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a> libMesh::DofMap::_stashed_dof_constraints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01687">1687</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00911">stash_dof_constraints()</a>, and <a class="el" href="dof__map_8h_source.html#l00917">unstash_dof_constraints()</a>.</p>

</div>
</div>
<a id="a32b9faf7127f48555386705a952460d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32b9faf7127f48555386705a952460d6">&#9670;&nbsp;</a></span>_sys_number</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int libMesh::DofMap::_sys_number</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of the system we manage DOFs for. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01513">1513</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8h_source.html#l01744">sys_number()</a>.</p>

</div>
</div>
<a id="a04bedd57c80ef97a7d9a0a3e2fe8a248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04bedd57c80ef97a7d9a0a3e2fe8a248">&#9670;&nbsp;</a></span>_variable_group_numbers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned int&gt; libMesh::DofMap::_variable_group_numbers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The variable group number for each variable. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01508">1508</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00245">add_variable_group()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, and <a class="el" href="dof__map_8C_source.html#l02040">dof_indices()</a>.</p>

</div>
</div>
<a id="ad840cf4659b6b1a2f781d29225e82743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad840cf4659b6b1a2f781d29225e82743">&#9670;&nbsp;</a></span>_variable_groups</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a>&gt; libMesh::DofMap::_variable_groups</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The finite element type for each variable group. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01503">1503</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00245">add_variable_group()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00533">n_variable_groups()</a>, <a class="el" href="dof__map_8h_source.html#l01752">variable_group()</a>, <a class="el" href="dof__map_8h_source.html#l01782">variable_group_order()</a>, and <a class="el" href="dof__map_8h_source.html#l01802">variable_group_type()</a>.</p>

</div>
</div>
<a id="a5232a8054e580a408f394ba1574c63df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5232a8054e580a408f394ba1574c63df">&#9670;&nbsp;</a></span>_variables</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classlibMesh_1_1Variable.html">Variable</a>&gt; libMesh::DofMap::_variables</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The finite element type for each variable. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01498">1498</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00245">add_variable_group()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00541">n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l01762">variable()</a>, <a class="el" href="dof__map_8h_source.html#l01772">variable_order()</a>, and <a class="el" href="dof__map_8h_source.html#l01792">variable_type()</a>.</p>

</div>
</div>
<a id="aa8ed6583656addff061ba113f0ca4347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ed6583656addff061ba113f0ca4347">&#9670;&nbsp;</a></span>need_full_sparsity_pattern</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::need_full_sparsity_pattern</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default false; set to true if any attached matrix requires a full sparsity pattern. </p>

<p class="definition">Definition at line <a class="el" href="dof__map_8h_source.html#l01624">1624</a> of file <a class="el" href="dof__map_8h_source.html">dof_map.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="dof__map_8C_source.html#l00262">attach_matrix()</a>, <a class="el" href="dof__map_8C_source.html#l00058">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00828">clear()</a>, <a class="el" href="dof__map_8C_source.html#l01771">clear_sparsity()</a>, and <a class="el" href="dof__map_8C_source.html#l01739">compute_sparsity()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="dof__map_8h_source.html">dof_map.h</a></li>
<li><a class="el" href="dof__map_8C_source.html">dof_map.C</a></li>
<li><a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
generated by <a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a>
</small></address>
<!-- dynamic header stuff -->
<script type="text/javascript">
$(document).ready(function(){
  $(window).on('scroll',function() {
    var scrolltop = $(this).scrollTop();
    if(scrolltop >= 215) {
      $('#fixedbar').fadeIn(250);
    }
    else if(scrolltop <= 210) {
      $('#fixedbar').fadeOut(250);
    }
  });
});
</script>
<!-- Google Analytics stuff -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24978333-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
