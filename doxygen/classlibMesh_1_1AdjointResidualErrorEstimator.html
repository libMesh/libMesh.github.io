<!-- HTML header for doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libMesh: libMesh::AdjointResidualErrorEstimator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="../styles.css" rel="stylesheet" type="text/css" />
<link href="doxygen_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <nav id="fixedbar">
    <ul id="fixednav">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../support.html">About Us</a></li>
      <li><a href="../publications.html">Publications</a></li>
      <li><a href="../developers.html">Developers</a></li>
      <li><a href="../installation.html">Installation</a></li>
      <li><a href="../examples.html">Examples</a></li>
      <li><a href="../doxygen/index.html">Documentation</a></li>
    </ul>
  </nav>
  <div id="w">
    <header id="logo"><a href="index.html"><span id="logobg">SomeWebsiteLogo</span></a></header>
    <nav id="navigation">
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../support.html">About Us</a></li>
        <li><a href="../publications.html">Publications</a></li>
        <li><a href="../developers.html">Developers</a></li>
        <li><a href="../installation.html">Installation</a></li>
        <li><a href="../examples.html">Examples</a></li>
        <li><a href="../doxygen/index.html">Documentation</a></li>
      </ul>
    </nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <\!--BEGIN TITLEAREA-\-> -->
<!-- <div id="titlearea"> -->
<!-- <table cellspacing="0" cellpadding="0"> -->
<!--  <tbody> -->
<!--  <tr style="height: 56px;"> -->
<!--   <\!--BEGIN PROJECT_LOGO-\-> -->
<!--   <td id="projectlogo"><img alt="Logo" src=""/></td> -->
<!--   <\!--END PROJECT_LOGO-\-> -->
<!--   <\!--BEGIN PROJECT_NAME-\-> -->
<!--   <td style="padding-left: 0.5em;"> -->
<!--    <div id="projectname">libMesh -->
<!--    <\!--BEGIN PROJECT_NUMBER-\->&#160;<span id="projectnumber"></span><\!--END PROJECT_NUMBER-\-> -->
<!--    </div> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-><div id="projectbrief"></div><\!--END PROJECT_BRIEF-\-> -->
<!--   </td> -->
<!--   <\!--END PROJECT_NAME-\-> -->
<!--   <\!--BEGIN !PROJECT_NAME-\-> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-> -->
<!--     <td style="padding-left: 0.5em;"> -->
<!--     <div id="projectbrief"></div> -->
<!--     </td> -->
<!--    <\!--END PROJECT_BRIEF-\-> -->
<!--   <\!--END !PROJECT_NAME-\-> -->
<!--   <\!--BEGIN DISABLE_INDEX-\-> -->
<!--    <\!--BEGIN SEARCHENGINE-\-> -->
<!--    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td> -->
<!--    <\!--END SEARCHENGINE-\-> -->
<!--   <\!--END DISABLE_INDEX-\-> -->
<!--  </tr> -->
<!--  </tbody> -->
<!-- </table> -->
<!-- </div> -->
<!-- <\!--END TITLEAREA-\-> -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classlibMesh_1_1AdjointResidualErrorEstimator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::AdjointResidualErrorEstimator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for libMesh::AdjointResidualErrorEstimator:</div>
<div class="dyncontent">
<div class="center"><img src="classlibMesh_1_1AdjointResidualErrorEstimator__inherit__graph.png" border="0" usemap="#libMesh_1_1AdjointResidualErrorEstimator_inherit__map" alt="Inheritance graph"/></div>
<map name="libMesh_1_1AdjointResidualErrorEstimator_inherit__map" id="libMesh_1_1AdjointResidualErrorEstimator_inherit__map">
<area shape="rect" id="node2" href="classlibMesh_1_1ErrorEstimator.html" title="libMesh::ErrorEstimator" alt="" coords="9,5,170,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a662486f8192c2f70733efa723a9fb336"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::pair&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int &gt;, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a></td></tr>
<tr class="separator:a662486f8192c2f70733efa723a9fb336"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6a0f8337eae9e8c156680441d2840c24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a6a0f8337eae9e8c156680441d2840c24">AdjointResidualErrorEstimator</a> ()</td></tr>
<tr class="separator:a6a0f8337eae9e8c156680441d2840c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f557cdc3f18f2107ae06d34f8991b7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3f557cdc3f18f2107ae06d34f8991b7a">AdjointResidualErrorEstimator</a> (const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;)=delete</td></tr>
<tr class="separator:a3f557cdc3f18f2107ae06d34f8991b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413daf2ddf36014329d2cdaa3dd32d98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a413daf2ddf36014329d2cdaa3dd32d98">operator=</a> (const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;)=delete</td></tr>
<tr class="separator:a413daf2ddf36014329d2cdaa3dd32d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a331621d77b1c60bb166339238e036c95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a331621d77b1c60bb166339238e036c95">AdjointResidualErrorEstimator</a> (<a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;)=default</td></tr>
<tr class="separator:a331621d77b1c60bb166339238e036c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b7a77d8e14b54b65efcfb94f8ce573"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a79b7a77d8e14b54b65efcfb94f8ce573">operator=</a> (<a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;)=default</td></tr>
<tr class="separator:a79b7a77d8e14b54b65efcfb94f8ce573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb31b1283d8824410124f15246d4890"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a8eb31b1283d8824410124f15246d4890">~AdjointResidualErrorEstimator</a> ()=default</td></tr>
<tr class="separator:a8eb31b1283d8824410124f15246d4890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9930b4a3f1b7c10ac5e1412d2960632"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#ab9930b4a3f1b7c10ac5e1412d2960632">primal_error_estimator</a> ()</td></tr>
<tr class="separator:ab9930b4a3f1b7c10ac5e1412d2960632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6bc793251852fa41a61a4e34b0098b1"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#af6bc793251852fa41a61a4e34b0098b1">dual_error_estimator</a> ()</td></tr>
<tr class="separator:af6bc793251852fa41a61a4e34b0098b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b1d0230d7ba9bfc8850ffa76c01e4a1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4b1d0230d7ba9bfc8850ffa76c01e4a1">qoi_set</a> ()</td></tr>
<tr class="separator:a4b1d0230d7ba9bfc8850ffa76c01e4a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09ffc198632ee59305c99b8feec8b43f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a09ffc198632ee59305c99b8feec8b43f">qoi_set</a> () const</td></tr>
<tr class="separator:a09ffc198632ee59305c99b8feec8b43f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb44aeaa53dd5cfdb1f78794f971815"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#aabb44aeaa53dd5cfdb1f78794f971815">estimate_error</a> (const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *solution_vector=nullptr, bool estimate_parent_error=false) override</td></tr>
<tr class="separator:aabb44aeaa53dd5cfdb1f78794f971815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0605dad340ea999b5d7366326fd837a0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a0605dad340ea999b5d7366326fd837a0">type</a> () const override</td></tr>
<tr class="separator:a0605dad340ea999b5d7366326fd837a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513952f2b4a0b30834c04e1411cd030f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a513952f2b4a0b30834c04e1411cd030f">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;error_norms, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</td></tr>
<tr class="separator:a513952f2b4a0b30834c04e1411cd030f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1ddba9905e39aa89ed2aff7438b1b6e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#aa1ddba9905e39aa89ed2aff7438b1b6e">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a> &amp;errors_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</td></tr>
<tr class="separator:aa1ddba9905e39aa89ed2aff7438b1b6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a40755ebde43be4598a02b45e4f1196d4"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a></td></tr>
<tr class="separator:a40755ebde43be4598a02b45e4f1196d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a></td></tr>
<tr class="separator:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a6a5807a86e0751edc399afa2ac44ae89"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a6a5807a86e0751edc399afa2ac44ae89">reduce_error</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;error_per_cell, const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;comm) const</td></tr>
<tr class="separator:a6a5807a86e0751edc399afa2ac44ae89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a3e34dc73ee9e57e02b6204c5bdf72582"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a></td></tr>
<tr class="separator:a3e34dc73ee9e57e02b6204c5bdf72582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e1d0928ffa681b2285cedc2dfc6575e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a></td></tr>
<tr class="separator:a1e1d0928ffa681b2285cedc2dfc6575e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d04cafa87de4f7aa6ad7bac316a7a39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a></td></tr>
<tr class="separator:a4d04cafa87de4f7aa6ad7bac316a7a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements a goal oriented error indicator, by weighting residual-based estimates from the primal problem against estimates from the adjoint problem.</p>
<p>This is based on a trick suggested by Brian Carnes, (first proposed by Babuska and Miller in 1984) but if it doesn't actually work then the misunderstanding or misimplementation will be the fault of Roy Stogner. It's also Roy's fault there's no literature reference here yet.</p>
<dl class="section author"><dt>Author</dt><dd>Roy H. Stogner </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2009 </dd></dl>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00050">50</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a662486f8192c2f70733efa723a9fb336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a662486f8192c2f70733efa723a9fb336">&#9670;&nbsp;</a></span>ErrorMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::pair&lt;const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int&gt;, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> *&gt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">libMesh::ErrorEstimator::ErrorMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>When calculating many error vectors at once, we need a data structure to hold them all </p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8h_source.html#l00124">124</a> of file <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6a0f8337eae9e8c156680441d2840c24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a0f8337eae9e8c156680441d2840c24">&#9670;&nbsp;</a></span>AdjointResidualErrorEstimator() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::AdjointResidualErrorEstimator::AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Responsible for picking default subestimators. </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00041">41</a> of file <a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                                              :</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#abd4e67c1f8f49543f64859513208faa4">ErrorEstimator</a>(),</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a>(),</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>(<span class="keyword">new</span> PatchRecoveryErrorEstimator()),</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>(<span class="keyword">new</span> PatchRecoveryErrorEstimator()),</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>(QoISet())</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00139">adjoint_residual_error_estimator.h:139</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a40755ebde43be4598a02b45e4f1196d4"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">libMesh::AdjointResidualErrorEstimator::error_plot_suffix</a></div><div class="ttdeci">std::string error_plot_suffix</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00105">adjoint_residual_error_estimator.h:105</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_abd4e67c1f8f49543f64859513208faa4"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#abd4e67c1f8f49543f64859513208faa4">libMesh::ErrorEstimator::ErrorEstimator</a></div><div class="ttdeci">ErrorEstimator()=default</div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a1e1d0928ffa681b2285cedc2dfc6575e"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _dual_error_estimator</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00134">adjoint_residual_error_estimator.h:134</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a3e34dc73ee9e57e02b6204c5bdf72582"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _primal_error_estimator</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00129">adjoint_residual_error_estimator.h:129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f557cdc3f18f2107ae06d34f8991b7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f557cdc3f18f2107ae06d34f8991b7a">&#9670;&nbsp;</a></span>AdjointResidualErrorEstimator() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::AdjointResidualErrorEstimator::AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This class cannot be (default) copy constructed/assigned because it has unique_ptr members. Explicitly deleting these functions is the best way to document this fact. </p>

</div>
</div>
<a id="a331621d77b1c60bb166339238e036c95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a331621d77b1c60bb166339238e036c95">&#9670;&nbsp;</a></span>AdjointResidualErrorEstimator() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::AdjointResidualErrorEstimator::AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Defaulted move ctor, move assignment operator, and destructor. </p>

</div>
</div>
<a id="a8eb31b1283d8824410124f15246d4890"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb31b1283d8824410124f15246d4890">&#9670;&nbsp;</a></span>~AdjointResidualErrorEstimator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual libMesh::AdjointResidualErrorEstimator::~AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af6bc793251852fa41a61a4e34b0098b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6bc793251852fa41a61a4e34b0098b1">&#9670;&nbsp;</a></span>dual_error_estimator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt;&amp; libMesh::AdjointResidualErrorEstimator::dual_error_estimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access to the "subestimator" (default: PatchRecovery) to use on the dual/adjoint solution </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00084">84</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">References <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00134">_dual_error_estimator</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>; }</div><div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a1e1d0928ffa681b2285cedc2dfc6575e"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _dual_error_estimator</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00134">adjoint_residual_error_estimator.h:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aabb44aeaa53dd5cfdb1f78794f971815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabb44aeaa53dd5cfdb1f78794f971815">&#9670;&nbsp;</a></span>estimate_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::AdjointResidualErrorEstimator::estimate_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>solution_vector</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the adjoint-weighted error on each element and place it in the <code>error_per_cell</code> vector.</p>
<dl class="section note"><dt>Note</dt><dd><code>this-&gt;error_norm</code> is ignored; the error estimate is in the seminorm given by the absolute value of the error in the quantity of interest functional. The primal and dual subestimator error_norm values are used, and should be chosen appropriately for your model. </dd></dl>

<p>Implements <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00060">60</a> of file <a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00134">_dual_error_estimator</a>, <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00129">_primal_error_estimator</a>, <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00139">_qoi_set</a>, <a class="el" href="system_8h_source.html#l02300">libMesh::System::adjoint_solve()</a>, <a class="el" href="system__norm_8C_source.html#l00230">libMesh::SystemNorm::calculate_norm()</a>, <a class="el" href="error__estimator_8h_source.html#l00161">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00105">error_plot_suffix</a>, <a class="el" href="libmesh__common_8h_source.html#l00202">libMesh::ErrorVectorReal</a>, <a class="el" href="system_8C_source.html#l00969">libMesh::System::get_adjoint_solution()</a>, <a class="el" href="system_8h_source.html#l00712">libMesh::System::get_equation_systems()</a>, <a class="el" href="system_8h_source.html#l02033">libMesh::System::get_mesh()</a>, <a class="el" href="qoi__set_8h_source.html#l00221">libMesh::QoISet::has_index()</a>, <a class="el" href="int__range_8h_source.html#l00104">libMesh::index_range()</a>, <a class="el" href="system_8h_source.html#l00388">libMesh::System::is_adjoint_already_solved()</a>, <a class="el" href="system__norm_8C_source.html#l00235">libMesh::SystemNorm::is_identity()</a>, <a class="el" href="mesh__communication_8C_source.html#l01245">mesh</a>, <a class="el" href="system_8h_source.html#l02278">libMesh::System::n_qois()</a>, <a class="el" href="tecplot__io_8C_source.html#l00069">n_vars</a>, <a class="el" href="system_8h_source.html#l02105">libMesh::System::n_vars()</a>, <a class="el" href="error__vector_8C_source.html#l00210">libMesh::ErrorVector::plot_error()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, <a class="el" href="system_8h_source.html#l01523">libMesh::System::solution</a>, and <a class="el" href="qoi__set_8h_source.html#l00240">libMesh::QoISet::weight()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;estimate_error()&quot;</span>, <span class="stringliteral">&quot;AdjointResidualErrorEstimator&quot;</span>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// The current mesh</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">const</span> MeshBase &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a> = _system.get_mesh();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// Resize the error_per_cell vector to be</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// the number of elements, initialize it to 0.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  error_per_cell.resize (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.max_elem_id());</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  std::fill (error_per_cell.begin(), error_per_cell.end(), 0.);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// Get the number of variables in the system</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = _system.n_vars();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// We need to make a map of the pointer to the solution vector</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  std::map&lt;const System *, const NumericVector&lt;Number&gt; *&gt;solutionvecs;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  solutionvecs[&amp;_system] = _system.solution.get();</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// Solve the dual problem if we have to</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">if</span> (!_system.is_adjoint_already_solved())</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">// FIXME - we&#39;ll need to change a lot of APIs to make this trick</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">// work with a const System...</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      System &amp;  system = <span class="keyword">const_cast&lt;</span>System &amp;<span class="keyword">&gt;</span>(_system);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      system.adjoint_solve(<a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// Flag to check whether we have not been asked to weight the variable error contributions in any specific manner</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">bool</span> error_norm_is_identity = <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ae6cce0dd5b1659cd55e4f8430ea1bb39">is_identity</a>();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// Create an ErrorMap/ErrorVector to store the primal, dual and total_dual variable errors</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a> primal_errors_per_cell;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a> dual_errors_per_cell;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a> total_dual_errors_per_cell;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// Allocate ErrorVectors to this map if we&#39;re going to use it</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (!error_norm_is_identity)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        primal_errors_per_cell[std::make_pair(&amp;_system, v)] = <span class="keyword">new</span> ErrorVector;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        dual_errors_per_cell[std::make_pair(&amp;_system, v)] = <span class="keyword">new</span> ErrorVector;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        total_dual_errors_per_cell[std::make_pair(&amp;_system, v)] = <span class="keyword">new</span> ErrorVector;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  ErrorVector primal_error_per_cell;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  ErrorVector dual_error_per_cell;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  ErrorVector total_dual_error_per_cell;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we do</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="comment">// Estimate the primal problem error for each variable</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>-&gt;estimate_errors</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        (_system.get_equation_systems(), primal_errors_per_cell, &amp;solutionvecs, estimate_parent_error);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// If not</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">// Just get the combined error estimate</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>-&gt;estimate_error</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        (_system, primal_error_per_cell, solution_vector, estimate_parent_error);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">// Sum and weight the dual error estimate based on our QoISet</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0, n_qois = _system.n_qois(); i != n_qois; ++i)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>.<a class="code" href="classlibMesh_1_1QoISet.html#afb2189ec653ed963db3754cc6949bc8b">has_index</a>(i))</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          <span class="comment">// Get the weight for the current QoI</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> error_weight = <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>.<a class="code" href="classlibMesh_1_1QoISet.html#a3c4222c23feb8c3aab09b7589526f113">weight</a>(i);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="comment">// We need to make a map of the pointer to the adjoint solution vector</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          std::map&lt;const System *, const NumericVector&lt;Number&gt; *&gt;adjointsolutionvecs;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          adjointsolutionvecs[&amp;_system] = &amp;_system.get_adjoint_solution(i);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we have</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;              <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>-&gt;estimate_errors</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                (_system.get_equation_systems(), dual_errors_per_cell, &amp;adjointsolutionvecs,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                 estimate_parent_error);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// If not</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;              <span class="comment">// Just get the combined error estimate</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;              <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>-&gt;estimate_error</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                (_system, dual_error_per_cell, &amp;(_system.get_adjoint_solution(i)), estimate_parent_error);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          std::size_t error_size;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="comment">// Get the size of the first ErrorMap vector; this will give us the number of elements</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If in non default weights case</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;              error_size = dual_errors_per_cell[std::make_pair(&amp;_system, 0)]-&gt;size();</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// If in the standard default weights case</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;              error_size = dual_error_per_cell.size();</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="comment">// Resize the ErrorVector(s)</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordflow">if</span> (!error_norm_is_identity)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;              <span class="comment">// Loop over variables</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                  libmesh_assert(!total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;size() ||</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                 total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;size() == error_size) ;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                  total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;resize(error_size);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;              libmesh_assert(!total_dual_error_per_cell.size() ||</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                             total_dual_error_per_cell.size() == error_size);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;              total_dual_error_per_cell.resize(error_size);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="keywordflow">for</span> (std::size_t e = 0; e != error_size; ++e)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we have</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                  <span class="comment">// Loop over variables</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                      <span class="comment">// Now fill in total_dual_error ErrorMap with the weight</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                      (*total_dual_errors_per_cell[std::make_pair(&amp;_system, v)])[e] +=</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        static_cast&lt;ErrorVectorReal&gt;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        (error_weight *</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                         (*dual_errors_per_cell[std::make_pair(&amp;_system, v)])[e]);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;              <span class="keywordflow">else</span> <span class="comment">// If not</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                  total_dual_error_per_cell[e] +=</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(error_weight * dual_error_per_cell[e]);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Do some debugging plots if requested</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a>.empty())</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we have</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="comment">// Loop over variables</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;              std::ostringstream primal_out;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;              std::ostringstream dual_out;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              primal_out &lt;&lt; <span class="stringliteral">&quot;primal_&quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;              dual_out &lt;&lt; <span class="stringliteral">&quot;dual_&quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;              primal_out &lt;&lt; std::setw(1)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                         &lt;&lt; std::setprecision(0)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                         &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                         &lt;&lt; std::right</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                         &lt;&lt; v;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;              dual_out &lt;&lt; std::setw(1)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                       &lt;&lt; std::setprecision(0)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                       &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                       &lt;&lt; std::right</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                       &lt;&lt; v;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;              (*primal_errors_per_cell[std::make_pair(&amp;_system, v)]).plot_error(primal_out.str(), _system.get_mesh());</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;              (*total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]).plot_error(dual_out.str(), _system.get_mesh());</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;              primal_out.clear();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;              dual_out.clear();</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// If not</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          std::ostringstream primal_out;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          std::ostringstream dual_out;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          primal_out &lt;&lt; <span class="stringliteral">&quot;primal_&quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a> ;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          dual_out &lt;&lt; <span class="stringliteral">&quot;dual_&quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a> ;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          primal_error_per_cell.plot_error(primal_out.str(), _system.get_mesh());</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          total_dual_error_per_cell.plot_error(dual_out.str(), _system.get_mesh());</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          primal_out.clear();</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          dual_out.clear();</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// Weight the primal error by the dual error using the system norm object</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// FIXME: we ought to thread this</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(error_per_cell))</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we do</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          <span class="comment">// Create Error Vectors to pass to calculate_norm</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          std::vector&lt;Real&gt; cell_primal_error;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          std::vector&lt;Real&gt; cell_dual_error;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;              cell_primal_error.push_back((*primal_errors_per_cell[std::make_pair(&amp;_system, v)])[i]);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;              cell_dual_error.push_back((*total_dual_errors_per_cell[std::make_pair(&amp;_system, v)])[i]);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          error_per_cell[i] =</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8afa822767f85f32acc11abba82ece3">calculate_norm</a>(cell_primal_error, cell_dual_error));</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// If not</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          error_per_cell[i] = primal_error_per_cell[i]*total_dual_error_per_cell[i];</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// Deallocate the ErrorMap contents if we allocated them earlier</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">if</span> (!error_norm_is_identity)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keyword">delete</span> primal_errors_per_cell[std::make_pair(&amp;_system, v)];</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keyword">delete</span> dual_errors_per_cell[std::make_pair(&amp;_system, v)];</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keyword">delete</span> total_dual_errors_per_cell[std::make_pair(&amp;_system, v)];</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00161">error_estimator.h:161</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01245">mesh_communication.C:1245</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab64fa61b4505bc7554e508972dfaecd5"><div class="ttname"><a href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">libMesh::index_range</a></div><div class="ttdeci">IntRange&lt; std::size_t &gt; index_range(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00104">int_range.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00139">adjoint_residual_error_estimator.h:139</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00069">tecplot_io.C:69</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00202">libmesh_common.h:202</a></div></div>
<div class="ttc" id="classlibMesh_1_1QoISet_html_afb2189ec653ed963db3754cc6949bc8b"><div class="ttname"><a href="classlibMesh_1_1QoISet.html#afb2189ec653ed963db3754cc6949bc8b">libMesh::QoISet::has_index</a></div><div class="ttdeci">bool has_index(std::size_t) const</div><div class="ttdef"><b>Definition:</b> <a href="qoi__set_8h_source.html#l00221">qoi_set.h:221</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a40755ebde43be4598a02b45e4f1196d4"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">libMesh::AdjointResidualErrorEstimator::error_plot_suffix</a></div><div class="ttdeci">std::string error_plot_suffix</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00105">adjoint_residual_error_estimator.h:105</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ae6cce0dd5b1659cd55e4f8430ea1bb39"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ae6cce0dd5b1659cd55e4f8430ea1bb39">libMesh::SystemNorm::is_identity</a></div><div class="ttdeci">bool is_identity()</div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00235">system_norm.C:235</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a662486f8192c2f70733efa723a9fb336"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">libMesh::ErrorEstimator::ErrorMap</a></div><div class="ttdeci">std::map&lt; std::pair&lt; const System *, unsigned int &gt;, ErrorVector * &gt; ErrorMap</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00124">error_estimator.h:124</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a1e1d0928ffa681b2285cedc2dfc6575e"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _dual_error_estimator</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00134">adjoint_residual_error_estimator.h:134</a></div></div>
<div class="ttc" id="classlibMesh_1_1QoISet_html_a3c4222c23feb8c3aab09b7589526f113"><div class="ttname"><a href="classlibMesh_1_1QoISet.html#a3c4222c23feb8c3aab09b7589526f113">libMesh::QoISet::weight</a></div><div class="ttdeci">Real weight(std::size_t) const</div><div class="ttdef"><b>Definition:</b> <a href="qoi__set_8h_source.html#l00240">qoi_set.h:240</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ac8afa822767f85f32acc11abba82ece3"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ac8afa822767f85f32acc11abba82ece3">libMesh::SystemNorm::calculate_norm</a></div><div class="ttdeci">Real calculate_norm(const std::vector&lt; Real &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00230">system_norm.C:230</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a3e34dc73ee9e57e02b6204c5bdf72582"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _primal_error_estimator</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00129">adjoint_residual_error_estimator.h:129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a513952f2b4a0b30834c04e1411cd030f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a513952f2b4a0b30834c04e1411cd030f">&#9670;&nbsp;</a></span>estimate_errors() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This virtual function can be redefined in derived classes, but by default computes the sum of the error_per_cell for each system in the equation_systems.</p>
<p>Currently this function ignores the error_norm member variable, and uses the function argument error_norms instead.</p>
<p>This function is named estimate_errors instead of estimate_error because otherwise C++ can get confused. </p>

<p>Reimplemented in <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a8a8763fa2f4a7999a38bdc8afe7d2566">libMesh::UniformRefinementEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8C_source.html#l00047">47</a> of file <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="error__estimator_8h_source.html#l00161">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error()</a>, <a class="el" href="equation__systems_8h_source.html#l00742">libMesh::EquationSystems::get_system()</a>, <a class="el" href="int__range_8h_source.html#l00104">libMesh::index_range()</a>, and <a class="el" href="equation__systems_8h_source.html#l00637">libMesh::EquationSystems::n_systems()</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  SystemNorm old_error_norm = this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// Sum the error values from each system</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = 0; s != equation_systems.n_systems(); ++s)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      ErrorVector system_error_per_cell;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keyword">const</span> System &amp; sys = equation_systems.get_system(s);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (error_norms.find(&amp;sys) == error_norms.end())</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = error_norms.find(&amp;sys)-&gt;second;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keyword">const</span> NumericVector&lt;Number&gt; * solution_vector = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (solution_vectors &amp;&amp;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          solution_vectors-&gt;find(&amp;sys) != solution_vectors-&gt;end())</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        solution_vector = solution_vectors-&gt;find(&amp;sys)-&gt;second;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">estimate_error</a>(sys, system_error_per_cell,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                           solution_vector, estimate_parent_error);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (s)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          libmesh_assert_equal_to (error_per_cell.size(), system_error_per_cell.size());</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">index_range</a>(error_per_cell))</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            error_per_cell[i] += system_error_per_cell[i];</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        error_per_cell = system_error_per_cell;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Restore our old state before returning</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00161">error_estimator.h:161</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab64fa61b4505bc7554e508972dfaecd5"><div class="ttname"><a href="namespacelibMesh.html#ab64fa61b4505bc7554e508972dfaecd5">libMesh::index_range</a></div><div class="ttdeci">IntRange&lt; std::size_t &gt; index_range(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00104">int_range.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ab5ee8217ac35baaa00cc3b72e9815d93"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error</a></div><div class="ttdeci">virtual void estimate_error(const System &amp;system, ErrorVector &amp;error_per_cell, const NumericVector&lt; Number &gt; *solution_vector=nullptr, bool estimate_parent_error=false)=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1ddba9905e39aa89ed2aff7438b1b6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1ddba9905e39aa89ed2aff7438b1b6e">&#9670;&nbsp;</a></span>estimate_errors() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a662486f8192c2f70733efa723a9fb336">ErrorMap</a> &amp;&#160;</td>
          <td class="paramname"><em>errors_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This virtual function can be redefined in derived classes, but by default it calls estimate_error repeatedly to calculate the requested error vectors.</p>
<p>Currently this function ignores the <a class="el" href="namespacelibMesh_1_1MeshTools.html#a0701de7f01fd5eced3da4a332ff5ae51">error_norm.weight()</a> values because it calculates each variable's error individually, unscaled.</p>
<p>The user selects which errors get computed by filling a map with error vectors: If errors_per_cell[&amp;system][v] exists, it will be filled with the error values in variable <code>v</code> of <code>system</code> </p>
<p>FIXME: This is a default implementation - derived classes should reimplement it for efficiency. </p>

<p>Reimplemented in <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a7a12902561609d903b2a0404bfe808f0">libMesh::UniformRefinementEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8C_source.html#l00093">93</a> of file <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="error__estimator_8h_source.html#l00161">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error()</a>, <a class="el" href="equation__systems_8h_source.html#l00742">libMesh::EquationSystems::get_system()</a>, <a class="el" href="equation__systems_8h_source.html#l00637">libMesh::EquationSystems::n_systems()</a>, <a class="el" href="tecplot__io_8C_source.html#l00069">n_vars</a>, <a class="el" href="system_8h_source.html#l02105">libMesh::System::n_vars()</a>, and <a class="el" href="system__norm_8C_source.html#l00110">libMesh::SystemNorm::type()</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  SystemNorm old_error_norm = this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// Find the requested error values from each system</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = 0; s != equation_systems.n_systems(); ++s)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keyword">const</span> System &amp; sys = equation_systems.get_system(s);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = sys.n_vars();</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v != <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; ++v)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="comment">// Only fill in ErrorVectors the user asks for</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          <span class="keywordflow">if</span> (errors_per_cell.find(std::make_pair(&amp;sys, v)) ==</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;              errors_per_cell.end())</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <span class="comment">// Calculate error in only one variable</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          std::vector&lt;Real&gt; weights(<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>, 0.0);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          weights[v] = 1.0;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> =</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            SystemNorm(std::vector&lt;FEMNormType&gt;(<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>, old_error_norm.type(v)),</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                       weights);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keyword">const</span> NumericVector&lt;Number&gt; * solution_vector = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <span class="keywordflow">if</span> (solution_vectors &amp;&amp;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;              solution_vectors-&gt;find(&amp;sys) != solution_vectors-&gt;end())</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            solution_vector = solution_vectors-&gt;find(&amp;sys)-&gt;second;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">estimate_error</a></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            (sys, *errors_per_cell[std::make_pair(&amp;sys, v)],</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;             solution_vector, estimate_parent_error);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// Restore our old state before returning</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00161">error_estimator.h:161</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ab5ee8217ac35baaa00cc3b72e9815d93"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error</a></div><div class="ttdeci">virtual void estimate_error(const System &amp;system, ErrorVector &amp;error_per_cell, const NumericVector&lt; Number &gt; *solution_vector=nullptr, bool estimate_parent_error=false)=0</div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00069">tecplot_io.C:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a413daf2ddf36014329d2cdaa3dd32d98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a413daf2ddf36014329d2cdaa3dd32d98">&#9670;&nbsp;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a>&amp; libMesh::AdjointResidualErrorEstimator::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a79b7a77d8e14b54b65efcfb94f8ce573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79b7a77d8e14b54b65efcfb94f8ce573">&#9670;&nbsp;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a>&amp; libMesh::AdjointResidualErrorEstimator::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab9930b4a3f1b7c10ac5e1412d2960632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9930b4a3f1b7c10ac5e1412d2960632">&#9670;&nbsp;</a></span>primal_error_estimator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt;&amp; libMesh::AdjointResidualErrorEstimator::primal_error_estimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access to the "subestimator" (default: PatchRecovery) to use on the primal/forward solution </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00078">78</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">References <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00129">_primal_error_estimator</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>; }</div><div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a3e34dc73ee9e57e02b6204c5bdf72582"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _primal_error_estimator</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00129">adjoint_residual_error_estimator.h:129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b1d0230d7ba9bfc8850ffa76c01e4a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b1d0230d7ba9bfc8850ffa76c01e4a1">&#9670;&nbsp;</a></span>qoi_set() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a>&amp; libMesh::AdjointResidualErrorEstimator::qoi_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access to the <a class="el" href="classlibMesh_1_1QoISet.html" title="Used to specify quantities of interest in a simulation. ">QoISet</a> (default: weight all QoIs equally) to use when computing errors </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00090">90</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">References <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00139">_qoi_set</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>; }</div><div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00139">adjoint_residual_error_estimator.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a09ffc198632ee59305c99b8feec8b43f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09ffc198632ee59305c99b8feec8b43f">&#9670;&nbsp;</a></span>qoi_set() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a>&amp; libMesh::AdjointResidualErrorEstimator::qoi_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access to the <a class="el" href="classlibMesh_1_1QoISet.html" title="Used to specify quantities of interest in a simulation. ">QoISet</a> (default: weight all QoIs equally) to use when computing errors </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00096">96</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">References <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00139">_qoi_set</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>; }</div><div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00139">adjoint_residual_error_estimator.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a5807a86e0751edc399afa2ac44ae89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a5807a86e0751edc399afa2ac44ae89">&#9670;&nbsp;</a></span>reduce_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::reduce_error </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method takes the local error contributions in <code>error_per_cell</code> from each processor and combines them to get the global error vector. </p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8C_source.html#l00032">32</a> of file <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">libMesh::Parallel::Communicator::sum()</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00055">libMesh::WeightedPatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00153">libMesh::PatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00053">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>, and <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// parallel_object_only();</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">// Each processor has now computed the error contributions</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// for its local elements.  We may need to sum the vector to</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// recover the error for each element.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  comm.sum(error_per_cell);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a0605dad340ea999b5d7366326fd837a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0605dad340ea999b5d7366326fd837a0">&#9670;&nbsp;</a></span>type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a> libMesh::AdjointResidualErrorEstimator::type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The type for the <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> subclass. </dd></dl>

<p>Implements <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a8a3162f59ee5f231d73ab54252cfa8f1">libMesh::ErrorEstimator</a>.</p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00053">53</a> of file <a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a>.</p>

<p class="reference">References <a class="el" href="enum__error__estimator__type_8h_source.html#l00036">libMesh::ADJOINT_RESIDUAL</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7aa905ae40b37d21c9bac957364d3a4fd0">ADJOINT_RESIDUAL</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="ttc" id="namespacelibMesh_html_a370493a82a7f09613a0fdc56fc7912b7aa905ae40b37d21c9bac957364d3a4fd0"><div class="ttname"><a href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7aa905ae40b37d21c9bac957364d3a4fd0">libMesh::ADJOINT_RESIDUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__error__estimator__type_8h_source.html#l00036">enum_error_estimator_type.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1e1d0928ffa681b2285cedc2dfc6575e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e1d0928ffa681b2285cedc2dfc6575e">&#9670;&nbsp;</a></span>_dual_error_estimator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt; libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>An error estimator for the adjoint problem </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00134">134</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00084">dual_error_estimator()</a>, and <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00060">estimate_error()</a>.</p>

</div>
</div>
<a id="a3e34dc73ee9e57e02b6204c5bdf72582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e34dc73ee9e57e02b6204c5bdf72582">&#9670;&nbsp;</a></span>_primal_error_estimator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt; libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>An error estimator for the forward problem </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00129">129</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00060">estimate_error()</a>, and <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00078">primal_error_estimator()</a>.</p>

</div>
</div>
<a id="a4d04cafa87de4f7aa6ad7bac316a7a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d04cafa87de4f7aa6ad7bac316a7a39">&#9670;&nbsp;</a></span>_qoi_set</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a> libMesh::AdjointResidualErrorEstimator::_qoi_set</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A <a class="el" href="classlibMesh_1_1QoISet.html" title="Used to specify quantities of interest in a simulation. ">QoISet</a> to handle cases with multiple QoIs available </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00139">139</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00060">estimate_error()</a>, and <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00090">qoi_set()</a>.</p>

</div>
</div>
<a id="a9d626496b0b6f99f679c4ef4f0a5e46e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d626496b0b6f99f679c4ef4f0a5e46e">&#9670;&nbsp;</a></span>error_norm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> libMesh::ErrorEstimator::error_norm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>When estimating the error in a single system, the <code>error_norm</code> is used to control the scaling and norm choice for each variable. Not all estimators will support all norm choices. The default scaling is for all variables to be weighted equally. The default norm choice depends on the error estimator.</p>
<p>Part of this functionality was supported via component_scale and sobolev_order in older <a class="el" href="namespacelibMesh.html">libMesh</a> versions, and a small part was supported via component_mask in even older versions. Hopefully the encapsulation here will allow us to avoid changing this API again. </p>

<p class="definition">Definition at line <a class="el" href="error__estimator_8h_source.html#l00161">161</a> of file <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00073">libMesh::AdjointRefinementEstimator::AdjointRefinementEstimator()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00129">libMesh::DiscontinuityMeasure::boundary_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00135">libMesh::KellyErrorEstimator::boundary_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00041">libMesh::DiscontinuityMeasure::DiscontinuityMeasure()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00053">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00060">estimate_error()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="error__estimator_8C_source.html#l00047">libMesh::ErrorEstimator::estimate_errors()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00048">libMesh::ExactErrorEstimator::ExactErrorEstimator()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00401">libMesh::ExactErrorEstimator::find_squared_element_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00063">libMesh::LaplacianErrorEstimator::init_context()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00059">libMesh::DiscontinuityMeasure::init_context()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00059">libMesh::KellyErrorEstimator::init_context()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">libMesh::DiscontinuityMeasure::internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00041">libMesh::KellyErrorEstimator::KellyErrorEstimator()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00046">libMesh::LaplacianErrorEstimator::LaplacianErrorEstimator()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00112">libMesh::WeightedPatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00210">libMesh::PatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00065">libMesh::PatchRecoveryErrorEstimator::PatchRecoveryErrorEstimator()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00424">libMesh::JumpErrorEstimator::reinit_sides()</a>, and <a class="el" href="uniform__refinement__estimator_8C_source.html#l00053">libMesh::UniformRefinementEstimator::UniformRefinementEstimator()</a>.</p>

</div>
</div>
<a id="a40755ebde43be4598a02b45e4f1196d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40755ebde43be4598a02b45e4f1196d4">&#9670;&nbsp;</a></span>error_plot_suffix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::AdjointResidualErrorEstimator::error_plot_suffix</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>To aid in investigating error estimator behavior, set this string to a suffix with which to plot (prefixed by "primal_" or "dual_") the subestimator results. The suffix should end with a file extension (e.g. ".gmv") that the <a class="el" href="classlibMesh_1_1ErrorVector.html#a7fc0eea63ef2cd040db30fb206fc0a7d">ErrorVector::plot_error</a> recognizes. </p>

<p class="definition">Definition at line <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00105">105</a> of file <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00060">estimate_error()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a></li>
<li><a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
generated by <a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a>
</small></address>
<!-- dynamic header stuff -->
<script type="text/javascript">
$(document).ready(function(){
  $(window).on('scroll',function() {
    var scrolltop = $(this).scrollTop();
    if(scrolltop >= 215) {
      $('#fixedbar').fadeIn(250);
    }
    else if(scrolltop <= 210) {
      $('#fixedbar').fadeOut(250);
    }
  });
});
</script>
<!-- Google Analytics stuff -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24978333-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
