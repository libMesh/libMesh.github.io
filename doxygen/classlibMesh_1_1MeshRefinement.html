<!-- HTML header for doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libMesh: libMesh::MeshRefinement Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="../styles.css" rel="stylesheet" type="text/css" />
<link href="doxygen_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <nav id="fixedbar">
    <ul id="fixednav">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../support.html">About Us</a></li>
      <li><a href="../publications.html">Publications</a></li>
      <li><a href="../developers.html">Developers</a></li>
      <li><a href="../installation.html">Installation</a></li>
      <li><a href="../examples.html">Examples</a></li>
      <li><a href="../doxygen/index.html">Documentation</a></li>
    </ul>
  </nav>
  <div id="w">
    <header id="logo"><a href="index.html"><span id="logobg">SomeWebsiteLogo</span></a></header>
    <nav id="navigation">
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../support.html">About Us</a></li>
        <li><a href="../publications.html">Publications</a></li>
        <li><a href="../developers.html">Developers</a></li>
        <li><a href="../installation.html">Installation</a></li>
        <li><a href="../examples.html">Examples</a></li>
        <li><a href="../doxygen/index.html">Documentation</a></li>
      </ul>
    </nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <\!--BEGIN TITLEAREA-\-> -->
<!-- <div id="titlearea"> -->
<!-- <table cellspacing="0" cellpadding="0"> -->
<!--  <tbody> -->
<!--  <tr style="height: 56px;"> -->
<!--   <\!--BEGIN PROJECT_LOGO-\-> -->
<!--   <td id="projectlogo"><img alt="Logo" src=""/></td> -->
<!--   <\!--END PROJECT_LOGO-\-> -->
<!--   <\!--BEGIN PROJECT_NAME-\-> -->
<!--   <td style="padding-left: 0.5em;"> -->
<!--    <div id="projectname">libMesh -->
<!--    <\!--BEGIN PROJECT_NUMBER-\->&#160;<span id="projectnumber"></span><\!--END PROJECT_NUMBER-\-> -->
<!--    </div> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-><div id="projectbrief"></div><\!--END PROJECT_BRIEF-\-> -->
<!--   </td> -->
<!--   <\!--END PROJECT_NAME-\-> -->
<!--   <\!--BEGIN !PROJECT_NAME-\-> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-> -->
<!--     <td style="padding-left: 0.5em;"> -->
<!--     <div id="projectbrief"></div> -->
<!--     </td> -->
<!--    <\!--END PROJECT_BRIEF-\-> -->
<!--   <\!--END !PROJECT_NAME-\-> -->
<!--   <\!--BEGIN DISABLE_INDEX-\-> -->
<!--    <\!--BEGIN SEARCHENGINE-\-> -->
<!--    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td> -->
<!--    <\!--END SEARCHENGINE-\-> -->
<!--   <\!--END DISABLE_INDEX-\-> -->
<!--  </tr> -->
<!--  </tbody> -->
<!-- </table> -->
<!-- </div> -->
<!-- <\!--END TITLEAREA-\-> -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classlibMesh_1_1MeshRefinement-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::MeshRefinement Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Responsible for mesh refinement algorithms and data.  
 <a href="classlibMesh_1_1MeshRefinement.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for libMesh::MeshRefinement:</div>
<div class="dyncontent">
<div class="center"><img src="classlibMesh_1_1MeshRefinement__inherit__graph.png" border="0" usemap="#libMesh_1_1MeshRefinement_inherit__map" alt="Inheritance graph"/></div>
<map name="libMesh_1_1MeshRefinement_inherit__map" id="libMesh_1_1MeshRefinement_inherit__map">
<area shape="rect" id="node2" href="classlibMesh_1_1ParallelObject.html" title="An object whose state is distributed along a set of processors. " alt="" coords="14,5,173,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement_1_1ElementFlagging.html">ElementFlagging</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa08885aefc8dbd6572f9b2478b17e92f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#aa08885aefc8dbd6572f9b2478b17e92f">MeshRefinement</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>)</td></tr>
<tr class="separator:aa08885aefc8dbd6572f9b2478b17e92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bec9c92d8089a8b3098643defa4a83a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a9bec9c92d8089a8b3098643defa4a83a">set_periodic_boundaries_ptr</a> (<a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> *pb_ptr)</td></tr>
<tr class="separator:a9bec9c92d8089a8b3098643defa4a83a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2b4fc8fbeef7897987b69fdba7d2ccc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac2b4fc8fbeef7897987b69fdba7d2ccc">~MeshRefinement</a> ()</td></tr>
<tr class="separator:ac2b4fc8fbeef7897987b69fdba7d2ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac64e4f1afa4af23fe11997dfbeae071b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac64e4f1afa4af23fe11997dfbeae071b">clear</a> ()</td></tr>
<tr class="separator:ac64e4f1afa4af23fe11997dfbeae071b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef885bd531649c9d0738f2e9c65b53b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a6ef885bd531649c9d0738f2e9c65b53b">flag_elements_by_error_fraction</a> (const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> <a class="el" href="classlibMesh_1_1MeshRefinement.html#ac65900f46067a75f67814fc91ef05d4b">refine_fraction</a>=0.3, const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> <a class="el" href="classlibMesh_1_1MeshRefinement.html#afc484f7cbbb97079dee552daaaa06613">coarsen_fraction</a>=0.0, const unsigned int max_level=<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</td></tr>
<tr class="separator:a6ef885bd531649c9d0738f2e9c65b53b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31da3a2dbca4c3e0a893090f4e467ddc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a31da3a2dbca4c3e0a893090f4e467ddc">flag_elements_by_error_tolerance</a> (const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell)</td></tr>
<tr class="separator:a31da3a2dbca4c3e0a893090f4e467ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700c8faeb937a543ced5e3979ab06033"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a700c8faeb937a543ced5e3979ab06033">flag_elements_by_nelem_target</a> (const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell)</td></tr>
<tr class="separator:a700c8faeb937a543ced5e3979ab06033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e328f89c951deca3895d130750ac07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a50e328f89c951deca3895d130750ac07">flag_elements_by_elem_fraction</a> (const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> <a class="el" href="classlibMesh_1_1MeshRefinement.html#ac65900f46067a75f67814fc91ef05d4b">refine_fraction</a>=0.3, const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> <a class="el" href="classlibMesh_1_1MeshRefinement.html#afc484f7cbbb97079dee552daaaa06613">coarsen_fraction</a>=0.0, const unsigned int max_level=<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</td></tr>
<tr class="separator:a50e328f89c951deca3895d130750ac07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0377024040f50645b4eec3d8ebc3268"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ae0377024040f50645b4eec3d8ebc3268">flag_elements_by_mean_stddev</a> (const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> <a class="el" href="classlibMesh_1_1MeshRefinement.html#ac65900f46067a75f67814fc91ef05d4b">refine_fraction</a>=1.0, const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> <a class="el" href="classlibMesh_1_1MeshRefinement.html#afc484f7cbbb97079dee552daaaa06613">coarsen_fraction</a>=0.0, const unsigned int max_level=<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</td></tr>
<tr class="separator:ae0377024040f50645b4eec3d8ebc3268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadfc9d7cb09e236a9e04f06cce8d2ecc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#aadfc9d7cb09e236a9e04f06cce8d2ecc">flag_elements_by</a> (<a class="el" href="classlibMesh_1_1MeshRefinement_1_1ElementFlagging.html">ElementFlagging</a> &amp;element_flagging)</td></tr>
<tr class="separator:aadfc9d7cb09e236a9e04f06cce8d2ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f565f6b741867544c70a2c96ef728f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a4f565f6b741867544c70a2c96ef728f0">switch_h_to_p_refinement</a> ()</td></tr>
<tr class="separator:a4f565f6b741867544c70a2c96ef728f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f2ecc36e231ddc26798014ee133045"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ab3f2ecc36e231ddc26798014ee133045">add_p_to_h_refinement</a> ()</td></tr>
<tr class="separator:ab3f2ecc36e231ddc26798014ee133045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59312babe07e6584cba0c25c9e86824"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ab59312babe07e6584cba0c25c9e86824">refine_and_coarsen_elements</a> ()</td></tr>
<tr class="separator:ab59312babe07e6584cba0c25c9e86824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a429ba27c5fa2e7bb910c7199c4a0bafd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a429ba27c5fa2e7bb910c7199c4a0bafd">coarsen_elements</a> ()</td></tr>
<tr class="separator:a429ba27c5fa2e7bb910c7199c4a0bafd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8164c3ac46f98365b9b0c937b6e288a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ae8164c3ac46f98365b9b0c937b6e288a">refine_elements</a> ()</td></tr>
<tr class="separator:ae8164c3ac46f98365b9b0c937b6e288a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a406e53c22bd8c9e2cefa862ef02f226f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a406e53c22bd8c9e2cefa862ef02f226f">uniformly_refine</a> (unsigned int n=1)</td></tr>
<tr class="separator:a406e53c22bd8c9e2cefa862ef02f226f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c090a5a22834d33fa0d436fbccab795"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a0c090a5a22834d33fa0d436fbccab795">uniformly_coarsen</a> (unsigned int n=1)</td></tr>
<tr class="separator:a0c090a5a22834d33fa0d436fbccab795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8b117eccc68c96f20c0c0b4045303e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac8b117eccc68c96f20c0c0b4045303e8">uniformly_p_refine</a> (unsigned int n=1)</td></tr>
<tr class="separator:ac8b117eccc68c96f20c0c0b4045303e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19810e55f1ba17b88aa665e8c31cb5a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a19810e55f1ba17b88aa665e8c31cb5a2">uniformly_p_coarsen</a> (unsigned int n=1)</td></tr>
<tr class="separator:a19810e55f1ba17b88aa665e8c31cb5a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6930cd279030a81ff6d36a40809b1fd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">clean_refinement_flags</a> ()</td></tr>
<tr class="separator:a6930cd279030a81ff6d36a40809b1fd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f90c35be7bbebea889c925b6f20713a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a> (bool libmesh_assert_yes=false)</td></tr>
<tr class="separator:a4f90c35be7bbebea889c925b6f20713a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a95dae49cbfe9cb0ab381f14ccc337c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a2a95dae49cbfe9cb0ab381f14ccc337c">test_unflagged</a> (bool libmesh_assert_yes=false)</td></tr>
<tr class="separator:a2a95dae49cbfe9cb0ab381f14ccc337c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb6f0822dc243ae06b7c801da5cca6a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1Node.html">Node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a9fb6f0822dc243ae06b7c801da5cca6a">add_node</a> (<a class="el" href="classlibMesh_1_1Elem.html">Elem</a> &amp;parent, unsigned int child, unsigned int node, <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> proc_id)</td></tr>
<tr class="separator:a9fb6f0822dc243ae06b7c801da5cca6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a052c0307f8d231199f9a5d20b9d698ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a052c0307f8d231199f9a5d20b9d698ca">add_elem</a> (<a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *elem)</td></tr>
<tr class="separator:a052c0307f8d231199f9a5d20b9d698ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2914437c9011c3a88ec7ebc6e7d8562"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac2914437c9011c3a88ec7ebc6e7d8562">get_mesh</a> () const</td></tr>
<tr class="separator:ac2914437c9011c3a88ec7ebc6e7d8562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5fca6c48816c0221eea5c120571649f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ae5fca6c48816c0221eea5c120571649f">get_mesh</a> ()</td></tr>
<tr class="separator:ae5fca6c48816c0221eea5c120571649f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5db36c33bd581e101f38bcc1f3d2ce5d"><td class="memItemLeft" align="right" valign="top">bool &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a5db36c33bd581e101f38bcc1f3d2ce5d">coarsen_by_parents</a> ()</td></tr>
<tr class="separator:a5db36c33bd581e101f38bcc1f3d2ce5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65900f46067a75f67814fc91ef05d4b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac65900f46067a75f67814fc91ef05d4b">refine_fraction</a> ()</td></tr>
<tr class="separator:ac65900f46067a75f67814fc91ef05d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc484f7cbbb97079dee552daaaa06613"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#afc484f7cbbb97079dee552daaaa06613">coarsen_fraction</a> ()</td></tr>
<tr class="separator:afc484f7cbbb97079dee552daaaa06613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa761b1dfd3fd39c9b823a772d9f4f0ea"><td class="memItemLeft" align="right" valign="top">unsigned int &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#aa761b1dfd3fd39c9b823a772d9f4f0ea">max_h_level</a> ()</td></tr>
<tr class="separator:aa761b1dfd3fd39c9b823a772d9f4f0ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a811a18927f38ec427530bd7cb126c3a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a811a18927f38ec427530bd7cb126c3a0">coarsen_threshold</a> ()</td></tr>
<tr class="separator:a811a18927f38ec427530bd7cb126c3a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e38c68d99dd71d4c99756aa67f3d3f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a8e38c68d99dd71d4c99756aa67f3d3f5">nelem_target</a> ()</td></tr>
<tr class="separator:a8e38c68d99dd71d4c99756aa67f3d3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd3b275dc8d45ac914f638cc7179c9a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a3cd3b275dc8d45ac914f638cc7179c9a">absolute_global_tolerance</a> ()</td></tr>
<tr class="separator:a3cd3b275dc8d45ac914f638cc7179c9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81fa55fe9538fded1391a56952aa1376"><td class="memItemLeft" align="right" valign="top">unsigned char &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a81fa55fe9538fded1391a56952aa1376">face_level_mismatch_limit</a> ()</td></tr>
<tr class="separator:a81fa55fe9538fded1391a56952aa1376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb3800bb748de340a82caef581ed43d"><td class="memItemLeft" align="right" valign="top">unsigned char &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#adeb3800bb748de340a82caef581ed43d">edge_level_mismatch_limit</a> ()</td></tr>
<tr class="separator:adeb3800bb748de340a82caef581ed43d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7508c29a7083069c0c4d325c3bb27a"><td class="memItemLeft" align="right" valign="top">unsigned char &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a7c7508c29a7083069c0c4d325c3bb27a">node_level_mismatch_limit</a> ()</td></tr>
<tr class="separator:a7c7508c29a7083069c0c4d325c3bb27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa30997ed9b31c99e61cb77ba0183403"><td class="memItemLeft" align="right" valign="top">signed char &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#afa30997ed9b31c99e61cb77ba0183403">overrefined_boundary_limit</a> ()</td></tr>
<tr class="separator:afa30997ed9b31c99e61cb77ba0183403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3af86e696b675d6385dd1fda3e4933e"><td class="memItemLeft" align="right" valign="top">signed char &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ab3af86e696b675d6385dd1fda3e4933e">underrefined_boundary_limit</a> ()</td></tr>
<tr class="separator:ab3af86e696b675d6385dd1fda3e4933e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e925a80a9435e0d2d2a5f6113050043"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">make_flags_parallel_consistent</a> ()</td></tr>
<tr class="separator:a0e925a80a9435e0d2d2a5f6113050043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a599fc777ab63147d13cb552a0ecde8a8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a599fc777ab63147d13cb552a0ecde8a8">get_enforce_mismatch_limit_prior_to_refinement</a> ()</td></tr>
<tr class="separator:a599fc777ab63147d13cb552a0ecde8a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e894aa781331e9ff5686720b56cba2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac6e894aa781331e9ff5686720b56cba2">set_enforce_mismatch_limit_prior_to_refinement</a> (bool enforce)</td></tr>
<tr class="separator:ac6e894aa781331e9ff5686720b56cba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e18ee522c67a8eb52dd58f6374686d2"><td class="memItemLeft" align="right" valign="top">bool &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">enforce_mismatch_limit_prior_to_refinement</a> ()</td></tr>
<tr class="separator:a4e18ee522c67a8eb52dd58f6374686d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dfeba78f759a8e42683bb559ce1e9fa"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a> () const</td></tr>
<tr class="separator:a4dfeba78f759a8e42683bb559ce1e9fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6fe0cda2874d85c373ba4493822651c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a> () const</td></tr>
<tr class="separator:aa6fe0cda2874d85c373ba4493822651c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62700690227d24d28c853ab62d38ebb9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a> () const</td></tr>
<tr class="separator:a62700690227d24d28c853ab62d38ebb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1ffb5b08919ab435109a302f94a7b3eb"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a></td></tr>
<tr class="separator:a1ffb5b08919ab435109a302f94a7b3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a3b5e2d673faf6f8d4db8b2da3e1f8824"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824">NeighborType</a> { <a class="el" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36">POINT</a>, 
<a class="el" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea">EDGE</a>
 }</td></tr>
<tr class="separator:a3b5e2d673faf6f8d4db8b2da3e1f8824"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a9d8a1efbac7596e00f3281a51f5ba8fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a9d8a1efbac7596e00f3281a51f5ba8fe">MeshRefinement</a> (const <a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a> &amp;)</td></tr>
<tr class="separator:a9d8a1efbac7596e00f3281a51f5ba8fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad627b508017c8838cf513933dd6bdd00"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ad627b508017c8838cf513933dd6bdd00">operator=</a> (const <a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a> &amp;)</td></tr>
<tr class="separator:ad627b508017c8838cf513933dd6bdd00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ef7ebd80c846f24998ef0f222c55e1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a46ef7ebd80c846f24998ef0f222c55e1">_coarsen_elements</a> ()</td></tr>
<tr class="separator:a46ef7ebd80c846f24998ef0f222c55e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad794507aa1e1908fea6fb373dd31c548"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ad794507aa1e1908fea6fb373dd31c548">_refine_elements</a> ()</td></tr>
<tr class="separator:ad794507aa1e1908fea6fb373dd31c548"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86813ddc62a0fa53467a55688bae38ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a86813ddc62a0fa53467a55688bae38ce">_smooth_flags</a> (bool refining, bool coarsening)</td></tr>
<tr class="separator:a86813ddc62a0fa53467a55688bae38ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc5744304854c3ce239abced653624e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#acbc5744304854c3ce239abced653624e">limit_level_mismatch_at_node</a> (const unsigned int max_mismatch)</td></tr>
<tr class="separator:acbc5744304854c3ce239abced653624e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6726f2900feee33e74f571aa31a9d545"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a6726f2900feee33e74f571aa31a9d545">limit_level_mismatch_at_edge</a> (const unsigned int max_mismatch)</td></tr>
<tr class="separator:a6726f2900feee33e74f571aa31a9d545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d051c8d27a2abc3ab879f2f982bbcb0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a3d051c8d27a2abc3ab879f2f982bbcb0">limit_overrefined_boundary</a> (const signed char max_mismatch)</td></tr>
<tr class="separator:a3d051c8d27a2abc3ab879f2f982bbcb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eef84fcf5c69894597662b16b8cf373"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a2eef84fcf5c69894597662b16b8cf373">limit_underrefined_boundary</a> (const signed char max_mismatch)</td></tr>
<tr class="separator:a2eef84fcf5c69894597662b16b8cf373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f57c999ade430e94e7cf25bfc97eb07"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a2f57c999ade430e94e7cf25bfc97eb07">eliminate_unrefined_patches</a> ()</td></tr>
<tr class="separator:a2f57c999ade430e94e7cf25bfc97eb07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac25b931ac102cee61e84fac044bdbf0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">create_parent_error_vector</a> (const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_parent, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;parent_error_min, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;parent_error_max)</td></tr>
<tr class="separator:ac25b931ac102cee61e84fac044bdbf0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fbd7b73883ab6ad3f587a7e6e756ab0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a2fbd7b73883ab6ad3f587a7e6e756ab0">update_nodes_map</a> ()</td></tr>
<tr class="separator:a2fbd7b73883ab6ad3f587a7e6e756ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae7cec33d6f1fe1c28f4cbda2449df1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">make_coarsening_compatible</a> ()</td></tr>
<tr class="separator:a1ae7cec33d6f1fe1c28f4cbda2449df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b5b704315a18872765740e9b88ce24"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">make_refinement_compatible</a> ()</td></tr>
<tr class="separator:af8b5b704315a18872765740e9b88ce24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6afb4f67a92e0d3cebf6cbcd27fc22e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">topological_neighbor</a> (<a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *elem, const <a class="el" href="classlibMesh_1_1PointLocatorBase.html">PointLocatorBase</a> *point_locator, const unsigned int <a class="el" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>)</td></tr>
<tr class="separator:a6afb4f67a92e0d3cebf6cbcd27fc22e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2ced3c8ba705a7e3b7b48c6721f7062"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ac2ced3c8ba705a7e3b7b48c6721f7062">has_topological_neighbor</a> (const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *elem, const <a class="el" href="classlibMesh_1_1PointLocatorBase.html">PointLocatorBase</a> *point_locator, const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *neighbor)</td></tr>
<tr class="separator:ac2ced3c8ba705a7e3b7b48c6721f7062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8651f3ae66141c3270f519d8bdd7efe5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a8651f3ae66141c3270f519d8bdd7efe5">enforce_mismatch_limit_prior_to_refinement</a> (<a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *elem, <a class="el" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824">NeighborType</a> nt, unsigned max_mismatch)</td></tr>
<tr class="separator:a8651f3ae66141c3270f519d8bdd7efe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a668c8ef9154f08b469eb9d90dd2074d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1TopologyMap.html">TopologyMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">_new_nodes_map</a></td></tr>
<tr class="separator:a668c8ef9154f08b469eb9d90dd2074d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df23471791e621cfeb7a7828c8c73a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a></td></tr>
<tr class="separator:a6df23471791e621cfeb7a7828c8c73a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdeef5e2ff1463f80d57bd343f5ce0f6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a></td></tr>
<tr class="separator:acdeef5e2ff1463f80d57bd343f5ce0f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6fda707e1285340135e56469b055746"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a></td></tr>
<tr class="separator:ab6fda707e1285340135e56469b055746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af56d90ecbcb73303903c0e298eea13ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a></td></tr>
<tr class="separator:af56d90ecbcb73303903c0e298eea13ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e98b91b8eb9b6ddcf0dff673a1a281"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a></td></tr>
<tr class="separator:a04e98b91b8eb9b6ddcf0dff673a1a281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ebcf25e84315a95e59128b57c5834f"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a></td></tr>
<tr class="separator:a80ebcf25e84315a95e59128b57c5834f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4c09ce1e49edffc4b7f196d4b91b8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">_coarsen_threshold</a></td></tr>
<tr class="separator:aef4c09ce1e49edffc4b7f196d4b91b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ac4703621b5298120f5028c99bd94de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a7ac4703621b5298120f5028c99bd94de">_nelem_target</a></td></tr>
<tr class="separator:a7ac4703621b5298120f5028c99bd94de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea1a97aa9a8e4a8ec1967050c96f5b13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#aea1a97aa9a8e4a8ec1967050c96f5b13">_absolute_global_tolerance</a></td></tr>
<tr class="separator:aea1a97aa9a8e4a8ec1967050c96f5b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56f1015a59736175b39e4a1ca4d084bc"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a></td></tr>
<tr class="separator:a56f1015a59736175b39e4a1ca4d084bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae705082e7bc067be443b6792c1be54d6"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">_edge_level_mismatch_limit</a></td></tr>
<tr class="separator:ae705082e7bc067be443b6792c1be54d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae794162fe8b50db70bb236ef9cbe68ab"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">_node_level_mismatch_limit</a></td></tr>
<tr class="separator:ae794162fe8b50db70bb236ef9cbe68ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a4151995d4be05f4d7bf890b1e3234b"><td class="memItemLeft" align="right" valign="top">signed char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">_overrefined_boundary_limit</a></td></tr>
<tr class="separator:a4a4151995d4be05f4d7bf890b1e3234b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee86268abe102ac27effa05bbf6fa15"><td class="memItemLeft" align="right" valign="top">signed char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">_underrefined_boundary_limit</a></td></tr>
<tr class="separator:a1ee86268abe102ac27effa05bbf6fa15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380986d25467e922fc62f0f6f0f33d48"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">_enforce_mismatch_limit_prior_to_refinement</a></td></tr>
<tr class="separator:a380986d25467e922fc62f0f6f0f33d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a409d8f3852a859271fafc5b466bb8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a></td></tr>
<tr class="separator:a47a409d8f3852a859271fafc5b466bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Responsible for mesh refinement algorithms and data. </p>
<p>This is the <code><a class="el" href="classlibMesh_1_1MeshRefinement.html" title="Responsible for mesh refinement algorithms and data. ">MeshRefinement</a></code> class. This class implements adaptive mesh refinement algorithms for a <code><a class="el" href="classlibMesh_1_1MeshBase.html" title="Base class for Mesh. ">MeshBase</a></code>.</p>
<dl class="section author"><dt>Author</dt><dd>Benjamin S. Kirk </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-2007 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00058">58</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a3b5e2d673faf6f8d4db8b2da3e1f8824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5e2d673faf6f8d4db8b2da3e1f8824">&#9670;&nbsp;</a></span>NeighborType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824">libMesh::MeshRefinement::NeighborType</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This helper function enforces the desired mismatch limits prior to refinement. It is called from the <a class="el" href="classlibMesh_1_1MeshRefinement.html#a6726f2900feee33e74f571aa31a9d545">MeshRefinement::limit_level_mismatch_at_edge()</a> and <a class="el" href="classlibMesh_1_1MeshRefinement.html#acbc5744304854c3ce239abced653624e">MeshRefinement::limit_level_mismatch_at_node()</a> functions.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if this enforcement caused the refinement flags for <code>elem</code> to change, false otherwise. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36"></a>POINT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea"></a>EDGE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00855">855</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;{<a class="code" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36">POINT</a>, <a class="code" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea">EDGE</a>};</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea">libMesh::MeshRefinement::EDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00855">mesh_refinement.h:855</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36">libMesh::MeshRefinement::POINT</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00855">mesh_refinement.h:855</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa08885aefc8dbd6572f9b2478b17e92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa08885aefc8dbd6572f9b2478b17e92f">&#9670;&nbsp;</a></span>MeshRefinement() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::MeshRefinement::MeshRefinement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00093">93</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                            :</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="classlibMesh_1_1ParallelObject.html#a503a851291cc9665284daf6a304337a5">ParallelObject</a>(m),</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>(m),</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a>(<span class="keyword">false</span>),</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a>(<span class="keyword">false</span>),</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>(0.3),</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>(0.0),</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a>(<a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>),</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">_coarsen_threshold</a>(10),</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a7ac4703621b5298120f5028c99bd94de">_nelem_target</a>(0),</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#aea1a97aa9a8e4a8ec1967050c96f5b13">_absolute_global_tolerance</a>(0.0),</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>(1),</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">_edge_level_mismatch_limit</a>(0),</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">_node_level_mismatch_limit</a>(0),</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">_overrefined_boundary_limit</a>(0),</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">_underrefined_boundary_limit</a>(0),</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">_enforce_mismatch_limit_prior_to_refinement</a>(<span class="keyword">false</span>)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  , <a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>(<span class="keyword">nullptr</span>)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a9bec9c92d8089a8b3098643defa4a83a">MeshRefinement::set_periodic_boundaries_ptr</a>(PeriodicBoundaries * pb_ptr)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a> = pb_ptr;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1ParallelObject_html_a503a851291cc9665284daf6a304337a5"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a503a851291cc9665284daf6a304337a5">libMesh::ParallelObject::ParallelObject</a></div><div class="ttdeci">ParallelObject(const Parallel::Communicator &amp;comm_in)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00058">parallel_object.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a04e98b91b8eb9b6ddcf0dff673a1a281"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">libMesh::MeshRefinement::_coarsen_fraction</a></div><div class="ttdeci">Real _coarsen_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00759">mesh_refinement.h:759</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af56d90ecbcb73303903c0e298eea13ec"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">libMesh::MeshRefinement::_refine_fraction</a></div><div class="ttdeci">Real _refine_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00757">mesh_refinement.h:757</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a80ebcf25e84315a95e59128b57c5834f"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">libMesh::MeshRefinement::_max_h_level</a></div><div class="ttdeci">unsigned int _max_h_level</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00761">mesh_refinement.h:761</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a47a409d8f3852a859271fafc5b466bb8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">libMesh::MeshRefinement::_periodic_boundaries</a></div><div class="ttdeci">PeriodicBoundaries * _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00861">mesh_refinement.h:861</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a1ee86268abe102ac27effa05bbf6fa15"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">libMesh::MeshRefinement::_underrefined_boundary_limit</a></div><div class="ttdeci">signed char _underrefined_boundary_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00774">mesh_refinement.h:774</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a56f1015a59736175b39e4a1ca4d084bc"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">libMesh::MeshRefinement::_face_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _face_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00769">mesh_refinement.h:769</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4a4151995d4be05f4d7bf890b1e3234b"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">libMesh::MeshRefinement::_overrefined_boundary_limit</a></div><div class="ttdeci">signed char _overrefined_boundary_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00773">mesh_refinement.h:773</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a380986d25467e922fc62f0f6f0f33d48"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">libMesh::MeshRefinement::_enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool _enforce_mismatch_limit_prior_to_refinement</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00844">mesh_refinement.h:844</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ae794162fe8b50db70bb236ef9cbe68ab"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">libMesh::MeshRefinement::_node_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _node_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00771">mesh_refinement.h:771</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_aef4c09ce1e49edffc4b7f196d4b91b8a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">libMesh::MeshRefinement::_coarsen_threshold</a></div><div class="ttdeci">Real _coarsen_threshold</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00763">mesh_refinement.h:763</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ae705082e7bc067be443b6792c1be54d6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">libMesh::MeshRefinement::_edge_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _edge_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00770">mesh_refinement.h:770</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a7ac4703621b5298120f5028c99bd94de"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a7ac4703621b5298120f5028c99bd94de">libMesh::MeshRefinement::_nelem_target</a></div><div class="ttdeci">dof_id_type _nelem_target</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00765">mesh_refinement.h:765</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a9bec9c92d8089a8b3098643defa4a83a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a9bec9c92d8089a8b3098643defa4a83a">libMesh::MeshRefinement::set_periodic_boundaries_ptr</a></div><div class="ttdeci">void set_periodic_boundaries_ptr(PeriodicBoundaries *pb_ptr)</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ab6fda707e1285340135e56469b055746"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">libMesh::MeshRefinement::_coarsen_by_parents</a></div><div class="ttdeci">bool _coarsen_by_parents</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00755">mesh_refinement.h:755</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_aea1a97aa9a8e4a8ec1967050c96f5b13"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#aea1a97aa9a8e4a8ec1967050c96f5b13">libMesh::MeshRefinement::_absolute_global_tolerance</a></div><div class="ttdeci">Real _absolute_global_tolerance</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00767">mesh_refinement.h:767</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d8a1efbac7596e00f3281a51f5ba8fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8a1efbac7596e00f3281a51f5ba8fe">&#9670;&nbsp;</a></span>MeshRefinement() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::MeshRefinement::MeshRefinement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2b4fc8fbeef7897987b69fdba7d2ccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2b4fc8fbeef7897987b69fdba7d2ccc">&#9670;&nbsp;</a></span>~MeshRefinement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::MeshRefinement::~MeshRefinement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destructor. Deletes all the elements that are currently stored. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00127">127</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8C_source.html#l00134">clear()</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#ac64e4f1afa4af23fe11997dfbeae071b">clear</a>();</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac64e4f1afa4af23fe11997dfbeae071b"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac64e4f1afa4af23fe11997dfbeae071b">libMesh::MeshRefinement::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00134">mesh_refinement.C:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a46ef7ebd80c846f24998ef0f222c55e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46ef7ebd80c846f24998ef0f222c55e1">&#9670;&nbsp;</a></span>_coarsen_elements()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::_coarsen_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Coarsens user-requested elements. Both coarsen_elements and refine_elements used to be in the public interface for the <a class="el" href="classlibMesh_1_1MeshRefinement.html" title="Responsible for mesh refinement algorithms and data. ">MeshRefinement</a> object. Unfortunately, without proper preparation (make_refinement_compatible, make_coarsening_compatible) at least <a class="el" href="classlibMesh_1_1MeshRefinement.html#a429ba27c5fa2e7bb910c7199c4a0bafd">coarsen_elements()</a> did not work alone. By making them private, we signal to the user that they are not part of the interface. It is possible that for a given set of refinement flags there is actually no change upon calling this member function.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the mesh actually changed (hence data needs to be projected) and <code>false</code> otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01335">1335</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8C_source.html#l00134">clear()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="elem_8h_source.html#l01204">libMesh::Elem::COARSEN_INACTIVE</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>, <a class="el" href="mesh__base_8h_source.html#l00131">libMesh::MeshBase::get_boundary_info()</a>, <a class="el" href="mesh__base_8h_source.html#l00154">libMesh::MeshBase::is_serial()</a>, <a class="el" href="elem_8h_source.html#l01202">libMesh::Elem::JUST_COARSENED</a>, <a class="el" href="mesh__communication_8C_source.html#l01763">libMesh::MeshCommunication::make_nodes_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01529">libMesh::MeshCommunication::make_p_levels_parallel_consistent()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="boundary__info_8C_source.html#l01321">libMesh::BoundaryInfo::remove()</a>, <a class="el" href="mesh__communication_8C_source.html#l00915">libMesh::MeshCommunication::send_coarse_ghosts()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00345">update_nodes_map()</a>, and <a class="el" href="classlibMesh_1_1MeshBase.html#ae10a5f947142866d4a1c1409973b1582">libMesh::MeshBase::update_parallel_id_counts()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00607">coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01701">uniformly_coarsen()</a>.</p>
<div class="fragment"><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;{</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  parallel_object_only();</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  LOG_SCOPE (<span class="stringliteral">&quot;_coarsen_elements()&quot;</span>, <span class="stringliteral">&quot;MeshRefinement&quot;</span>);</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="comment">// Flags indicating if this call actually changes the mesh</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordtype">bool</span> mesh_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordtype">bool</span> mesh_p_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="comment">// Clear the unused_elements data structure.</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="comment">// The elements have been packed since it was built,</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="comment">// so there are _no_ unused elements.  We cannot trust</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="comment">// any iterators currently in this data structure.</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="comment">// _unused_elements.clear();</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="comment">// Loop over the elements first to determine if the mesh will</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="comment">// undergo h-coarsening.  If it will, then we&#39;ll need to communicate</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="comment">// more ghosted elements.  We need to communicate them *before* we</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="comment">// do the coarsening; otherwise it is possible to coarsen away a</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">// one-element-thick layer partition and leave the partitions on</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">// either side unable to figure out how to talk to each other.</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        mesh_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      }</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">// If the mesh changed on any processor, it changed globally</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(mesh_changed);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// And then we may need to widen the ghosting layers.</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordflow">if</span> (mesh_changed)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    MeshCommunication().send_coarse_ghosts(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    {</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="comment">// active elements flagged for coarsening will</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="comment">// no longer be deleted until MeshRefinement::contract()</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        {</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;          <span class="comment">// Huh?  no level-0 element should be active</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;          <span class="comment">// and flagged for coarsening.</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;          libmesh_assert_not_equal_to (elem-&gt;level(), 0);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          <span class="comment">// Remove this element from any neighbor</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;          <span class="comment">// lists that point to it.</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          elem-&gt;nullify_neighbors();</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          <span class="comment">// Remove any boundary information associated</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          <span class="comment">// with this element</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a640865bf6d6c35628d6c56703dc51834">get_boundary_info</a>().<a class="code" href="classlibMesh_1_1BoundaryInfo.html#ad0689912289a62de894c8ccecdf9c4bf">remove</a> (elem);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          <span class="comment">// Add this iterator to the _unused_elements</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          <span class="comment">// data structure so we might fill it.</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;          <span class="comment">// The _unused_elements optimization is currently off.</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;          <span class="comment">// _unused_elements.push_back (it);</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          <span class="comment">// Don&#39;t delete the element until</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          <span class="comment">// MeshRefinement::contract()</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;          <span class="comment">// _mesh.delete_elem(elem);</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="comment">// inactive elements flagged for coarsening</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="comment">// will become active</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>)</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        {</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;          elem-&gt;coarsen();</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          libmesh_assert (elem-&gt;active());</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          <span class="comment">// the mesh has certainly changed</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          mesh_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;p_level() &gt; 0)</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            {</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;              elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">Elem::JUST_COARSENED</a>);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;              elem-&gt;set_p_level(elem-&gt;p_level() - 1);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;              mesh_p_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            }</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            {</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;              elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            }</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        }</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    }</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(mesh_p_changed);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="comment">// And we may need to update DistributedMesh values reflecting the changes</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="keywordflow">if</span> (mesh_changed)</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ae10a5f947142866d4a1c1409973b1582">update_parallel_id_counts</a>();</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">// Node processor ids may need to change if an element of that id</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">// was coarsened away</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keywordflow">if</span> (mesh_changed &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>())</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    {</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="comment">// Update the _new_nodes_map so that processors can</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="comment">// find requested nodes</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a2fbd7b73883ab6ad3f587a7e6e756ab0">update_nodes_map</a> ();</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      MeshCommunication().make_nodes_parallel_consistent (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="comment">// Clear the _new_nodes_map</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#ac64e4f1afa4af23fe11997dfbeae071b">clear</a>();</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      MeshTools::libmesh_assert_valid_procids&lt;Node&gt;(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    }</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="comment">// If p levels changed all we need to do is make sure that parent p</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="comment">// levels changed in sync</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="keywordflow">if</span> (mesh_p_changed &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>())</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      MeshCommunication().make_p_levels_parallel_consistent (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">return</span> (mesh_changed || mesh_p_changed);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a2fbd7b73883ab6ad3f587a7e6e756ab0"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a2fbd7b73883ab6ad3f587a7e6e756ab0">libMesh::MeshRefinement::update_nodes_map</a></div><div class="ttdeci">void update_nodes_map()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00345">mesh_refinement.C:345</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1BoundaryInfo_html_ad0689912289a62de894c8ccecdf9c4bf"><div class="ttname"><a href="classlibMesh_1_1BoundaryInfo.html#ad0689912289a62de894c8ccecdf9c4bf">libMesh::BoundaryInfo::remove</a></div><div class="ttdeci">void remove(const Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="boundary__info_8C_source.html#l01321">boundary_info.C:1321</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a640865bf6d6c35628d6c56703dc51834"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a640865bf6d6c35628d6c56703dc51834">libMesh::MeshBase::get_boundary_info</a></div><div class="ttdeci">const BoundaryInfo &amp; get_boundary_info() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00131">mesh_base.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0629d79c85d44523e4e11624aa96cd85"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">libMesh::MeshBase::is_serial</a></div><div class="ttdeci">virtual bool is_serial() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00154">mesh_base.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">libMesh::Elem::JUST_COARSENED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01202">elem.h:1202</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae10a5f947142866d4a1c1409973b1582"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae10a5f947142866d4a1c1409973b1582">libMesh::MeshBase::update_parallel_id_counts</a></div><div class="ttdeci">virtual void update_parallel_id_counts()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">libMesh::Elem::COARSEN_INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01204">elem.h:1204</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac64e4f1afa4af23fe11997dfbeae071b"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac64e4f1afa4af23fe11997dfbeae071b">libMesh::MeshRefinement::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00134">mesh_refinement.C:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad794507aa1e1908fea6fb373dd31c548"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad794507aa1e1908fea6fb373dd31c548">&#9670;&nbsp;</a></span>_refine_elements()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::_refine_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refines user-requested elements. It is possible that for a given set of refinement flags there is actually no change upon calling this member function.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the mesh actually changed (hence data needs to be projected) and <code>false</code> otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01461">1461</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">libMesh::MeshBase::active_not_local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">libMesh::MeshBase::active_not_local_elements_end()</a>, <a class="el" href="simple__range_8h_source.html#l00057">libMesh::as_range()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00134">clear()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>, <a class="el" href="mesh__base_8h_source.html#l00176">libMesh::MeshBase::is_replicated()</a>, <a class="el" href="elem_8h_source.html#l01201">libMesh::Elem::JUST_REFINED</a>, <a class="el" href="mesh__base_8h_source.html#l01007">libMesh::MeshBase::libmesh_assert_valid_parallel_ids()</a>, <a class="el" href="mesh__communication_8C_source.html#l01505">libMesh::MeshCommunication::make_elems_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01805">libMesh::MeshCommunication::make_new_nodes_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01529">libMesh::MeshCommunication::make_p_levels_parallel_consistent()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="partitioner_8C_source.html#l00679">libMesh::Partitioner::set_node_processor_ids()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a0e898a7c74ad9552269753ee54e52b45">libMesh::MeshBase::unpartitioned_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ace9f5d288950516202e18c42a0552b0f">libMesh::MeshBase::unpartitioned_elements_end()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00345">update_nodes_map()</a>, and <a class="el" href="classlibMesh_1_1MeshBase.html#ae10a5f947142866d4a1c1409973b1582">libMesh::MeshBase::update_parallel_id_counts()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00682">refine_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01676">uniformly_refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;{</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  parallel_object_only();</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">// Update the _new_nodes_map so that elements can</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="comment">// find nodes to connect to.</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a2fbd7b73883ab6ad3f587a7e6e756ab0">update_nodes_map</a> ();</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  LOG_SCOPE (<span class="stringliteral">&quot;_refine_elements()&quot;</span>, <span class="stringliteral">&quot;MeshRefinement&quot;</span>);</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="comment">// Iterate over the elements, counting the elements</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="comment">// flagged for h refinement.</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_elems_flagged = 0;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      n_elems_flagged++;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">// Construct a local vector of Elem * which have been</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// previously marked for refinement.  We reserve enough</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="comment">// space to allow for every element to be refined.</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  std::vector&lt;Elem *&gt; local_copy_of_elements;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  local_copy_of_elements.reserve(n_elems_flagged);</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// If mesh p levels changed, we might need to synchronize parent p</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="comment">// levels on a distributed mesh.</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="keywordtype">bool</span> mesh_p_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="comment">// Iterate over the elements, looking for elements flagged for</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="comment">// refinement.</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="comment">// If we are on a ReplicatedMesh, then we just do the refinement in</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="comment">// the same order on every processor and everything stays in sync.</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="comment">// If we are on a DistributedMesh, that&#39;s impossible.</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="comment">// If the mesh is distributed, we need to make sure that if we end</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">// up as the owner of a new node, which might happen if that node is</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="comment">// attached to one of our own elements, then we have given it a</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">// legitimate node id and our own processor id.  We generate</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">// legitimate node ids and use our own processor id when we are</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">// refining our own elements but not when we refine others&#39;</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="comment">// elements.  Therefore we want to refine our own elements *first*,</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="comment">// thereby generating all nodes which might belong to us, and then</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="comment">// refine others&#39; elements *after*, thereby generating nodes with</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">// temporary ids which we know we will discard.</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="comment">// Even if the DistributedMesh is serialized, we can&#39;t just treat it</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="comment">// like a ReplicatedMesh, because DistributedMesh doesn&#39;t *trust*</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">// users to refine partitioned elements in a serialized way, so it</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">// assigns temporary ids, so we need to synchronize ids afterward to</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="comment">// be safe anyway, so we might as well use the distributed mesh code</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="comment">// path.</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">is_replicated</a>() ? <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>() : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        local_copy_of_elements.push_back(elem);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> &amp;&amp;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          elem-&gt;active())</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        {</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;          elem-&gt;set_p_level(elem-&gt;p_level()+1);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;          mesh_p_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        }</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    }</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">is_replicated</a>())</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    {</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">as_range</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">active_not_local_elements_begin</a>(),</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">active_not_local_elements_end</a>()))</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        {</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            local_copy_of_elements.push_back(elem);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> &amp;&amp;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;              elem-&gt;active())</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            {</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;              elem-&gt;set_p_level(elem-&gt;p_level()+1);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;              elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;              mesh_p_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            }</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        }</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    }</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="comment">// Now iterate over the local copies and refine each one.</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="comment">// This may resize the mesh&#39;s internal container and invalidate</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="comment">// any existing iterators.</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="keywordflow">for</span> (std::size_t e = 0; e != local_copy_of_elements.size(); ++e)</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    local_copy_of_elements[e]-&gt;refine(*<span class="keyword">this</span>);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">// The mesh changed if there were elements h refined</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordtype">bool</span> mesh_changed = !local_copy_of_elements.empty();</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="comment">// If the mesh changed on any processor, it changed globally</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(mesh_changed);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(mesh_p_changed);</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="comment">// And we may need to update DistributedMesh values reflecting the changes</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">if</span> (mesh_changed)</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ae10a5f947142866d4a1c1409973b1582">update_parallel_id_counts</a>();</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordflow">if</span> (mesh_changed &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">is_replicated</a>())</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    {</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      MeshCommunication().make_elems_parallel_consistent (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      MeshCommunication().make_new_nodes_parallel_consistent (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ada599f713083209fd36b1e0024ec99b3">libmesh_assert_valid_parallel_ids</a>();</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    }</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="comment">// If we&#39;re refining a ReplicatedMesh, then we haven&#39;t yet assigned</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">// node processor ids.  But if we&#39;re refining a partitioned</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="comment">// ReplicatedMesh, then we *need* to assign node processor ids.</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordflow">if</span> (mesh_changed &amp;&amp; <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">is_replicated</a>() &amp;&amp;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0e898a7c74ad9552269753ee54e52b45">unpartitioned_elements_begin</a>() ==</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;       <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ace9f5d288950516202e18c42a0552b0f">unpartitioned_elements_end</a>()))</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <a class="code" href="classlibMesh_1_1Partitioner.html#accc819bc421fd8e50323b46f9762c714">Partitioner::set_node_processor_ids</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <span class="keywordflow">if</span> (mesh_p_changed &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">is_replicated</a>())</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    {</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      MeshCommunication().make_p_levels_parallel_consistent (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    }</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="comment">// Clear the _new_nodes_map and _unused_elements data structures.</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#ac64e4f1afa4af23fe11997dfbeae071b">clear</a>();</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="keywordflow">return</span> (mesh_changed || mesh_p_changed);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a2fbd7b73883ab6ad3f587a7e6e756ab0"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a2fbd7b73883ab6ad3f587a7e6e756ab0">libMesh::MeshRefinement::update_nodes_map</a></div><div class="ttdeci">void update_nodes_map()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00345">mesh_refinement.C:345</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Partitioner_html_accc819bc421fd8e50323b46f9762c714"><div class="ttname"><a href="classlibMesh_1_1Partitioner.html#accc819bc421fd8e50323b46f9762c714">libMesh::Partitioner::set_node_processor_ids</a></div><div class="ttdeci">static void set_node_processor_ids(MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="partitioner_8C_source.html#l00679">partitioner.C:679</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0e898a7c74ad9552269753ee54e52b45"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0e898a7c74ad9552269753ee54e52b45">libMesh::MeshBase::unpartitioned_elements_begin</a></div><div class="ttdeci">virtual element_iterator unpartitioned_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae10a5f947142866d4a1c1409973b1582"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae10a5f947142866d4a1c1409973b1582">libMesh::MeshBase::update_parallel_id_counts</a></div><div class="ttdeci">virtual void update_parallel_id_counts()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a977361a82b7a9e7ad8e50ae1cae40d20"><div class="ttname"><a href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">libMesh::as_range</a></div><div class="ttdeci">SimpleRange&lt; I &gt; as_range(const std::pair&lt; I, I &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="simple__range_8h_source.html#l00057">simple_range.h:57</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a81252a490defae08c5fd39ffac034333"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a81252a490defae08c5fd39ffac034333">libMesh::MeshBase::active_not_local_elements_end</a></div><div class="ttdeci">virtual element_iterator active_not_local_elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a1b15de4062298b11df7d8267053d8aee"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">libMesh::MeshBase::is_replicated</a></div><div class="ttdeci">virtual bool is_replicated() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00176">mesh_base.h:176</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ace9f5d288950516202e18c42a0552b0f"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ace9f5d288950516202e18c42a0552b0f">libMesh::MeshBase::unpartitioned_elements_end</a></div><div class="ttdeci">virtual element_iterator unpartitioned_elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac64e4f1afa4af23fe11997dfbeae071b"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac64e4f1afa4af23fe11997dfbeae071b">libMesh::MeshRefinement::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00134">mesh_refinement.C:134</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac68163904060c11860cd46b0fd9e4003"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac68163904060c11860cd46b0fd9e4003">libMesh::MeshBase::active_not_local_elements_begin</a></div><div class="ttdeci">virtual element_iterator active_not_local_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ada599f713083209fd36b1e0024ec99b3"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ada599f713083209fd36b1e0024ec99b3">libMesh::MeshBase::libmesh_assert_valid_parallel_ids</a></div><div class="ttdeci">virtual void libmesh_assert_valid_parallel_ids() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01007">mesh_base.h:1007</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">libMesh::Elem::JUST_REFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01201">elem.h:1201</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86813ddc62a0fa53467a55688bae38ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86813ddc62a0fa53467a55688bae38ce">&#9670;&nbsp;</a></span>_smooth_flags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::_smooth_flags </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>refining</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>coarsening</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Smooths refinement flags according to current settings. It is possible that for a given set of refinement flags there is actually no change upon calling this member function.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the flags actually changed (hence data needs to be projected) and <code>false</code> otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01592">1592</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00770">_edge_level_mismatch_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00771">_node_level_mismatch_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00773">_overrefined_boundary_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00774">_underrefined_boundary_limit</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00380">eliminate_unrefined_patches()</a>, <a class="el" href="mesh__base_8h_source.html#l00154">libMesh::MeshBase::is_serial()</a>, <a class="el" href="mesh__tools_8C_source.html#l02068">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00126">limit_level_mismatch_at_edge()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">limit_level_mismatch_at_node()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00255">limit_overrefined_boundary()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00316">limit_underrefined_boundary()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">make_flags_parallel_consistent()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00607">coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00682">refine_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;{</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="comment">// Smoothing can break in weird ways on a mesh with broken topology</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <a class="code" href="namespacelibMesh_1_1MeshTools.html#a2c59d3e13f4d9f89d41eb66cb043f4ee">MeshTools::libmesh_assert_valid_neighbors</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">// Repeat until flag changes match on every processor</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="keywordflow">do</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <span class="comment">// Repeat until coarsening &amp; refinement flags jive</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keywordtype">bool</span> satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        {</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          <span class="comment">// If we&#39;re refining or coarsening, hit the corresponding</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          <span class="comment">// face level test code.  Short-circuiting || is our friend</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span> coarsening_satisfied =</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            !coarsening ||</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">make_coarsening_compatible</a>();</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span> refinement_satisfied =</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            !refining ||</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">make_refinement_compatible</a>();</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;          <span class="keywordtype">bool</span> smoothing_satisfied =</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            !this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a2f57c999ade430e94e7cf25bfc97eb07">eliminate_unrefined_patches</a>();<span class="comment">// &amp;&amp;</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">_edge_level_mismatch_limit</a>)</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            smoothing_satisfied = smoothing_satisfied &amp;&amp;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;              !this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6726f2900feee33e74f571aa31a9d545">limit_level_mismatch_at_edge</a> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">_edge_level_mismatch_limit</a>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">_node_level_mismatch_limit</a>)</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            smoothing_satisfied = smoothing_satisfied &amp;&amp;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;              !this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#acbc5744304854c3ce239abced653624e">limit_level_mismatch_at_node</a> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">_node_level_mismatch_limit</a>);</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">_overrefined_boundary_limit</a>&gt;=0)</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            smoothing_satisfied = smoothing_satisfied &amp;&amp;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;              !this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a3d051c8d27a2abc3ab879f2f982bbcb0">limit_overrefined_boundary</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">_overrefined_boundary_limit</a>);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">_underrefined_boundary_limit</a>&gt;=0)</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            smoothing_satisfied = smoothing_satisfied &amp;&amp;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;              !this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a2eef84fcf5c69894597662b16b8cf373">limit_underrefined_boundary</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">_underrefined_boundary_limit</a>);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          satisfied = (coarsening_satisfied &amp;&amp;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                       refinement_satisfied &amp;&amp;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                       smoothing_satisfied);</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().verify(satisfied));</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        }</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keywordflow">while</span> (!satisfied);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    }</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>() &amp;&amp; !this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">make_flags_parallel_consistent</a>());</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6726f2900feee33e74f571aa31a9d545"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6726f2900feee33e74f571aa31a9d545">libMesh::MeshRefinement::limit_level_mismatch_at_edge</a></div><div class="ttdeci">bool limit_level_mismatch_at_edge(const unsigned int max_mismatch)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__smoothing_8C_source.html#l00126">mesh_refinement_smoothing.C:126</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acbc5744304854c3ce239abced653624e"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acbc5744304854c3ce239abced653624e">libMesh::MeshRefinement::limit_level_mismatch_at_node</a></div><div class="ttdeci">bool limit_level_mismatch_at_node(const unsigned int max_mismatch)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__smoothing_8C_source.html#l00039">mesh_refinement_smoothing.C:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a2eef84fcf5c69894597662b16b8cf373"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a2eef84fcf5c69894597662b16b8cf373">libMesh::MeshRefinement::limit_underrefined_boundary</a></div><div class="ttdeci">bool limit_underrefined_boundary(const signed char max_mismatch)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__smoothing_8C_source.html#l00316">mesh_refinement_smoothing.C:316</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a3d051c8d27a2abc3ab879f2f982bbcb0"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a3d051c8d27a2abc3ab879f2f982bbcb0">libMesh::MeshRefinement::limit_overrefined_boundary</a></div><div class="ttdeci">bool limit_overrefined_boundary(const signed char max_mismatch)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__smoothing_8C_source.html#l00255">mesh_refinement_smoothing.C:255</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a1ee86268abe102ac27effa05bbf6fa15"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">libMesh::MeshRefinement::_underrefined_boundary_limit</a></div><div class="ttdeci">signed char _underrefined_boundary_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00774">mesh_refinement.h:774</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af8b5b704315a18872765740e9b88ce24"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">libMesh::MeshRefinement::make_refinement_compatible</a></div><div class="ttdeci">bool make_refinement_compatible()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01159">mesh_refinement.C:1159</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0629d79c85d44523e4e11624aa96cd85"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">libMesh::MeshBase::is_serial</a></div><div class="ttdeci">virtual bool is_serial() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00154">mesh_base.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a0e925a80a9435e0d2d2a5f6113050043"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">libMesh::MeshRefinement::make_flags_parallel_consistent</a></div><div class="ttdeci">bool make_flags_parallel_consistent()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00751">mesh_refinement.C:751</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4a4151995d4be05f4d7bf890b1e3234b"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">libMesh::MeshRefinement::_overrefined_boundary_limit</a></div><div class="ttdeci">signed char _overrefined_boundary_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00773">mesh_refinement.h:773</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a1ae7cec33d6f1fe1c28f4cbda2449df1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">libMesh::MeshRefinement::make_coarsening_compatible</a></div><div class="ttdeci">bool make_coarsening_compatible()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00779">mesh_refinement.C:779</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ae794162fe8b50db70bb236ef9cbe68ab"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">libMesh::MeshRefinement::_node_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _node_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00771">mesh_refinement.h:771</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ae705082e7bc067be443b6792c1be54d6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">libMesh::MeshRefinement::_edge_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _edge_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00770">mesh_refinement.h:770</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_a2c59d3e13f4d9f89d41eb66cb043f4ee"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#a2c59d3e13f4d9f89d41eb66cb043f4ee">libMesh::MeshTools::libmesh_assert_valid_neighbors</a></div><div class="ttdeci">void libmesh_assert_valid_neighbors(const MeshBase &amp;mesh, bool assert_valid_remote_elems=true)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l02068">mesh_tools.C:2068</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a2f57c999ade430e94e7cf25bfc97eb07"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a2f57c999ade430e94e7cf25bfc97eb07">libMesh::MeshRefinement::eliminate_unrefined_patches</a></div><div class="ttdeci">bool eliminate_unrefined_patches()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__smoothing_8C_source.html#l00380">mesh_refinement_smoothing.C:380</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3cd3b275dc8d45ac914f638cc7179c9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd3b275dc8d45ac914f638cc7179c9a">&#9670;&nbsp;</a></span>absolute_global_tolerance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp; libMesh::MeshRefinement::absolute_global_tolerance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>absolute_global_tolerance</code> is set to a nonzero value, methods like flag_elements_by_global_tolerance() will attempt to reduce the global error of the mesh (defined as the square root of the sum of the squares of the errors on active elements) to below this tolerance.</p>
<p><code>absolute_global_tolerance</code> is 0 by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00906">906</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00767">_absolute_global_tolerance</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>.</p>
<div class="fragment"><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;{</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#aea1a97aa9a8e4a8ec1967050c96f5b13">_absolute_global_tolerance</a>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_aea1a97aa9a8e4a8ec1967050c96f5b13"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#aea1a97aa9a8e4a8ec1967050c96f5b13">libMesh::MeshRefinement::_absolute_global_tolerance</a></div><div class="ttdeci">Real _absolute_global_tolerance</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00767">mesh_refinement.h:767</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a052c0307f8d231199f9a5d20b9d698ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a052c0307f8d231199f9a5d20b9d698ca">&#9670;&nbsp;</a></span>add_elem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> * libMesh::MeshRefinement::add_elem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td>
          <td class="paramname"><em>elem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds the element <code>elem</code> to the mesh. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00210">210</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, and <a class="el" href="classlibMesh_1_1MeshBase.html#a5ab834283fa6bc335ad623d2b737ec5e">libMesh::MeshBase::add_elem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="elem__refinement_8C_source.html#l00041">libMesh::Elem::refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  libmesh_assert(elem);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5ab834283fa6bc335ad623d2b737ec5e">add_elem</a> (elem);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">return</span> elem;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5ab834283fa6bc335ad623d2b737ec5e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5ab834283fa6bc335ad623d2b737ec5e">libMesh::MeshBase::add_elem</a></div><div class="ttdeci">virtual Elem * add_elem(Elem *e)=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fb6f0822dc243ae06b7c801da5cca6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb6f0822dc243ae06b7c801da5cca6a">&#9670;&nbsp;</a></span>add_node()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Node.html">Node</a> * libMesh::MeshRefinement::add_node </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> &amp;&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>child</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a node to the mesh. The node should be node n of child c of parent <a class="el" href="classlibMesh_1_1Elem.html" title="The base class for all geometric element types. ">Elem</a> parent. The processor id <code>proc_id</code> is used if necessary to help determine numbering of newly created nodes, but newly created nodes are left unpartitioned until a node partitionining sweep is done later.</p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a suitable existing or newly-created node. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00141">141</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00737">_new_nodes_map</a>, <a class="el" href="topology__map_8C_source.html#l00052">libMesh::TopologyMap::add_node()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a9361e2879e37831f80afb43b762d651f">libMesh::MeshBase::add_point()</a>, <a class="el" href="type__vector_8h_source.html#l00627">libMesh::TypeVector&lt; T &gt;::add_scaled()</a>, <a class="el" href="elem_8C_source.html#l01933">libMesh::Elem::as_parent_node()</a>, <a class="el" href="elem_8C_source.html#l02206">libMesh::Elem::bracketing_nodes()</a>, <a class="el" href="classlibMesh_1_1Elem.html#a80c875428cd16109a2bc5667c6940542">libMesh::Elem::embedding_matrix()</a>, <a class="el" href="topology__map_8C_source.html#l00118">libMesh::TopologyMap::find()</a>, <a class="el" href="dof__object_8h_source.html#l00347">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__object_8h_source.html#l00358">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, <a class="el" href="elem_8h_source.html#l02148">libMesh::Elem::node_index_range()</a>, <a class="el" href="elem_8h_source.html#l01957">libMesh::Elem::node_ptr()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">libMesh::MeshBase::node_ptr()</a>, <a class="el" href="elem_8h_source.html#l01892">libMesh::Elem::point()</a>, and <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="elem__refinement_8C_source.html#l00041">libMesh::Elem::refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;add_node()&quot;</span>, <span class="stringliteral">&quot;MeshRefinement&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parent_n = parent.as_parent_node(child, node);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">if</span> (parent_n != <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">return</span> parent.node_ptr(parent_n);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, dof_id_type&gt;&gt;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    bracketing_nodes = parent.bracketing_nodes(child, node);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// If we&#39;re not a parent node, we *must* be bracketed by at least</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// one pair of parent nodes</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  libmesh_assert(bracketing_nodes.size());</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> new_node_id =</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">_new_nodes_map</a>.<a class="code" href="classlibMesh_1_1TopologyMap.html#a006067c6914bffa08e1fe35431deb724">find</a>(bracketing_nodes);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Return the node if it already exists.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// We&#39;ll leave the processor_id untouched in this case - if we&#39;re</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// repartitioning later or if this is a new unpartitioned node,</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// we&#39;ll update it then, and if not then we don&#39;t want to update it.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">if</span> (new_node_id != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">node_ptr</a>(new_node_id);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// Otherwise we need to add a new node.</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// Figure out where to add the point:</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  Point p; <span class="comment">// defaults to 0,0,0</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : parent.node_index_range())</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">// The value from the embedding matrix</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">float</span> em_val = parent.embedding_matrix(child,node,n);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (em_val != 0.)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          p.<a class="code" href="classlibMesh_1_1TypeVector.html#a76f328deef9664e512cda807813dff43">add_scaled</a> (parent.point(n), em_val);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          <span class="comment">// If we&#39;d already found the node we shouldn&#39;t be here</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          libmesh_assert_not_equal_to (em_val, 1);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// Although we&#39;re leaving new nodes unpartitioned at first, with a</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// DistributedMesh we would need a default id based on the numbering</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// scheme for the requested processor_id.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  Node * new_node = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a9361e2879e37831f80afb43b762d651f">add_point</a> (p, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>, proc_id);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  libmesh_assert(new_node);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// But then we&#39;ll make sure this node is marked as unpartitioned.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  new_node-&gt;processor_id() = <a class="code" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Add the node to the map.</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">_new_nodes_map</a>.<a class="code" href="classlibMesh_1_1TopologyMap.html#a799fb6434d0156d78d9e21a39f68c997">add_node</a>(*new_node, bracketing_nodes);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Return the address of the new node</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> new_node;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a668c8ef9154f08b469eb9d90dd2074d1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">libMesh::MeshRefinement::_new_nodes_map</a></div><div class="ttdeci">TopologyMap _new_nodes_map</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00737">mesh_refinement.h:737</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1TypeVector_html_a76f328deef9664e512cda807813dff43"><div class="ttname"><a href="classlibMesh_1_1TypeVector.html#a76f328deef9664e512cda807813dff43">libMesh::TypeVector::add_scaled</a></div><div class="ttdeci">void add_scaled(const TypeVector&lt; T2 &gt; &amp;, const T)</div><div class="ttdef"><b>Definition:</b> <a href="type__vector_8h_source.html#l00627">type_vector.h:627</a></div></div>
<div class="ttc" id="classlibMesh_1_1TopologyMap_html_a006067c6914bffa08e1fe35431deb724"><div class="ttname"><a href="classlibMesh_1_1TopologyMap.html#a006067c6914bffa08e1fe35431deb724">libMesh::TopologyMap::find</a></div><div class="ttdeci">dof_id_type find(dof_id_type bracket_node1, dof_id_type bracket_node2) const</div><div class="ttdef"><b>Definition:</b> <a href="topology__map_8C_source.html#l00118">topology_map.C:118</a></div></div>
<div class="ttc" id="classlibMesh_1_1TopologyMap_html_a799fb6434d0156d78d9e21a39f68c997"><div class="ttname"><a href="classlibMesh_1_1TopologyMap.html#a799fb6434d0156d78d9e21a39f68c997">libMesh::TopologyMap::add_node</a></div><div class="ttdeci">void add_node(const Node &amp;mid_node, const std::vector&lt; std::pair&lt; dof_id_type, dof_id_type &gt;&gt; &amp;bracketing_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="topology__map_8C_source.html#l00052">topology_map.C:52</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a9361e2879e37831f80afb43b762d651f"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a9361e2879e37831f80afb43b762d651f">libMesh::MeshBase::add_point</a></div><div class="ttdeci">virtual Node * add_point(const Point &amp;p, const dof_id_type id=DofObject::invalid_id, const processor_id_type proc_id=DofObject::invalid_processor_id)=0</div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_aa65deab833c8b1802790cd43ab1b6ee4"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">libMesh::DofObject::invalid_processor_id</a></div><div class="ttdeci">static const processor_id_type invalid_processor_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00358">dof_object.h:358</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00347">dof_object.h:347</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_abc2fd76e7bf6c200f5e8849dfca9cd03"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#abc2fd76e7bf6c200f5e8849dfca9cd03">libMesh::MeshBase::node_ptr</a></div><div class="ttdeci">virtual const Node * node_ptr(const dof_id_type i) const =0</div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3f2ecc36e231ddc26798014ee133045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3f2ecc36e231ddc26798014ee133045">&#9670;&nbsp;</a></span>add_p_to_h_refinement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::add_p_to_h_refinement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Takes a mesh whose elements are flagged for h refinement and coarsening, and adds flags to request p refinement and coarsening of the same elements. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00654">654</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, and <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>.</p>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    elem-&gt;set_p_refinement_flag(elem-&gt;refinement_flag());</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6930cd279030a81ff6d36a40809b1fd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6930cd279030a81ff6d36a40809b1fd8">&#9670;&nbsp;</a></span>clean_refinement_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::clean_refinement_flags </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the refinement flag to <code><a class="el" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a></code> for each element in the mesh. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00662">662</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>, and <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>, <a class="el" href="equation__systems_8C_source.html#l00096">libMesh::EquationSystems::init()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00072">libMesh::EquationSystems::read()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">uniformly_coarsen()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01676">uniformly_refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;{</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// Possibly clean up the refinement flags from</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// a previous step</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;active())</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac64e4f1afa4af23fe11997dfbeae071b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac64e4f1afa4af23fe11997dfbeae071b">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deletes all the data that are currently stored. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00134">134</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00737">_new_nodes_map</a>, and <a class="el" href="topology__map_8h_source.html#l00076">libMesh::TopologyMap::clear()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01335">_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01461">_refine_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00127">~MeshRefinement()</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">_new_nodes_map</a>.<a class="code" href="classlibMesh_1_1TopologyMap.html#a945e9ac73201bf5a2060fb593cb334be">clear</a>();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1TopologyMap_html_a945e9ac73201bf5a2060fb593cb334be"><div class="ttname"><a href="classlibMesh_1_1TopologyMap.html#a945e9ac73201bf5a2060fb593cb334be">libMesh::TopologyMap::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="topology__map_8h_source.html#l00076">topology_map.h:76</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a668c8ef9154f08b469eb9d90dd2074d1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">libMesh::MeshRefinement::_new_nodes_map</a></div><div class="ttdeci">TopologyMap _new_nodes_map</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00737">mesh_refinement.h:737</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5db36c33bd581e101f38bcc1f3d2ce5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5db36c33bd581e101f38bcc1f3d2ce5d">&#9670;&nbsp;</a></span>coarsen_by_parents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool &amp; libMesh::MeshRefinement::coarsen_by_parents </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>coarsen_by_parents</code> is true, complete groups of sibling elements (elements with the same parent) will be flagged for coarsening. This should make the coarsening more likely to occur as requested.</p>
<p><code>coarsen_by_parents</code> is true by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00870">870</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00755">_coarsen_by_parents</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>.</p>
<div class="fragment"><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;{</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ab6fda707e1285340135e56469b055746"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">libMesh::MeshRefinement::_coarsen_by_parents</a></div><div class="ttdeci">bool _coarsen_by_parents</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00755">mesh_refinement.h:755</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a429ba27c5fa2e7bb910c7199c4a0bafd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a429ba27c5fa2e7bb910c7199c4a0bafd">&#9670;&nbsp;</a></span>coarsen_elements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::coarsen_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Only coarsens the user-requested elements. Some elements will not be coarsened to satisfy the level one rule. It is possible that for a given set of refinement flags there is actually no change upon calling this member function.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the mesh actually changed (hence data needs to be projected) and <code>false</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function used to take an argument, <code>maintain_level_one</code>, new code should use <a class="el" href="classlibMesh_1_1MeshRefinement.html#a81fa55fe9538fded1391a56952aa1376">face_level_mismatch_limit()</a> instead. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00607">607</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8C_source.html#l01335">_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00769">_face_level_mismatch_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>, <a class="el" href="elem_8h_source.html#l01201">libMesh::Elem::JUST_REFINED</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">make_flags_parallel_consistent()</a>, <a class="el" href="libmesh__common_8h_source.html#l00228">libMesh::out</a>, <a class="el" href="mesh__base_8C_source.html#l00152">libMesh::MeshBase::prepare_for_use()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00352">test_level_one()</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00133">libMesh::EquationSystems::reinit_solutions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;{</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// We can&#39;t yet turn a non-level-one mesh into a level-one mesh</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// Possibly clean up the refinement flags from</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// a previous step</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">// Set refinement flag to INACTIVE if the</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// element isn&#39;t active</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">if</span> (!elem-&gt;active())</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="comment">// This might be left over from the last step</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// Parallel consistency has to come first, or coarsening</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// along processor boundaries might occasionally be falsely</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// prevented</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordtype">bool</span> flags_were_consistent = this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">make_flags_parallel_consistent</a>();</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">// In theory, we should be able to remove the above call, which can</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">// be expensive and should be unnecessary.  In practice, doing</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">// consistent flagging in parallel is hard, it&#39;s impossible to</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// verify at the library level if it&#39;s being done by user code, and</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// we don&#39;t want to abort large parallel runs in opt mode... but we</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// do want to warn that they should be fixed.</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  libmesh_assert(flags_were_consistent);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">if</span> (!flags_were_consistent)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;Refinement flags were not consistent between processors!\n&quot;</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Correcting and continuing.&quot;</span>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// Smooth coarsening flags</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a86813ddc62a0fa53467a55688bae38ce">_smooth_flags</a>(<span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// Coarsen the flagged elements.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> mesh_changed =</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a46ef7ebd80c846f24998ef0f222c55e1">_coarsen_elements</a> ();</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">make_coarsening_compatible</a>());</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">// FIXME: This won&#39;t pass unless we add a redundant find_neighbors()</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// call or replace find_neighbors() with on-the-fly neighbor updating</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">// libmesh_assert(!this-&gt;eliminate_unrefined_patches());</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// We can&#39;t contract the mesh ourselves anymore - a System might</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="comment">// need to restrict old coefficient vectors first</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">// _mesh.contract();</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// Finally, the new mesh may need to be prepared for use</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">if</span> (mesh_changed)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">prepare_for_use</a> (<span class="comment">/*skip_renumber =*/</span><span class="keyword">false</span>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">return</span> mesh_changed;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4f90c35be7bbebea889c925b6f20713a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">libMesh::MeshRefinement::test_level_one</a></div><div class="ttdeci">bool test_level_one(bool libmesh_assert_yes=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00352">mesh_refinement.C:352</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a56f1015a59736175b39e4a1ca4d084bc"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">libMesh::MeshRefinement::_face_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _face_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00769">mesh_refinement.h:769</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a0e925a80a9435e0d2d2a5f6113050043"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">libMesh::MeshRefinement::make_flags_parallel_consistent</a></div><div class="ttdeci">bool make_flags_parallel_consistent()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00751">mesh_refinement.C:751</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a61ce1c1cdddaa68acd35c7fa49a8a45e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">libMesh::MeshBase::prepare_for_use</a></div><div class="ttdeci">void prepare_for_use(const bool skip_renumber_nodes_and_elements=false, const bool skip_find_neighbors=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00152">mesh_base.C:152</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a1ae7cec33d6f1fe1c28f4cbda2449df1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">libMesh::MeshRefinement::make_coarsening_compatible</a></div><div class="ttdeci">bool make_coarsening_compatible()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00779">mesh_refinement.C:779</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a86813ddc62a0fa53467a55688bae38ce"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a86813ddc62a0fa53467a55688bae38ce">libMesh::MeshRefinement::_smooth_flags</a></div><div class="ttdeci">void _smooth_flags(bool refining, bool coarsening)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01592">mesh_refinement.C:1592</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a46ef7ebd80c846f24998ef0f222c55e1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a46ef7ebd80c846f24998ef0f222c55e1">libMesh::MeshRefinement::_coarsen_elements</a></div><div class="ttdeci">bool _coarsen_elements()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01335">mesh_refinement.C:1335</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a63e3c3158308e2184c12b55ab9ea9a35"><div class="ttname"><a href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></div><div class="ttdeci">OStreamProxy out(std::cout)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00228">libmesh_common.h:228</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">libMesh::Elem::JUST_REFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01201">elem.h:1201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc484f7cbbb97079dee552daaaa06613"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc484f7cbbb97079dee552daaaa06613">&#9670;&nbsp;</a></span>coarsen_fraction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp; libMesh::MeshRefinement::coarsen_fraction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The <code>coarsen_fraction</code> sets either a desired target or a desired maximum number of elements to flag for coarsening, depending on which flag_elements_by method is called.</p>
<p><code>coarsen_fraction</code> must be in <img class="formulaInl" alt="$ [0,1] $" src="form_98.png"/>, and is 0 by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00882">882</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00759">_coarsen_fraction</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>.</p>
<div class="fragment"><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;{</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a04e98b91b8eb9b6ddcf0dff673a1a281"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">libMesh::MeshRefinement::_coarsen_fraction</a></div><div class="ttdeci">Real _coarsen_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00759">mesh_refinement.h:759</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a811a18927f38ec427530bd7cb126c3a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a811a18927f38ec427530bd7cb126c3a0">&#9670;&nbsp;</a></span>coarsen_threshold()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp; libMesh::MeshRefinement::coarsen_threshold </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The <code>coarsen_threshold</code> provides hysteresis in AMR/C strategies. Refinement of elements with error estimate E will be done even at the expense of coarsening elements whose children's accumulated error does not exceed <code>coarsen_threshold</code> * E.</p>
<p><code>coarsen_threshold</code> must be in <img class="formulaInl" alt="$ [0,1] $" src="form_98.png"/>, and is 0.1 by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00894">894</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00763">_coarsen_threshold</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>.</p>
<div class="fragment"><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;{</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">_coarsen_threshold</a>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_aef4c09ce1e49edffc4b7f196d4b91b8a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">libMesh::MeshRefinement::_coarsen_threshold</a></div><div class="ttdeci">Real _coarsen_threshold</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00763">mesh_refinement.h:763</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4dfeba78f759a8e42683bb559ce1e9fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dfeba78f759a8e42683bb559ce1e9fa">&#9670;&nbsp;</a></span>comm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a>&amp; libMesh::ParallelObject::comm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A reference to the <code><a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a></code> object used by this mesh. </dd></dl>

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00089">89</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00107">libMesh::ParallelObject::_communicator</a>.</p>

<p class="reference">Referenced by <a class="el" href="petsc__diff__solver_8C_source.html#l00132">libMesh::__libmesh_petsc_diff_solver_jacobian()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00043">libMesh::__libmesh_petsc_diff_solver_monitor()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00086">libMesh::__libmesh_petsc_diff_solver_residual()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00205">libMesh::__libmesh_tao_equality_constraints()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00257">libMesh::__libmesh_tao_equality_constraints_jacobian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00097">libMesh::__libmesh_tao_gradient()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00148">libMesh::__libmesh_tao_hessian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00306">libMesh::__libmesh_tao_inequality_constraints()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00358">libMesh::__libmesh_tao_inequality_constraints_jacobian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00049">libMesh::__libmesh_tao_objective()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01335">_coarsen_elements()</a>, <a class="el" href="exact__solution_8C_source.html#l00455">libMesh::ExactSolution::_compute_error()</a>, <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="boundary__info_8C_source.html#l02412">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="slepc__eigen__solver_8C_source.html#l00889">libMesh::SlepcEigenSolver&lt; T &gt;::_petsc_shell_matrix_get_diagonal()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01781">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_get_diagonal()</a>, <a class="el" href="slepc__eigen__solver_8C_source.html#l00864">libMesh::SlepcEigenSolver&lt; T &gt;::_petsc_shell_matrix_mult()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01727">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_mult()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01751">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_mult_add()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00143">libMesh::EquationSystems::_read_impl()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01461">_refine_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00407">libMesh::PetscDMWrapper::add_dofs_helper()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00340">libMesh::PetscDMWrapper::add_dofs_to_section()</a>, <a class="el" href="implicit__system_8C_source.html#l00203">libMesh::ImplicitSystem::add_matrix()</a>, <a class="el" href="system_8C_source.html#l00661">libMesh::System::add_vector()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00969">libMesh::UnstructuredMesh::all_second_order()</a>, <a class="el" href="mesh__modification_8C_source.html#l00271">libMesh::MeshTools::Modification::all_tri()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00261">libMesh::LaplaceMeshSmoother::allgather_graph()</a>, <a class="el" href="fem__system_8C_source.html#l01121">libMesh::FEMSystem::assemble_qoi()</a>, <a class="el" href="mesh__communication__global__indices_8C_source.html#l00168">libMesh::MeshCommunication::assign_global_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00262">libMesh::DofMap::attach_matrix()</a>, <a class="el" href="mesh__generation_8C_source.html#l01992">libMesh::MeshTools::Generation::build_extrusion()</a>, <a class="el" href="boundary__info_8C_source.html#l01779">libMesh::BoundaryInfo::build_node_list_from_side_list()</a>, <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="equation__systems_8C_source.html#l00600">libMesh::EquationSystems::build_parallel_solution_vector()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00098">libMesh::PetscDMWrapper::build_section()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00163">libMesh::PetscDMWrapper::build_sf()</a>, <a class="el" href="mesh__base_8C_source.html#l00574">libMesh::MeshBase::cache_elem_dims()</a>, <a class="el" href="system_8C_source.html#l01400">libMesh::System::calculate_norm()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04362">libMesh::DofMap::check_dirichlet_bcid_consistency()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00440">libMesh::PetscDMWrapper::check_section_n_dofs()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01595">libMesh::Nemesis_IO_Helper::compute_num_global_elem_blocks()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01484">libMesh::Nemesis_IO_Helper::compute_num_global_nodesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01391">libMesh::Nemesis_IO_Helper::compute_num_global_sidesets()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00095">libMesh::Problem_Interface::computeF()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00153">libMesh::Problem_Interface::computeJacobian()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00215">libMesh::Problem_Interface::computePreconditioner()</a>, <a class="el" href="exodusII__io_8C_source.html#l00513">libMesh::ExodusII_IO::copy_elemental_solution()</a>, <a class="el" href="mesh__tools_8C_source.html#l02259">libMesh::MeshTools::correct_node_proc_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l00386">libMesh::MeshTools::create_bounding_box()</a>, <a class="el" href="mesh__tools_8C_source.html#l00411">libMesh::MeshTools::create_nodal_bounding_box()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00219">create_parent_error_vector()</a>, <a class="el" href="mesh__tools_8C_source.html#l00477">libMesh::MeshTools::create_processor_bounding_box()</a>, <a class="el" href="mesh__tools_8C_source.html#l00529">libMesh::MeshTools::create_subdomain_bounding_box()</a>, <a class="el" href="mesh__communication_8C_source.html#l01844">libMesh::MeshCommunication::delete_remote_elements()</a>, <a class="el" href="dof__map_8C_source.html#l00902">libMesh::DofMap::distribute_dofs()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00782">DMlibMeshFunction()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00852">DMlibMeshJacobian()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00089">DMlibMeshSetSystem_libMesh()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00945">DMVariableBounds_libMesh()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00380">eliminate_unrefined_patches()</a>, <a class="el" href="trilinos__epetra__vector_8h_source.html#l00477">libMesh::EpetraVector&lt; T &gt;::EpetraVector()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00055">libMesh::WeightedPatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00153">libMesh::PatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00053">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00187">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>, <a class="el" href="condensed__eigen__system_8C_source.html#l00174">libMesh::CondensedEigenSystem::get_eigenpair()</a>, <a class="el" href="dof__map_8C_source.html#l02703">libMesh::DofMap::get_info()</a>, <a class="el" href="implicit__system_8C_source.html#l01395">libMesh::ImplicitSystem::get_linear_solver()</a>, <a class="el" href="location__maps_8C_source.html#l00046">libMesh::LocationMap&lt; T &gt;::init()</a>, <a class="el" href="time__solver_8C_source.html#l00064">libMesh::TimeSolver::init()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00054">libMesh::PetscDMWrapper::init_and_attach_petscdm()</a>, <a class="el" href="eigen__system_8C_source.html#l00116">libMesh::EigenSystem::init_data()</a>, <a class="el" href="eigen__system_8C_source.html#l00135">libMesh::EigenSystem::init_matrices()</a>, <a class="el" href="optimization__system_8C_source.html#l00091">libMesh::OptimizationSystem::initialize_equality_constraints_storage()</a>, <a class="el" href="optimization__system_8C_source.html#l00127">libMesh::OptimizationSystem::initialize_inequality_constraints_storage()</a>, <a class="el" href="mesh__tools_8C_source.html#l01671">libMesh::MeshTools::libmesh_assert_consistent_distributed()</a>, <a class="el" href="mesh__tools_8C_source.html#l01701">libMesh::MeshTools::libmesh_assert_consistent_distributed_nodes()</a>, <a class="el" href="mesh__tools_8C_source.html#l01598">libMesh::MeshTools::libmesh_assert_contiguous_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01877">libMesh::MeshTools::libmesh_assert_parallel_consistent_new_node_procids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01777">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01915">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01826">libMesh::MeshTools::libmesh_assert_topology_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01401">libMesh::MeshTools::libmesh_assert_valid_boundary_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01571">libMesh::MeshTools::libmesh_assert_valid_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l02068">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00931">libMesh::DistributedMesh::libmesh_assert_valid_parallel_flags()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00844">libMesh::DistributedMesh::libmesh_assert_valid_parallel_object_ids()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00908">libMesh::DistributedMesh::libmesh_assert_valid_parallel_p_levels()</a>, <a class="el" href="mesh__tools_8C_source.html#l01985">libMesh::MeshTools::libmesh_assert_valid_refinement_flags()</a>, <a class="el" href="mesh__tools_8C_source.html#l01641">libMesh::MeshTools::libmesh_assert_valid_unique_ids()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00201">libMesh::libmesh_petsc_snes_fd_residual()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00288">libMesh::libmesh_petsc_snes_jacobian()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00238">libMesh::libmesh_petsc_snes_mffd_residual()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00425">libMesh::libmesh_petsc_snes_postcheck()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00150">libMesh::libmesh_petsc_snes_residual()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00064">libMesh::libmesh_petsc_snes_residual_helper()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00126">limit_level_mismatch_at_edge()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">limit_level_mismatch_at_node()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00255">limit_overrefined_boundary()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00316">limit_underrefined_boundary()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__communication_8C_source.html#l01505">libMesh::MeshCommunication::make_elems_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">make_flags_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01685">libMesh::MeshCommunication::make_new_node_proc_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01805">libMesh::MeshCommunication::make_new_nodes_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01452">libMesh::MeshCommunication::make_node_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01656">libMesh::MeshCommunication::make_node_proc_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01481">libMesh::MeshCommunication::make_node_unique_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01763">libMesh::MeshCommunication::make_nodes_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01529">libMesh::MeshCommunication::make_p_levels_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>, <a class="el" href="fem__system_8C_source.html#l01061">libMesh::FEMSystem::mesh_position_set()</a>, <a class="el" href="distributed__mesh_8C_source.html#l01317">libMesh::DistributedMesh::n_active_elem()</a>, <a class="el" href="mesh__tools_8C_source.html#l00623">libMesh::MeshTools::n_active_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01646">libMesh::BoundaryInfo::n_boundary_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01667">libMesh::BoundaryInfo::n_edge_conds()</a>, <a class="el" href="condensed__eigen__system_8C_source.html#l00071">libMesh::CondensedEigenSystem::n_global_non_condensed_dofs()</a>, <a class="el" href="mesh__tools_8C_source.html#l00653">libMesh::MeshTools::n_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01711">libMesh::BoundaryInfo::n_nodeset_conds()</a>, <a class="el" href="mesh__tools_8C_source.html#l00718">libMesh::MeshTools::n_p_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01689">libMesh::BoundaryInfo::n_shellface_conds()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00182">libMesh::DistributedMesh::parallel_max_elem_id()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00240">libMesh::DistributedMesh::parallel_max_node_id()</a>, <a class="el" href="replicated__mesh_8C_source.html#l00592">libMesh::ReplicatedMesh::parallel_max_unique_id()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00213">libMesh::DistributedMesh::parallel_max_unique_id()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00169">libMesh::DistributedMesh::parallel_n_elem()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00227">libMesh::DistributedMesh::parallel_n_nodes()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00443">libMesh::SparsityPattern::Build::parallel_sync()</a>, <a class="el" href="mesh__tools_8C_source.html#l00677">libMesh::MeshTools::paranoid_n_levels()</a>, <a class="el" href="petsc__auto__fieldsplit_8C_source.html#l00058">libMesh::petsc_auto_fieldsplit()</a>, <a class="el" href="system_8C_source.html#l02100">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02220">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01993">libMesh::System::point_value()</a>, <a class="el" href="mesh__base_8C_source.html#l00152">libMesh::MeshBase::prepare_for_use()</a>, <a class="el" href="nemesis__io_8C_source.html#l00148">libMesh::Nemesis_IO::read()</a>, <a class="el" href="xdr__io_8C_source.html#l01250">libMesh::XdrIO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00830">libMesh::CheckpointIO::read_header()</a>, <a class="el" href="xdr__io_8C_source.html#l01380">libMesh::XdrIO::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00115">libMesh::System::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00310">libMesh::System::read_legacy_data()</a>, <a class="el" href="system__io_8C_source.html#l01121">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l02061">libMesh::XdrIO::read_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l01841">libMesh::XdrIO::read_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l00811">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l01504">libMesh::XdrIO::read_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l01690">libMesh::XdrIO::read_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01974">libMesh::XdrIO::read_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l01442">libMesh::XdrIO::read_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l01168">libMesh::System::read_serialized_vector()</a>, <a class="el" href="mesh__base_8C_source.html#l00458">libMesh::MeshBase::recalculate_n_partitions()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00961">libMesh::DistributedMesh::renumber_dof_objects()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00186">libMesh::CheckpointIO::select_split_config()</a>, <a class="el" href="dof__map_8C_source.html#l00321">libMesh::DofMap::set_nonlocal_dof_objects()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00337">libMesh::PetscDiffSolver::setup_petsc_data()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00045">libMesh::LaplaceMeshSmoother::smooth()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00134">libMesh::split_mesh()</a>, <a class="el" href="mesh__base_8C_source.html#l00288">libMesh::MeshBase::subdomain_ids()</a>, <a class="el" href="boundary__info_8C_source.html#l00163">libMesh::BoundaryInfo::sync()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00352">test_level_one()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00427">test_unflagged()</a>, <a class="el" href="mesh__tools_8C_source.html#l00210">libMesh::MeshTools::total_weight()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">uniformly_coarsen()</a>, <a class="el" href="namebased__io_8C_source.html#l00276">libMesh::NameBasedIO::write()</a>, <a class="el" href="xdr__io_8C_source.html#l00168">libMesh::XdrIO::write()</a>, <a class="el" href="system__io_8C_source.html#l02101">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l00993">libMesh::XdrIO::write_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l01815">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00351">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l00710">libMesh::XdrIO::write_serialized_nodes()</a>, and <a class="el" href="xdr__io_8C_source.html#l01136">libMesh::XdrIO::write_serialized_nodesets()</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>; }</div><div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00107">parallel_object.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac25b931ac102cee61e84fac044bdbf0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac25b931ac102cee61e84fac044bdbf0a">&#9670;&nbsp;</a></span>create_parent_error_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::create_parent_error_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>parent_error_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp;&#160;</td>
          <td class="paramname"><em>parent_error_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculates the error on all coarsenable parents. error_per_parent[parent_id] stores this error if parent_id corresponds to a coarsenable parent, and stores -1 otherwise. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00219">219</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00029">std::min()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min()</a>, <a class="el" href="elem_8h_source.html#l02479">libMesh::Elem::parent()</a>, and <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">libMesh::Parallel::Communicator::sum()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>, and <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// Make sure the input error vector is valid</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i != error_per_cell.size(); ++i)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      libmesh_assert_greater_equal (error_per_cell[i], 0);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="comment">// isnan() isn&#39;t standard C++ yet</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#ifdef isnan</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      libmesh_assert(!isnan(error_per_cell[i]));</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// Use a reference to std::vector to avoid confusing</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// this-&gt;comm().verify</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  std::vector&lt;ErrorVectorReal&gt; &amp; epc = error_per_parent;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().verify(epc));</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#endif // #ifdef DEBUG</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// error values on uncoarsenable elements will be left at -1</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  error_per_parent.clear();</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  error_per_parent.resize(error_per_cell.size(), 0.0);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// Find which elements are uncoarsenable</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        Elem * parent = elem-&gt;parent();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// Active elements are uncoarsenable</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        error_per_parent[elem-&gt;id()] = -1.0;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// Grandparents and up are uncoarsenable</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">while</span> (parent)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            parent = parent-&gt;parent();</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">if</span> (parent)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;              {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> parentid  = parent-&gt;id();</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                libmesh_assert_less (parentid, error_per_parent.size());</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                error_per_parent[parentid] = -1.0;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;              }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// Sync between processors.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// Use a reference to std::vector to avoid confusing</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// this-&gt;comm().min</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    std::vector&lt;ErrorVectorReal&gt; &amp; epp = error_per_parent;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">min</a>(epp);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// The parent&#39;s error is defined as the square root of the</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// sum of the children&#39;s errors squared, so errors that are</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Hilbert norms remain Hilbert norms.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// Because the children may be on different processors, we</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// calculate local contributions to the parents&#39; errors squared</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// first, then sum across processors and take the square roots</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// second.</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      Elem * parent = elem-&gt;parent();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// Calculate each contribution to parent cells</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">if</span> (parent)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> parentid  = parent-&gt;id();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          libmesh_assert_less (parentid, error_per_parent.size());</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <span class="comment">// If the parent has grandchildren we won&#39;t be able to</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <span class="comment">// coarsen it, so forget it.  Otherwise, add this child&#39;s</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <span class="comment">// contribution to the sum of the squared child errors</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="keywordflow">if</span> (error_per_parent[parentid] != -1.0)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            error_per_parent[parentid] += (error_per_cell[elem-&gt;id()] *</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                           error_per_cell[elem-&gt;id()]);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// Sum the vector across all processors</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">sum</a>(<span class="keyword">static_cast&lt;</span>std::vector&lt;ErrorVectorReal&gt; &amp;<span class="keyword">&gt;</span>(error_per_parent));</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// Calculate the min and max as we loop</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  parent_error_min = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::numeric_limits&lt;double&gt;::max</a>();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  parent_error_max = 0.;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">for</span> (std::size_t i = 0; i != error_per_parent.size(); ++i)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">// If this element isn&#39;t a coarsenable parent with error, we</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// have nothing to do.  Just flag it as -1 and move on</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// Note that this-&gt;comm().sum might have left uncoarsenable</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// elements with error_per_parent=-n_proc, so reset it to</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="comment">// error_per_parent=-1</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (error_per_parent[i] &lt; 0.)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          error_per_parent[i] = -1.;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="comment">// The error estimator might have already given us an</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">// estimate on the coarsenable parent elements; if so then</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="comment">// we want to retain that estimate</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">if</span> (error_per_cell[i])</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          error_per_parent[i] = error_per_cell[i];</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">// if not, then e_parent = sqrt(sum(e_child^2))</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        error_per_parent[i] = std::sqrt(error_per_parent[i]);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      parent_error_min = <a class="code" href="namespacestd.html#a4444b32c7044d9b34125eaebd070a0e3">std::min</a> (parent_error_min,</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                   error_per_parent[i]);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      parent_error_max = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a> (parent_error_max,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                   error_per_parent[i]);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ae98cb59b3edcacefe07571dcc0742e91"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min</a></div><div class="ttdeci">void min(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3f8b3675d745f7d586e93158aa951174"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3f8b3675d745f7d586e93158aa951174">libMesh::Parallel::Communicator::sum</a></div><div class="ttdeci">void sum(T &amp;r) const</div></div>
<div class="ttc" id="namespacestd_html_a4444b32c7044d9b34125eaebd070a0e3"><div class="ttname"><a href="namespacestd.html#a4444b32c7044d9b34125eaebd070a0e3">std::min</a></div><div class="ttdeci">long double min(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00029">libmesh_augment_std_namespace.h:29</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adeb3800bb748de340a82caef581ed43d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb3800bb748de340a82caef581ed43d">&#9670;&nbsp;</a></span>edge_level_mismatch_limit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char &amp; libMesh::MeshRefinement::edge_level_mismatch_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>edge_level_mismatch_limit</code> is set to a nonzero value, then refinement and coarsening will produce meshes in which the refinement level of two edge neighbors will not differ by more than that limit. If <code>edge_level_mismatch_limit</code> is 0, then level differences will be unlimited.</p>
<p><code>edge_level_mismatch_limit</code> is 0 by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00917">917</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00770">_edge_level_mismatch_limit</a>.</p>
<div class="fragment"><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;{</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">_edge_level_mismatch_limit</a>;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ae705082e7bc067be443b6792c1be54d6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ae705082e7bc067be443b6792c1be54d6">libMesh::MeshRefinement::_edge_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _edge_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00770">mesh_refinement.h:770</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f57c999ade430e94e7cf25bfc97eb07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f57c999ade430e94e7cf25bfc97eb07">&#9670;&nbsp;</a></span>eliminate_unrefined_patches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::eliminate_unrefined_patches </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This algorithm selects an element for refinement if all of its neighbors are (or will be) refined. This algorithm will transform this mesh: </p><pre class="fragment">* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* |   |   |       |   |   |
* |   |   |       |   |   |
* o---o---o       o---o---o
* |   |   |       |   |   |
* |   |   |       |   |   |
* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* </pre><p>into this: </p><pre class="fragment">* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* |   |   |   :   |   |   |
* |   |   |   :   |   |   |
* o---o---o...o...o---o---o
* |   |   |   :   |   |   |
* |   |   |   :   |   |   |
* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* |   |   |   |   |   |   |
* |   |   |   |   |   |   |
* o---o---o---o---o---o---o
* </pre><p>by refining the indicated element </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00380">380</a> of file <a class="el" href="mesh__refinement__smoothing_8C_source.html">mesh_refinement_smoothing.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="elem_8h_source.html#l01204">libMesh::Elem::COARSEN_INACTIVE</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, and <a class="el" href="remote__elem_8C_source.html#l00057">libMesh::remote_elem</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordtype">bool</span> flags_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// Note: we *cannot* use a reference to the real pointer here, since</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// the pointer may be reseated below and we don&#39;t want to reseat</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// pointers held by the Mesh.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">for</span> (Elem * elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="comment">// First, see if there&#39;s any possibility we might have to flag</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="comment">// this element for h and p refinement - do we have any visible</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="comment">// neighbors?  Next we&#39;ll check to see if any of those neighbors</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">// are as coarse or coarser than us.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordtype">bool</span> h_flag_me = <span class="keyword">false</span>,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;           p_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> neighbor : elem-&gt;neighbor_ptr_range())</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          <span class="comment">// Quit if the element is not a local boundary</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <span class="keywordflow">if</span> (neighbor != <span class="keyword">nullptr</span> &amp;&amp; neighbor != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;              h_flag_me = <span class="keyword">true</span>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;              p_flag_me = <span class="keyword">true</span>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="comment">// Skip the element if it is already fully flagged for refinement</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        p_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          h_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="keywordflow">if</span> (!p_flag_me)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">// Test the parent if that is already flagged for coarsening</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          libmesh_assert(elem-&gt;parent());</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;          elem = elem-&gt;parent();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;          <span class="comment">// FIXME - this doesn&#39;t seem right - RHS</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;          p_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_level = elem-&gt;level();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordtype">int</span> my_p_adjustment = 0;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        my_p_adjustment = 1;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          libmesh_assert_greater (elem-&gt;p_level(), 0);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          my_p_adjustment = -1;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_new_p_level = elem-&gt;p_level() +</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        my_p_adjustment;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="comment">// Check all the element neighbors</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> neighbor : elem-&gt;neighbor_ptr_range())</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          <span class="comment">// Quit if the element is on a local boundary</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          <span class="keywordflow">if</span> (neighbor == <span class="keyword">nullptr</span> || neighbor == <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;              h_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;              p_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          <span class="comment">// if the neighbor will be equally or less refined than</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <span class="comment">// we are, then we will not become an unrefined island.</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          <span class="comment">// So if we are still considering h refinement:</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          <span class="keywordflow">if</span> (h_flag_me &amp;&amp;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;              <span class="comment">// If our neighbor is already at a lower level,</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;              <span class="comment">// it can&#39;t end up at a higher level even if it</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;              <span class="comment">// is flagged for refinement once</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;              ((neighbor-&gt;level() &lt; my_level) ||</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;               <span class="comment">// If our neighbor is at the same level but isn&#39;t</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;               <span class="comment">// flagged for refinement, it won&#39;t end up at a</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;               <span class="comment">// higher level</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;               ((neighbor-&gt;active()) &amp;&amp;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                (neighbor-&gt;refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)) ||</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;               <span class="comment">// If our neighbor is currently more refined but is</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;               <span class="comment">// a parent flagged for coarsening, it will end up</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;               <span class="comment">// at the same level.</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;               (neighbor-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>)))</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;              <span class="comment">// We&#39;ve proven we won&#39;t become an unrefined island,</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;              <span class="comment">// so don&#39;t h refine to avoid that.</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;              h_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;              <span class="comment">// If we&#39;ve also proven we don&#39;t need to p refine,</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;              <span class="comment">// we don&#39;t need to check more neighbors</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              <span class="keywordflow">if</span> (!p_flag_me)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          <span class="keywordflow">if</span> (p_flag_me)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;              <span class="comment">// if active neighbors will have a p level</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;              <span class="comment">// equal to or lower than ours, then we do not need to p</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;              <span class="comment">// refine ourselves.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;              <span class="keywordflow">if</span> (neighbor-&gt;active())</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                  <span class="keywordtype">int</span> p_adjustment = 0;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                  <span class="keywordflow">if</span> (neighbor-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    p_adjustment = 1;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (neighbor-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                      libmesh_assert_greater (neighbor-&gt;p_level(), 0);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                      p_adjustment = -1;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    }</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                  <span class="keywordflow">if</span> (my_new_p_level &gt;= neighbor-&gt;p_level() + p_adjustment)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                      p_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                      <span class="keywordflow">if</span> (!h_flag_me)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;              <span class="comment">// If we have inactive neighbors, we need to</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;              <span class="comment">// test all their active descendants which neighbor us</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (neighbor-&gt;ancestor())</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                  <span class="keywordflow">if</span> (neighbor-&gt;min_new_p_level_by_neighbor(elem,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                            my_new_p_level + 2) &lt;= my_new_p_level)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                      p_flag_me = <span class="keyword">false</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                      <span class="keywordflow">if</span> (!h_flag_me)</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">if</span> (h_flag_me)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          <span class="comment">// Parents that would create islands should no longer</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          <span class="comment">// coarsen</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; child : elem-&gt;child_ref_range())</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                  libmesh_assert_equal_to (child.refinement_flag(),</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                           <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                  child.set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">if</span> (p_flag_me)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// If flags changed on any processor then they changed globally</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(flags_changed);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">return</span> flags_changed;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">libMesh::Elem::COARSEN_INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01204">elem.h:1204</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a903992f631b52b5ba05ad96a51e7b383"><div class="ttname"><a href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">libMesh::remote_elem</a></div><div class="ttdeci">const RemoteElem * remote_elem</div><div class="ttdef"><b>Definition:</b> <a href="remote__elem_8C_source.html#l00057">remote_elem.C:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e18ee522c67a8eb52dd58f6374686d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e18ee522c67a8eb52dd58f6374686d2">&#9670;&nbsp;</a></span>enforce_mismatch_limit_prior_to_refinement() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool &amp; libMesh::MeshRefinement::enforce_mismatch_limit_prior_to_refinement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get/set the _enforce_mismatch_limit_prior_to_refinement flag. The default value for this flag is false. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00951">951</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00844">_enforce_mismatch_limit_prior_to_refinement</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8h_source.html#l00938">get_enforce_mismatch_limit_prior_to_refinement()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00126">limit_level_mismatch_at_edge()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">limit_level_mismatch_at_node()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00944">set_enforce_mismatch_limit_prior_to_refinement()</a>.</p>
<div class="fragment"><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;{</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">_enforce_mismatch_limit_prior_to_refinement</a>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a380986d25467e922fc62f0f6f0f33d48"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">libMesh::MeshRefinement::_enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool _enforce_mismatch_limit_prior_to_refinement</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00844">mesh_refinement.h:844</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8651f3ae66141c3270f519d8bdd7efe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8651f3ae66141c3270f519d8bdd7efe5">&#9670;&nbsp;</a></span>enforce_mismatch_limit_prior_to_refinement() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::enforce_mismatch_limit_prior_to_refinement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824">NeighborType</a>&#160;</td>
          <td class="paramname"><em>nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_mismatch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00551">551</a> of file <a class="el" href="mesh__refinement__smoothing_8C_source.html">mesh_refinement_smoothing.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00844">_enforce_mismatch_limit_prior_to_refinement</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="mesh__refinement_8h_source.html#l00855">EDGE</a>, <a class="el" href="elem_8C_source.html#l00637">libMesh::Elem::find_edge_neighbors()</a>, <a class="el" href="elem_8C_source.html#l00498">libMesh::Elem::find_point_neighbors()</a>, <a class="el" href="elem_8h_source.html#l02521">libMesh::Elem::level()</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00855">POINT</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02662">libMesh::Elem::set_p_refinement_flag()</a>, and <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// Eventual return value</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordtype">bool</span> flags_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// If we are enforcing the limit prior to refinement then we</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// need to remove flags from any elements marked for refinement that</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// would cause a mismatch</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">_enforce_mismatch_limit_prior_to_refinement</a></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      &amp;&amp; elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="comment">// get all the relevant neighbors since we may have to refine</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="comment">// elements off edges or corners as well</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      std::set&lt;const Elem *&gt; neighbor_set;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">if</span> (nt == <a class="code" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36">POINT</a>)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        elem-&gt;find_point_neighbors(neighbor_set);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nt == <a class="code" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea">EDGE</a>)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        elem-&gt;find_edge_neighbors(neighbor_set);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        libmesh_error_msg(<span class="stringliteral">&quot;Unrecognized NeighborType: &quot;</span> &lt;&lt; nt);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="comment">// Loop over the neighbors of element e</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; neighbor : neighbor_set)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <span class="keywordflow">if</span> ((elem-&gt;level() + 1 - max_mismatch) &gt; neighbor-&gt;level())</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;              elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;              flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <span class="keywordflow">if</span> ((elem-&gt;p_level() + 1 - max_mismatch) &gt; neighbor-&gt;p_level())</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;              elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;              flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        } <span class="comment">// loop over edge/point neighbors</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    } <span class="comment">// if _enforce_mismatch_limit_prior_to_refinement</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">return</span> flags_changed;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea">libMesh::MeshRefinement::EDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00855">mesh_refinement.h:855</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36">libMesh::MeshRefinement::POINT</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00855">mesh_refinement.h:855</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a380986d25467e922fc62f0f6f0f33d48"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">libMesh::MeshRefinement::_enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool _enforce_mismatch_limit_prior_to_refinement</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00844">mesh_refinement.h:844</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81fa55fe9538fded1391a56952aa1376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81fa55fe9538fded1391a56952aa1376">&#9670;&nbsp;</a></span>face_level_mismatch_limit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char &amp; libMesh::MeshRefinement::face_level_mismatch_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>face_level_mismatch_limit</code> is set to a nonzero value, then refinement and coarsening will produce meshes in which the refinement level of two face neighbors will not differ by more than that limit. If <code>face_level_mismatch_limit</code> is 0, then level differences will be unlimited.</p>
<p><code>face_level_mismatch_limit</code> is 1 by default. Currently the only supported options are 0 and 1. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00912">912</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00769">_face_level_mismatch_limit</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00133">libMesh::EquationSystems::reinit_solutions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;{</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a56f1015a59736175b39e4a1ca4d084bc"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">libMesh::MeshRefinement::_face_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _face_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00769">mesh_refinement.h:769</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aadfc9d7cb09e236a9e04f06cce8d2ecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadfc9d7cb09e236a9e04f06cce8d2ecc">&#9670;&nbsp;</a></span>flag_elements_by()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::flag_elements_by </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshRefinement_1_1ElementFlagging.html">ElementFlagging</a> &amp;&#160;</td>
          <td class="paramname"><em>element_flagging</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag elements based on a function object. The class <code><a class="el" href="classlibMesh_1_1MeshRefinement_1_1ElementFlagging.html">ElementFlagging</a></code> defines a mechanism for implementing refinement strategies. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00628">628</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="classlibMesh_1_1MeshRefinement_1_1ElementFlagging.html#ae00a8cc55bc7c93dcc74e86a2ed3b5cb">libMesh::MeshRefinement::ElementFlagging::flag_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;{</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  element_flagging.flag_elements();</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a50e328f89c951deca3895d130750ac07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50e328f89c951deca3895d130750ac07">&#9670;&nbsp;</a></span>flag_elements_by_elem_fraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::flag_elements_by_elem_fraction </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>refine_fraction</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>coarsen_fraction</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_level</em> = <code><a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flags elements for coarsening and refinement based on the computed error passed in <code>error_per_cell</code>. This method picks the top <code>refine_fraction</code> * <code>n_elem</code> elements for refinement and the bottom <code>coarsen_fraction</code> * <code>n_elem</code> elements for coarsening. The two fractions <code>refine_fraction</code> and <code>coarsen_fraction</code> must be in <img class="formulaInl" alt="$ [0,1] $" src="form_98.png"/>.</p>
<p>All the function arguments except error_per_cell have been deprecated, and will be removed in future <a class="el" href="namespacelibMesh.html">libMesh</a> releases - to control these parameters, set the corresponding member variables. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">434</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00755">_coarsen_by_parents</a>, <a class="el" href="mesh__refinement_8h_source.html#l00759">_coarsen_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00761">_max_h_level</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00757">_refine_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="parallel__implementation_8h_source.html#l02746">libMesh::Parallel::Communicator::allgather()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00662">clean_refinement_flags()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00219">create_parent_error_vector()</a>, <a class="el" href="libmesh__common_8h_source.html#l00202">libMesh::ErrorVectorReal</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, <a class="el" href="mesh__base_8C_source.html#l00126">libMesh::MeshBase::mesh_dimension()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">libMesh::MeshBase::n_active_elem()</a>, <a class="el" href="elem_8h_source.html#l02479">libMesh::Elem::parent()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, and <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;{</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// The function arguments are currently just there for</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// backwards_compatibility</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a>)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="comment">// If the user used non-default parameters, lets warn</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="comment">// that they&#39;re deprecated</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">if</span> (refine_frac != 0.3 ||</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          coarsen_frac != 0.0 ||</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          max_l != <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        libmesh_deprecated();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a> = refine_frac;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a> = coarsen_frac;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a> = max_l;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// Check for valid fractions..</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// The fraction values must be in [0,1]</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 0);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 1);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 0);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 1);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// The number of active elements in the mesh</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_active_elem  = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">n_active_elem</a>();</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// The number of elements to flag for coarsening</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_elem_coarsen =</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a> * n_active_elem);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// The number of elements to flag for refinement</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_elem_refine =</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>  * n_active_elem);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// Clean up the refinement flags.  These could be left</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// over from previous refinement steps.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">clean_refinement_flags</a>();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// This vector stores the error and element number for all the</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// active elements.  It will be sorted and the top &amp; bottom</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// elements will then be flagged for coarsening &amp; refinement</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  std::vector&lt;ErrorVectorReal&gt; sorted_error;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  sorted_error.reserve (n_active_elem);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// Loop over the active elements and create the entry</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// in the sorted_error vector</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    sorted_error.push_back (error_per_cell[elem-&gt;id()]);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a9784f116118938b9260753a6b4b9fc3f">allgather</a>(sorted_error);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Now sort the sorted_error vector</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  std::sort (sorted_error.begin(), sorted_error.end());</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// If we&#39;re coarsening by parents:</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// Create a sorted error vector with coarsenable parent elements</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// only, sorted by lowest errors first</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  ErrorVector error_per_parent, sorted_parent_error;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a>)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_error_min, parent_error_max;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">create_parent_error_vector</a>(error_per_cell,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                 error_per_parent,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                 parent_error_min,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                 parent_error_max);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      sorted_parent_error = error_per_parent;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      std::sort (sorted_parent_error.begin(), sorted_parent_error.end());</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="comment">// All the other error values will be 0., so get rid of them.</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      sorted_parent_error.erase (std::remove(sorted_parent_error.begin(),</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                             sorted_parent_error.end(), 0.),</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                 sorted_parent_error.end());</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> top_error= 0., bottom_error = 0.;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">// Get the maximum error value corresponding to the</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// bottom n_elem_coarsen elements</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a> &amp;&amp; n_elem_coarsen)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a169bc3297f1070065f9380ff54eb0400">mesh_dimension</a>();</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> twotodim = 1;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i!=dim; ++i)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        twotodim *= 2;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_parent_coarsen = n_elem_coarsen / (twotodim - 1);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">if</span> (n_parent_coarsen)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        bottom_error = sorted_parent_error[n_parent_coarsen - 1];</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n_elem_coarsen)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      bottom_error = sorted_error[n_elem_coarsen - 1];</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">if</span> (n_elem_refine)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    top_error = sorted_error[sorted_error.size() - n_elem_refine];</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// Finally, let&#39;s do the element flagging</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      Elem * parent = elem-&gt;parent();</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a> &amp;&amp; parent &amp;&amp; n_elem_coarsen &amp;&amp;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          error_per_parent[parent-&gt;id()] &lt;= bottom_error)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a> &amp;&amp; n_elem_coarsen &amp;&amp;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;          error_per_cell[elem-&gt;id()] &lt;= bottom_error)</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">if</span> (n_elem_refine &amp;&amp;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          elem-&gt;level() &lt; <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a> &amp;&amp;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          error_per_cell[elem-&gt;id()] &gt;= top_error)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a04e98b91b8eb9b6ddcf0dff673a1a281"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">libMesh::MeshRefinement::_coarsen_fraction</a></div><div class="ttdeci">Real _coarsen_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00759">mesh_refinement.h:759</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae5b70f8be225d006fb25ef1e6b82bc3a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">libMesh::MeshBase::n_active_elem</a></div><div class="ttdeci">virtual dof_id_type n_active_elem() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af56d90ecbcb73303903c0e298eea13ec"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">libMesh::MeshRefinement::_refine_fraction</a></div><div class="ttdeci">Real _refine_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00757">mesh_refinement.h:757</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a80ebcf25e84315a95e59128b57c5834f"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">libMesh::MeshRefinement::_max_h_level</a></div><div class="ttdeci">unsigned int _max_h_level</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00761">mesh_refinement.h:761</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a9784f116118938b9260753a6b4b9fc3f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a9784f116118938b9260753a6b4b9fc3f">libMesh::Parallel::Communicator::allgather</a></div><div class="ttdeci">void allgather(const T &amp;send, std::vector&lt; T, A &gt; &amp;recv) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l02746">parallel_implementation.h:2746</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6930cd279030a81ff6d36a40809b1fd8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">libMesh::MeshRefinement::clean_refinement_flags</a></div><div class="ttdeci">void clean_refinement_flags()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__flagging_8C_source.html#l00662">mesh_refinement_flagging.C:662</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac25b931ac102cee61e84fac044bdbf0a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">libMesh::MeshRefinement::create_parent_error_vector</a></div><div class="ttdeci">void create_parent_error_vector(const ErrorVector &amp;error_per_cell, ErrorVector &amp;error_per_parent, Real &amp;parent_error_min, Real &amp;parent_error_max)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00219">mesh_refinement.C:219</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00202">libmesh_common.h:202</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a169bc3297f1070065f9380ff54eb0400"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a169bc3297f1070065f9380ff54eb0400">libMesh::MeshBase::mesh_dimension</a></div><div class="ttdeci">unsigned int mesh_dimension() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00126">mesh_base.C:126</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ab6fda707e1285340135e56469b055746"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">libMesh::MeshRefinement::_coarsen_by_parents</a></div><div class="ttdeci">bool _coarsen_by_parents</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00755">mesh_refinement.h:755</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ef885bd531649c9d0738f2e9c65b53b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef885bd531649c9d0738f2e9c65b53b">&#9670;&nbsp;</a></span>flag_elements_by_error_fraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::flag_elements_by_error_fraction </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>refine_fraction</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>coarsen_fraction</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_level</em> = <code><a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flags elements for coarsening and refinement based on the computed error passed in <code>error_per_cell</code>. The two fractions <code>refine_fraction</code> and <code>coarsen_fraction</code> must be in <img class="formulaInl" alt="$ [0,1] $" src="form_98.png"/>.</p>
<p>All the function arguments except error_per_cell have been deprecated, and will be removed in future <a class="el" href="namespacelibMesh.html">libMesh</a> releases - to control these parameters, set the corresponding member variables. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">44</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00755">_coarsen_by_parents</a>, <a class="el" href="mesh__refinement_8h_source.html#l00759">_coarsen_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00761">_max_h_level</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00757">_refine_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00662">clean_refinement_flags()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00219">create_parent_error_vector()</a>, <a class="el" href="libmesh__common_8h_source.html#l00202">libMesh::ErrorVectorReal</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00029">std::min()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min()</a>, <a class="el" href="elem_8h_source.html#l02479">libMesh::Elem::parent()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, and <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// The function arguments are currently just there for</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// backwards_compatibility</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a>)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="comment">// If the user used non-default parameters, lets warn</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="comment">// that they&#39;re deprecated</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">if</span> (refine_frac != 0.3 ||</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          coarsen_frac != 0.0 ||</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          max_l != <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        libmesh_deprecated();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a> = refine_frac;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a> = coarsen_frac;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a> = max_l;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// Check for valid fractions..</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// The fraction values must be in [0,1]</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 0);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 1);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 0);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 1);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// Clean up the refinement flags.  These could be left</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// over from previous refinement steps.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">clean_refinement_flags</a>();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// We&#39;re getting the minimum and maximum error values</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// for the ACTIVE elements</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> error_min = 1.e30;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> error_max = 0.;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// And, if necessary, for their parents</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_error_min = 1.e30;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_error_max = 0.;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// Prepare another error vector if we need to sum parent errors</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  ErrorVector error_per_parent;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a>)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">create_parent_error_vector</a>(error_per_cell,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                 error_per_parent,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                 parent_error_min,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                 parent_error_max);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// We need to loop over all active elements to find the minimum</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> <span class="keywordtype">id</span>  = elem-&gt;id();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      libmesh_assert_less (<span class="keywordtype">id</span>, error_per_cell.size());</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      error_max = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a> (error_max, error_per_cell[<span class="keywordtype">id</span>]);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      error_min = <a class="code" href="namespacestd.html#a4444b32c7044d9b34125eaebd070a0e3">std::min</a> (error_min, error_per_cell[<span class="keywordtype">id</span>]);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(error_max);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">min</a>(error_min);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// Compute the cutoff values for coarsening and refinement</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> error_delta = (error_max - error_min);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_error_delta = parent_error_max - parent_error_min;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> refine_cutoff  = (1.- <a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>)*error_max;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> coarsen_cutoff = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>*error_delta + error_min;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_cutoff = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>*parent_error_delta + error_min;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">//   // Print information about the error</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">//   libMesh::out &lt;&lt; &quot; Error Information:&quot;                     &lt;&lt; std::endl</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">//     &lt;&lt; &quot; ------------------&quot;                     &lt;&lt; std::endl</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">//     &lt;&lt; &quot;   min:              &quot; &lt;&lt; error_min      &lt;&lt; std::endl</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">//     &lt;&lt; &quot;   max:              &quot; &lt;&lt; error_max      &lt;&lt; std::endl</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">//     &lt;&lt; &quot;   delta:            &quot; &lt;&lt; error_delta    &lt;&lt; std::endl</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">//     &lt;&lt; &quot;     refine_cutoff:  &quot; &lt;&lt; refine_cutoff  &lt;&lt; std::endl</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">//     &lt;&lt; &quot;     coarsen_cutoff: &quot; &lt;&lt; coarsen_cutoff &lt;&lt; std::endl;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// Loop over the elements and flag them for coarsening or</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// refinement based on the element error</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> <span class="keywordtype">id</span> = elem-&gt;id();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      libmesh_assert_less (<span class="keywordtype">id</span>, error_per_cell.size());</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> elem_error = error_per_cell[id];</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a>)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          Elem * parent           = elem-&gt;parent();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <span class="keywordflow">if</span> (parent)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> parentid  = parent-&gt;id();</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              <span class="keywordflow">if</span> (error_per_parent[parentid] &gt;= 0. &amp;&amp;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                  error_per_parent[parentid] &lt;= parent_cutoff)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// Flag the element for coarsening if its error</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// is &lt;= coarsen_fraction*delta + error_min</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem_error &lt;= coarsen_cutoff)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">// Flag the element for refinement if its error</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// is &gt;= refinement_cutoff.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">if</span> (elem_error &gt;= refine_cutoff)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (elem-&gt;level() &lt; <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a>)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a04e98b91b8eb9b6ddcf0dff673a1a281"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">libMesh::MeshRefinement::_coarsen_fraction</a></div><div class="ttdeci">Real _coarsen_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00759">mesh_refinement.h:759</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af56d90ecbcb73303903c0e298eea13ec"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">libMesh::MeshRefinement::_refine_fraction</a></div><div class="ttdeci">Real _refine_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00757">mesh_refinement.h:757</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a80ebcf25e84315a95e59128b57c5834f"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">libMesh::MeshRefinement::_max_h_level</a></div><div class="ttdeci">unsigned int _max_h_level</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00761">mesh_refinement.h:761</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ae98cb59b3edcacefe07571dcc0742e91"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min</a></div><div class="ttdeci">void min(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6930cd279030a81ff6d36a40809b1fd8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">libMesh::MeshRefinement::clean_refinement_flags</a></div><div class="ttdeci">void clean_refinement_flags()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__flagging_8C_source.html#l00662">mesh_refinement_flagging.C:662</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac25b931ac102cee61e84fac044bdbf0a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">libMesh::MeshRefinement::create_parent_error_vector</a></div><div class="ttdeci">void create_parent_error_vector(const ErrorVector &amp;error_per_cell, ErrorVector &amp;error_per_parent, Real &amp;parent_error_min, Real &amp;parent_error_max)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00219">mesh_refinement.C:219</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00202">libmesh_common.h:202</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="namespacestd_html_a4444b32c7044d9b34125eaebd070a0e3"><div class="ttname"><a href="namespacestd.html#a4444b32c7044d9b34125eaebd070a0e3">std::min</a></div><div class="ttdeci">long double min(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00029">libmesh_augment_std_namespace.h:29</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ab6fda707e1285340135e56469b055746"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">libMesh::MeshRefinement::_coarsen_by_parents</a></div><div class="ttdeci">bool _coarsen_by_parents</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00755">mesh_refinement.h:755</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a31da3a2dbca4c3e0a893090f4e467ddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31da3a2dbca4c3e0a893090f4e467ddc">&#9670;&nbsp;</a></span>flag_elements_by_error_tolerance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::flag_elements_by_error_tolerance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flags elements for coarsening and refinement based on the computed error passed in <code>error_per_cell</code>. This method refines the worst elements with errors greater than <code>absolute_global_tolerance</code> / n_active_elem, flagging at most <code>refine_fraction</code> * n_active_elem It coarsens elements with errors less than <code>coarsen_threshold</code> * <code>global_tolerance</code> / n_active_elem, flagging at most <code>coarsen_fraction</code> * n_active_elem</p>
<p>The three fractions <code>refine_fraction</code> <code>coarsen_fraction</code> and <code>coarsen_threshold</code> should be in <img class="formulaInl" alt="$ [0,1] $" src="form_98.png"/>. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">166</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00767">_absolute_global_tolerance</a>, <a class="el" href="mesh__refinement_8h_source.html#l00755">_coarsen_by_parents</a>, <a class="el" href="mesh__refinement_8h_source.html#l00759">_coarsen_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00763">_coarsen_threshold</a>, <a class="el" href="mesh__refinement_8h_source.html#l00761">_max_h_level</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00757">_refine_fraction</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="mesh__refinement_8C_source.html#l00219">create_parent_error_vector()</a>, <a class="el" href="libmesh__common_8h_source.html#l00202">libMesh::ErrorVectorReal</a>, <a class="el" href="dof__object_8h_source.html#l00655">libMesh::DofObject::id()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">libMesh::MeshBase::n_active_elem()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ac9df9e0213d3ea1d2d8279892f6f1094">libMesh::Elem::n_children()</a>, <a class="el" href="elem_8h_source.html#l02479">libMesh::Elem::parent()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, and <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  libmesh_assert_greater (<a class="code" href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">_coarsen_threshold</a>, 0);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// Check for valid fractions..</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// The fraction values must be in [0,1]</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 0);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 1);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 0);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 1);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// How much error per cell will we tolerate?</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> local_refinement_tolerance =</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#aea1a97aa9a8e4a8ec1967050c96f5b13">_absolute_global_tolerance</a> / std::sqrt(static_cast&lt;Real&gt;(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">n_active_elem</a>()));</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> local_coarsening_tolerance =</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    local_refinement_tolerance * <a class="code" href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">_coarsen_threshold</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// Prepare another error vector if we need to sum parent errors</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  ErrorVector error_per_parent;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a>)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_error_min, parent_error_max;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">create_parent_error_vector</a>(error_per_cell_in,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                 error_per_parent,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                 parent_error_min,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                 parent_error_max);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      Elem * parent = elem-&gt;parent();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> elem_number    = elem-&gt;id();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> elem_error = error_per_cell_in[elem_number];</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span> (elem_error &gt; local_refinement_tolerance &amp;&amp;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          elem-&gt;level() &lt; <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a>)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a> &amp;&amp; elem_error &lt;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          local_coarsening_tolerance)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a> &amp;&amp; parent)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> parent_error = error_per_parent[parent-&gt;id()];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="keywordflow">if</span> (parent_error &gt;= 0.)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_coarsening_tolerance =</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                std::sqrt(parent-&gt;n_children() *</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                          local_coarsening_tolerance *</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                          local_coarsening_tolerance);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;              <span class="keywordflow">if</span> (parent_error &lt; parent_coarsening_tolerance)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a04e98b91b8eb9b6ddcf0dff673a1a281"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">libMesh::MeshRefinement::_coarsen_fraction</a></div><div class="ttdeci">Real _coarsen_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00759">mesh_refinement.h:759</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae5b70f8be225d006fb25ef1e6b82bc3a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">libMesh::MeshBase::n_active_elem</a></div><div class="ttdeci">virtual dof_id_type n_active_elem() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af56d90ecbcb73303903c0e298eea13ec"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">libMesh::MeshRefinement::_refine_fraction</a></div><div class="ttdeci">Real _refine_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00757">mesh_refinement.h:757</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a80ebcf25e84315a95e59128b57c5834f"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">libMesh::MeshRefinement::_max_h_level</a></div><div class="ttdeci">unsigned int _max_h_level</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00761">mesh_refinement.h:761</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac25b931ac102cee61e84fac044bdbf0a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">libMesh::MeshRefinement::create_parent_error_vector</a></div><div class="ttdeci">void create_parent_error_vector(const ErrorVector &amp;error_per_cell, ErrorVector &amp;error_per_parent, Real &amp;parent_error_min, Real &amp;parent_error_max)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00219">mesh_refinement.C:219</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00202">libmesh_common.h:202</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_aef4c09ce1e49edffc4b7f196d4b91b8a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">libMesh::MeshRefinement::_coarsen_threshold</a></div><div class="ttdeci">Real _coarsen_threshold</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00763">mesh_refinement.h:763</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ab6fda707e1285340135e56469b055746"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">libMesh::MeshRefinement::_coarsen_by_parents</a></div><div class="ttdeci">bool _coarsen_by_parents</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00755">mesh_refinement.h:755</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_aea1a97aa9a8e4a8ec1967050c96f5b13"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#aea1a97aa9a8e4a8ec1967050c96f5b13">libMesh::MeshRefinement::_absolute_global_tolerance</a></div><div class="ttdeci">Real _absolute_global_tolerance</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00767">mesh_refinement.h:767</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0377024040f50645b4eec3d8ebc3268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0377024040f50645b4eec3d8ebc3268">&#9670;&nbsp;</a></span>flag_elements_by_mean_stddev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::flag_elements_by_mean_stddev </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>refine_fraction</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>coarsen_fraction</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_level</em> = <code><a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flags elements for coarsening and refinement based on the computed error passed in <code>error_per_cell</code>. This method picks the top <code>refine_fraction</code> * <code>stddev</code> + <code>mean</code> elements for refinement and the bottom <code>mean</code> - <code>coarsen_fraction</code> * <code>stddev</code> elements for coarsening. The two fractions <code>refine_fraction</code> and <code>coarsen_fraction</code> must be in <img class="formulaInl" alt="$ [0,1] $" src="form_98.png"/>.</p>
<p>All the function arguments except error_per_cell have been deprecated, and will be removed in future <a class="el" href="namespacelibMesh.html">libMesh</a> releases - to control these parameters, set the corresponding member variables. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00568">568</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00759">_coarsen_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00761">_max_h_level</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00757">_refine_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="libmesh__common_8h_source.html#l00202">libMesh::ErrorVectorReal</a>, <a class="el" href="libmesh_8h_source.html#l00245">libMesh::invalid_uint</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="error__vector_8C_source.html#l00069">libMesh::ErrorVector::mean()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, and <a class="el" href="error__vector_8h_source.html#l00115">libMesh::ErrorVector::variance()</a>.</p>
<div class="fragment"><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// The function arguments are currently just there for</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// backwards_compatibility</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a>)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">// If the user used non-default parameters, lets warn</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="comment">// that they&#39;re deprecated</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">if</span> (refine_frac != 0.3 ||</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          coarsen_frac != 0.0 ||</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          max_l != <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        libmesh_deprecated();</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a> = refine_frac;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a> = coarsen_frac;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a> = max_l;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// Get the mean value from the error vector</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> mean = error_per_cell.mean();</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// Get the standard deviation.  This equals the</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// square-root of the variance</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> stddev = std::sqrt (error_per_cell.variance());</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// Check for valid fractions</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 0);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 1);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 0);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 1);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">// The refine and coarsen cutoff</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> refine_cutoff  =  mean + <a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>  * stddev;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> coarsen_cutoff =  <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(mean - <a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a> * stddev, 0.);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// Loop over the elements and flag them for coarsening or</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">// refinement based on the element error</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> <span class="keywordtype">id</span>  = elem-&gt;id();</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      libmesh_assert_less (<span class="keywordtype">id</span>, error_per_cell.size());</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> elem_error = error_per_cell[id];</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="comment">// Possibly flag the element for coarsening ...</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">if</span> (elem_error &lt;= coarsen_cutoff)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">// ... or refinement</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> ((elem_error &gt;= refine_cutoff) &amp;&amp; (elem-&gt;level() &lt; <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a>))</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a04e98b91b8eb9b6ddcf0dff673a1a281"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">libMesh::MeshRefinement::_coarsen_fraction</a></div><div class="ttdeci">Real _coarsen_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00759">mesh_refinement.h:759</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af56d90ecbcb73303903c0e298eea13ec"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">libMesh::MeshRefinement::_refine_fraction</a></div><div class="ttdeci">Real _refine_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00757">mesh_refinement.h:757</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a80ebcf25e84315a95e59128b57c5834f"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">libMesh::MeshRefinement::_max_h_level</a></div><div class="ttdeci">unsigned int _max_h_level</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00761">mesh_refinement.h:761</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00245">libmesh.h:245</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00202">libmesh_common.h:202</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a700c8faeb937a543ced5e3979ab06033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a700c8faeb937a543ced5e3979ab06033">&#9670;&nbsp;</a></span>flag_elements_by_nelem_target()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::flag_elements_by_nelem_target </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flags elements for coarsening and refinement based on the computed error passed in <code>error_per_cell</code>. This method attempts to produce a mesh with slightly more than <code>nelem_target</code> active elements, trading element refinement for element coarsening when their error ratios exceed <code>coarsen_threshold</code>. It flags no more than <code>refine_fraction</code> * n_elem elements for refinement and flags no more than <code>coarsen_fraction</code> * n_elem elements for coarsening.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if it has done all the AMR/C it can do in a single step, or false if further adaptive steps may be required to produce a mesh with a narrow error distribution and the right number of elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">229</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00755">_coarsen_by_parents</a>, <a class="el" href="mesh__refinement_8h_source.html#l00759">_coarsen_fraction</a>, <a class="el" href="mesh__refinement_8h_source.html#l00763">_coarsen_threshold</a>, <a class="el" href="mesh__refinement_8h_source.html#l00761">_max_h_level</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00765">_nelem_target</a>, <a class="el" href="mesh__refinement_8h_source.html#l00757">_refine_fraction</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="parallel__implementation_8h_source.html#l02746">libMesh::Parallel::Communicator::allgather()</a>, <a class="el" href="elem_8h_source.html#l01779">libMesh::Elem::child_ref_range()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00662">clean_refinement_flags()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00219">create_parent_error_vector()</a>, <a class="el" href="elem_8h_source.html#l02428">libMesh::Elem::has_children()</a>, <a class="el" href="elem_8h_source.html#l02521">libMesh::Elem::level()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a807e5541b5e0608c8847daf6f3ffc1cf">libMesh::MeshBase::max_elem_id()</a>, <a class="el" href="mesh__base_8C_source.html#l00126">libMesh::MeshBase::mesh_dimension()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00029">std::min()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">libMesh::MeshBase::n_active_elem()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a61954736112b225cf323b93f57cd70ed">libMesh::MeshBase::query_elem_ptr()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="remote__elem_8C_source.html#l00057">libMesh::remote_elem</a>, and <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// Check for valid fractions..</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// The fraction values must be in [0,1]</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 0);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>, 1);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  libmesh_assert_greater_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 0);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  libmesh_assert_less_equal (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a>, 1);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// This function is currently only coded to work when coarsening by</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// parents - it&#39;s too hard to guess how many coarsenings will be</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// performed otherwise.</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  libmesh_assert (<a class="code" href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">_coarsen_by_parents</a>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// The number of active elements in the mesh - hopefully less than</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// 2 billion on 32 bit machines</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_active_elem  = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">n_active_elem</a>();</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">// The maximum number of active elements to flag for coarsening</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> max_elem_coarsen =</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">_coarsen_fraction</a> * n_active_elem) + 1;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// The maximum number of elements to flag for refinement</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> max_elem_refine  =</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>  * n_active_elem) + 1;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// Clean up the refinement flags.  These could be left</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// over from previous refinement steps.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">clean_refinement_flags</a>();</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// The target number of elements to add or remove</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keyword">const</span> std::ptrdiff_t n_elem_new =</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    std::ptrdiff_t(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a7ac4703621b5298120f5028c99bd94de">_nelem_target</a>) - std::ptrdiff_t(n_active_elem);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Create an vector with active element errors and ids,</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// sorted by highest errors first</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> max_elem_id = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a807e5541b5e0608c8847daf6f3ffc1cf">max_elem_id</a>();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  std::vector&lt;std::pair&lt;ErrorVectorReal, dof_id_type&gt;&gt; sorted_error;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  sorted_error.reserve (n_active_elem);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// On a DistributedMesh, we need to communicate to know which remote ids</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// correspond to active elements.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    std::vector&lt;bool&gt; is_active(max_elem_id, <span class="keyword">false</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> eid = elem-&gt;id();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        is_active[eid] = <span class="keyword">true</span>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        libmesh_assert_less (eid, error_per_cell.size());</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        sorted_error.push_back</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          (std::make_pair(error_per_cell[eid], eid));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(is_active);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a9784f116118938b9260753a6b4b9fc3f">allgather</a>(sorted_error);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// Default sort works since pairs are sorted lexicographically</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  std::sort (sorted_error.begin(), sorted_error.end());</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  std::reverse (sorted_error.begin(), sorted_error.end());</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// Create a sorted error vector with coarsenable parent elements</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// only, sorted by lowest errors first</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  ErrorVector error_per_parent;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  std::vector&lt;std::pair&lt;ErrorVectorReal, dof_id_type&gt;&gt; sorted_parent_error;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> parent_error_min, parent_error_max;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">create_parent_error_vector</a>(error_per_cell,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                             error_per_parent,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                             parent_error_min,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                             parent_error_max);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// create_parent_error_vector sets values for non-parents and</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// non-coarsenable parents to -1.  Get rid of them.</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">for</span> (std::size_t i=0; i != error_per_parent.size(); ++i)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> (error_per_parent[i] != -1)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      sorted_parent_error.push_back(std::make_pair(error_per_parent[i], i));</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  std::sort (sorted_parent_error.begin(), sorted_parent_error.end());</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// Keep track of how many elements we plan to coarsen &amp; refine</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> coarsen_count = 0;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> refine_count = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a169bc3297f1070065f9380ff54eb0400">mesh_dimension</a>();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> twotodim = 1;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i!=dim; ++i)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    twotodim *= 2;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// First, let&#39;s try to get our element count to target_nelem</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (n_elem_new &gt;= 0)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="comment">// Every element refinement creates at least</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// 2^dim-1 new elements</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      refine_count =</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="namespacestd.html#a4444b32c7044d9b34125eaebd070a0e3">std::min</a>(cast_int&lt;dof_id_type&gt;(n_elem_new / (twotodim-1)),</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                 max_elem_refine);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">// Every successful element coarsening is likely to destroy</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="comment">// 2^dim-1 net elements.</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      coarsen_count =</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="namespacestd.html#a4444b32c7044d9b34125eaebd070a0e3">std::min</a>(cast_int&lt;dof_id_type&gt;(-n_elem_new / (twotodim-1)),</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                 max_elem_coarsen);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// Next, let&#39;s see if we can trade any refinement for coarsening</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">while</span> (coarsen_count &lt; max_elem_coarsen &amp;&amp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         refine_count &lt; max_elem_refine &amp;&amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;         coarsen_count &lt; sorted_parent_error.size() &amp;&amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         refine_count &lt; sorted_error.size() &amp;&amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         sorted_error[refine_count].first &gt;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         sorted_parent_error[coarsen_count].first * <a class="code" href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">_coarsen_threshold</a>)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      coarsen_count++;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      refine_count++;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// On a DistributedMesh, we need to communicate to know which remote ids</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// correspond to refinable elements</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> successful_refine_count = 0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    std::vector&lt;bool&gt; is_refinable(max_elem_id, <span class="keyword">false</span>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span> (std::size_t i=0; i != sorted_error.size(); ++i)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> eid = sorted_error[i].second;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        Elem * elem = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61954736112b225cf323b93f57cd70ed">query_elem_ptr</a>(eid);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span> (elem &amp;&amp; elem-&gt;level() &lt; <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a>)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          is_refinable[eid] = <span class="keyword">true</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(is_refinable);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (refine_count &gt; max_elem_refine)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      refine_count = max_elem_refine;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">for</span> (std::size_t i=0; i != sorted_error.size(); ++i)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (successful_refine_count &gt;= refine_count)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> eid = sorted_error[i].second;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        Elem * elem = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61954736112b225cf323b93f57cd70ed">query_elem_ptr</a>(eid);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">if</span> (is_refinable[eid])</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">if</span> (elem)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;              elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">set_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            successful_refine_count++;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// If we couldn&#39;t refine enough elements, don&#39;t coarsen too many</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// either</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">if</span> (coarsen_count &lt; (refine_count - successful_refine_count))</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    coarsen_count = 0;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    coarsen_count -= (refine_count - successful_refine_count);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> (coarsen_count &gt; max_elem_coarsen)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    coarsen_count = max_elem_coarsen;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> successful_coarsen_count = 0;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span> (coarsen_count)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i != sorted_parent_error.size(); ++i)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <span class="keywordflow">if</span> (successful_coarsen_count &gt;= coarsen_count * twotodim)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> parent_id = sorted_parent_error[i].second;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          Elem * parent = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61954736112b225cf323b93f57cd70ed">query_elem_ptr</a>(parent_id);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <span class="comment">// On a DistributedMesh we skip remote elements</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="keywordflow">if</span> (!parent)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          libmesh_assert(parent-&gt;has_children());</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : parent-&gt;child_ref_range())</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;              <span class="keywordflow">if</span> (&amp;elem != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                  libmesh_assert(elem.active());</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                  elem.<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">set_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                  successful_coarsen_count++;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// Return true if we&#39;ve done all the AMR/C we can</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">if</span> (!successful_coarsen_count &amp;&amp;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      !successful_refine_count)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// And false if there may still be more to do.</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a04e98b91b8eb9b6ddcf0dff673a1a281"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a04e98b91b8eb9b6ddcf0dff673a1a281">libMesh::MeshRefinement::_coarsen_fraction</a></div><div class="ttdeci">Real _coarsen_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00759">mesh_refinement.h:759</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae5b70f8be225d006fb25ef1e6b82bc3a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae5b70f8be225d006fb25ef1e6b82bc3a">libMesh::MeshBase::n_active_elem</a></div><div class="ttdeci">virtual dof_id_type n_active_elem() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af56d90ecbcb73303903c0e298eea13ec"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">libMesh::MeshRefinement::_refine_fraction</a></div><div class="ttdeci">Real _refine_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00757">mesh_refinement.h:757</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a80ebcf25e84315a95e59128b57c5834f"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">libMesh::MeshRefinement::_max_h_level</a></div><div class="ttdeci">unsigned int _max_h_level</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00761">mesh_refinement.h:761</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a9784f116118938b9260753a6b4b9fc3f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a9784f116118938b9260753a6b4b9fc3f">libMesh::Parallel::Communicator::allgather</a></div><div class="ttdeci">void allgather(const T &amp;send, std::vector&lt; T, A &gt; &amp;recv) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l02746">parallel_implementation.h:2746</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_adb60ffafaf6ebf931978c9335d278b46"><div class="ttname"><a href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">libMesh::Elem::set_refinement_flag</a></div><div class="ttdeci">void set_refinement_flag(const RefinementState rflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02646">elem.h:2646</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6930cd279030a81ff6d36a40809b1fd8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">libMesh::MeshRefinement::clean_refinement_flags</a></div><div class="ttdeci">void clean_refinement_flags()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__flagging_8C_source.html#l00662">mesh_refinement_flagging.C:662</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac25b931ac102cee61e84fac044bdbf0a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac25b931ac102cee61e84fac044bdbf0a">libMesh::MeshRefinement::create_parent_error_vector</a></div><div class="ttdeci">void create_parent_error_vector(const ErrorVector &amp;error_per_cell, ErrorVector &amp;error_per_parent, Real &amp;parent_error_min, Real &amp;parent_error_max)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00219">mesh_refinement.C:219</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a807e5541b5e0608c8847daf6f3ffc1cf"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a807e5541b5e0608c8847daf6f3ffc1cf">libMesh::MeshBase::max_elem_id</a></div><div class="ttdeci">virtual dof_id_type max_elem_id() const =0</div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a61954736112b225cf323b93f57cd70ed"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a61954736112b225cf323b93f57cd70ed">libMesh::MeshBase::query_elem_ptr</a></div><div class="ttdeci">virtual const Elem * query_elem_ptr(const dof_id_type i) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a169bc3297f1070065f9380ff54eb0400"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a169bc3297f1070065f9380ff54eb0400">libMesh::MeshBase::mesh_dimension</a></div><div class="ttdeci">unsigned int mesh_dimension() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00126">mesh_base.C:126</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_aef4c09ce1e49edffc4b7f196d4b91b8a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#aef4c09ce1e49edffc4b7f196d4b91b8a">libMesh::MeshRefinement::_coarsen_threshold</a></div><div class="ttdeci">Real _coarsen_threshold</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00763">mesh_refinement.h:763</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a7ac4703621b5298120f5028c99bd94de"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a7ac4703621b5298120f5028c99bd94de">libMesh::MeshRefinement::_nelem_target</a></div><div class="ttdeci">dof_id_type _nelem_target</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00765">mesh_refinement.h:765</a></div></div>
<div class="ttc" id="namespacestd_html_a4444b32c7044d9b34125eaebd070a0e3"><div class="ttname"><a href="namespacestd.html#a4444b32c7044d9b34125eaebd070a0e3">std::min</a></div><div class="ttdeci">long double min(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00029">libmesh_augment_std_namespace.h:29</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ab6fda707e1285340135e56469b055746"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ab6fda707e1285340135e56469b055746">libMesh::MeshRefinement::_coarsen_by_parents</a></div><div class="ttdeci">bool _coarsen_by_parents</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00755">mesh_refinement.h:755</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a903992f631b52b5ba05ad96a51e7b383"><div class="ttname"><a href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">libMesh::remote_elem</a></div><div class="ttdeci">const RemoteElem * remote_elem</div><div class="ttdef"><b>Definition:</b> <a href="remote__elem_8C_source.html#l00057">remote_elem.C:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a599fc777ab63147d13cb552a0ecde8a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a599fc777ab63147d13cb552a0ecde8a8">&#9670;&nbsp;</a></span>get_enforce_mismatch_limit_prior_to_refinement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::get_enforce_mismatch_limit_prior_to_refinement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The value of the <code>_enforce_mismatch_limit_prior_to_refinement</code> flag, false by default.</dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000037">Deprecated:</a></b></dt><dd>Use <a class="el" href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">enforce_mismatch_limit_prior_to_refinement()</a> instead. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00938">938</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00951">enforce_mismatch_limit_prior_to_refinement()</a>.</p>
<div class="fragment"><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;{</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  libmesh_deprecated();</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">enforce_mismatch_limit_prior_to_refinement</a>();</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4e18ee522c67a8eb52dd58f6374686d2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">libMesh::MeshRefinement::enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool &amp; enforce_mismatch_limit_prior_to_refinement()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00951">mesh_refinement.h:951</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2914437c9011c3a88ec7ebc6e7d8562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2914437c9011c3a88ec7ebc6e7d8562">&#9670;&nbsp;</a></span>get_mesh() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a>&amp; libMesh::MeshRefinement::get_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A constant reference to the <code><a class="el" href="classlibMesh_1_1MeshBase.html" title="Base class for Mesh. ">MeshBase</a></code> object associated with this object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00324">324</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>; }</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5fca6c48816c0221eea5c120571649f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5fca6c48816c0221eea5c120571649f">&#9670;&nbsp;</a></span>get_mesh() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a>&amp; libMesh::MeshRefinement::get_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A writable reference to the <code><a class="el" href="classlibMesh_1_1MeshBase.html" title="Base class for Mesh. ">MeshBase</a></code> object associated with this object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00330">330</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>.</p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>; }</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2ced3c8ba705a7e3b7b48c6721f7062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2ced3c8ba705a7e3b7b48c6721f7062">&#9670;&nbsp;</a></span>has_topological_neighbor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::has_topological_neighbor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PointLocatorBase.html">PointLocatorBase</a> *&#160;</td>
          <td class="paramname"><em>point_locator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Local dispatch function for checking the correct has_neighbor function from the <a class="el" href="classlibMesh_1_1Elem.html" title="The base class for all geometric element types. ">Elem</a> class </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01805">1805</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00861">_periodic_boundaries</a>, <a class="el" href="elem_8h_source.html#l02093">libMesh::Elem::has_neighbor()</a>, and <a class="el" href="elem_8C_source.html#l00957">libMesh::Elem::has_topological_neighbor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>.</p>
<div class="fragment"><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;{</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a> &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>-&gt;empty())</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      libmesh_assert(point_locator);</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="keywordflow">return</span> elem-&gt;has_topological_neighbor(neighbor, <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>, *point_locator, <a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keywordflow">return</span> elem-&gt;has_neighbor(neighbor);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a47a409d8f3852a859271fafc5b466bb8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">libMesh::MeshRefinement::_periodic_boundaries</a></div><div class="ttdeci">PeriodicBoundaries * _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00861">mesh_refinement.h:861</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6726f2900feee33e74f571aa31a9d545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6726f2900feee33e74f571aa31a9d545">&#9670;&nbsp;</a></span>limit_level_mismatch_at_edge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::limit_level_mismatch_at_edge </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_mismatch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00126">126</a> of file <a class="el" href="mesh__refinement__smoothing_8C_source.html">mesh_refinement_smoothing.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00844">_enforce_mismatch_limit_prior_to_refinement</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00855">EDGE</a>, <a class="el" href="mesh__refinement_8h_source.html#l00951">enforce_mismatch_limit_prior_to_refinement()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="elem_8h_source.html#l02479">libMesh::Elem::parent()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, and <a class="el" href="variant__filter__iterator_8h_source.html#l00478">swap()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">bool</span> flags_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// Maps holding the maximum element level that touches an edge</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  std::map&lt;std::pair&lt;unsigned int, unsigned int&gt;, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>&gt;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    max_level_at_edge;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  std::map&lt;std::pair&lt;unsigned int, unsigned int&gt;, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>&gt;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    max_p_level_at_edge;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// Loop over all the active elements &amp; fill the maps</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elem_level =</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        cast_int&lt;unsigned char&gt;(elem-&gt;level() +</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                ((elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elem_p_level =</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        cast_int&lt;unsigned char&gt;(elem-&gt;p_level() +</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                ((elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// Set the max_level at each edge</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;elem-&gt;n_edges(); n++)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          std::unique_ptr&lt;const Elem&gt; edge = elem-&gt;build_edge_ptr(n);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> childnode0 = edge-&gt;node_id(0);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> childnode1 = edge-&gt;node_id(1);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordflow">if</span> (childnode1 &lt; childnode0)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="variant__filter__iterator_8h.html#a8e84acf9c8e70b7fa0b00795c4209f19">std::swap</a>(childnode0, childnode1);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> Elem * p = elem; p != <span class="keyword">nullptr</span>; p = p-&gt;parent())</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;              std::unique_ptr&lt;const Elem&gt; pedge = p-&gt;build_edge_ptr(n);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> node0 = pedge-&gt;node_id(0);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> node1 = pedge-&gt;node_id(1);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;              <span class="keywordflow">if</span> (node1 &lt; node0)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <a class="code" href="variant__filter__iterator_8h.html#a8e84acf9c8e70b7fa0b00795c4209f19">std::swap</a>(node0, node1);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;              <span class="comment">// If elem does not share this edge with its ancestor</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;              <span class="comment">// p, refinement levels of elements sharing p&#39;s edge</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;              <span class="comment">// are not restricted by refinement levels of elem.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;              <span class="comment">// Furthermore, elem will not share this edge with any</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              <span class="comment">// of p&#39;s ancestors, so we can safely break out of the</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;              <span class="comment">// for loop early.</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;              <span class="keywordflow">if</span> (node0 != childnode0 &amp;&amp; node1 != childnode1)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;              childnode0 = node0;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;              childnode1 = node1;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;              std::pair&lt;unsigned int, unsigned int&gt; edge_key =</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                std::make_pair(node0, node1);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              <span class="keywordflow">if</span> (max_level_at_edge.find(edge_key) ==</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                  max_level_at_edge.end())</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  max_level_at_edge[edge_key] = elem_level;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  max_p_level_at_edge[edge_key] = elem_p_level;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                  max_level_at_edge[edge_key] =</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a> (max_level_at_edge[edge_key], elem_level);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                  max_p_level_at_edge[edge_key] =</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a> (max_p_level_at_edge[edge_key], elem_p_level);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Now loop over the active elements and flag the elements</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// who violate the requested level mismatch</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_level = elem-&gt;level();</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_p_level = elem-&gt;p_level();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="comment">// Skip the element if it is already fully flagged</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> &amp;&amp;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">_enforce_mismatch_limit_prior_to_refinement</a>)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">// Loop over the nodes, check for possible mismatch</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;elem-&gt;n_edges(); n++)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          std::unique_ptr&lt;Elem&gt; edge = elem-&gt;build_edge_ptr(n);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> node0 = edge-&gt;node_id(0);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> node1 = edge-&gt;node_id(1);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="keywordflow">if</span> (node1 &lt; node0)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <a class="code" href="variant__filter__iterator_8h.html#a8e84acf9c8e70b7fa0b00795c4209f19">std::swap</a>(node0, node1);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          std::pair&lt;dof_id_type, dof_id_type&gt; edge_key =</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            std::make_pair(node0, node1);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="comment">// Flag the element for refinement if it violates</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          <span class="comment">// the requested level mismatch</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <span class="keywordflow">if</span> ((elem_level + max_mismatch) &lt; max_level_at_edge[edge_key]</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;              &amp;&amp; elem-&gt;refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              elem-&gt;set_refinement_flag (<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;              flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          <span class="keywordflow">if</span> ((elem_p_level + max_mismatch) &lt; max_p_level_at_edge[edge_key]</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;              &amp;&amp; elem-&gt;p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;              elem-&gt;set_p_refinement_flag (<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;              flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          <span class="comment">// Possibly enforce limit mismatch prior to refinement</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          flags_changed |= this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">enforce_mismatch_limit_prior_to_refinement</a>(elem, <a class="code" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea">EDGE</a>, max_mismatch);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        } <span class="comment">// loop over edges</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    } <span class="comment">// loop over active elements</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// If flags changed on any processor then they changed globally</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(flags_changed);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">return</span> flags_changed;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4e18ee522c67a8eb52dd58f6374686d2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">libMesh::MeshRefinement::enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool &amp; enforce_mismatch_limit_prior_to_refinement()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00951">mesh_refinement.h:951</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a71e64e1185f1f02fc14c66deee513bea">libMesh::MeshRefinement::EDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00855">mesh_refinement.h:855</a></div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a380986d25467e922fc62f0f6f0f33d48"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">libMesh::MeshRefinement::_enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool _enforce_mismatch_limit_prior_to_refinement</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00844">mesh_refinement.h:844</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a8e84acf9c8e70b7fa0b00795c4209f19"><div class="ttname"><a href="variant__filter__iterator_8h.html#a8e84acf9c8e70b7fa0b00795c4209f19">swap</a></div><div class="ttdeci">void swap(Iterator &amp;lhs, Iterator &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00478">variant_filter_iterator.h:478</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbc5744304854c3ce239abced653624e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc5744304854c3ce239abced653624e">&#9670;&nbsp;</a></span>limit_level_mismatch_at_node()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::limit_level_mismatch_at_node </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_mismatch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This algorithm restricts the maximum level mismatch at any node in the mesh. Calling this with <code>max_mismatch</code> equal to 1 would transform this mesh: </p><pre class="fragment">* o---o---o---o---o-------o-------o
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o       |       |
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o-------o-------o
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o       |       |
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o-------o-------o
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* o-------o-------o               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* o-------o-------o---------------o
* </pre><p>into this:</p>
<pre class="fragment">* o---o---o---o---o-------o-------o
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o       |       |
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o-------o-------o
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o       |       |
* |   |   |   |   |       |       |
* |   |   |   |   |       |       |
* o---o---o---o---o-------o-------o
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* o-------o-------o.......o.......o
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* o-------o-------o-------o-------o
* </pre><p> by refining the indicated element </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">39</a> of file <a class="el" href="mesh__refinement__smoothing_8C_source.html">mesh_refinement_smoothing.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00844">_enforce_mismatch_limit_prior_to_refinement</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00951">enforce_mismatch_limit_prior_to_refinement()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5b76b109bc6bd087c981774897aa6167">libMesh::MeshBase::n_nodes()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00855">POINT</a>, and <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">bool</span> flags_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// Vector holding the maximum element level that touches a node.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  std::vector&lt;unsigned char&gt; max_level_at_node (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b76b109bc6bd087c981774897aa6167">n_nodes</a>(), 0);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  std::vector&lt;unsigned char&gt; max_p_level_at_node (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b76b109bc6bd087c981774897aa6167">n_nodes</a>(), 0);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// Loop over all the active elements &amp; fill the vector</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elem_level =</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        cast_int&lt;unsigned char&gt;(elem-&gt;level() +</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                ((elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elem_p_level =</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        cast_int&lt;unsigned char&gt;(elem-&gt;p_level() +</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                ((elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">// Set the max_level at each node</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;elem-&gt;n_nodes(); n++)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> node_number = elem-&gt;node_id(n);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          libmesh_assert_less (node_number, max_level_at_node.size());</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          max_level_at_node[node_number] =</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a> (max_level_at_node[node_number], elem_level);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          max_p_level_at_node[node_number] =</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a> (max_p_level_at_node[node_number], elem_p_level);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// Now loop over the active elements and flag the elements</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// who violate the requested level mismatch. Alternatively, if</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// _enforce_mismatch_limit_prior_to_refinement is true, swap refinement flags</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// accordingly.</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_level = elem-&gt;level();</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_p_level = elem-&gt;p_level();</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">// Skip the element if it is already fully flagged</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">// unless we are enforcing mismatch prior to refinement and may need to</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="comment">// remove the refinement flag(s)</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> &amp;&amp;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">_enforce_mismatch_limit_prior_to_refinement</a>)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">// Loop over the nodes, check for possible mismatch</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;elem-&gt;n_nodes(); n++)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> node_number = elem-&gt;node_id(n);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <span class="comment">// Flag the element for refinement if it violates</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <span class="comment">// the requested level mismatch</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          <span class="keywordflow">if</span> ((elem_level + max_mismatch) &lt; max_level_at_node[node_number]</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;              &amp;&amp; elem-&gt;refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;              elem-&gt;set_refinement_flag (<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;              flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          <span class="keywordflow">if</span> ((elem_p_level + max_mismatch) &lt; max_p_level_at_node[node_number]</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;              &amp;&amp; elem-&gt;p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;              elem-&gt;set_p_refinement_flag (<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;              flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <span class="comment">// Possibly enforce limit mismatch prior to refinement</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          flags_changed |= this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">enforce_mismatch_limit_prior_to_refinement</a>(elem, <a class="code" href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36">POINT</a>, max_mismatch);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// If flags changed on any processor then they changed globally</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(flags_changed);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">return</span> flags_changed;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4e18ee522c67a8eb52dd58f6374686d2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">libMesh::MeshRefinement::enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool &amp; enforce_mismatch_limit_prior_to_refinement()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00951">mesh_refinement.h:951</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a3b5e2d673faf6f8d4db8b2da3e1f8824a39cf91b9450138e4d0a036a35d0b9a36">libMesh::MeshRefinement::POINT</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00855">mesh_refinement.h:855</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a380986d25467e922fc62f0f6f0f33d48"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a380986d25467e922fc62f0f6f0f33d48">libMesh::MeshRefinement::_enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool _enforce_mismatch_limit_prior_to_refinement</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00844">mesh_refinement.h:844</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5b76b109bc6bd087c981774897aa6167"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5b76b109bc6bd087c981774897aa6167">libMesh::MeshBase::n_nodes</a></div><div class="ttdeci">virtual dof_id_type n_nodes() const =0</div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d051c8d27a2abc3ab879f2f982bbcb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d051c8d27a2abc3ab879f2f982bbcb0">&#9670;&nbsp;</a></span>limit_overrefined_boundary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::limit_overrefined_boundary </td>
          <td>(</td>
          <td class="paramtype">const signed char&#160;</td>
          <td class="paramname"><em>max_mismatch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00255">255</a> of file <a class="el" href="mesh__refinement__smoothing_8C_source.html">mesh_refinement_smoothing.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l02521">libMesh::Elem::level()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="elem_8h_source.html#l02654">libMesh::Elem::p_refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02662">libMesh::Elem::set_p_refinement_flag()</a>, and <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordtype">bool</span> flags_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// Loop over all the active elements &amp; look for mismatches to fix.</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">// If we don&#39;t have an interior_parent then there&#39;s nothing to</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="comment">// be mismatched with.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span> ((elem-&gt;dim() &gt;= LIBMESH_DIM) ||</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          !elem-&gt;interior_parent())</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elem_level =</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        cast_int&lt;unsigned char&gt;(elem-&gt;level() +</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                ((elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> elem_p_level =</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        cast_int&lt;unsigned char&gt;(elem-&gt;p_level() +</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                ((elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// get all relevant interior elements</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      std::set&lt;const Elem *&gt; neighbor_set;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      elem-&gt;find_interior_neighbors(neighbor_set);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      std::set&lt;const Elem *&gt;::iterator n_it = neighbor_set.begin();</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">for</span> (; n_it != neighbor_set.end(); ++n_it)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="comment">// FIXME - non-const versions of the Elem set methods</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          <span class="comment">// would be nice</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          Elem * neighbor = <span class="keyword">const_cast&lt;</span>Elem *<span class="keyword">&gt;</span>(*n_it);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="keywordflow">if</span> (max_mismatch &gt;= 0)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;              <span class="keywordflow">if</span> ((elem_level &gt; neighbor-&gt;level() + max_mismatch) &amp;&amp;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                  (neighbor-&gt;refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>))</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                  neighbor-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                  flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;              <span class="keywordflow">if</span> ((elem_p_level &gt; neighbor-&gt;p_level() + max_mismatch) &amp;&amp;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                  (neighbor-&gt;p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>))</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                  neighbor-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                  flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        } <span class="comment">// loop over interior neighbors</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// If flags changed on any processor then they changed globally</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(flags_changed);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">return</span> flags_changed;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2eef84fcf5c69894597662b16b8cf373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eef84fcf5c69894597662b16b8cf373">&#9670;&nbsp;</a></span>limit_underrefined_boundary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::limit_underrefined_boundary </td>
          <td>(</td>
          <td class="paramtype">const signed char&#160;</td>
          <td class="paramname"><em>max_mismatch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00316">316</a> of file <a class="el" href="mesh__refinement__smoothing_8C_source.html">mesh_refinement_smoothing.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l02521">libMesh::Elem::level()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="elem_8h_source.html#l02654">libMesh::Elem::p_refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, and <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordtype">bool</span> flags_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// Loop over all the active elements &amp; look for mismatches to fix.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="comment">// If we don&#39;t have an interior_parent then there&#39;s nothing to</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// be mismatched with.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">if</span> ((elem-&gt;dim() &gt;= LIBMESH_DIM) ||</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          !elem-&gt;interior_parent())</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">// get all relevant interior elements</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      std::set&lt;const Elem *&gt; neighbor_set;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      elem-&gt;find_interior_neighbors(neighbor_set);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      std::set&lt;const Elem *&gt;::iterator n_it = neighbor_set.begin();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">for</span> (; n_it != neighbor_set.end(); ++n_it)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <span class="comment">// FIXME - non-const versions of the Elem set methods</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <span class="comment">// would be nice</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          <span class="keyword">const</span> Elem * neighbor = *n_it;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> neighbor_level =</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            cast_int&lt;unsigned char&gt;(neighbor-&gt;level() +</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                    ((neighbor-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> neighbor_p_level =</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            cast_int&lt;unsigned char&gt;(neighbor-&gt;p_level() +</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                    ((neighbor-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>) ? 1 : 0));</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          <span class="keywordflow">if</span> (max_mismatch &gt;= 0)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              <span class="keywordflow">if</span> ((neighbor_level &gt;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                   elem-&gt;level() + max_mismatch) &amp;&amp;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                  (elem-&gt;refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>))</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                  elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                  flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;              <span class="keywordflow">if</span> ((neighbor_p_level &gt;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                   elem-&gt;p_level() + max_mismatch) &amp;&amp;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                  (elem-&gt;p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>))</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                  elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                  flags_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        } <span class="comment">// loop over interior neighbors</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// If flags changed on any processor then they changed globally</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(flags_changed);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">return</span> flags_changed;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ae7cec33d6f1fe1c28f4cbda2449df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ae7cec33d6f1fe1c28f4cbda2449df1">&#9670;&nbsp;</a></span>make_coarsening_compatible()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::make_coarsening_compatible </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Take user-specified coarsening flags and augment them so that level-one dependency is satisfied.</p>
<p>This function used to take an argument, <code>maintain_level_one</code> - new code should use <a class="el" href="classlibMesh_1_1MeshRefinement.html#a81fa55fe9538fded1391a56952aa1376">face_level_mismatch_limit()</a> instead. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00779">779</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00769">_face_level_mismatch_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00861">_periodic_boundaries</a>, <a class="el" href="elem_8h_source.html#l02390">libMesh::Elem::active()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a49e8bef33dabe0c21c7e81d61e055154">libMesh::MeshBase::ancestor_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a993d03afe0646ec1e9a192808ad2ebd9">libMesh::MeshBase::ancestor_elements_end()</a>, <a class="el" href="communicator_8h_source.html#l00070">libMesh::Parallel::any_source</a>, <a class="el" href="simple__range_8h_source.html#l00057">libMesh::as_range()</a>, <a class="el" href="elem_8h_source.html#l01779">libMesh::Elem::child_ref_range()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="elem_8h_source.html#l01204">libMesh::Elem::COARSEN_INACTIVE</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="mesh__base_8h_source.html#l00504">libMesh::MeshBase::elem_ref()</a>, <a class="el" href="communicator_8C_source.html#l00201">libMesh::Parallel::Communicator::get_unique_tag()</a>, <a class="el" href="elem_8h_source.html#l02428">libMesh::Elem::has_children()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01805">has_topological_neighbor()</a>, <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>, <a class="el" href="mesh__base_8h_source.html#l00176">libMesh::MeshBase::is_replicated()</a>, <a class="el" href="mesh__base_8h_source.html#l00154">libMesh::MeshBase::is_serial()</a>, <a class="el" href="elem_8h_source.html#l02521">libMesh::Elem::level()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a0a4aaa9ec643866aac1330dcd22f33d8">libMesh::MeshBase::level_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a1d98b8c062de7f861f0eca8cc16b9b79">libMesh::MeshBase::level_elements_end()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="namespacelibMesh_1_1MeshTools.html#a57a0ae7fb3cba63f06621d6c701327c8">libMesh::MeshTools::max_level()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min()</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a151e26d7ee601e24a57f4f18a1ddec2e">libMesh::MeshBase::not_local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#aa7ba43cbc4025fc5629dad18485e019d">libMesh::MeshBase::not_local_elements_end()</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="elem_8h_source.html#l02654">libMesh::Elem::p_refinement_flag()</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="dof__object_8h_source.html#l00717">libMesh::DofObject::processor_id()</a>, <a class="el" href="parallel__implementation_8h_source.html#l00771">libMesh::Parallel::Communicator::receive()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, <a class="el" href="remote__elem_8C_source.html#l00057">libMesh::remote_elem</a>, <a class="el" href="parallel__implementation_8h_source.html#l00261">libMesh::Parallel::Communicator::send()</a>, <a class="el" href="elem_8h_source.html#l02662">libMesh::Elem::set_p_refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>, <a class="el" href="mesh__base_8C_source.html#l00496">libMesh::MeshBase::sub_point_locator()</a>, <a class="el" href="parallel__ghost__sync_8h_source.html#l00336">libMesh::Parallel::sync_dofobject_data_by_id()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01789">topological_neighbor()</a>, and <a class="el" href="request_8C_source.html#l00213">libMesh::Parallel::wait()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00607">coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;{</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">// We may need a PointLocator for topological_neighbor() tests</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="comment">// later, which we need to make sure gets constructed on all</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// processors at once.</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  std::unique_ptr&lt;PointLocatorBase&gt; point_locator;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordtype">bool</span> has_periodic_boundaries =</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a> &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>-&gt;empty();</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().verify(has_periodic_boundaries));</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">if</span> (has_periodic_boundaries)</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    point_locator = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">sub_point_locator</a>();</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  LOG_SCOPE (<span class="stringliteral">&quot;make_coarsening_compatible()&quot;</span>, <span class="stringliteral">&quot;MeshRefinement&quot;</span>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="comment">// Unless we encounter a specific situation level-one</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">// will be satisfied after executing this loop just once</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordtype">bool</span> level_one_satisfied = <span class="keyword">true</span>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">// Unless we encounter a specific situation we will be compatible</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// with any selected refinement flags</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordtype">bool</span> compatible_with_refinement = <span class="keyword">true</span>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="comment">// find the maximum h and p levels in the mesh</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacelibMesh_1_1MeshTools.html#a57a0ae7fb3cba63f06621d6c701327c8">max_level</a> = 0;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_p_level = 0;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">// First we look at all the active level-0 elements.  Since it doesn&#39;t make</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">// sense to coarsen them we must un-set their coarsen flags if</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">// they are set.</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      {</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <a class="code" href="namespacelibMesh_1_1MeshTools.html#a57a0ae7fb3cba63f06621d6c701327c8">max_level</a> = <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(<a class="code" href="namespacelibMesh_1_1MeshTools.html#a57a0ae7fb3cba63f06621d6c701327c8">max_level</a>, elem-&gt;level());</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        max_p_level =</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;          <a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a>(max_p_level,</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                   static_cast&lt;unsigned int&gt;(elem-&gt;p_level()));</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">if</span> ((elem-&gt;level() == 0) &amp;&amp;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>))</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">if</span> ((elem-&gt;p_level() == 0) &amp;&amp;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>))</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      }</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// Even if there are no refined elements on this processor then</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// there may still be work for us to do on e.g. ancestor elements.</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// At the very least we need to be in the loop if a distributed mesh</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// needs to synchronize data.</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh_1_1MeshTools.html#a57a0ae7fb3cba63f06621d6c701327c8">max_level</a> == 0 &amp;&amp; max_p_level == 0)</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    {</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="comment">// But we still have to check with other processors</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">min</a>(compatible_with_refinement);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">return</span> compatible_with_refinement;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">// Loop over all the active elements.  If an element is marked</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="comment">// for coarsening we better check its neighbors.  If ANY of these neighbors</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// are marked for refinement AND are at the same level then there is a</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// conflict.  By convention refinement wins, so we un-mark the element for</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// coarsening.  Level-one would be violated in this case so we need to re-run</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// the loop.</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    repeat:</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      level_one_satisfied = <span class="keyword">true</span>;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          level_one_satisfied = <span class="keyword">true</span>;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            {</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;              <span class="keywordtype">bool</span> my_flag_changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>) <span class="comment">// If the element is active and</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <span class="comment">// the coarsen flag is set</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_level = elem-&gt;level();</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;side_index_range())</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                      <span class="keyword">const</span> Elem * neighbor =</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                        <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">topological_neighbor</a>(elem, point_locator.get(), n);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                      <span class="keywordflow">if</span> (neighbor != <span class="keyword">nullptr</span> &amp;&amp;      <span class="comment">// I have a</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                          neighbor != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>) <span class="comment">// neighbor here</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                          <span class="keywordflow">if</span> (neighbor-&gt;active()) <span class="comment">// and it is active</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                            {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                              <span class="keywordflow">if</span> ((neighbor-&gt;level() == my_level) &amp;&amp;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                  (neighbor-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)) <span class="comment">// the neighbor is at my level</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                <span class="comment">// and wants to be refined</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                {</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                                  elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">set_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                  my_flag_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                            }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                          <span class="keywordflow">else</span> <span class="comment">// I have a neighbor and it is not active. That means it has children.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                            {  <span class="comment">// While it _may_ be possible to coarsen us if all the children of</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                              <span class="comment">// that element want to be coarsened, it is impossible to know at this</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                              <span class="comment">// stage.  Forget about it for the moment...  This can be handled in</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                              <span class="comment">// two steps.</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                              elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                              my_flag_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                            }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                        }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                }</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>) <span class="comment">// If</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="comment">// the element is active and the order reduction flag is set</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_p_level = elem-&gt;p_level();</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;side_index_range())</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                      <span class="keyword">const</span> Elem * neighbor =</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">topological_neighbor</a>(elem, point_locator.get(), n);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                      <span class="keywordflow">if</span> (neighbor != <span class="keyword">nullptr</span> &amp;&amp;      <span class="comment">// I have a</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                          neighbor != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>) <span class="comment">// neighbor here</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                          <span class="keywordflow">if</span> (neighbor-&gt;active()) <span class="comment">// and it is active</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                            {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                              <span class="keywordflow">if</span> ((neighbor-&gt;p_level() &gt; my_p_level &amp;&amp;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                   neighbor-&gt;p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                  || (neighbor-&gt;p_level() == my_p_level &amp;&amp;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                      neighbor-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>))</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                  elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a13716b8bb2b92fa2244f6f4f375a0004">set_p_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                  my_flag_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                            }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                          <span class="keywordflow">else</span> <span class="comment">// I have a neighbor and it is not active.</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                            {  <span class="comment">// We need to find which of its children</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                              <span class="comment">// have me as a neighbor, and maintain</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                              <span class="comment">// level one p compatibility with them.</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                              <span class="comment">// Because we currently have level one h</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                              <span class="comment">// compatibility, we don&#39;t need to check</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                              <span class="comment">// grandchildren</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                              libmesh_assert(neighbor-&gt;has_children());</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; subneighbor : neighbor-&gt;child_ref_range())</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                <span class="keywordflow">if</span> (&amp;subneighbor != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a> &amp;&amp;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                    subneighbor.<a class="code" href="classlibMesh_1_1Elem.html#a1d7452337eaa808b8721664b7961d713">active</a>() &amp;&amp;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                    <a class="code" href="classlibMesh_1_1MeshRefinement.html#ac2ced3c8ba705a7e3b7b48c6721f7062">has_topological_neighbor</a>(&amp;subneighbor, point_locator.get(), elem))</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                  <span class="keywordflow">if</span> ((subneighbor.p_level() &gt; my_p_level &amp;&amp;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                       subneighbor.p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                      || (subneighbor.p_level() == my_p_level &amp;&amp;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                          subneighbor.p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>))</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                    {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                      elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                      my_flag_changed = <span class="keyword">true</span>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                    }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                              <span class="keywordflow">if</span> (my_flag_changed)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                            }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                    }</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;              <span class="comment">// If the current element&#39;s flag changed, we hadn&#39;t</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;              <span class="comment">// satisfied the level one rule.</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;              <span class="keywordflow">if</span> (my_flag_changed)</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;              <span class="comment">// Additionally, if it has non-local neighbors, and</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;              <span class="comment">// we&#39;re not in serial, then we&#39;ll eventually have to</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;              <span class="comment">// return compatible_with_refinement = false, because</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              <span class="comment">// our change has to propagate to neighboring</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;              <span class="comment">// processors.</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;              <span class="keywordflow">if</span> (my_flag_changed &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">is_serial</a>())</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;side_index_range())</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                  {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    Elem * neigh =</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">topological_neighbor</a>(elem, point_locator.get(), n);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    <span class="keywordflow">if</span> (!neigh)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    <span class="keywordflow">if</span> (neigh == <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a> ||</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        neigh-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() !=</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                      {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                        compatible_with_refinement = <span class="keyword">false</span>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                      }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                    <span class="comment">// FIXME - for non-level one meshes we should</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                    <span class="comment">// test all descendants</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    <span class="keywordflow">if</span> (neigh-&gt;has_children())</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; child : neigh-&gt;child_ref_range())</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                        <span class="keywordflow">if</span> (&amp;child == <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a> ||</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                            child.<a class="code" href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">processor_id</a>() !=</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                            this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>())</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                          {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                            compatible_with_refinement = <span class="keyword">false</span>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                          }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                  }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        }</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keywordflow">while</span> (!level_one_satisfied);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    } <span class="comment">// end if (_face_level_mismatch_limit)</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="comment">// Next we look at all of the ancestor cells.</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="comment">// If there is a parent cell with all of its children</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">// wanting to be unrefined then the element is a candidate</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="comment">// for unrefinement.  If all the children don&#39;t</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="comment">// all want to be unrefined then ALL of them need to have their</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="comment">// unrefinement flags cleared.</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> level = <a class="code" href="namespacelibMesh_1_1MeshTools.html#a57a0ae7fb3cba63f06621d6c701327c8">max_level</a>; level &gt;= 0; level--)</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">as_range</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a0a4aaa9ec643866aac1330dcd22f33d8">level_elements_begin</a>(level), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1d98b8c062de7f861f0eca8cc16b9b79">level_elements_end</a>(level)))</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;ancestor())</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <span class="comment">// right now the element hasn&#39;t been disqualified</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <span class="comment">// as a candidate for unrefinement</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          <span class="keywordtype">bool</span> is_a_candidate = <span class="keyword">true</span>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <span class="keywordtype">bool</span> found_remote_child = <span class="keyword">false</span>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; child : elem-&gt;child_ref_range())</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;              <span class="keywordflow">if</span> (&amp;child == <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>)</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                found_remote_child = <span class="keyword">true</span>;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((child.refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>) ||</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                       !child.active() )</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                is_a_candidate = <span class="keyword">false</span>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            }</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;          <span class="keywordflow">if</span> (!is_a_candidate &amp;&amp; !found_remote_child)</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            {</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;              elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">set_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; child : elem-&gt;child_ref_range())</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                {</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                  <span class="keywordflow">if</span> (&amp;child == <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                  <span class="keywordflow">if</span> (child.refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    {</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                      level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                      child.set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        }</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">if</span> (!level_one_satisfied &amp;&amp; <a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>) <span class="keywordflow">goto</span> repeat;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="comment">// If all the children of a parent are set to be coarsened</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="comment">// then flag the parent so that they can kill their kids.</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="comment">// On a distributed mesh, we won&#39;t always be able to determine this</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="comment">// on parent elements with remote children, even if we own the</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="comment">// parent, without communication.</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="comment">// We&#39;ll first communicate *to* parents&#39; owners when we determine</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="comment">// they cannot be coarsened, then we&#39;ll sync the final refinement</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="comment">// flag *from* the parents.</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">// uncoarsenable_parents[p] live on processor id p</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> n_proc     = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>();</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> my_proc_id = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>();</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> distributed_mesh = !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">is_replicated</a>();</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  std::vector&lt;std::vector&lt;dof_id_type&gt;&gt;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    uncoarsenable_parents(n_proc);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">as_range</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a49e8bef33dabe0c21c7e81d61e055154">ancestor_elements_begin</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a993d03afe0646ec1e9a192808ad2ebd9">ancestor_elements_end</a>()))</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="comment">// Presume all the children are flagged for coarsening and</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="comment">// then look for a contradiction</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordtype">bool</span> all_children_flagged_for_coarsening = <span class="keyword">true</span>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; child : elem-&gt;child_ref_range())</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        {</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          <span class="keywordflow">if</span> (&amp;child != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a> &amp;&amp;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;              child.<a class="code" href="classlibMesh_1_1Elem.html#a1960f0611789fe6552d2dd6794778ca5">refinement_flag</a>() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;              all_children_flagged_for_coarsening = <span class="keyword">false</span>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;              <span class="keywordflow">if</span> (!distributed_mesh)</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;              <span class="keywordflow">if</span> (child.processor_id() != elem-&gt;processor_id())</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                  uncoarsenable_parents[elem-&gt;processor_id()].push_back(elem-&gt;id());</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">if</span> (all_children_flagged_for_coarsening)</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="comment">// If we have a distributed mesh, we might need to sync up</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">// INACTIVE vs. COARSEN_INACTIVE flags.</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordflow">if</span> (distributed_mesh)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    {</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="comment">// We&#39;d better still be in sync here</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      parallel_object_only();</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      Parallel::MessageTag</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        uncoarsenable_tag = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">get_unique_tag</a>(2718);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      std::vector&lt;Parallel::Request&gt; uncoarsenable_push_requests(n_proc-1);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p = 0; p != n_proc; ++p)</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          <span class="keywordflow">if</span> (p == my_proc_id)</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;          Parallel::Request &amp;<a class="code" href="namespacelibMesh_1_1Parallel.html#a4cf28cfb3d6fefc535e83fb4b2698276">request</a> =</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            uncoarsenable_push_requests[p - (p &gt; my_proc_id)];</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a9fa78572d83d7756fbe6bc2b2c6337d7">send</a></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            (p, uncoarsenable_parents[p], <a class="code" href="namespacelibMesh_1_1Parallel.html#a4cf28cfb3d6fefc535e83fb4b2698276">request</a>, uncoarsenable_tag);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p = 1; p != n_proc; ++p)</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          std::vector&lt;dof_id_type&gt; my_uncoarsenable_parents;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;          <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a751fba5447d0593802384b58b2136364">receive</a></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            (<a class="code" href="namespacelibMesh_1_1Parallel.html#a981cb1019c5fd951755cf6e00caaa634">Parallel::any_source</a>, my_uncoarsenable_parents,</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;             uncoarsenable_tag);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <span class="keywordtype">id</span> : my_uncoarsenable_parents)</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;              Elem &amp; elem = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a8ef08bc51daf3d70fe7fb780c49bd002">elem_ref</a>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;              libmesh_assert(elem.refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a> ||</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                             elem.refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;              elem.<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">set_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            }</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <a class="code" href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">Parallel::wait</a>(uncoarsenable_push_requests);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      SyncRefinementFlags hsync(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>, &amp;<a class="code" href="classlibMesh_1_1Elem.html#a1960f0611789fe6552d2dd6794778ca5">Elem::refinement_flag</a>,</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                &amp;<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">Elem::set_refinement_flag</a>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">sync_dofobject_data_by_id</a></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a151e26d7ee601e24a57f4f18a1ddec2e">not_local_elements_begin</a>(),</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;         <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#aa7ba43cbc4025fc5629dad18485e019d">not_local_elements_end</a>(),</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;         <span class="comment">// We&#39;d like a smaller sync, but this leads to bugs?</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;         <span class="comment">// SyncCoarsenInactive(),</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;         hsync);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    }</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="comment">// If one processor finds an incompatibility, we&#39;re globally</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="comment">// incompatible</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">min</a>(compatible_with_refinement);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordflow">return</span> compatible_with_refinement;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a1960f0611789fe6552d2dd6794778ca5"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a1960f0611789fe6552d2dd6794778ca5">libMesh::Elem::refinement_flag</a></div><div class="ttdeci">RefinementState refinement_flag() const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02638">elem.h:2638</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a9fa78572d83d7756fbe6bc2b2c6337d7"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a9fa78572d83d7756fbe6bc2b2c6337d7">libMesh::Parallel::Communicator::send</a></div><div class="ttdeci">void send(const unsigned int dest_processor_id, const T &amp;buf, const MessageTag &amp;tag=no_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00261">parallel_implementation.h:261</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a49e8bef33dabe0c21c7e81d61e055154"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a49e8bef33dabe0c21c7e81d61e055154">libMesh::MeshBase::ancestor_elements_begin</a></div><div class="ttdeci">virtual element_iterator ancestor_elements_begin()=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_aea5278a91928fa4f33b74aa0786f3592"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">libMesh::Parallel::wait</a></div><div class="ttdeci">void wait(std::vector&lt; Request &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="request_8C_source.html#l00213">request.C:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_aa7ba43cbc4025fc5629dad18485e019d"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#aa7ba43cbc4025fc5629dad18485e019d">libMesh::MeshBase::not_local_elements_end</a></div><div class="ttdeci">virtual element_iterator not_local_elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ad5bb1bebf75049eb42e511b6ae5f2b7e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">libMesh::MeshBase::sub_point_locator</a></div><div class="ttdeci">std::unique_ptr&lt; PointLocatorBase &gt; sub_point_locator() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00496">mesh_base.C:496</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0a4aaa9ec643866aac1330dcd22f33d8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0a4aaa9ec643866aac1330dcd22f33d8">libMesh::MeshBase::level_elements_begin</a></div><div class="ttdeci">virtual element_iterator level_elements_begin(unsigned int level)=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a981cb1019c5fd951755cf6e00caaa634"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a981cb1019c5fd951755cf6e00caaa634">libMesh::Parallel::any_source</a></div><div class="ttdeci">const unsigned int any_source</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8h_source.html#l00070">communicator.h:70</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ae98cb59b3edcacefe07571dcc0742e91"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min</a></div><div class="ttdeci">void min(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a993d03afe0646ec1e9a192808ad2ebd9"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a993d03afe0646ec1e9a192808ad2ebd9">libMesh::MeshBase::ancestor_elements_end</a></div><div class="ttdeci">virtual element_iterator ancestor_elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a4cf28cfb3d6fefc535e83fb4b2698276"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a4cf28cfb3d6fefc535e83fb4b2698276">libMesh::Parallel::request</a></div><div class="ttdeci">MPI_Request request</div><div class="ttdef"><b>Definition:</b> <a href="request_8h_source.html#l00040">request.h:40</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_adb60ffafaf6ebf931978c9335d278b46"><div class="ttname"><a href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">libMesh::Elem::set_refinement_flag</a></div><div class="ttdeci">void set_refinement_flag(const RefinementState rflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02646">elem.h:2646</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac865c9ea66f0b31884d53f156ce474ad"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">libMesh::Parallel::Communicator::get_unique_tag</a></div><div class="ttdeci">MessageTag get_unique_tag(int tagvalue) const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8C_source.html#l00201">communicator.C:201</a></div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a47a409d8f3852a859271fafc5b466bb8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">libMesh::MeshRefinement::_periodic_boundaries</a></div><div class="ttdeci">PeriodicBoundaries * _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00861">mesh_refinement.h:861</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_a57a0ae7fb3cba63f06621d6c701327c8"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#a57a0ae7fb3cba63f06621d6c701327c8">libMesh::MeshTools::max_level</a></div><div class="ttdeci">unsigned int max_level(const MeshBase &amp;mesh)</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a1d98b8c062de7f861f0eca8cc16b9b79"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a1d98b8c062de7f861f0eca8cc16b9b79">libMesh::MeshBase::level_elements_end</a></div><div class="ttdeci">virtual element_iterator level_elements_end(unsigned int level)=0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a0629d79c85d44523e4e11624aa96cd85"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a0629d79c85d44523e4e11624aa96cd85">libMesh::MeshBase::is_serial</a></div><div class="ttdeci">virtual bool is_serial() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00154">mesh_base.h:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a56f1015a59736175b39e4a1ca4d084bc"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">libMesh::MeshRefinement::_face_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _face_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00769">mesh_refinement.h:769</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a977361a82b7a9e7ad8e50ae1cae40d20"><div class="ttname"><a href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">libMesh::as_range</a></div><div class="ttdeci">SimpleRange&lt; I &gt; as_range(const std::pair&lt; I, I &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="simple__range_8h_source.html#l00057">simple_range.h:57</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">libMesh::Elem::COARSEN_INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01204">elem.h:1204</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_ac7d4f06bb34625465942e6b8d10f135e"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">libMesh::Parallel::sync_dofobject_data_by_id</a></div><div class="ttdeci">void sync_dofobject_data_by_id(const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00336">parallel_ghost_sync.h:336</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac2ced3c8ba705a7e3b7b48c6721f7062"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac2ced3c8ba705a7e3b7b48c6721f7062">libMesh::MeshRefinement::has_topological_neighbor</a></div><div class="ttdeci">bool has_topological_neighbor(const Elem *elem, const PointLocatorBase *point_locator, const Elem *neighbor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01805">mesh_refinement.C:1805</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a1b15de4062298b11df7d8267053d8aee"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">libMesh::MeshBase::is_replicated</a></div><div class="ttdeci">virtual bool is_replicated() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00176">mesh_base.h:176</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a8ef08bc51daf3d70fe7fb780c49bd002"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a8ef08bc51daf3d70fe7fb780c49bd002">libMesh::MeshBase::elem_ref</a></div><div class="ttdeci">virtual const Elem &amp; elem_ref(const dof_id_type i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00504">mesh_base.h:504</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a751fba5447d0593802384b58b2136364"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a751fba5447d0593802384b58b2136364">libMesh::Parallel::Communicator::receive</a></div><div class="ttdeci">Status receive(const unsigned int dest_processor_id, T &amp;buf, const MessageTag &amp;tag=any_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00771">parallel_implementation.h:771</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a13716b8bb2b92fa2244f6f4f375a0004"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a13716b8bb2b92fa2244f6f4f375a0004">libMesh::Elem::set_p_refinement_flag</a></div><div class="ttdeci">void set_p_refinement_flag(const RefinementState pflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02662">elem.h:2662</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a151e26d7ee601e24a57f4f18a1ddec2e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a151e26d7ee601e24a57f4f18a1ddec2e">libMesh::MeshBase::not_local_elements_begin</a></div><div class="ttdeci">virtual element_iterator not_local_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a1d7452337eaa808b8721664b7961d713"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a1d7452337eaa808b8721664b7961d713">libMesh::Elem::active</a></div><div class="ttdeci">bool active() const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02390">elem.h:2390</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a754f2866ec9d8a49a02a68a32e7aa518"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a754f2866ec9d8a49a02a68a32e7aa518">libMesh::DofObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00717">dof_object.h:717</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6afb4f67a92e0d3cebf6cbcd27fc22e3"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">libMesh::MeshRefinement::topological_neighbor</a></div><div class="ttdeci">Elem * topological_neighbor(Elem *elem, const PointLocatorBase *point_locator, const unsigned int side)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01789">mesh_refinement.C:1789</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a903992f631b52b5ba05ad96a51e7b383"><div class="ttname"><a href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">libMesh::remote_elem</a></div><div class="ttdeci">const RemoteElem * remote_elem</div><div class="ttdef"><b>Definition:</b> <a href="remote__elem_8C_source.html#l00057">remote_elem.C:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e925a80a9435e0d2d2a5f6113050043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e925a80a9435e0d2d2a5f6113050043">&#9670;&nbsp;</a></span>make_flags_parallel_consistent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::make_flags_parallel_consistent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy refinement flags on ghost elements from their local processors.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if any flags changed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00751">751</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min()</a>, <a class="el" href="elem_8h_source.html#l02654">libMesh::Elem::p_refinement_flag()</a>, <a class="el" href="sync__refinement__flags_8h_source.html#l00051">libMesh::SyncRefinementFlags::parallel_consistent</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02662">libMesh::Elem::set_p_refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>, and <a class="el" href="parallel__ghost__sync_8h_source.html#l00336">libMesh::Parallel::sync_dofobject_data_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00607">coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00682">refine_elements()</a>, and <a class="el" href="hp__coarsentest_8C_source.html#l00140">libMesh::HPCoarsenTest::select_refinement()</a>.</p>
<div class="fragment"><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;{</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  LOG_SCOPE (<span class="stringliteral">&quot;make_flags_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshRefinement&quot;</span>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  SyncRefinementFlags hsync(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>, &amp;<a class="code" href="classlibMesh_1_1Elem.html#a1960f0611789fe6552d2dd6794778ca5">Elem::refinement_flag</a>,</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                            &amp;<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">Elem::set_refinement_flag</a>);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">Parallel::sync_dofobject_data_by_id</a></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">elements_begin</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">elements_end</a>(), hsync);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  SyncRefinementFlags psync(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>, &amp;<a class="code" href="classlibMesh_1_1Elem.html#aeddcae788b6d6e84b9aab6986b9847e3">Elem::p_refinement_flag</a>,</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                            &amp;<a class="code" href="classlibMesh_1_1Elem.html#a13716b8bb2b92fa2244f6f4f375a0004">Elem::set_p_refinement_flag</a>);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">Parallel::sync_dofobject_data_by_id</a></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">elements_begin</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">elements_end</a>(), psync);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="comment">// If we weren&#39;t consistent in both h and p on every processor then</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="comment">// we weren&#39;t globally consistent</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordtype">bool</span> parallel_consistent = hsync.parallel_consistent &amp;&amp;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    psync.parallel_consistent;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">min</a>(parallel_consistent);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">return</span> parallel_consistent;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a1960f0611789fe6552d2dd6794778ca5"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a1960f0611789fe6552d2dd6794778ca5">libMesh::Elem::refinement_flag</a></div><div class="ttdeci">RefinementState refinement_flag() const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02638">elem.h:2638</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ae98cb59b3edcacefe07571dcc0742e91"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min</a></div><div class="ttdeci">void min(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_aeddcae788b6d6e84b9aab6986b9847e3"><div class="ttname"><a href="classlibMesh_1_1Elem.html#aeddcae788b6d6e84b9aab6986b9847e3">libMesh::Elem::p_refinement_flag</a></div><div class="ttdeci">RefinementState p_refinement_flag() const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02654">elem.h:2654</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_adb60ffafaf6ebf931978c9335d278b46"><div class="ttname"><a href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">libMesh::Elem::set_refinement_flag</a></div><div class="ttdeci">void set_refinement_flag(const RefinementState rflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02646">elem.h:2646</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac266e1f5eb6ac9566ccbd7e6add6c239"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin</a></div><div class="ttdeci">virtual element_iterator elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae94f1bce0dc50c489c6bae9ba64d06e8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end</a></div><div class="ttdeci">virtual element_iterator elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_ac7d4f06bb34625465942e6b8d10f135e"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">libMesh::Parallel::sync_dofobject_data_by_id</a></div><div class="ttdeci">void sync_dofobject_data_by_id(const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00336">parallel_ghost_sync.h:336</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a13716b8bb2b92fa2244f6f4f375a0004"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a13716b8bb2b92fa2244f6f4f375a0004">libMesh::Elem::set_p_refinement_flag</a></div><div class="ttdeci">void set_p_refinement_flag(const RefinementState pflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02662">elem.h:2662</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8b5b704315a18872765740e9b88ce24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b5b704315a18872765740e9b88ce24">&#9670;&nbsp;</a></span>make_refinement_compatible()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::make_refinement_compatible </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Take user-specified refinement flags and augment them so that level-one dependency is satisfied.</p>
<p>This function used to take an argument, <code>maintain_level_one</code> - new code should use <a class="el" href="classlibMesh_1_1MeshRefinement.html#a81fa55fe9538fded1391a56952aa1376">face_level_mismatch_limit()</a> instead. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01159">1159</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00769">_face_level_mismatch_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00861">_periodic_boundaries</a>, <a class="el" href="elem_8h_source.html#l02390">libMesh::Elem::active()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01779">libMesh::Elem::child_ref_range()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="elem_8h_source.html#l02428">libMesh::Elem::has_children()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01805">has_topological_neighbor()</a>, <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>, <a class="el" href="elem_8h_source.html#l02521">libMesh::Elem::level()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min()</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="elem_8h_source.html#l02654">libMesh::Elem::p_refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02479">libMesh::Elem::parent()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, <a class="el" href="remote__elem_8C_source.html#l00057">libMesh::remote_elem</a>, <a class="el" href="elem_8h_source.html#l02662">libMesh::Elem::set_p_refinement_flag()</a>, <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>, <a class="el" href="xdr__io_8C_source.html#l00050">side</a>, <a class="el" href="mesh__base_8C_source.html#l00496">libMesh::MeshBase::sub_point_locator()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01789">topological_neighbor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00682">refine_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;{</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  parallel_object_only();</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="comment">// We may need a PointLocator for topological_neighbor() tests</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="comment">// later, which we need to make sure gets constructed on all</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="comment">// processors at once.</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  std::unique_ptr&lt;PointLocatorBase&gt; point_locator;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordtype">bool</span> has_periodic_boundaries =</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a> &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>-&gt;empty();</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().verify(has_periodic_boundaries));</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">if</span> (has_periodic_boundaries)</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    point_locator = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">sub_point_locator</a>();</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  LOG_SCOPE (<span class="stringliteral">&quot;make_refinement_compatible()&quot;</span>, <span class="stringliteral">&quot;MeshRefinement&quot;</span>);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">// Unless we encounter a specific situation we will be compatible</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">// with any selected coarsening flags</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordtype">bool</span> compatible_with_coarsening = <span class="keyword">true</span>;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">// This loop enforces the level-1 rule.  We should only</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="comment">// execute it if the user indeed wants level-1 satisfied!</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="comment">// Unless we encounter a specific situation level-one</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="comment">// will be satisfied after executing this loop just once</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordtype">bool</span> level_one_satisfied = <span class="keyword">true</span>;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;          level_one_satisfied = <span class="keyword">true</span>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> n_sides = elem-&gt;n_sides();</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)  <span class="comment">// If the element is active and the</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="comment">// h refinement flag is set</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                {</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_level = elem-&gt;level();</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a> = 0; <a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a> != n_sides;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                       ++<a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>)</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                    {</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                      Elem * neighbor =</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                        <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">topological_neighbor</a>(elem, point_locator.get(), <a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                      <span class="keywordflow">if</span> (neighbor != <span class="keyword">nullptr</span>        &amp;&amp; <span class="comment">// I have a</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                          neighbor != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a> &amp;&amp; <span class="comment">// neighbor here</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                          neighbor-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a1d7452337eaa808b8721664b7961d713">active</a>()) <span class="comment">// and it is active</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                        {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                          <span class="comment">// Case 1:  The neighbor is at the same level I am.</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                          <span class="comment">//        1a: The neighbor will be refined       -&gt; NO PROBLEM</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                          <span class="comment">//        1b: The neighbor won&#39;t be refined      -&gt; NO PROBLEM</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                          <span class="comment">//        1c: The neighbor wants to be coarsened -&gt; PROBLEM</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                          <span class="keywordflow">if</span> (neighbor-&gt;level() == my_level)</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                            {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                              <span class="keywordflow">if</span> (neighbor-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                  neighbor-&gt;<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">set_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                  <span class="keywordflow">if</span> (neighbor-&gt;parent())</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                    neighbor-&gt;parent()-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                  compatible_with_coarsening = <span class="keyword">false</span>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                  level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                            }</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                          <span class="comment">// Case 2: The neighbor is one level lower than I am.</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                          <span class="comment">//         The neighbor thus MUST be refined to satisfy</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                          <span class="comment">//         the level-one rule, regardless of whether it</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                          <span class="comment">//         was originally flagged for refinement. If it</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                          <span class="comment">//         wasn&#39;t flagged already we need to repeat</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                          <span class="comment">//         this process.</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((neighbor-&gt;level()+1) == my_level)</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                            {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                              <span class="keywordflow">if</span> (neighbor-&gt;refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                {</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                                  neighbor-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                  <span class="keywordflow">if</span> (neighbor-&gt;parent())</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                    neighbor-&gt;parent()-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                  compatible_with_coarsening = <span class="keyword">false</span>;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                  level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                                }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                            }</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                          <span class="comment">// Note that the only other possibility is that the</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                          <span class="comment">// neighbor is already refined, in which case it isn&#39;t</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                          <span class="comment">// active and we should never get here.</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                          <span class="keywordflow">else</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                            libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Neighbor level must be equal or 1 higher than mine.&quot;</span>);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                        }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                    }</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                }</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)  <span class="comment">// If the element is active and the</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                <span class="comment">// p refinement flag is set</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_p_level = elem-&gt;p_level();</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>=0; <a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a> != n_sides; <a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>++)</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                    {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                      Elem * neighbor =</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                        <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">topological_neighbor</a>(elem, point_locator.get(), <a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                      <span class="keywordflow">if</span> (neighbor != <span class="keyword">nullptr</span> &amp;&amp;      <span class="comment">// I have a</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                          neighbor != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>) <span class="comment">// neighbor here</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                        {</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                          <span class="keywordflow">if</span> (neighbor-&gt;active()) <span class="comment">// and it is active</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                            {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                              <span class="keywordflow">if</span> (neighbor-&gt;p_level() &lt; my_p_level &amp;&amp;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                  neighbor-&gt;p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                {</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                  neighbor-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a13716b8bb2b92fa2244f6f4f375a0004">set_p_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                  level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                  compatible_with_coarsening = <span class="keyword">false</span>;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                              <span class="keywordflow">if</span> (neighbor-&gt;p_level() == my_p_level &amp;&amp;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                  neighbor-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                  neighbor-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                  level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                  compatible_with_coarsening = <span class="keyword">false</span>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                            }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                          <span class="keywordflow">else</span> <span class="comment">// I have an inactive neighbor</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                            {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                              libmesh_assert(neighbor-&gt;has_children());</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; subneighbor : neighbor-&gt;child_ref_range())</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                                <span class="keywordflow">if</span> (&amp;subneighbor != <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a> &amp;&amp; subneighbor.<a class="code" href="classlibMesh_1_1Elem.html#a1d7452337eaa808b8721664b7961d713">active</a>() &amp;&amp;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                                    <a class="code" href="classlibMesh_1_1MeshRefinement.html#ac2ced3c8ba705a7e3b7b48c6721f7062">has_topological_neighbor</a>(&amp;subneighbor, point_locator.get(), elem))</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                  {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                    <span class="keywordflow">if</span> (subneighbor.p_level() &lt; my_p_level &amp;&amp;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                        subneighbor.p_refinement_flag() != <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                      {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                        <span class="comment">// We should already be level one</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                        <span class="comment">// compatible</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                        libmesh_assert_greater (subneighbor.p_level() + 2u,</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                                                                my_p_level);</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                        subneighbor.set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                        level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                        compatible_with_coarsening = <span class="keyword">false</span>;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                      }</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                    <span class="keywordflow">if</span> (subneighbor.p_level() == my_p_level &amp;&amp;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                        subneighbor.p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                      {</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                        subneighbor.set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                        level_one_satisfied = <span class="keyword">false</span>;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                        compatible_with_coarsening = <span class="keyword">false</span>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                                      }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                                  }</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                            }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                        }</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                    }</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                }</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        }</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keywordflow">while</span> (!level_one_satisfied);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    } <span class="comment">// end if (_face_level_mismatch_limit)</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="comment">// If we&#39;re not compatible on one processor, we&#39;re globally not</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">// compatible</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">min</a>(compatible_with_coarsening);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keywordflow">return</span> compatible_with_coarsening;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ad5bb1bebf75049eb42e511b6ae5f2b7e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">libMesh::MeshBase::sub_point_locator</a></div><div class="ttdeci">std::unique_ptr&lt; PointLocatorBase &gt; sub_point_locator() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00496">mesh_base.C:496</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ae98cb59b3edcacefe07571dcc0742e91"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ae98cb59b3edcacefe07571dcc0742e91">libMesh::Parallel::Communicator::min</a></div><div class="ttdeci">void min(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="xdr__io_8C_html_a538c9c249908c84b07be8ce1400b82c9"><div class="ttname"><a href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a></div><div class="ttdeci">unsigned short int side</div><div class="ttdef"><b>Definition:</b> <a href="xdr__io_8C_source.html#l00050">xdr_io.C:50</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_adb60ffafaf6ebf931978c9335d278b46"><div class="ttname"><a href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">libMesh::Elem::set_refinement_flag</a></div><div class="ttdeci">void set_refinement_flag(const RefinementState rflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02646">elem.h:2646</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a47a409d8f3852a859271fafc5b466bb8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">libMesh::MeshRefinement::_periodic_boundaries</a></div><div class="ttdeci">PeriodicBoundaries * _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00861">mesh_refinement.h:861</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a56f1015a59736175b39e4a1ca4d084bc"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">libMesh::MeshRefinement::_face_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _face_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00769">mesh_refinement.h:769</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ac2ced3c8ba705a7e3b7b48c6721f7062"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ac2ced3c8ba705a7e3b7b48c6721f7062">libMesh::MeshRefinement::has_topological_neighbor</a></div><div class="ttdeci">bool has_topological_neighbor(const Elem *elem, const PointLocatorBase *point_locator, const Elem *neighbor)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01805">mesh_refinement.C:1805</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a13716b8bb2b92fa2244f6f4f375a0004"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a13716b8bb2b92fa2244f6f4f375a0004">libMesh::Elem::set_p_refinement_flag</a></div><div class="ttdeci">void set_p_refinement_flag(const RefinementState pflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02662">elem.h:2662</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a1d7452337eaa808b8721664b7961d713"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a1d7452337eaa808b8721664b7961d713">libMesh::Elem::active</a></div><div class="ttdeci">bool active() const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02390">elem.h:2390</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6afb4f67a92e0d3cebf6cbcd27fc22e3"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">libMesh::MeshRefinement::topological_neighbor</a></div><div class="ttdeci">Elem * topological_neighbor(Elem *elem, const PointLocatorBase *point_locator, const unsigned int side)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01789">mesh_refinement.C:1789</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a903992f631b52b5ba05ad96a51e7b383"><div class="ttname"><a href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">libMesh::remote_elem</a></div><div class="ttdeci">const RemoteElem * remote_elem</div><div class="ttdef"><b>Definition:</b> <a href="remote__elem_8C_source.html#l00057">remote_elem.C:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa761b1dfd3fd39c9b823a772d9f4f0ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa761b1dfd3fd39c9b823a772d9f4f0ea">&#9670;&nbsp;</a></span>max_h_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int &amp; libMesh::MeshRefinement::max_h_level </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The <code>max_h_level</code> is the greatest refinement level an element should reach.</p>
<p><code>max_h_level</code> is unlimited (<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>) by default </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00888">888</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00761">_max_h_level</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>.</p>
<div class="fragment"><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;{</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">_max_h_level</a>;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a80ebcf25e84315a95e59128b57c5834f"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a80ebcf25e84315a95e59128b57c5834f">libMesh::MeshRefinement::_max_h_level</a></div><div class="ttdeci">unsigned int _max_h_level</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00761">mesh_refinement.h:761</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6fe0cda2874d85c373ba4493822651c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6fe0cda2874d85c373ba4493822651c">&#9670;&nbsp;</a></span>n_processors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libMesh::ParallelObject::n_processors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The number of processors in the group. </dd></dl>

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00095">95</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00107">libMesh::ParallelObject::_communicator</a>, and <a class="el" href="communicator_8h_source.html#l00175">libMesh::Parallel::Communicator::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="boundary__info_8C_source.html#l02412">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00340">libMesh::PetscDMWrapper::add_dofs_to_section()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00385">libMesh::DistributedMesh::add_elem()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00596">libMesh::DistributedMesh::add_node()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00261">libMesh::LaplaceMeshSmoother::allgather_graph()</a>, <a class="el" href="fem__system_8C_source.html#l00854">libMesh::FEMSystem::assembly()</a>, <a class="el" href="trilinos__aztec__linear__solver_8C_source.html#l00041">libMesh::AztecLinearSolver&lt; T &gt;::AztecLinearSolver()</a>, <a class="el" href="boundary__info_8C_source.html#l01779">libMesh::BoundaryInfo::build_node_list_from_side_list()</a>, <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00764">libMesh::DistributedMesh::clear()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01846">libMesh::Nemesis_IO_Helper::compute_border_node_ids()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02648">libMesh::Nemesis_IO_Helper::construct_nemesis_filename()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00655">libMesh::UnstructuredMesh::create_pid_mesh()</a>, <a class="el" href="mesh__tools_8C_source.html#l00477">libMesh::MeshTools::create_processor_bounding_box()</a>, <a class="el" href="dof__map_8C_source.html#l00902">libMesh::DofMap::distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01163">libMesh::DofMap::distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">libMesh::DofMap::distribute_local_dofs_var_major()</a>, <a class="el" href="ensight__io_8C_source.html#l00064">libMesh::EnsightIO::EnsightIO()</a>, <a class="el" href="mesh__base_8C_source.html#l00378">libMesh::MeshBase::get_info()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00054">libMesh::PetscDMWrapper::init_and_attach_petscdm()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00763">libMesh::Nemesis_IO_Helper::initialize()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00481">libMesh::DistributedMesh::insert_elem()</a>, <a class="el" href="mesh__tools_8C_source.html#l01598">libMesh::MeshTools::libmesh_assert_contiguous_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01877">libMesh::MeshTools::libmesh_assert_parallel_consistent_new_node_procids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01777">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01915">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01826">libMesh::MeshTools::libmesh_assert_topology_consistent_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01401">libMesh::MeshTools::libmesh_assert_valid_boundary_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01571">libMesh::MeshTools::libmesh_assert_valid_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l02068">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="mesh__tools_8C_source.html#l01985">libMesh::MeshTools::libmesh_assert_valid_refinement_flags()</a>, <a class="el" href="dof__map_8C_source.html#l01076">libMesh::DofMap::local_variable_indices()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__base_8C_source.html#l00345">libMesh::MeshBase::n_active_elem_on_proc()</a>, <a class="el" href="mesh__base_8C_source.html#l00332">libMesh::MeshBase::n_elem_on_proc()</a>, <a class="el" href="mesh__base_8C_source.html#l00319">libMesh::MeshBase::n_nodes_on_proc()</a>, <a class="el" href="mesh__base_8h_source.html#l00749">libMesh::MeshBase::partition()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l00134">libMesh::PetscLinearSolver&lt; T &gt;::PetscLinearSolver()</a>, <a class="el" href="system_8C_source.html#l02100">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02220">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01993">libMesh::System::point_value()</a>, <a class="el" href="namebased__io_8C_source.html#l00059">libMesh::NameBasedIO::read()</a>, <a class="el" href="nemesis__io_8C_source.html#l00148">libMesh::Nemesis_IO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00750">libMesh::CheckpointIO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l01023">libMesh::CheckpointIO::read_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l01380">libMesh::XdrIO::read_header()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00950">libMesh::CheckpointIO::read_nodes()</a>, <a class="el" href="system__io_8C_source.html#l00493">libMesh::System::read_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l01121">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="system__io_8C_source.html#l00811">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="system__io_8C_source.html#l01168">libMesh::System::read_serialized_vector()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00961">libMesh::DistributedMesh::renumber_dof_objects()</a>, <a class="el" href="dof__map_8C_source.html#l00321">libMesh::DofMap::set_nonlocal_dof_objects()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">uniformly_coarsen()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00127">libMesh::DistributedMesh::update_parallel_id_counts()</a>, <a class="el" href="gmv__io_8C_source.html#l01230">libMesh::GMVIO::write_binary()</a>, <a class="el" href="gmv__io_8C_source.html#l01551">libMesh::GMVIO::write_discontinuous_gmv()</a>, <a class="el" href="system__io_8C_source.html#l01504">libMesh::System::write_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l02101">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l00993">libMesh::XdrIO::write_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l01815">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00351">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l00710">libMesh::XdrIO::write_serialized_nodes()</a>, and <a class="el" href="xdr__io_8C_source.html#l01136">libMesh::XdrIO::write_serialized_nodesets()</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3fc3b57958613c0bddb53e77c9891ff1">size</a>()); }</div><div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3fc3b57958613c0bddb53e77c9891ff1"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3fc3b57958613c0bddb53e77c9891ff1">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">processor_id_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8h_source.html#l00175">communicator.h:175</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00107">parallel_object.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e38c68d99dd71d4c99756aa67f3d3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e38c68d99dd71d4c99756aa67f3d3f5">&#9670;&nbsp;</a></span>nelem_target()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp; libMesh::MeshRefinement::nelem_target </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>nelem_target</code> is set to a nonzero value, methods like <a class="el" href="classlibMesh_1_1MeshRefinement.html#a700c8faeb937a543ced5e3979ab06033">flag_elements_by_nelem_target()</a> will attempt to keep the number of active elements in the mesh close to nelem_target.</p>
<p><code>nelem_target</code> is 0 by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00900">900</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00765">_nelem_target</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>.</p>
<div class="fragment"><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;{</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a7ac4703621b5298120f5028c99bd94de">_nelem_target</a>;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a7ac4703621b5298120f5028c99bd94de"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a7ac4703621b5298120f5028c99bd94de">libMesh::MeshRefinement::_nelem_target</a></div><div class="ttdeci">dof_id_type _nelem_target</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00765">mesh_refinement.h:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c7508c29a7083069c0c4d325c3bb27a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7508c29a7083069c0c4d325c3bb27a">&#9670;&nbsp;</a></span>node_level_mismatch_limit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char &amp; libMesh::MeshRefinement::node_level_mismatch_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>node_level_mismatch_limit</code> is set to a nonzero value, then refinement and coarsening will produce meshes in which the refinement level of two nodal neighbors will not differ by more than that limit. If <code>node_level_mismatch_limit</code> is 0, then level differences will be unlimited.</p>
<p><code>node_level_mismatch_limit</code> is 0 by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00922">922</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00771">_node_level_mismatch_limit</a>.</p>
<div class="fragment"><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;{</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">_node_level_mismatch_limit</a>;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ae794162fe8b50db70bb236ef9cbe68ab"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ae794162fe8b50db70bb236ef9cbe68ab">libMesh::MeshRefinement::_node_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _node_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00771">mesh_refinement.h:771</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad627b508017c8838cf513933dd6bdd00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad627b508017c8838cf513933dd6bdd00">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a>&amp; libMesh::MeshRefinement::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afa30997ed9b31c99e61cb77ba0183403"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa30997ed9b31c99e61cb77ba0183403">&#9670;&nbsp;</a></span>overrefined_boundary_limit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">signed char &amp; libMesh::MeshRefinement::overrefined_boundary_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>overrefined_boundary_limit</code> is set to a nonnegative value, then refinement and coarsening will produce meshes in which the refinement level of a boundary element is no more than that many levels greater than the level of any of its interior neighbors.</p>
<p>This may be counter-intuitive in the 1D-embedded-in-3D case: an edge has <em>more</em> interior neighbors than a face containing that edge.</p>
<p>If <code>overrefined_boundary_limit</code> is negative, then level differences will be unlimited.</p>
<p><code>overrefined_boundary_limit</code> is 0 by default. This implies that adaptive coarsening can only be done on an interior element if any boundary elements on its sides are simultaneously coarsened. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00927">927</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00773">_overrefined_boundary_limit</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00133">libMesh::EquationSystems::reinit_solutions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;{</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">_overrefined_boundary_limit</a>;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4a4151995d4be05f4d7bf890b1e3234b"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4a4151995d4be05f4d7bf890b1e3234b">libMesh::MeshRefinement::_overrefined_boundary_limit</a></div><div class="ttdeci">signed char _overrefined_boundary_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00773">mesh_refinement.h:773</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62700690227d24d28c853ab62d38ebb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62700690227d24d28c853ab62d38ebb9">&#9670;&nbsp;</a></span>processor_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libMesh::ParallelObject::processor_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The rank of this processor in the group. </dd></dl>

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00101">101</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">References <a class="el" href="parallel__object_8h_source.html#l00107">libMesh::ParallelObject::_communicator</a>, and <a class="el" href="communicator_8h_source.html#l00173">libMesh::Parallel::Communicator::rank()</a>.</p>

<p class="reference">Referenced by <a class="el" href="boundary__info_8C_source.html#l02412">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00143">libMesh::EquationSystems::_read_impl()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00340">libMesh::PetscDMWrapper::add_dofs_to_section()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00385">libMesh::DistributedMesh::add_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l00347">libMesh::BoundaryInfo::add_elements()</a>, <a class="el" href="dof__map_8C_source.html#l01499">libMesh::DofMap::add_neighbors_to_send_list()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00596">libMesh::DistributedMesh::add_node()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00969">libMesh::UnstructuredMesh::all_second_order()</a>, <a class="el" href="mesh__modification_8C_source.html#l00271">libMesh::MeshTools::Modification::all_tri()</a>, <a class="el" href="fem__system_8C_source.html#l00854">libMesh::FEMSystem::assembly()</a>, <a class="el" href="equation__systems_8C_source.html#l01055">libMesh::EquationSystems::build_discontinuous_solution_vector()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01695">libMesh::Nemesis_IO_Helper::build_element_and_node_maps()</a>, <a class="el" href="inf__elem__builder_8C_source.html#l00041">libMesh::InfElemBuilder::build_inf_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l01779">libMesh::BoundaryInfo::build_node_list_from_side_list()</a>, <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00764">libMesh::DistributedMesh::clear()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00795">libMesh::ExodusII_IO_Helper::close()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01846">libMesh::Nemesis_IO_Helper::compute_border_node_ids()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01171">libMesh::Nemesis_IO_Helper::compute_communication_map_parameters()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01249">libMesh::Nemesis_IO_Helper::compute_internal_and_border_elems_and_internal_nodes()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01096">libMesh::Nemesis_IO_Helper::compute_node_communication_maps()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01595">libMesh::Nemesis_IO_Helper::compute_num_global_elem_blocks()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01484">libMesh::Nemesis_IO_Helper::compute_num_global_nodesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01391">libMesh::Nemesis_IO_Helper::compute_num_global_sidesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02648">libMesh::Nemesis_IO_Helper::construct_nemesis_filename()</a>, <a class="el" href="mesh__tools_8C_source.html#l02259">libMesh::MeshTools::correct_node_proc_ids()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01079">libMesh::ExodusII_IO_Helper::create()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00515">libMesh::DistributedMesh::delete_elem()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00700">libMesh::DistributedMesh::delete_node()</a>, <a class="el" href="mesh__communication_8C_source.html#l01844">libMesh::MeshCommunication::delete_remote_elements()</a>, <a class="el" href="dof__map_8C_source.html#l00902">libMesh::DofMap::distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01163">libMesh::DofMap::distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01302">libMesh::DofMap::distribute_local_dofs_var_major()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00035">libMesh::DistributedMesh::DistributedMesh()</a>, <a class="el" href="dof__map_8h_source.html#l00644">libMesh::DofMap::end_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00667">libMesh::DofMap::end_old_dof()</a>, <a class="el" href="ensight__io_8C_source.html#l00064">libMesh::EnsightIO::EnsightIO()</a>, <a class="el" href="mesh__function_8C_source.html#l00674">libMesh::MeshFunction::find_element()</a>, <a class="el" href="mesh__function_8C_source.html#l00718">libMesh::MeshFunction::find_elements()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00240">libMesh::UnstructuredMesh::find_neighbors()</a>, <a class="el" href="dof__map_8h_source.html#l00602">libMesh::DofMap::first_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00612">libMesh::DofMap::first_old_dof()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00322">libMesh::Nemesis_IO_Helper::get_cmap_params()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00176">libMesh::Nemesis_IO_Helper::get_eb_info_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00407">libMesh::Nemesis_IO_Helper::get_elem_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00254">libMesh::Nemesis_IO_Helper::get_elem_map()</a>, <a class="el" href="mesh__base_8C_source.html#l00378">libMesh::MeshBase::get_info()</a>, <a class="el" href="dof__map_8C_source.html#l02703">libMesh::DofMap::get_info()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00085">libMesh::Nemesis_IO_Helper::get_init_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00205">libMesh::Nemesis_IO_Helper::get_init_info()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00224">libMesh::Nemesis_IO_Helper::get_loadbal_param()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00365">libMesh::Nemesis_IO_Helper::get_node_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00285">libMesh::Nemesis_IO_Helper::get_node_map()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00144">libMesh::Nemesis_IO_Helper::get_ns_param_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00108">libMesh::Nemesis_IO_Helper::get_ss_param_global()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00098">libMesh::SparsityPattern::Build::handle_vi_vj()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00115">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01119">libMesh::ExodusII_IO_Helper::initialize()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01695">libMesh::ExodusII_IO_Helper::initialize_element_variables()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01788">libMesh::ExodusII_IO_Helper::initialize_global_variables()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01760">libMesh::ExodusII_IO_Helper::initialize_nodal_variables()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00481">libMesh::DistributedMesh::insert_elem()</a>, <a class="el" href="dof__map_8C_source.html#l02413">libMesh::DofMap::is_evaluable()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00341">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="dof__map_8h_source.html#l00631">libMesh::DofMap::last_dof()</a>, <a class="el" href="mesh__tools_8C_source.html#l01671">libMesh::MeshTools::libmesh_assert_consistent_distributed()</a>, <a class="el" href="mesh__tools_8C_source.html#l01701">libMesh::MeshTools::libmesh_assert_consistent_distributed_nodes()</a>, <a class="el" href="mesh__tools_8C_source.html#l01598">libMesh::MeshTools::libmesh_assert_contiguous_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01777">libMesh::MeshTools::libmesh_assert_parallel_consistent_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l02068">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00844">libMesh::DistributedMesh::libmesh_assert_valid_parallel_object_ids()</a>, <a class="el" href="dof__map_8C_source.html#l01076">libMesh::DofMap::local_variable_indices()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__base_8h_source.html#l00403">libMesh::MeshBase::n_active_local_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l01646">libMesh::BoundaryInfo::n_boundary_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01667">libMesh::BoundaryInfo::n_edge_conds()</a>, <a class="el" href="dof__map_8h_source.html#l00584">libMesh::DofMap::n_local_dofs()</a>, <a class="el" href="system_8C_source.html#l00187">libMesh::System::n_local_dofs()</a>, <a class="el" href="mesh__base_8h_source.html#l00386">libMesh::MeshBase::n_local_elem()</a>, <a class="el" href="mesh__base_8h_source.html#l00286">libMesh::MeshBase::n_local_nodes()</a>, <a class="el" href="boundary__info_8C_source.html#l01711">libMesh::BoundaryInfo::n_nodeset_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01689">libMesh::BoundaryInfo::n_shellface_conds()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00207">libMesh::SparsityPattern::Build::operator()()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00582">libMesh::DistributedMesh::own_node()</a>, <a class="el" href="system_8C_source.html#l02100">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02220">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01993">libMesh::System::point_value()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00573">libMesh::Nemesis_IO_Helper::put_cmap_params()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00659">libMesh::Nemesis_IO_Helper::put_elem_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00680">libMesh::Nemesis_IO_Helper::put_elem_map()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00547">libMesh::Nemesis_IO_Helper::put_loadbal_param()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00597">libMesh::Nemesis_IO_Helper::put_node_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00642">libMesh::Nemesis_IO_Helper::put_node_map()</a>, <a class="el" href="namebased__io_8C_source.html#l00059">libMesh::NameBasedIO::read()</a>, <a class="el" href="nemesis__io_8C_source.html#l00148">libMesh::Nemesis_IO::read()</a>, <a class="el" href="xdr__io_8C_source.html#l01250">libMesh::XdrIO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00750">libMesh::CheckpointIO::read()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00639">libMesh::ExodusII_IO_Helper::read_elem_num_map()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l02031">libMesh::ExodusII_IO_Helper::read_global_values()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00830">libMesh::CheckpointIO::read_header()</a>, <a class="el" href="xdr__io_8C_source.html#l01380">libMesh::XdrIO::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00115">libMesh::System::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00310">libMesh::System::read_legacy_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00489">libMesh::ExodusII_IO_Helper::read_node_num_map()</a>, <a class="el" href="system__io_8C_source.html#l00493">libMesh::System::read_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l01121">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l02061">libMesh::XdrIO::read_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l01841">libMesh::XdrIO::read_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l00811">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l01504">libMesh::XdrIO::read_serialized_connectivity()</a>, <a class="el" href="system__io_8C_source.html#l00725">libMesh::System::read_serialized_data()</a>, <a class="el" href="xdr__io_8C_source.html#l01690">libMesh::XdrIO::read_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01974">libMesh::XdrIO::read_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l01442">libMesh::XdrIO::read_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l01168">libMesh::System::read_serialized_vector()</a>, <a class="el" href="system__io_8C_source.html#l02203">libMesh::System::read_serialized_vectors()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00961">libMesh::DistributedMesh::renumber_dof_objects()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00186">libMesh::CheckpointIO::select_split_config()</a>, <a class="el" href="dof__map_8C_source.html#l00321">libMesh::DofMap::set_nonlocal_dof_objects()</a>, <a class="el" href="petsc__dm__wrapper_8C_source.html#l00224">libMesh::PetscDMWrapper::set_point_range_in_section()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00045">libMesh::LaplaceMeshSmoother::smooth()</a>, <a class="el" href="mesh__tools_8C_source.html#l00210">libMesh::MeshTools::total_weight()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">uniformly_coarsen()</a>, <a class="el" href="parallel__elem_8C_source.html#l00354">libMesh::Parallel::Packing&lt; T &gt;::unpack()</a>, <a class="el" href="distributed__mesh_8C_source.html#l00127">libMesh::DistributedMesh::update_parallel_id_counts()</a>, <a class="el" href="namebased__io_8C_source.html#l00276">libMesh::NameBasedIO::write()</a>, <a class="el" href="xdr__io_8C_source.html#l00168">libMesh::XdrIO::write()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00270">libMesh::CheckpointIO::write()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00378">libMesh::EquationSystems::write()</a>, <a class="el" href="gmv__io_8C_source.html#l01551">libMesh::GMVIO::write_discontinuous_gmv()</a>, <a class="el" href="exodusII__io_8C_source.html#l00599">libMesh::ExodusII_IO::write_element_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01865">libMesh::ExodusII_IO_Helper::write_element_values()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01324">libMesh::ExodusII_IO_Helper::write_elements()</a>, <a class="el" href="exodusII__io_8C_source.html#l00809">libMesh::ExodusII_IO::write_global_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l02009">libMesh::ExodusII_IO_Helper::write_global_values()</a>, <a class="el" href="system__io_8C_source.html#l01299">libMesh::System::write_header()</a>, <a class="el" href="exodusII__io_8C_source.html#l00796">libMesh::ExodusII_IO::write_information_records()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01970">libMesh::ExodusII_IO_Helper::write_information_records()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01208">libMesh::ExodusII_IO_Helper::write_nodal_coordinates()</a>, <a class="el" href="ucd__io_8C_source.html#l00324">libMesh::UCDIO::write_nodal_data()</a>, <a class="el" href="exodusII__io_8C_source.html#l00700">libMesh::ExodusII_IO::write_nodal_data()</a>, <a class="el" href="exodusII__io_8C_source.html#l00912">libMesh::ExodusII_IO::write_nodal_data_discontinuous()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01948">libMesh::ExodusII_IO_Helper::write_nodal_values()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01965">libMesh::Nemesis_IO_Helper::write_nodesets()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01653">libMesh::ExodusII_IO_Helper::write_nodesets()</a>, <a class="el" href="system__io_8C_source.html#l01504">libMesh::System::write_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l02101">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l01210">libMesh::XdrIO::write_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l00993">libMesh::XdrIO::write_serialized_bcs_helper()</a>, <a class="el" href="system__io_8C_source.html#l01815">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00351">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="system__io_8C_source.html#l01704">libMesh::System::write_serialized_data()</a>, <a class="el" href="xdr__io_8C_source.html#l00710">libMesh::XdrIO::write_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01136">libMesh::XdrIO::write_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l00313">libMesh::XdrIO::write_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l02156">libMesh::System::write_serialized_vector()</a>, <a class="el" href="system__io_8C_source.html#l02297">libMesh::System::write_serialized_vectors()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02116">libMesh::Nemesis_IO_Helper::write_sidesets()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01544">libMesh::ExodusII_IO_Helper::write_sidesets()</a>, <a class="el" href="exodusII__io_8C_source.html#l00862">libMesh::ExodusII_IO::write_timestep()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01843">libMesh::ExodusII_IO_Helper::write_timestep()</a>, and <a class="el" href="exodusII__io_8C_source.html#l00104">libMesh::ExodusII_IO::write_timestep_discontinuous()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a2d45839ac93774286a0f4e72295a3837">rank</a>()); }</div><div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00107">parallel_object.h:107</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a2d45839ac93774286a0f4e72295a3837"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a2d45839ac93774286a0f4e72295a3837">libMesh::Parallel::Communicator::rank</a></div><div class="ttdeci">processor_id_type rank() const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8h_source.html#l00173">communicator.h:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab59312babe07e6584cba0c25c9e86824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab59312babe07e6584cba0c25c9e86824">&#9670;&nbsp;</a></span>refine_and_coarsen_elements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::refine_and_coarsen_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refines and coarsens user-requested elements. Will also refine/coarsen additional elements to satisfy level-one rule. It is possible that for a given set of refinement flags there is actually no change upon calling this member function.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the mesh actually changed (hence data needs to be projected) and <code>false</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function used to take an argument, <code>maintain_level_one</code>. New code should use <code><a class="el" href="classlibMesh_1_1MeshRefinement.html#a81fa55fe9538fded1391a56952aa1376">face_level_mismatch_limit()</a></code> instead. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00475">475</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8C_source.html#l01335">_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00769">_face_level_mismatch_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8C_source.html#l01461">_refine_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>, <a class="el" href="elem_8h_source.html#l01201">libMesh::Elem::JUST_REFINED</a>, <a class="el" href="mesh__base_8h_source.html#l01007">libMesh::MeshBase::libmesh_assert_valid_parallel_ids()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">make_flags_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="mesh__base_8C_source.html#l00152">libMesh::MeshBase::prepare_for_use()</a>, <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>, <a class="el" href="mesh__refinement_8C_source.html#l00352">test_level_one()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00427">test_unflagged()</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// We can&#39;t yet turn a non-level-one mesh into a level-one mesh</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// Possibly clean up the refinement flags from</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// a previous step.  While we&#39;re at it, see if this method should be</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">// a no-op.</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">bool</span> elements_flagged = <span class="keyword">false</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="comment">// This might be left over from the last step</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54">Elem::RefinementState</a> flag = elem-&gt;refinement_flag();</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">// Set refinement flag to INACTIVE if the</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="comment">// element isn&#39;t active</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">if</span> ( !elem-&gt;active())</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flag == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>)</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!elements_flagged)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;          <span class="keywordflow">if</span> (flag == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> || flag == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            elements_flagged = <span class="keyword">true</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;              <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54">Elem::RefinementState</a> pflag =</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                elem-&gt;p_refinement_flag();</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;              <span class="keywordflow">if</span> (pflag == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> || pflag == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                elements_flagged = <span class="keyword">true</span>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// Did *any* processor find elements flagged for AMR/C?</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(elements_flagged);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// If we have nothing to do, let&#39;s not bother verifying that nothing</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">// is compatible with nothing.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">if</span> (!elements_flagged)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// Parallel consistency has to come first, or coarsening</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// along processor boundaries might occasionally be falsely</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// prevented</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordtype">bool</span> flags_were_consistent = this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">make_flags_parallel_consistent</a>();</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  libmesh_assert (flags_were_consistent);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// Smooth refinement and coarsening flags</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a86813ddc62a0fa53467a55688bae38ce">_smooth_flags</a>(<span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// First coarsen the flagged elements.</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> coarsening_changed_mesh =</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a46ef7ebd80c846f24998ef0f222c55e1">_coarsen_elements</a> ();</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// First coarsen the flagged elements.</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// FIXME: test_level_one now tests consistency across periodic</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// boundaries, which requires a point_locator, which just got</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// invalidated by _coarsen_elements() and hasn&#39;t yet been cleared by</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="comment">// prepare_for_use().</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">//  libmesh_assert(this-&gt;make_coarsening_compatible());</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">//  libmesh_assert(this-&gt;make_refinement_compatible());</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// FIXME: This won&#39;t pass unless we add a redundant find_neighbors()</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// call or replace find_neighbors() with on-the-fly neighbor updating</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// libmesh_assert(!this-&gt;eliminate_unrefined_patches());</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// We can&#39;t contract the mesh ourselves anymore - a System might</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// need to restrict old coefficient vectors first</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// _mesh.contract();</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// First coarsen the flagged elements.</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// Now refine the flagged elements.  This will</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// take up some space, maybe more than what was freed.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> refining_changed_mesh =</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#ad794507aa1e1908fea6fb373dd31c548">_refine_elements</a>();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// First coarsen the flagged elements.</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// Finally, the new mesh needs to be prepared for use</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span> (coarsening_changed_mesh || refining_changed_mesh)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ada599f713083209fd36b1e0024ec99b3">libmesh_assert_valid_parallel_ids</a>();</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">prepare_for_use</a> (<span class="comment">/*skip_renumber =*/</span><span class="keyword">false</span>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a2a95dae49cbfe9cb0ab381f14ccc337c">test_unflagged</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">make_coarsening_compatible</a>());</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">make_refinement_compatible</a>());</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="comment">// FIXME: This won&#39;t pass unless we add a redundant find_neighbors()</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="comment">// call or replace find_neighbors() with on-the-fly neighbor updating</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="comment">// libmesh_assert(!this-&gt;eliminate_unrefined_patches());</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a2a95dae49cbfe9cb0ab381f14ccc337c">test_unflagged</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">make_coarsening_compatible</a>());</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">make_refinement_compatible</a>());</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// Otherwise there was no change in the mesh,</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// let the user know.  Also, there is no need</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// to prepare the mesh for use since it did not change.</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ad794507aa1e1908fea6fb373dd31c548"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ad794507aa1e1908fea6fb373dd31c548">libMesh::MeshRefinement::_refine_elements</a></div><div class="ttdeci">bool _refine_elements()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01461">mesh_refinement.C:1461</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54">libMesh::Elem::RefinementState</a></div><div class="ttdeci">RefinementState</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af8b5b704315a18872765740e9b88ce24"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">libMesh::MeshRefinement::make_refinement_compatible</a></div><div class="ttdeci">bool make_refinement_compatible()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01159">mesh_refinement.C:1159</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4f90c35be7bbebea889c925b6f20713a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">libMesh::MeshRefinement::test_level_one</a></div><div class="ttdeci">bool test_level_one(bool libmesh_assert_yes=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00352">mesh_refinement.C:352</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a56f1015a59736175b39e4a1ca4d084bc"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">libMesh::MeshRefinement::_face_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _face_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00769">mesh_refinement.h:769</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a0e925a80a9435e0d2d2a5f6113050043"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">libMesh::MeshRefinement::make_flags_parallel_consistent</a></div><div class="ttdeci">bool make_flags_parallel_consistent()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00751">mesh_refinement.C:751</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a61ce1c1cdddaa68acd35c7fa49a8a45e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">libMesh::MeshBase::prepare_for_use</a></div><div class="ttdeci">void prepare_for_use(const bool skip_renumber_nodes_and_elements=false, const bool skip_find_neighbors=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00152">mesh_base.C:152</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a1ae7cec33d6f1fe1c28f4cbda2449df1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a1ae7cec33d6f1fe1c28f4cbda2449df1">libMesh::MeshRefinement::make_coarsening_compatible</a></div><div class="ttdeci">bool make_coarsening_compatible()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00779">mesh_refinement.C:779</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a2a95dae49cbfe9cb0ab381f14ccc337c"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a2a95dae49cbfe9cb0ab381f14ccc337c">libMesh::MeshRefinement::test_unflagged</a></div><div class="ttdeci">bool test_unflagged(bool libmesh_assert_yes=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00427">mesh_refinement.C:427</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a86813ddc62a0fa53467a55688bae38ce"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a86813ddc62a0fa53467a55688bae38ce">libMesh::MeshRefinement::_smooth_flags</a></div><div class="ttdeci">void _smooth_flags(bool refining, bool coarsening)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01592">mesh_refinement.C:1592</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ada599f713083209fd36b1e0024ec99b3"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ada599f713083209fd36b1e0024ec99b3">libMesh::MeshBase::libmesh_assert_valid_parallel_ids</a></div><div class="ttdeci">virtual void libmesh_assert_valid_parallel_ids() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01007">mesh_base.h:1007</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a46ef7ebd80c846f24998ef0f222c55e1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a46ef7ebd80c846f24998ef0f222c55e1">libMesh::MeshRefinement::_coarsen_elements</a></div><div class="ttdeci">bool _coarsen_elements()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01335">mesh_refinement.C:1335</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">libMesh::Elem::JUST_REFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01201">elem.h:1201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8164c3ac46f98365b9b0c937b6e288a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8164c3ac46f98365b9b0c937b6e288a">&#9670;&nbsp;</a></span>refine_elements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::refine_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Only refines the user-requested elements. It is possible that for a given set of refinement flags there is actually no change upon calling this member function.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the mesh actually changed (hence data needs to be projected) and <code>false</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function used to take an argument, <code>maintain_level_one</code>, new code should use <code><a class="el" href="classlibMesh_1_1MeshRefinement.html#a81fa55fe9538fded1391a56952aa1376">face_level_mismatch_limit()</a></code> instead. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00682">682</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00769">_face_level_mismatch_limit</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8C_source.html#l01461">_refine_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>, <a class="el" href="elem_8h_source.html#l01201">libMesh::Elem::JUST_REFINED</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">make_flags_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>, <a class="el" href="libmesh__common_8h_source.html#l00228">libMesh::out</a>, <a class="el" href="mesh__base_8C_source.html#l00152">libMesh::MeshBase::prepare_for_use()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00352">test_level_one()</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00133">libMesh::EquationSystems::reinit_solutions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;{</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// Possibly clean up the refinement flags from</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// a previous step</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="comment">// Set refinement flag to INACTIVE if the</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="comment">// element isn&#39;t active</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">if</span> (!elem-&gt;active())</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="comment">// This might be left over from the last step</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">// Parallel consistency has to come first, or coarsening</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">// along processor boundaries might occasionally be falsely</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">// prevented</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordtype">bool</span> flags_were_consistent = this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">make_flags_parallel_consistent</a>();</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// In theory, we should be able to remove the above call, which can</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// be expensive and should be unnecessary.  In practice, doing</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="comment">// consistent flagging in parallel is hard, it&#39;s impossible to</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">// verify at the library level if it&#39;s being done by user code, and</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// we don&#39;t want to abort large parallel runs in opt mode... but we</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">// do want to warn that they should be fixed.</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  libmesh_assert(flags_were_consistent);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordflow">if</span> (!flags_were_consistent)</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;Refinement flags were not consistent between processors!\n&quot;</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Correcting and continuing.&quot;</span>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">// Smooth refinement flags</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a86813ddc62a0fa53467a55688bae38ce">_smooth_flags</a>(<span class="keyword">true</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// Now refine the flagged elements.  This will</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// take up some space, maybe more than what was freed.</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> mesh_changed =</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#ad794507aa1e1908fea6fb373dd31c548">_refine_elements</a>();</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">_face_level_mismatch_limit</a>)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">test_level_one</a>(<span class="keyword">true</span>));</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">make_refinement_compatible</a>());</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// FIXME: This won&#39;t pass unless we add a redundant find_neighbors()</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">// call or replace find_neighbors() with on-the-fly neighbor updating</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="comment">// libmesh_assert(!this-&gt;eliminate_unrefined_patches());</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// Finally, the new mesh needs to be prepared for use</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordflow">if</span> (mesh_changed)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">prepare_for_use</a> (<span class="comment">/*skip_renumber =*/</span><span class="keyword">false</span>);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">return</span> mesh_changed;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ad794507aa1e1908fea6fb373dd31c548"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ad794507aa1e1908fea6fb373dd31c548">libMesh::MeshRefinement::_refine_elements</a></div><div class="ttdeci">bool _refine_elements()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01461">mesh_refinement.C:1461</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af8b5b704315a18872765740e9b88ce24"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af8b5b704315a18872765740e9b88ce24">libMesh::MeshRefinement::make_refinement_compatible</a></div><div class="ttdeci">bool make_refinement_compatible()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01159">mesh_refinement.C:1159</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4f90c35be7bbebea889c925b6f20713a"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4f90c35be7bbebea889c925b6f20713a">libMesh::MeshRefinement::test_level_one</a></div><div class="ttdeci">bool test_level_one(bool libmesh_assert_yes=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00352">mesh_refinement.C:352</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a56f1015a59736175b39e4a1ca4d084bc"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a56f1015a59736175b39e4a1ca4d084bc">libMesh::MeshRefinement::_face_level_mismatch_limit</a></div><div class="ttdeci">unsigned char _face_level_mismatch_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00769">mesh_refinement.h:769</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a0e925a80a9435e0d2d2a5f6113050043"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a0e925a80a9435e0d2d2a5f6113050043">libMesh::MeshRefinement::make_flags_parallel_consistent</a></div><div class="ttdeci">bool make_flags_parallel_consistent()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l00751">mesh_refinement.C:751</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a61ce1c1cdddaa68acd35c7fa49a8a45e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">libMesh::MeshBase::prepare_for_use</a></div><div class="ttdeci">void prepare_for_use(const bool skip_renumber_nodes_and_elements=false, const bool skip_find_neighbors=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00152">mesh_base.C:152</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a86813ddc62a0fa53467a55688bae38ce"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a86813ddc62a0fa53467a55688bae38ce">libMesh::MeshRefinement::_smooth_flags</a></div><div class="ttdeci">void _smooth_flags(bool refining, bool coarsening)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01592">mesh_refinement.C:1592</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a63e3c3158308e2184c12b55ab9ea9a35"><div class="ttname"><a href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></div><div class="ttdeci">OStreamProxy out(std::cout)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00228">libmesh_common.h:228</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">libMesh::Elem::JUST_REFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01201">elem.h:1201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac65900f46067a75f67814fc91ef05d4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac65900f46067a75f67814fc91ef05d4b">&#9670;&nbsp;</a></span>refine_fraction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &amp; libMesh::MeshRefinement::refine_fraction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The <code>refine_fraction</code> sets either a desired target or a desired maximum number of elements to flag for refinement, depending on which flag_elements_by method is called.</p>
<p><code>refine_fraction</code> must be in <img class="formulaInl" alt="$ [0,1] $" src="form_98.png"/>, and is 0.3 by default. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00876">876</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00757">_refine_fraction</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00749">_use_member_parameters</a>.</p>
<div class="fragment"><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;{</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">_use_member_parameters</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">_refine_fraction</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_af56d90ecbcb73303903c0e298eea13ec"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#af56d90ecbcb73303903c0e298eea13ec">libMesh::MeshRefinement::_refine_fraction</a></div><div class="ttdeci">Real _refine_fraction</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00757">mesh_refinement.h:757</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_acdeef5e2ff1463f80d57bd343f5ce0f6"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#acdeef5e2ff1463f80d57bd343f5ce0f6">libMesh::MeshRefinement::_use_member_parameters</a></div><div class="ttdeci">bool _use_member_parameters</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00749">mesh_refinement.h:749</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6e894aa781331e9ff5686720b56cba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e894aa781331e9ff5686720b56cba2">&#9670;&nbsp;</a></span>set_enforce_mismatch_limit_prior_to_refinement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::set_enforce_mismatch_limit_prior_to_refinement </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enforce</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set _enforce_mismatch_limit_prior_to_refinement option. Defaults to false.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000038">Deprecated:</a></b></dt><dd>Use <a class="el" href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">enforce_mismatch_limit_prior_to_refinement()</a> instead. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00944">944</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00951">enforce_mismatch_limit_prior_to_refinement()</a>.</p>
<div class="fragment"><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;{</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  libmesh_deprecated();</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">enforce_mismatch_limit_prior_to_refinement</a>() = enforce;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a4e18ee522c67a8eb52dd58f6374686d2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a4e18ee522c67a8eb52dd58f6374686d2">libMesh::MeshRefinement::enforce_mismatch_limit_prior_to_refinement</a></div><div class="ttdeci">bool &amp; enforce_mismatch_limit_prior_to_refinement()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00951">mesh_refinement.h:951</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bec9c92d8089a8b3098643defa4a83a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bec9c92d8089a8b3098643defa4a83a">&#9670;&nbsp;</a></span>set_periodic_boundaries_ptr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::set_periodic_boundaries_ptr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> *&#160;</td>
          <td class="paramname"><em>pb_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the <code><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html" title="Maps between boundary ids and PeriodicBoundaryBase objects. ">PeriodicBoundaries</a></code> pointer. </p>

</div>
</div>
<a id="a4f565f6b741867544c70a2c96ef728f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f565f6b741867544c70a2c96ef728f0">&#9670;&nbsp;</a></span>switch_h_to_p_refinement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::switch_h_to_p_refinement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Takes a mesh whose elements are flagged for h refinement and coarsening, and switches those flags to request p refinement and coarsening instead. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement__flagging_8C_source.html#l00635">635</a> of file <a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="elem_8h_source.html#l01199">libMesh::Elem::DO_NOTHING</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range()</a>, and <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>.</p>
<div class="fragment"><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;{</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">element_ptr_range</a>())</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;active())</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;          elem-&gt;set_p_refinement_flag(elem-&gt;refinement_flag());</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">Elem::DO_NOTHING</a>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          elem-&gt;set_p_refinement_flag(elem-&gt;refinement_flag());</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a5a64eb29d0df43150a3b87184fb56be4">libMesh::Elem::DO_NOTHING</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01199">elem.h:1199</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5173d38b4db709085b1cde698137d042"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5173d38b4db709085b1cde698137d042">libMesh::MeshBase::element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; element_ptr_range()=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f90c35be7bbebea889c925b6f20713a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f90c35be7bbebea889c925b6f20713a">&#9670;&nbsp;</a></span>test_level_one()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::test_level_one </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>libmesh_assert_yes</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the mesh satisfies the level one restriction, and false otherwise.</dd></dl>
<p>Aborts the program if <code>libmesh_assert_yes</code> is true and the mesh does not satisfy the level one restriction. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00352">352</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00861">_periodic_boundaries</a>, <a class="el" href="elem_8h_source.html#l02390">libMesh::Elem::active()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="elem_8h_source.html#l02521">libMesh::Elem::level()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="libmesh__common_8h_source.html#l00228">libMesh::out</a>, <a class="el" href="elem_8h_source.html#l02555">libMesh::Elem::p_level()</a>, <a class="el" href="remote__elem_8C_source.html#l00057">libMesh::remote_elem</a>, <a class="el" href="mesh__base_8C_source.html#l00496">libMesh::MeshBase::sub_point_locator()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01789">topological_neighbor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00607">coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00682">refine_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;{</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// We may need a PointLocator for topological_neighbor() tests</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// later, which we need to make sure gets constructed on all</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// processors at once.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  std::unique_ptr&lt;PointLocatorBase&gt; point_locator;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">bool</span> has_periodic_boundaries =</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a> &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>-&gt;empty();</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().verify(has_periodic_boundaries));</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">if</span> (has_periodic_boundaries)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    point_locator = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">sub_point_locator</a>();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">bool</span> failure = <span class="keyword">false</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  Elem * failed_elem = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  Elem * failed_neighbor = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#endif // !NDEBUG</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;side_index_range())</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        Elem * neighbor =</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">topological_neighbor</a>(elem, point_locator.get(), n);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">if</span> (!neighbor || !neighbor-&gt;active() ||</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            neighbor == <a class="code" href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">remote_elem</a>)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span> ((neighbor-&gt;level() + 1 &lt; elem-&gt;level()) ||</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            (neighbor-&gt;p_level() + 1 &lt; elem-&gt;p_level()) ||</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            (neighbor-&gt;p_level() &gt; elem-&gt;p_level() + 1))</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            failure = <span class="keyword">true</span>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            failed_elem = elem;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            failed_neighbor = neighbor;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#endif // !NDEBUG</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// If any processor failed, we failed globally</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(failure);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">if</span> (failure)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="comment">// We didn&#39;t pass the level one test, so libmesh_assert that</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="comment">// we&#39;re allowed not to</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">if</span> (libmesh_assert_pass)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;MeshRefinement Level one failure, element: &quot;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                       &lt;&lt; *failed_elem</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                       &lt;&lt; std::endl;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;MeshRefinement Level one failure, neighbor: &quot;</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                       &lt;&lt; *failed_neighbor</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                       &lt;&lt; std::endl;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#endif // !NDEBUG</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      libmesh_assert(!libmesh_assert_pass);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshBase_html_ad5bb1bebf75049eb42e511b6ae5f2b7e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ad5bb1bebf75049eb42e511b6ae5f2b7e">libMesh::MeshBase::sub_point_locator</a></div><div class="ttdeci">std::unique_ptr&lt; PointLocatorBase &gt; sub_point_locator() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00496">mesh_base.C:496</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a47a409d8f3852a859271fafc5b466bb8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">libMesh::MeshRefinement::_periodic_boundaries</a></div><div class="ttdeci">PeriodicBoundaries * _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00861">mesh_refinement.h:861</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a63e3c3158308e2184c12b55ab9ea9a35"><div class="ttname"><a href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></div><div class="ttdeci">OStreamProxy out(std::cout)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00228">libmesh_common.h:228</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6afb4f67a92e0d3cebf6cbcd27fc22e3"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6afb4f67a92e0d3cebf6cbcd27fc22e3">libMesh::MeshRefinement::topological_neighbor</a></div><div class="ttdeci">Elem * topological_neighbor(Elem *elem, const PointLocatorBase *point_locator, const unsigned int side)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01789">mesh_refinement.C:1789</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a903992f631b52b5ba05ad96a51e7b383"><div class="ttname"><a href="namespacelibMesh.html#a903992f631b52b5ba05ad96a51e7b383">libMesh::remote_elem</a></div><div class="ttdeci">const RemoteElem * remote_elem</div><div class="ttdef"><b>Definition:</b> <a href="remote__elem_8C_source.html#l00057">remote_elem.C:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a95dae49cbfe9cb0ab381f14ccc337c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a95dae49cbfe9cb0ab381f14ccc337c">&#9670;&nbsp;</a></span>test_unflagged()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::test_unflagged </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>libmesh_assert_yes</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the mesh has no elements flagged to be coarsened or refined, and false otherwise.</dd></dl>
<p>Aborts the program if libmesh_assert_yes is true and the mesh has flagged elements. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00427">427</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max()</a>, <a class="el" href="libmesh__common_8h_source.html#l00228">libMesh::out</a>, and <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  parallel_object_only();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">bool</span> found_flag = <span class="keyword">false</span>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  Elem * failed_elem = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// Search for local flags</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">active_local_element_ptr_range</a>())</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> ||</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a> ||</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a> ||</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        elem-&gt;p_refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        found_flag = <span class="keyword">true</span>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        failed_elem = elem;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// If we found a flag on any processor, it counts</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">max</a>(found_flag);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">if</span> (found_flag)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">if</span> (libmesh_assert_pass)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="stringliteral">&quot;MeshRefinement test_unflagged failure, element: &quot;</span> &lt;&lt;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            *failed_elem &lt;&lt; std::endl;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="comment">// We didn&#39;t pass the &quot;elements are unflagged&quot; test,</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="comment">// so libmesh_assert that we&#39;re allowed not to</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      libmesh_assert(!libmesh_assert_pass);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac82839410a5e87606482504ae269f31f"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac82839410a5e87606482504ae269f31f">libMesh::Parallel::Communicator::max</a></div><div class="ttdeci">void max(T &amp;r) const</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a4de0bcdc2a18c8b093cc55561e626dc5"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a4de0bcdc2a18c8b093cc55561e626dc5">libMesh::MeshBase::active_local_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_local_element_ptr_range()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a63e3c3158308e2184c12b55ab9ea9a35"><div class="ttname"><a href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></div><div class="ttdeci">OStreamProxy out(std::cout)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00228">libmesh_common.h:228</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6afb4f67a92e0d3cebf6cbcd27fc22e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6afb4f67a92e0d3cebf6cbcd27fc22e3">&#9670;&nbsp;</a></span>topological_neighbor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> * libMesh::MeshRefinement::topological_neighbor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1Elem.html">Elem</a> *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PointLocatorBase.html">PointLocatorBase</a> *&#160;</td>
          <td class="paramname"><em>point_locator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>side</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Local dispatch function for getting the correct topological neighbor from the <a class="el" href="classlibMesh_1_1Elem.html" title="The base class for all geometric element types. ">Elem</a> class </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01789">1789</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00861">_periodic_boundaries</a>, <a class="el" href="elem_8h_source.html#l02050">libMesh::Elem::neighbor_ptr()</a>, <a class="el" href="xdr__io_8C_source.html#l00050">side</a>, and <a class="el" href="elem_8C_source.html#l00920">libMesh::Elem::topological_neighbor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00352">test_level_one()</a>.</p>
<div class="fragment"><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;{</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a> &amp;&amp; !<a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>-&gt;empty())</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    {</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      libmesh_assert(point_locator);</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <span class="keywordflow">return</span> elem-&gt;topological_neighbor(<a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>, <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>, *point_locator, <a class="code" href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">_periodic_boundaries</a>);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    }</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="keywordflow">return</span> elem-&gt;neighbor_ptr(<a class="code" href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a>);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="xdr__io_8C_html_a538c9c249908c84b07be8ce1400b82c9"><div class="ttname"><a href="xdr__io_8C.html#a538c9c249908c84b07be8ce1400b82c9">side</a></div><div class="ttdeci">unsigned short int side</div><div class="ttdef"><b>Definition:</b> <a href="xdr__io_8C_source.html#l00050">xdr_io.C:50</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a47a409d8f3852a859271fafc5b466bb8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a47a409d8f3852a859271fafc5b466bb8">libMesh::MeshRefinement::_periodic_boundaries</a></div><div class="ttdeci">PeriodicBoundaries * _periodic_boundaries</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00861">mesh_refinement.h:861</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3af86e696b675d6385dd1fda3e4933e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3af86e696b675d6385dd1fda3e4933e">&#9670;&nbsp;</a></span>underrefined_boundary_limit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">signed char &amp; libMesh::MeshRefinement::underrefined_boundary_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>underrefined_boundary_limit</code> is set to a nonnegative value, then refinement and coarsening will produce meshes in which the refinement level of an element is no more than that many levels greater than the level of any boundary elements on its sides.</p>
<p>If <code>underrefined_boundary_limit</code> is negative, then level differences will be unlimited.</p>
<p><code>underrefined_boundary_limit</code> is 0 by default. This implies that adaptive coarsening can only be done on a boundary element if any interior elements it is on the side of are simultaneously coarsened. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00932">932</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00774">_underrefined_boundary_limit</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00133">libMesh::EquationSystems::reinit_solutions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;{</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">_underrefined_boundary_limit</a>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a1ee86268abe102ac27effa05bbf6fa15"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a1ee86268abe102ac27effa05bbf6fa15">libMesh::MeshRefinement::_underrefined_boundary_limit</a></div><div class="ttdeci">signed char _underrefined_boundary_limit</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00774">mesh_refinement.h:774</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c090a5a22834d33fa0d436fbccab795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c090a5a22834d33fa0d436fbccab795">&#9670;&nbsp;</a></span>uniformly_coarsen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::uniformly_coarsen </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to uniformly coarsen the mesh <code>n</code> times. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01701">1701</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8C_source.html#l01335">_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a49e8bef33dabe0c21c7e81d61e055154">libMesh::MeshBase::ancestor_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a993d03afe0646ec1e9a192808ad2ebd9">libMesh::MeshBase::ancestor_elements_end()</a>, <a class="el" href="communicator_8h_source.html#l00070">libMesh::Parallel::any_source</a>, <a class="el" href="simple__range_8h_source.html#l00057">libMesh::as_range()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00662">clean_refinement_flags()</a>, <a class="el" href="elem_8h_source.html#l01198">libMesh::Elem::COARSEN</a>, <a class="el" href="elem_8h_source.html#l01204">libMesh::Elem::COARSEN_INACTIVE</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__base_8h_source.html#l00504">libMesh::MeshBase::elem_ref()</a>, <a class="el" href="communicator_8C_source.html#l00201">libMesh::Parallel::Communicator::get_unique_tag()</a>, <a class="el" href="elem_8h_source.html#l01203">libMesh::Elem::INACTIVE</a>, <a class="el" href="mesh__base_8h_source.html#l00176">libMesh::MeshBase::is_replicated()</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a151e26d7ee601e24a57f4f18a1ddec2e">libMesh::MeshBase::not_local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#aa7ba43cbc4025fc5629dad18485e019d">libMesh::MeshBase::not_local_elements_end()</a>, <a class="el" href="mesh__base_8C_source.html#l00152">libMesh::MeshBase::prepare_for_use()</a>, <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>, <a class="el" href="parallel__implementation_8h_source.html#l00771">libMesh::Parallel::Communicator::receive()</a>, <a class="el" href="elem_8h_source.html#l02638">libMesh::Elem::refinement_flag()</a>, <a class="el" href="parallel__implementation_8h_source.html#l00261">libMesh::Parallel::Communicator::send()</a>, <a class="el" href="elem_8h_source.html#l02646">libMesh::Elem::set_refinement_flag()</a>, <a class="el" href="parallel__ghost__sync_8h_source.html#l00336">libMesh::Parallel::sync_dofobject_data_by_id()</a>, and <a class="el" href="request_8C_source.html#l00213">libMesh::Parallel::wait()</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, and <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;{</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="comment">// Coarsen n times</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rstep=0; rstep&lt;n; rstep++)</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    {</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="comment">// Clean up the refinement flags</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">clean_refinement_flags</a>();</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <span class="comment">// Flag all the active elements for coarsening.</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        {</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;          elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">Elem::COARSEN</a>);</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;parent())</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            elem-&gt;parent()-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>);</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        }</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="comment">// On a distributed mesh, we may have parent elements with</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="comment">// remote active children.  To keep flags consistent, we&#39;ll need</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="comment">// a communication step.</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">is_replicated</a>())</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        {</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> n_proc = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">n_processors</a>();</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> my_proc_id = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">processor_id</a>();</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;          std::vector&lt;std::vector&lt;dof_id_type&gt;&gt;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            parents_to_coarsen(n_proc);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">as_range</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a49e8bef33dabe0c21c7e81d61e055154">ancestor_elements_begin</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a993d03afe0646ec1e9a192808ad2ebd9">ancestor_elements_end</a>()))</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <span class="keywordflow">if</span> (elem-&gt;processor_id() != my_proc_id &amp;&amp;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                elem-&gt;refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>)</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;              parents_to_coarsen[elem-&gt;processor_id()].push_back(elem-&gt;id());</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;          Parallel::MessageTag</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            coarsen_tag = this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">get_unique_tag</a>(271);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          std::vector&lt;Parallel::Request&gt; coarsen_push_requests(n_proc-1);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p = 0; p != n_proc; ++p)</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            {</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;              <span class="keywordflow">if</span> (p == my_proc_id)</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;              Parallel::Request &amp;<a class="code" href="namespacelibMesh_1_1Parallel.html#a4cf28cfb3d6fefc535e83fb4b2698276">request</a> =</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                coarsen_push_requests[p - (p &gt; my_proc_id)];</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;              <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a9fa78572d83d7756fbe6bc2b2c6337d7">send</a></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                (p, parents_to_coarsen[p], <a class="code" href="namespacelibMesh_1_1Parallel.html#a4cf28cfb3d6fefc535e83fb4b2698276">request</a>, coarsen_tag);</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;            }</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p = 1; p != n_proc; ++p)</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            {</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;              std::vector&lt;dof_id_type&gt; my_parents_to_coarsen;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;              <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a751fba5447d0593802384b58b2136364">receive</a></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                (<a class="code" href="namespacelibMesh_1_1Parallel.html#a981cb1019c5fd951755cf6e00caaa634">Parallel::any_source</a>, my_parents_to_coarsen,</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                 coarsen_tag);</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <span class="keywordtype">id</span> : my_parents_to_coarsen)</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                {</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                  Elem &amp; elem = <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a8ef08bc51daf3d70fe7fb780c49bd002">elem_ref</a>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                  libmesh_assert(elem.refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">Elem::INACTIVE</a> ||</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                                 elem.refinement_flag() == <a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                  elem.<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">set_refinement_flag</a>(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">Elem::COARSEN_INACTIVE</a>);</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                }</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            }</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;          <a class="code" href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">Parallel::wait</a>(coarsen_push_requests);</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;          SyncRefinementFlags hsync(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>, &amp;<a class="code" href="classlibMesh_1_1Elem.html#a1960f0611789fe6552d2dd6794778ca5">Elem::refinement_flag</a>,</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                    &amp;<a class="code" href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">Elem::set_refinement_flag</a>);</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;          <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">sync_dofobject_data_by_id</a></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">comm</a>(), <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a151e26d7ee601e24a57f4f18a1ddec2e">not_local_elements_begin</a>(),</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;             <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#aa7ba43cbc4025fc5629dad18485e019d">not_local_elements_end</a>(),</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;             <span class="comment">// We&#39;d like a smaller sync, but this leads to bugs?</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;             <span class="comment">// SyncCoarsenInactive(),</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;             hsync);</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        }</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="comment">// Coarsen all the elements we just flagged.</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a46ef7ebd80c846f24998ef0f222c55e1">_coarsen_elements</a>();</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="comment">// Finally, the new mesh probably needs to be prepared for use</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="keywordflow">if</span> (n &gt; 0)</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">prepare_for_use</a> (<span class="comment">/*skip_renumber =*/</span><span class="keyword">false</span>);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1Elem_html_a1960f0611789fe6552d2dd6794778ca5"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a1960f0611789fe6552d2dd6794778ca5">libMesh::Elem::refinement_flag</a></div><div class="ttdeci">RefinementState refinement_flag() const</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02638">elem.h:2638</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a9fa78572d83d7756fbe6bc2b2c6337d7"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a9fa78572d83d7756fbe6bc2b2c6337d7">libMesh::Parallel::Communicator::send</a></div><div class="ttdeci">void send(const unsigned int dest_processor_id, const T &amp;buf, const MessageTag &amp;tag=no_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00261">parallel_implementation.h:261</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a49e8bef33dabe0c21c7e81d61e055154"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a49e8bef33dabe0c21c7e81d61e055154">libMesh::MeshBase::ancestor_elements_begin</a></div><div class="ttdeci">virtual element_iterator ancestor_elements_begin()=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_aea5278a91928fa4f33b74aa0786f3592"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#aea5278a91928fa4f33b74aa0786f3592">libMesh::Parallel::wait</a></div><div class="ttdeci">void wait(std::vector&lt; Request &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="request_8C_source.html#l00213">request.C:213</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_aa7ba43cbc4025fc5629dad18485e019d"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#aa7ba43cbc4025fc5629dad18485e019d">libMesh::MeshBase::not_local_elements_end</a></div><div class="ttdeci">virtual element_iterator not_local_elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a7d9c31942b061618643ecf815f74dd2c">libMesh::Elem::COARSEN</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01198">elem.h:1198</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a981cb1019c5fd951755cf6e00caaa634"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a981cb1019c5fd951755cf6e00caaa634">libMesh::Parallel::any_source</a></div><div class="ttdeci">const unsigned int any_source</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8h_source.html#l00070">communicator.h:70</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54af7c2ef5bee86b20e0a4e1cebd140caef">libMesh::Elem::INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01203">elem.h:1203</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a993d03afe0646ec1e9a192808ad2ebd9"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a993d03afe0646ec1e9a192808ad2ebd9">libMesh::MeshBase::ancestor_elements_end</a></div><div class="ttdeci">virtual element_iterator ancestor_elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a4cf28cfb3d6fefc535e83fb4b2698276"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a4cf28cfb3d6fefc535e83fb4b2698276">libMesh::Parallel::request</a></div><div class="ttdeci">MPI_Request request</div><div class="ttdef"><b>Definition:</b> <a href="request_8h_source.html#l00040">request.h:40</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_adb60ffafaf6ebf931978c9335d278b46"><div class="ttname"><a href="classlibMesh_1_1Elem.html#adb60ffafaf6ebf931978c9335d278b46">libMesh::Elem::set_refinement_flag</a></div><div class="ttdeci">void set_refinement_flag(const RefinementState rflag)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l02646">elem.h:2646</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a4dfeba78f759a8e42683bb559ce1e9fa"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a4dfeba78f759a8e42683bb559ce1e9fa">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00089">parallel_object.h:89</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6930cd279030a81ff6d36a40809b1fd8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">libMesh::MeshRefinement::clean_refinement_flags</a></div><div class="ttdeci">void clean_refinement_flags()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__flagging_8C_source.html#l00662">mesh_refinement_flagging.C:662</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ac865c9ea66f0b31884d53f156ce474ad"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ac865c9ea66f0b31884d53f156ce474ad">libMesh::Parallel::Communicator::get_unique_tag</a></div><div class="ttdeci">MessageTag get_unique_tag(int tagvalue) const</div><div class="ttdef"><b>Definition:</b> <a href="communicator_8C_source.html#l00201">communicator.C:201</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_aa6fe0cda2874d85c373ba4493822651c"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#aa6fe0cda2874d85c373ba4493822651c">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00095">parallel_object.h:95</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a977361a82b7a9e7ad8e50ae1cae40d20"><div class="ttname"><a href="namespacelibMesh.html#a977361a82b7a9e7ad8e50ae1cae40d20">libMesh::as_range</a></div><div class="ttdeci">SimpleRange&lt; I &gt; as_range(const std::pair&lt; I, I &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="simple__range_8h_source.html#l00057">simple_range.h:57</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a560ee64b3c009f94569a135dce55c8b6">libMesh::Elem::COARSEN_INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01204">elem.h:1204</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a61ce1c1cdddaa68acd35c7fa49a8a45e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">libMesh::MeshBase::prepare_for_use</a></div><div class="ttdeci">void prepare_for_use(const bool skip_renumber_nodes_and_elements=false, const bool skip_find_neighbors=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00152">mesh_base.C:152</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_ac7d4f06bb34625465942e6b8d10f135e"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">libMesh::Parallel::sync_dofobject_data_by_id</a></div><div class="ttdeci">void sync_dofobject_data_by_id(const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00336">parallel_ghost_sync.h:336</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a1b15de4062298b11df7d8267053d8aee"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a1b15de4062298b11df7d8267053d8aee">libMesh::MeshBase::is_replicated</a></div><div class="ttdeci">virtual bool is_replicated() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00176">mesh_base.h:176</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a8ef08bc51daf3d70fe7fb780c49bd002"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a8ef08bc51daf3d70fe7fb780c49bd002">libMesh::MeshBase::elem_ref</a></div><div class="ttdeci">virtual const Elem &amp; elem_ref(const dof_id_type i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l00504">mesh_base.h:504</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a751fba5447d0593802384b58b2136364"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a751fba5447d0593802384b58b2136364">libMesh::Parallel::Communicator::receive</a></div><div class="ttdeci">Status receive(const unsigned int dest_processor_id, T &amp;buf, const MessageTag &amp;tag=any_tag) const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l00771">parallel_implementation.h:771</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a151e26d7ee601e24a57f4f18a1ddec2e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a151e26d7ee601e24a57f4f18a1ddec2e">libMesh::MeshBase::not_local_elements_begin</a></div><div class="ttdeci">virtual element_iterator not_local_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a46ef7ebd80c846f24998ef0f222c55e1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a46ef7ebd80c846f24998ef0f222c55e1">libMesh::MeshRefinement::_coarsen_elements</a></div><div class="ttdeci">bool _coarsen_elements()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01335">mesh_refinement.C:1335</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a62700690227d24d28c853ab62d38ebb9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a62700690227d24d28c853ab62d38ebb9">libMesh::ParallelObject::processor_id</a></div><div class="ttdeci">processor_id_type processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00101">parallel_object.h:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a19810e55f1ba17b88aa665e8c31cb5a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19810e55f1ba17b88aa665e8c31cb5a2">&#9670;&nbsp;</a></span>uniformly_p_coarsen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::uniformly_p_coarsen </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to uniformly p coarsen the mesh <code>n</code> times. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01661">1661</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, and <a class="el" href="elem_8h_source.html#l01202">libMesh::Elem::JUST_COARSENED</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, and <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;{</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="comment">// Coarsen p times</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rstep=0; rstep&lt;n; rstep++)</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;p_level() &gt; 0)</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        {</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;          <span class="comment">// P coarsen all the active elements</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;          elem-&gt;set_p_level(elem-&gt;p_level()-1);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;          elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">Elem::JUST_COARSENED</a>);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54adec28448bd3f7297806b7d58e9625240">libMesh::Elem::JUST_COARSENED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01202">elem.h:1202</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8b117eccc68c96f20c0c0b4045303e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8b117eccc68c96f20c0c0b4045303e8">&#9670;&nbsp;</a></span>uniformly_p_refine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::uniformly_p_refine </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Uniformly p refines the mesh <code>n</code> times. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01647">1647</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, and <a class="el" href="elem_8h_source.html#l01201">libMesh::Elem::JUST_REFINED</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, and <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;{</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="comment">// Refine n times</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rstep=0; rstep&lt;n; rstep++)</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      {</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="comment">// P refine all the active elements</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        elem-&gt;set_p_level(elem-&gt;p_level()+1);</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        elem-&gt;set_p_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">Elem::JUST_REFINED</a>);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      }</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a6fb8f2a3f8b6cc1a569263dbc1f1c5cf">libMesh::Elem::JUST_REFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01201">elem.h:1201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a406e53c22bd8c9e2cefa862ef02f226f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a406e53c22bd8c9e2cefa862ef02f226f">&#9670;&nbsp;</a></span>uniformly_refine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::uniformly_refine </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Uniformly refines the mesh <code>n</code> times. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l01676">1676</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8C_source.html#l01461">_refine_elements()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00662">clean_refinement_flags()</a>, <a class="el" href="mesh__base_8C_source.html#l00152">libMesh::MeshBase::prepare_for_use()</a>, and <a class="el" href="elem_8h_source.html#l01200">libMesh::Elem::REFINE</a>.</p>

<p class="reference">Referenced by <a class="el" href="uniform__refinement__estimator_8C_source.html#l00117">libMesh::UniformRefinementEstimator::_estimate_error()</a>, and <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00090">libMesh::AdjointRefinementEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;{</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="comment">// Refine n times</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">// FIXME - this won&#39;t work if n&gt;1 and the mesh</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="comment">// has already been attached to an equation system</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rstep=0; rstep&lt;n; rstep++)</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="comment">// Clean up the refinement flags</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">clean_refinement_flags</a>();</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <span class="comment">// Flag all the active elements for refinement.</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">active_element_ptr_range</a>())</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        elem-&gt;set_refinement_flag(<a class="code" href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">Elem::REFINE</a>);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="comment">// Refine all the elements we just flagged.</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#ad794507aa1e1908fea6fb373dd31c548">_refine_elements</a>();</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    }</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="comment">// Finally, the new mesh probably needs to be prepared for use</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keywordflow">if</span> (n &gt; 0)</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>.<a class="code" href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">prepare_for_use</a> (<span class="comment">/*skip_renumber =*/</span><span class="keyword">false</span>);</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_ad794507aa1e1908fea6fb373dd31c548"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#ad794507aa1e1908fea6fb373dd31c548">libMesh::MeshRefinement::_refine_elements</a></div><div class="ttdeci">bool _refine_elements()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8C_source.html#l01461">mesh_refinement.C:1461</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a674d499e6c104bc63a68ca7e9c7ccb54a1511a7045e9a76eaa3b5b0f9511dd01b">libMesh::Elem::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01200">elem.h:1200</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6930cd279030a81ff6d36a40809b1fd8"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6930cd279030a81ff6d36a40809b1fd8">libMesh::MeshRefinement::clean_refinement_flags</a></div><div class="ttdeci">void clean_refinement_flags()</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement__flagging_8C_source.html#l00662">mesh_refinement_flagging.C:662</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_af744c644dfa9b7912eda9cf4f55db03a"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#af744c644dfa9b7912eda9cf4f55db03a">libMesh::MeshBase::active_element_ptr_range</a></div><div class="ttdeci">virtual SimpleRange&lt; element_iterator &gt; active_element_ptr_range()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a61ce1c1cdddaa68acd35c7fa49a8a45e"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a61ce1c1cdddaa68acd35c7fa49a8a45e">libMesh::MeshBase::prepare_for_use</a></div><div class="ttdeci">void prepare_for_use(const bool skip_renumber_nodes_and_elements=false, const bool skip_find_neighbors=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8C_source.html#l00152">mesh_base.C:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fbd7b73883ab6ad3f587a7e6e756ab0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fbd7b73883ab6ad3f587a7e6e756ab0">&#9670;&nbsp;</a></span>update_nodes_map()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshRefinement::update_nodes_map </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Updates the <code>_new_nodes_map</code> </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8C_source.html#l00345">345</a> of file <a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a>.</p>

<p class="reference">References <a class="el" href="mesh__refinement_8h_source.html#l00742">_mesh</a>, <a class="el" href="mesh__refinement_8h_source.html#l00737">_new_nodes_map</a>, and <a class="el" href="topology__map_8C_source.html#l00035">libMesh::TopologyMap::init()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01335">_coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01461">_refine_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;{</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">_new_nodes_map</a>.<a class="code" href="classlibMesh_1_1TopologyMap.html#a950a56d75b2b64b8848edea416c21b9d">init</a>(<a class="code" href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">_mesh</a>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div><div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a668c8ef9154f08b469eb9d90dd2074d1"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a668c8ef9154f08b469eb9d90dd2074d1">libMesh::MeshRefinement::_new_nodes_map</a></div><div class="ttdeci">TopologyMap _new_nodes_map</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00737">mesh_refinement.h:737</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshRefinement_html_a6df23471791e621cfeb7a7828c8c73a2"><div class="ttname"><a href="classlibMesh_1_1MeshRefinement.html#a6df23471791e621cfeb7a7828c8c73a2">libMesh::MeshRefinement::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__refinement_8h_source.html#l00742">mesh_refinement.h:742</a></div></div>
<div class="ttc" id="classlibMesh_1_1TopologyMap_html_a950a56d75b2b64b8848edea416c21b9d"><div class="ttname"><a href="classlibMesh_1_1TopologyMap.html#a950a56d75b2b64b8848edea416c21b9d">libMesh::TopologyMap::init</a></div><div class="ttdeci">void init(MeshBase &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="topology__map_8C_source.html#l00035">topology_map.C:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aea1a97aa9a8e4a8ec1967050c96f5b13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea1a97aa9a8e4a8ec1967050c96f5b13">&#9670;&nbsp;</a></span>_absolute_global_tolerance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> libMesh::MeshRefinement::_absolute_global_tolerance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00767">767</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8h_source.html#l00906">absolute_global_tolerance()</a>, and <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>.</p>

</div>
</div>
<a id="ab6fda707e1285340135e56469b055746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6fda707e1285340135e56469b055746">&#9670;&nbsp;</a></span>_coarsen_by_parents</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::_coarsen_by_parents</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refinement parameter values </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00755">755</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8h_source.html#l00870">coarsen_by_parents()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>, and <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>.</p>

</div>
</div>
<a id="a04e98b91b8eb9b6ddcf0dff673a1a281"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04e98b91b8eb9b6ddcf0dff673a1a281">&#9670;&nbsp;</a></span>_coarsen_fraction</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> libMesh::MeshRefinement::_coarsen_fraction</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00759">759</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8h_source.html#l00882">coarsen_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00568">flag_elements_by_mean_stddev()</a>, and <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>.</p>

</div>
</div>
<a id="aef4c09ce1e49edffc4b7f196d4b91b8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4c09ce1e49edffc4b7f196d4b91b8a">&#9670;&nbsp;</a></span>_coarsen_threshold</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> libMesh::MeshRefinement::_coarsen_threshold</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00763">763</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8h_source.html#l00894">coarsen_threshold()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>, and <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>.</p>

</div>
</div>
<a id="a1ffb5b08919ab435109a302f94a7b3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ffb5b08919ab435109a302f94a7b3eb">&#9670;&nbsp;</a></span>_communicator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a>&amp; libMesh::ParallelObject::_communicator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="parallel__object_8h_source.html#l00107">107</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="equation__systems_8C_source.html#l00913">libMesh::EquationSystems::build_parallel_elemental_solution_vector()</a>, <a class="el" href="equation__systems_8C_source.html#l00600">libMesh::EquationSystems::build_parallel_solution_vector()</a>, <a class="el" href="parallel__object_8h_source.html#l00089">libMesh::ParallelObject::comm()</a>, <a class="el" href="parallel__object_8h_source.html#l00095">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="parallel__object_8h_source.html#l00074">libMesh::ParallelObject::operator=()</a>, and <a class="el" href="parallel__object_8h_source.html#l00101">libMesh::ParallelObject::processor_id()</a>.</p>

</div>
</div>
<a id="ae705082e7bc067be443b6792c1be54d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae705082e7bc067be443b6792c1be54d6">&#9670;&nbsp;</a></span>_edge_level_mismatch_limit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char libMesh::MeshRefinement::_edge_level_mismatch_limit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00770">770</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00917">edge_level_mismatch_limit()</a>.</p>

</div>
</div>
<a id="a380986d25467e922fc62f0f6f0f33d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a380986d25467e922fc62f0f6f0f33d48">&#9670;&nbsp;</a></span>_enforce_mismatch_limit_prior_to_refinement</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::_enforce_mismatch_limit_prior_to_refinement</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This option enforces the mismatch level prior to refinement by checking if refining any element marked for refinement <b>would</b> cause a mismatch greater than the limit. Applies to all mismatch methods.</p>
<p>Calling this with <code><a class="el" href="classlibMesh_1_1MeshRefinement.html#a7c7508c29a7083069c0c4d325c3bb27a">node_level_mismatch_limit()</a></code> = 1 would transform this mesh: </p><pre class="fragment">* o-------o-------o-------o-------o
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* o-------o---o---o-------o-------o
* |       |   :   |       |       |
* |       |   :   |       |       |
* |       o...o...o       |       |
* |       |   :   |       |       |
* |       |   :   |       |       |
* o-------o---o---o-------o-------o
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* o-------o-------o               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* |       |       |               |
* o-------o-------o---------------o
* </pre><p>into this:</p>
<pre class="fragment">* o-------o-------o-------o-------o
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* o-------o-------o-------o-------o
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* |       |       |       |       |
* o-------o-------o-------o-------o
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* o-------o-------o.......o.......o
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* |       |       |       :       |
* o-------o-------o-------o-------o
* </pre><p> by moving the refinement flag to the indicated element.</p>
<p>Default value is false. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00844">844</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8h_source.html#l00951">enforce_mismatch_limit_prior_to_refinement()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00126">limit_level_mismatch_at_edge()</a>, and <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">limit_level_mismatch_at_node()</a>.</p>

</div>
</div>
<a id="a56f1015a59736175b39e4a1ca4d084bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56f1015a59736175b39e4a1ca4d084bc">&#9670;&nbsp;</a></span>_face_level_mismatch_limit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char libMesh::MeshRefinement::_face_level_mismatch_limit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00769">769</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00607">coarsen_elements()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00912">face_level_mismatch_limit()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00682">refine_elements()</a>.</p>

</div>
</div>
<a id="a80ebcf25e84315a95e59128b57c5834f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80ebcf25e84315a95e59128b57c5834f">&#9670;&nbsp;</a></span>_max_h_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::MeshRefinement::_max_h_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00761">761</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00568">flag_elements_by_mean_stddev()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00888">max_h_level()</a>.</p>

</div>
</div>
<a id="a6df23471791e621cfeb7a7828c8c73a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df23471791e621cfeb7a7828c8c73a2">&#9670;&nbsp;</a></span>_mesh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a>&amp; libMesh::MeshRefinement::_mesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reference to the mesh. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00742">742</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01335">_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01461">_refine_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00210">add_elem()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00141">add_node()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00654">add_p_to_h_refinement()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00662">clean_refinement_flags()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00607">coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00219">create_parent_error_vector()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00380">eliminate_unrefined_patches()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00568">flag_elements_by_mean_stddev()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00324">get_mesh()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01805">has_topological_neighbor()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00126">limit_level_mismatch_at_edge()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">limit_level_mismatch_at_node()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00255">limit_overrefined_boundary()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00316">limit_underrefined_boundary()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">make_flags_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00475">refine_and_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00682">refine_elements()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00635">switch_h_to_p_refinement()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00352">test_level_one()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00427">test_unflagged()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01789">topological_neighbor()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01701">uniformly_coarsen()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01661">uniformly_p_coarsen()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01647">uniformly_p_refine()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01676">uniformly_refine()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00345">update_nodes_map()</a>.</p>

</div>
</div>
<a id="a7ac4703621b5298120f5028c99bd94de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ac4703621b5298120f5028c99bd94de">&#9670;&nbsp;</a></span>_nelem_target</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::MeshRefinement::_nelem_target</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00765">765</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00900">nelem_target()</a>.</p>

</div>
</div>
<a id="a668c8ef9154f08b469eb9d90dd2074d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668c8ef9154f08b469eb9d90dd2074d1">&#9670;&nbsp;</a></span>_new_nodes_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1TopologyMap.html">TopologyMap</a> libMesh::MeshRefinement::_new_nodes_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure that holds the new nodes information. </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00737">737</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l00141">add_node()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00134">clear()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l00345">update_nodes_map()</a>.</p>

</div>
</div>
<a id="ae794162fe8b50db70bb236ef9cbe68ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae794162fe8b50db70bb236ef9cbe68ab">&#9670;&nbsp;</a></span>_node_level_mismatch_limit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char libMesh::MeshRefinement::_node_level_mismatch_limit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00771">771</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00922">node_level_mismatch_limit()</a>.</p>

</div>
</div>
<a id="a4a4151995d4be05f4d7bf890b1e3234b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a4151995d4be05f4d7bf890b1e3234b">&#9670;&nbsp;</a></span>_overrefined_boundary_limit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">signed char libMesh::MeshRefinement::_overrefined_boundary_limit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00773">773</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00927">overrefined_boundary_limit()</a>.</p>

</div>
</div>
<a id="a47a409d8f3852a859271fafc5b466bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a409d8f3852a859271fafc5b466bb8">&#9670;&nbsp;</a></span>_periodic_boundaries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a>* libMesh::MeshRefinement::_periodic_boundaries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00861">861</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01805">has_topological_neighbor()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">make_coarsening_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01159">make_refinement_compatible()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00352">test_level_one()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01789">topological_neighbor()</a>.</p>

</div>
</div>
<a id="af56d90ecbcb73303903c0e298eea13ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af56d90ecbcb73303903c0e298eea13ec">&#9670;&nbsp;</a></span>_refine_fraction</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> libMesh::MeshRefinement::_refine_fraction</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00757">757</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00166">flag_elements_by_error_tolerance()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00568">flag_elements_by_mean_stddev()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00229">flag_elements_by_nelem_target()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00876">refine_fraction()</a>.</p>

</div>
</div>
<a id="a1ee86268abe102ac27effa05bbf6fa15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee86268abe102ac27effa05bbf6fa15">&#9670;&nbsp;</a></span>_underrefined_boundary_limit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">signed char libMesh::MeshRefinement::_underrefined_boundary_limit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00774">774</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01592">_smooth_flags()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00932">underrefined_boundary_limit()</a>.</p>

</div>
</div>
<a id="acdeef5e2ff1463f80d57bd343f5ce0f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdeef5e2ff1463f80d57bd343f5ce0f6">&#9670;&nbsp;</a></span>_use_member_parameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::MeshRefinement::_use_member_parameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>For backwards compatibility, we initialize this as false and then set it to true if the user uses any of the refinement parameter accessor functions </p>

<p class="definition">Definition at line <a class="el" href="mesh__refinement_8h_source.html#l00749">749</a> of file <a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mesh__refinement_8h_source.html#l00906">absolute_global_tolerance()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00870">coarsen_by_parents()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00882">coarsen_fraction()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00894">coarsen_threshold()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00434">flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00044">flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00568">flag_elements_by_mean_stddev()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00888">max_h_level()</a>, <a class="el" href="mesh__refinement_8h_source.html#l00900">nelem_target()</a>, and <a class="el" href="mesh__refinement_8h_source.html#l00876">refine_fraction()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="mesh__refinement_8h_source.html">mesh_refinement.h</a></li>
<li><a class="el" href="mesh__refinement_8C_source.html">mesh_refinement.C</a></li>
<li><a class="el" href="mesh__refinement__flagging_8C_source.html">mesh_refinement_flagging.C</a></li>
<li><a class="el" href="mesh__refinement__smoothing_8C_source.html">mesh_refinement_smoothing.C</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
generated by <a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a>
</small></address>
<!-- dynamic header stuff -->
<script type="text/javascript">
$(document).ready(function(){
  $(window).on('scroll',function() {
    var scrolltop = $(this).scrollTop();
    if(scrolltop >= 215) {
      $('#fixedbar').fadeIn(250);
    }
    else if(scrolltop <= 210) {
      $('#fixedbar').fadeOut(250);
    }
  });
});
</script>
<!-- Google Analytics stuff -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24978333-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
