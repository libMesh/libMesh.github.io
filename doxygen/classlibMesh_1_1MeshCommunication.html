<!-- HTML header for doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libMesh: libMesh::MeshCommunication Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="../styles.css" rel="stylesheet" type="text/css" />
<link href="doxygen_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <nav id="fixedbar">
    <ul id="fixednav">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../support.html">About Us</a></li>
      <li><a href="../publications.html">Publications</a></li>
      <li><a href="../developers.html">Developers</a></li>
      <li><a href="../installation.html">Installation</a></li>
      <li><a href="../examples.html">Examples</a></li>
      <li><a href="../doxygen/index.html">Documentation</a></li>
    </ul>
  </nav>
  <div id="w">
    <header id="logo"><a href="index.html"><span id="logobg">SomeWebsiteLogo</span></a></header>
    <nav id="navigation">
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../support.html">About Us</a></li>
        <li><a href="../publications.html">Publications</a></li>
        <li><a href="../developers.html">Developers</a></li>
        <li><a href="../installation.html">Installation</a></li>
        <li><a href="../examples.html">Examples</a></li>
        <li><a href="../doxygen/index.html">Documentation</a></li>
      </ul>
    </nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <\!--BEGIN TITLEAREA-\-> -->
<!-- <div id="titlearea"> -->
<!-- <table cellspacing="0" cellpadding="0"> -->
<!--  <tbody> -->
<!--  <tr style="height: 56px;"> -->
<!--   <\!--BEGIN PROJECT_LOGO-\-> -->
<!--   <td id="projectlogo"><img alt="Logo" src=""/></td> -->
<!--   <\!--END PROJECT_LOGO-\-> -->
<!--   <\!--BEGIN PROJECT_NAME-\-> -->
<!--   <td style="padding-left: 0.5em;"> -->
<!--    <div id="projectname">libMesh -->
<!--    <\!--BEGIN PROJECT_NUMBER-\->&#160;<span id="projectnumber"></span><\!--END PROJECT_NUMBER-\-> -->
<!--    </div> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-><div id="projectbrief"></div><\!--END PROJECT_BRIEF-\-> -->
<!--   </td> -->
<!--   <\!--END PROJECT_NAME-\-> -->
<!--   <\!--BEGIN !PROJECT_NAME-\-> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-> -->
<!--     <td style="padding-left: 0.5em;"> -->
<!--     <div id="projectbrief"></div> -->
<!--     </td> -->
<!--    <\!--END PROJECT_BRIEF-\-> -->
<!--   <\!--END !PROJECT_NAME-\-> -->
<!--   <\!--BEGIN DISABLE_INDEX-\-> -->
<!--    <\!--BEGIN SEARCHENGINE-\-> -->
<!--    <td></td> -->
<!--    <\!--END SEARCHENGINE-\-> -->
<!--   <\!--END DISABLE_INDEX-\-> -->
<!--  </tr> -->
<!--  </tbody> -->
<!-- </table> -->
<!-- </div> -->
<!-- <\!--END TITLEAREA-\-> -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1MeshCommunication.html">MeshCommunication</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classlibMesh_1_1MeshCommunication-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::MeshCommunication Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="mesh__communication_8h_source.html">mesh_communication.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af7a9fe6fa2f8d820a0772e6ce73f0990"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#af7a9fe6fa2f8d820a0772e6ce73f0990">MeshCommunication</a> ()</td></tr>
<tr class="separator:af7a9fe6fa2f8d820a0772e6ce73f0990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e700d5cae2559747f64283dfc2ad81c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a7e700d5cae2559747f64283dfc2ad81c">~MeshCommunication</a> ()</td></tr>
<tr class="separator:a7e700d5cae2559747f64283dfc2ad81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a227f46dad6159d846d8e6c90a9cfe3cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a227f46dad6159d846d8e6c90a9cfe3cb">clear</a> ()</td></tr>
<tr class="separator:a227f46dad6159d846d8e6c90a9cfe3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d0275f5567a8253e3b10fa0d39a623"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#ab9d0275f5567a8253e3b10fa0d39a623">broadcast</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;) const </td></tr>
<tr class="separator:ab9d0275f5567a8253e3b10fa0d39a623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64195de35a3f834f9393aad8b6ca1be2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a64195de35a3f834f9393aad8b6ca1be2">redistribute</a> (<a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;) const </td></tr>
<tr class="separator:a64195de35a3f834f9393aad8b6ca1be2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5bcfce3b9a9daccb4abb795a0638e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a1b5bcfce3b9a9daccb4abb795a0638e0">gather_neighboring_elements</a> (<a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;) const </td></tr>
<tr class="separator:a1b5bcfce3b9a9daccb4abb795a0638e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5debc4e227d535b0f42f295edbaff199"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a5debc4e227d535b0f42f295edbaff199">gather</a> (const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> root_id, <a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;) const </td></tr>
<tr class="separator:a5debc4e227d535b0f42f295edbaff199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada889431c0c7443feca0dbb4389a03b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#ada889431c0c7443feca0dbb4389a03b6">allgather</a> (<a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;<a class="el" href="mesh__refinement_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>) const </td></tr>
<tr class="separator:ada889431c0c7443feca0dbb4389a03b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a0107f13a8af6e904a6067b19d4f5be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a4a0107f13a8af6e904a6067b19d4f5be">delete_remote_elements</a> (<a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;, const std::set&lt; <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> * &gt; &amp;) const </td></tr>
<tr class="separator:a4a0107f13a8af6e904a6067b19d4f5be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac07c8ba8aee328c186d853666dca4aa0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#ac07c8ba8aee328c186d853666dca4aa0">assign_global_indices</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;) const </td></tr>
<tr class="separator:ac07c8ba8aee328c186d853666dca4aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ea7ecf5b4741e026b46f09204c121f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a19ea7ecf5b4741e026b46f09204c121f">check_for_duplicate_global_indices</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;) const </td></tr>
<tr class="separator:a19ea7ecf5b4741e026b46f09204c121f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8e5bab57f0a189fe4b05185b3c2aec"><td class="memTemplParams" colspan="2">template&lt;typename ForwardIterator &gt; </td></tr>
<tr class="memitem:a0b8e5bab57f0a189fe4b05185b3c2aec"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a0b8e5bab57f0a189fe4b05185b3c2aec">find_global_indices</a> (const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;<a class="el" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>, const <a class="el" href="classlibMesh_1_1MeshTools_1_1BoundingBox.html">MeshTools::BoundingBox</a> &amp;, const ForwardIterator &amp;, const ForwardIterator &amp;, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;) const </td></tr>
<tr class="separator:a0b8e5bab57f0a189fe4b05185b3c2aec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a737da6ee13b781ac7aef37851a99af58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a737da6ee13b781ac7aef37851a99af58">make_elems_parallel_consistent</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:a737da6ee13b781ac7aef37851a99af58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eb166973b14e95ae36c14a39105907a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a9eb166973b14e95ae36c14a39105907a">make_p_levels_parallel_consistent</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:a9eb166973b14e95ae36c14a39105907a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0eae4e562c489db701776c3970e772b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#ab0eae4e562c489db701776c3970e772b">make_node_ids_parallel_consistent</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:ab0eae4e562c489db701776c3970e772b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e83bbe1c114c9de7be87927f7db9e85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#a0e83bbe1c114c9de7be87927f7db9e85">make_node_unique_ids_parallel_consistent</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:a0e83bbe1c114c9de7be87927f7db9e85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab67880939a7d98e9cb3e7a6425a4d7ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#ab67880939a7d98e9cb3e7a6425a4d7ec">make_node_proc_ids_parallel_consistent</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:ab67880939a7d98e9cb3e7a6425a4d7ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac76dd6bc5f023e8836591ca42a9caa94"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1MeshCommunication.html#ac76dd6bc5f023e8836591ca42a9caa94">make_nodes_parallel_consistent</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;)</td></tr>
<tr class="separator:ac76dd6bc5f023e8836591ca42a9caa94"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the <code><a class="el" href="classlibMesh_1_1MeshCommunication.html">MeshCommunication</a></code> class. It handles all the details of communicating mesh information from one processor to another. All parallelization of the <code><a class="el" href="classlibMesh_1_1Mesh.html">Mesh</a></code> data structures is done via this class.</p>
<dl class="section author"><dt>Author</dt><dd>Benjamin S. Kirk </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2003 </dd></dl>

<p>Definition at line <a class="el" href="mesh__communication_8h_source.html#l00046">46</a> of file <a class="el" href="mesh__communication_8h_source.html">mesh_communication.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af7a9fe6fa2f8d820a0772e6ce73f0990"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::MeshCommunication::MeshCommunication </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor. </p>

<p>Definition at line <a class="el" href="mesh__communication_8h_source.html#l00053">53</a> of file <a class="el" href="mesh__communication_8h_source.html">mesh_communication.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7e700d5cae2559747f64283dfc2ad81c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::MeshCommunication::~MeshCommunication </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor. </p>

<p>Definition at line <a class="el" href="mesh__communication_8h_source.html#l00058">58</a> of file <a class="el" href="mesh__communication_8h_source.html">mesh_communication.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ada889431c0c7443feca0dbb4389a03b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::allgather </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method takes an input <code><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a></code> which may be distributed among all the processors. Each processor then sends its local nodes and elements to the other processors. The end result is that a previously distributed <code><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a></code> will be serialized on each processor. Since this method is collective it must be called by all processors. </p>

<p>Definition at line <a class="el" href="mesh__communication_8h_source.html#l00121">121</a> of file <a class="el" href="mesh__communication_8h_source.html">mesh_communication.h</a>.</p>

<p>References <a class="el" href="mesh__communication_8C_source.html#l00834">gather()</a>, and <a class="el" href="dof__object_8h_source.html#l00346">libMesh::DofObject::invalid_processor_id</a>.</p>

<p>Referenced by <a class="el" href="parallel__mesh_8C_source.html#l01456">libMesh::ParallelMesh::allgather()</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  { <a class="code" href="classlibMesh_1_1MeshCommunication.html#a5debc4e227d535b0f42f295edbaff199">MeshCommunication::gather</a>(<a class="code" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a>, <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>); }</div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l00924">mesh_communication.C:924</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshCommunication_html_a5debc4e227d535b0f42f295edbaff199"><div class="ttname"><a href="classlibMesh_1_1MeshCommunication.html#a5debc4e227d535b0f42f295edbaff199">libMesh::MeshCommunication::gather</a></div><div class="ttdeci">void gather(const processor_id_type root_id, ParallelMesh &amp;) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l00834">mesh_communication.C:834</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_aa65deab833c8b1802790cd43ab1b6ee4"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">libMesh::DofObject::invalid_processor_id</a></div><div class="ttdeci">static const processor_id_type invalid_processor_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00346">dof_object.h:346</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac07c8ba8aee328c186d853666dca4aa0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::assign_global_indices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method assigns globally unique, partition-agnostic indices to the nodes and elements in the mesh. The approach is to compute the <a class="el" href="namespaceHilbert.html">Hilbert</a> space-filling curve key and use its value to assign an index in [0,N_global). Since the <a class="el" href="namespaceHilbert.html">Hilbert</a> key is unique for each spatial location, two objects occupying the same location will be assigned the same global id. Thus, this method can also be useful for identifying duplicate nodes which may occur during parallel refinement. </p>

<p>Definition at line <a class="el" href="mesh__communication__global__indices_8C_source.html#l00171">171</a> of file <a class="el" href="mesh__communication__global__indices_8C_source.html">mesh_communication_global_indices.C</a>.</p>

<p>References <a class="el" href="parallel__implementation_8h_source.html#l02975">libMesh::Parallel::Communicator::allgather()</a>, <a class="el" href="parallel__sort_8C_source.html#l00376">libMesh::Parallel::Sort&lt; KeyType, IdxType &gt;::bin()</a>, <a class="el" href="mesh__tools_8C_source.html#l00417">libMesh::MeshTools::bounding_box()</a>, <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">libMesh::communicator</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end()</a>, <a class="el" href="variant__filter__iterator_8h_source.html#l00334">end</a>, <a class="el" href="libmesh__common_8h_source.html#l00235">libMesh::err</a>, <a class="el" href="mesh__generation_8C_source.html#l00068">libMesh::MeshTools::Generation::Private::idx()</a>, <a class="el" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">libMesh::MeshBase::local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">libMesh::MeshBase::local_elements_end()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">libMesh::MeshBase::local_nodes_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ad0daaecd9c183194a99609db6507198c">libMesh::MeshBase::local_nodes_end()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a190e556d3be87f5ccd8d4fc98d1779d3">libMesh::MeshBase::n_elem()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5b76b109bc6bd087c981774897aa6167">libMesh::MeshBase::n_nodes()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">libMesh::MeshBase::nodes_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a47575077b6ad40d4f05292634f7615f8">libMesh::MeshBase::nodes_end()</a>, <a class="el" href="threads__none_8h_source.html#l00069">libMesh::Threads::parallel_for()</a>, <a class="el" href="parallel_8h_source.html#l00672">libMesh::Parallel::Communicator::rank()</a>, <a class="el" href="parallel__implementation_8h_source.html#l02722">libMesh::Parallel::Communicator::send_receive()</a>, <a class="el" href="dof__object_8h_source.html#l00628">libMesh::DofObject::set_id()</a>, <a class="el" href="parallel_8h_source.html#l00674">libMesh::Parallel::Communicator::size()</a>, <a class="el" href="parallel__sort_8C_source.html#l00058">libMesh::Parallel::Sort&lt; KeyType, IdxType &gt;::sort()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, and <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>.</p>

<p>Referenced by <a class="el" href="mesh__tools_8C_source.html#l01640">libMesh::MeshTools::Private::globally_renumber_nodes_and_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;assign_global_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// This method determines partition-agnostic global indices</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// for nodes and elements.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// Algorithm:</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// (1) compute the Hilbert key for each local node/element</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// (2) perform a parallel sort of the Hilbert key</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// (3) get the min/max value on each processor</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// (4) determine the position in the global ranking for</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">//     each local object</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp; <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a> (mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// Global bounding box</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="classlibMesh_1_1MeshTools_1_1BoundingBox.html">MeshTools::BoundingBox</a> bbox =</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="namespacelibMesh_1_1MeshTools.html#ab099ca10b8e0521017c6d28644b88135">MeshTools::bounding_box</a> (mesh);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// (1) compute Hilbert keys</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  std::vector&lt;Parallel::DofObjectKey&gt;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    node_keys, elem_keys;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// Nodes first</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <a class="code" href="classlibMesh_1_1StoredRange.html">ConstNodeRange</a> nr (mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">local_nodes_begin</a>(),</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                         mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ad0daaecd9c183194a99609db6507198c">local_nodes_end</a>());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      node_keys.resize (nr.size());</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a> (nr, ComputeHilbertKeys (bbox, node_keys));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="comment">// It&#39;s O(N^2) to check that these keys don&#39;t duplicate before the</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">// sort...</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">MeshBase::const_node_iterator</a> nodei = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">local_nodes_begin</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">for</span> (std::size_t i = 0; i != node_keys.size(); ++i, ++nodei)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <a class="code" href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">MeshBase::const_node_iterator</a> nodej = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">local_nodes_begin</a>();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keywordflow">for</span> (std::size_t j = 0; j != i; ++j, ++nodej)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;              <span class="keywordflow">if</span> (node_keys[i] == node_keys[j])</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                  CFixBitVec icoords[3], jcoords[3];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                  get_hilbert_coords(**nodej, bbox, jcoords);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    <span class="stringliteral">&quot;node &quot;</span> &lt;&lt; (*nodej)-&gt;id() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    *(<a class="code" href="classlibMesh_1_1Point.html">Point</a> *)(*nodej) &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    node_keys[j] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                  get_hilbert_coords(**nodei, bbox, icoords);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    <span class="stringliteral">&quot;node &quot;</span> &lt;&lt; (*nodei)-&gt;id() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    *(<a class="code" href="classlibMesh_1_1Point.html">Point</a> *)(*nodei) &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    node_keys[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                  libmesh_error_msg(<span class="stringliteral">&quot;Error: nodes with duplicate Hilbert keys!&quot;</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// Elements next</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="classlibMesh_1_1StoredRange.html">ConstElemRange</a> er (mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">local_elements_begin</a>(),</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                         mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">local_elements_end</a>());</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      elem_keys.resize (er.size());</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a> (er, ComputeHilbertKeys (bbox, elem_keys));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">// For elements, the keys can be (and in the case of TRI, are</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">// expected to be) duplicates, but only if the elements are at</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">// different levels</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> elemi = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">local_elements_begin</a>();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">for</span> (std::size_t i = 0; i != elem_keys.size(); ++i, ++elemi)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> elemj = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">local_elements_begin</a>();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <span class="keywordflow">for</span> (std::size_t j = 0; j != i; ++j, ++elemj)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              <span class="keywordflow">if</span> ((elem_keys[i] == elem_keys[j]) &amp;&amp;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                  ((*elemi)-&gt;level() == (*elemj)-&gt;level()))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    <span class="stringliteral">&quot;level &quot;</span> &lt;&lt; (*elemj)-&gt;level() &lt;&lt; <span class="stringliteral">&quot; elem\n&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    (**elemj) &lt;&lt; <span class="stringliteral">&quot; centroid &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    (*elemj)-&gt;centroid() &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    elem_keys[j] &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    get_hilbert_index((*elemj), bbox) &lt;&lt;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    std::endl;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    <span class="stringliteral">&quot;level &quot;</span> &lt;&lt; (*elemi)-&gt;level() &lt;&lt; <span class="stringliteral">&quot; elem\n&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    (**elemi) &lt;&lt; <span class="stringliteral">&quot; centroid &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    (*elemi)-&gt;centroid() &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    elem_keys[i] &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    get_hilbert_index((*elemi), bbox) &lt;&lt;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    std::endl;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                  libmesh_error_msg(<span class="stringliteral">&quot;Error: level &quot;</span> &lt;&lt; (*elemi)-&gt;level() &lt;&lt; <span class="stringliteral">&quot; elements with duplicate Hilbert keys!&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  } <span class="comment">// done computing Hilbert keys</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// (2) parallel sort the Hilbert keys</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="classlibMesh_1_1Parallel_1_1Sort.html">Parallel::Sort&lt;Parallel::DofObjectKey&gt;</a> node_sorter (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                                      node_keys);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  node_sorter.sort(); <span class="comment">/* done with node_keys */</span> <span class="comment">//node_keys.clear();</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keyword">const</span> std::vector&lt;Parallel::DofObjectKey&gt; &amp; my_node_bin =</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    node_sorter.bin();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classlibMesh_1_1Parallel_1_1Sort.html">Parallel::Sort&lt;Parallel::DofObjectKey&gt;</a> elem_sorter (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                                      elem_keys);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  elem_sorter.sort(); <span class="comment">/* done with elem_keys */</span> <span class="comment">//elem_keys.clear();</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">const</span> std::vector&lt;Parallel::DofObjectKey&gt; &amp; my_elem_bin =</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    elem_sorter.bin();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// (3) get the max value on each processor</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  std::vector&lt;Parallel::DofObjectKey&gt;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    node_upper_bounds(<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>()),</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    elem_upper_bounds(<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  { <span class="comment">// limit scope of temporaries</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    std::vector&lt;Parallel::DofObjectKey&gt; recvbuf(2*<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    std::vector&lt;unsigned short int&gt; <span class="comment">/* do not use a vector of bools here since it is not always so! */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      empty_nodes (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>()),</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      empty_elem  (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    std::vector&lt;Parallel::DofObjectKey&gt; my_max(2);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">allgather</a> (static_cast&lt;unsigned short int&gt;(my_node_bin.empty()), empty_nodes);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">allgather</a> (static_cast&lt;unsigned short int&gt;(my_elem_bin.empty()),  empty_elem);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (!my_node_bin.empty()) my_max[0] = my_node_bin.back();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (!my_elem_bin.empty()) my_max[1] = my_elem_bin.back();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">allgather</a> (my_max, <span class="comment">/* identical_buffer_sizes = */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// Be cereful here.  The *_upper_bounds will be used to find the processor</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// a given object belongs to.  So, if a processor contains no objects (possible!)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// then copy the bound from the lower processor id.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> p=0; p&lt;<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); p++)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        node_upper_bounds[p] = my_max[2*p+0];</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        elem_upper_bounds[p] = my_max[2*p+1];</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">if</span> (p &gt; 0) <span class="comment">// default hilbert index value is the OK upper bound for processor 0.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">if</span> (empty_nodes[p]) node_upper_bounds[p] = node_upper_bounds[p-1];</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">if</span> (empty_elem[p])  elem_upper_bounds[p] = elem_upper_bounds[p-1];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// (4) determine the position in the global ranking for</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">//     each local object</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">//----------------------------------------------</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// Nodes first -- all nodes, not just local ones</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      std::vector&lt;std::vector&lt;Parallel::DofObjectKey&gt; &gt;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        requested_ids (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="comment">// Results to gather from each processor</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      std::vector&lt;std::vector&lt;dof_id_type&gt; &gt;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        filled_request (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">MeshBase::const_node_iterator</a>       it  = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">nodes_begin</a>();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keyword">const</span> <a class="code" href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">MeshBase::const_node_iterator</a> <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a> = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a47575077b6ad40d4f05292634f7615f8">nodes_end</a>();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">// build up list of requests</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">for</span> (; it != <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>; ++it)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Node.html">Node</a> * node = (*it);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(node);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> hi =</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;              get_hilbert_index (node, bbox);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid =</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;              cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;              (std::distance (node_upper_bounds.begin(),</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                              std::lower_bound(node_upper_bounds.begin(),</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                               node_upper_bounds.end(),</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                               hi)));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            libmesh_assert_less (pid, <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            requested_ids[pid].push_back(hi);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="comment">// The number of objects in my_node_bin on each processor</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      std::vector&lt;dof_id_type&gt; node_bin_sizes(<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">allgather</a> (static_cast&lt;dof_id_type&gt;(my_node_bin.size()), node_bin_sizes);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">// The offset of my first global index</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_offset = 0;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid=0; pid&lt;<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>(); pid++)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        my_offset += node_bin_sizes[pid];</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">// start with pid=0, so that we will trade with ourself</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid=0; pid&lt;<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); pid++)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <span class="comment">// Trade my requests with processor procup and procdown</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> procup = cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            ((<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>() + pid) % <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> procdown = cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            ((<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>() + <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>() - pid) %</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;             <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          std::vector&lt;Parallel::DofObjectKey&gt; request_to_fill;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">send_receive</a>(procup, requested_ids[procup],</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                    procdown, request_to_fill);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          <span class="comment">// Fill the requests</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          std::vector&lt;dof_id_type&gt; global_ids;  global_ids.reserve(request_to_fill.size());</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          <span class="keywordflow">for</span> (std::size_t <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>=0; <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>&lt;request_to_fill.size(); <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>++)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> &amp; hi = request_to_fill[<a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>];</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;              libmesh_assert_less_equal (hi, node_upper_bounds[<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>()]);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;              <span class="comment">// find the requested index in my node bin</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;              std::vector&lt;Parallel::DofObjectKey&gt;::const_iterator pos =</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                std::lower_bound (my_node_bin.begin(), my_node_bin.end(), hi);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;              <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (pos != my_node_bin.end());</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;              libmesh_assert_equal_to (*pos, hi);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;              <span class="comment">// Finally, assign the global index based off the position of the index</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;              <span class="comment">// in my array, properly offset.</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;              global_ids.push_back(cast_int&lt;dof_id_type&gt;(std::distance(my_node_bin.begin(), pos) + my_offset));</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          <span class="comment">// and trade back</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">send_receive</a> (procdown, global_ids,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                     procup,   filled_request[procup]);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">// We now have all the filled requests, so we can loop through our</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">// nodes once and assign the global index to each one.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        std::vector&lt;std::vector&lt;dof_id_type&gt;::const_iterator&gt;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;          next_obj_on_proc; next_obj_on_proc.reserve(<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid=0; pid&lt;<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); pid++)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          next_obj_on_proc.push_back(filled_request[pid].begin());</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;          <a class="code" href="structlibMesh_1_1MeshBase_1_1node__iterator.html">MeshBase::node_iterator</a>       it  = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">nodes_begin</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          <span class="keyword">const</span> <a class="code" href="structlibMesh_1_1MeshBase_1_1node__iterator.html">MeshBase::node_iterator</a> end = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a47575077b6ad40d4f05292634f7615f8">nodes_end</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          <span class="keywordflow">for</span> (; it != <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>; ++it)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;              <a class="code" href="classlibMesh_1_1Node.html">Node</a> * node = (*it);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;              <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(node);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> hi =</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                get_hilbert_index (node, bbox);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid =</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                (std::distance (node_upper_bounds.begin(),</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                std::lower_bound(node_upper_bounds.begin(),</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                 node_upper_bounds.end(),</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                 hi)));</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;              libmesh_assert_less (pid, <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;              <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (next_obj_on_proc[pid] != filled_request[pid].<a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>());</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> global_index = *next_obj_on_proc[pid];</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;              libmesh_assert_less (global_index, mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b76b109bc6bd087c981774897aa6167">n_nodes</a>());</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;              node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a7efffd05f7f97d503c12c0cbf8fb9862">set_id</a>() = global_index;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;              ++next_obj_on_proc[pid];</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">//---------------------------------------------------</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// elements next -- all elements, not just local ones</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      std::vector&lt;std::vector&lt;Parallel::DofObjectKey&gt; &gt;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        requested_ids (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="comment">// Results to gather from each processor</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      std::vector&lt;std::vector&lt;dof_id_type&gt; &gt;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        filled_request (<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a>       it  = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">elements_begin</a>();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keyword">const</span> <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> end = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">elements_end</a>();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">for</span> (; it != <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>; ++it)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = (*it);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(elem);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> hi =</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              get_hilbert_index (elem, bbox);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid =</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;              cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;              (std::distance (elem_upper_bounds.begin(),</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                              std::lower_bound(elem_upper_bounds.begin(),</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                               elem_upper_bounds.end(),</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                               hi)));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            libmesh_assert_less (pid, <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            requested_ids[pid].push_back(hi);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;          }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="comment">// The number of objects in my_elem_bin on each processor</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      std::vector&lt;dof_id_type&gt; elem_bin_sizes(<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">allgather</a> (static_cast&lt;dof_id_type&gt;(my_elem_bin.size()), elem_bin_sizes);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="comment">// The offset of my first global index</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_offset = 0;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid=0; pid&lt;<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>(); pid++)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        my_offset += elem_bin_sizes[pid];</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">// start with pid=0, so that we will trade with ourself</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid=0; pid&lt;<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); pid++)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          <span class="comment">// Trade my requests with processor procup and procdown</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> procup = cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            ((<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>() + pid) % <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> procdown = cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            ((<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>() + <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>() - pid) %</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;             <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          std::vector&lt;Parallel::DofObjectKey&gt; request_to_fill;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">send_receive</a>(procup, requested_ids[procup],</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                    procdown, request_to_fill);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;          <span class="comment">// Fill the requests</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;          std::vector&lt;dof_id_type&gt; global_ids;  global_ids.reserve(request_to_fill.size());</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          <span class="keywordflow">for</span> (std::size_t <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>=0; <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>&lt;request_to_fill.size(); <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>++)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> &amp; hi = request_to_fill[<a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>];</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;              libmesh_assert_less_equal (hi, elem_upper_bounds[<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>()]);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;              <span class="comment">// find the requested index in my elem bin</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;              std::vector&lt;Parallel::DofObjectKey&gt;::const_iterator pos =</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                std::lower_bound (my_elem_bin.begin(), my_elem_bin.end(), hi);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;              <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (pos != my_elem_bin.end());</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;              libmesh_assert_equal_to (*pos, hi);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="comment">// Finally, assign the global index based off the position of the index</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;              <span class="comment">// in my array, properly offset.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              global_ids.push_back (cast_int&lt;dof_id_type&gt;(std::distance(my_elem_bin.begin(), pos) + my_offset));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          <span class="comment">// and trade back</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">send_receive</a> (procdown, global_ids,</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                     procup,   filled_request[procup]);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">// We now have all the filled requests, so we can loop through our</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="comment">// elements once and assign the global index to each one.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        std::vector&lt;std::vector&lt;dof_id_type&gt;::const_iterator&gt;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          next_obj_on_proc; next_obj_on_proc.reserve(<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid=0; pid&lt;<a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); pid++)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          next_obj_on_proc.push_back(filled_request[pid].begin());</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <a class="code" href="structlibMesh_1_1MeshBase_1_1element__iterator.html">MeshBase::element_iterator</a>       it  = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">elements_begin</a>();</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <span class="keyword">const</span> <a class="code" href="structlibMesh_1_1MeshBase_1_1element__iterator.html">MeshBase::element_iterator</a> end = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">elements_end</a>();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          <span class="keywordflow">for</span> (; it != <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>; ++it)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;              <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = (*it);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;              <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(elem);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> hi =</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                get_hilbert_index (elem, bbox);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid =</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                (std::distance (elem_upper_bounds.begin(),</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                std::lower_bound(elem_upper_bounds.begin(),</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                 elem_upper_bounds.end(),</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                                 hi)));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;              libmesh_assert_less (pid, <a class="code" href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;              <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (next_obj_on_proc[pid] != filled_request[pid].<a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>());</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> global_index = *next_obj_on_proc[pid];</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;              libmesh_assert_less (global_index, mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a190e556d3be87f5ccd8d4fc98d1779d3">n_elem</a>());</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;              elem-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#a7efffd05f7f97d503c12c0cbf8fb9862">set_id</a>() = global_index;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;              ++next_obj_on_proc[pid];</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;assign_global_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}</div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1element__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1element__iterator.html">libMesh::MeshBase::element_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01133">mesh_base.h:1133</a></div></div>
<div class="ttc" id="classlibMesh_1_1Node_html"><div class="ttname"><a href="classlibMesh_1_1Node.html">libMesh::Node</a></div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00053">node.h:53</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html">libMesh::Parallel::Communicator</a></div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00606">parallel.h:606</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ac03a5d846eeb24a13168f6b5358f86e3"><div class="ttname"><a href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(remote_elem)</div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3eca1f7abf02a11e5812b08b1d65f80b"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">unsigned int size() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00674">parallel.h:674</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_a97dcd01ff677ad850c3c9f6d8380dba2"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">libMesh::Threads::parallel_for</a></div><div class="ttdeci">void parallel_for(const Range &amp;range, const Body &amp;body)</div><div class="ttdef"><b>Definition:</b> <a href="threads__none_8h_source.html#l00069">threads_none.h:69</a></div></div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1const__element__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">libMesh::MeshBase::const_element_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01152">mesh_base.h:1152</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_aefbe7c94fa1895557e56fdc001710b16"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">libMesh::Parallel::DofObjectKey</a></div><div class="ttdeci">std::pair&lt; Hilbert::HilbertIndices, unique_id_type &gt; DofObjectKey</div><div class="ttdef"><b>Definition:</b> <a href="parallel__hilbert_8h_source.html#l00068">parallel_hilbert.h:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5b67c2aa94e76310a6db3470cce8ef11"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">libMesh::MeshBase::local_elements_begin</a></div><div class="ttdeci">virtual element_iterator local_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html"><div class="ttname"><a href="classlibMesh_1_1Elem.html">libMesh::Elem</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l00091">elem.h:91</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa22684eb6ec167d72352d47ffedd9afb"><div class="ttname"><a href="namespacelibMesh.html#aa22684eb6ec167d72352d47ffedd9afb">libMesh::communicator</a></div><div class="ttdeci">Parallel::Communicator communicator(comm)</div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a785f0bd261d7bd1918b031c5133da2b9"><div class="ttname"><a href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a></div><div class="ttdeci">IterBase * end</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00334">variant_filter_iterator.h:334</a></div></div>
<div class="ttc" id="classlibMesh_1_1StoredRange_html"><div class="ttname"><a href="classlibMesh_1_1StoredRange.html">libMesh::StoredRange</a></div><div class="ttdef"><b>Definition:</b> <a href="stored__range_8h_source.html#l00051">stored_range.h:51</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshTools_1_1BoundingBox_html"><div class="ttname"><a href="classlibMesh_1_1MeshTools_1_1BoundingBox.html">libMesh::MeshTools::BoundingBox</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8h_source.html#l00064">mesh_tools.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_a7efffd05f7f97d503c12c0cbf8fb9862"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#a7efffd05f7f97d503c12c0cbf8fb9862">libMesh::DofObject::set_id</a></div><div class="ttdeci">dof_id_type &amp; set_id()</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00628">dof_object.h:628</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a3ab1d28a6ea1e8028ce0c06e11cfb68d"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">libMesh::MeshBase::nodes_begin</a></div><div class="ttdeci">virtual node_iterator nodes_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac266e1f5eb6ac9566ccbd7e6add6c239"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin</a></div><div class="ttdeci">virtual element_iterator elements_begin()=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_ab099ca10b8e0521017c6d28644b88135"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#ab099ca10b8e0521017c6d28644b88135">libMesh::MeshTools::bounding_box</a></div><div class="ttdeci">BoundingBox bounding_box(const MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l00417">mesh_tools.C:417</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ad0daaecd9c183194a99609db6507198c"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ad0daaecd9c183194a99609db6507198c">libMesh::MeshBase::local_nodes_end</a></div><div class="ttdeci">virtual node_iterator local_nodes_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae94f1bce0dc50c489c6bae9ba64d06e8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end</a></div><div class="ttdeci">virtual element_iterator elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ab8bd839216a1ef9c0912d523b68ae136"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">libMesh::MeshBase::local_elements_end</a></div><div class="ttdeci">virtual element_iterator local_elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a74e5bc8a72d210b3d87b0221b1f69db1"><div class="ttname"><a href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a></div><div class="ttdeci">OStreamProxy err(std::cerr)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00235">libmesh_common.h:235</a></div></div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1node__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1node__iterator.html">libMesh::MeshBase::node_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01190">mesh_base.h:1190</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a7a87dbe56aaa89961e03d60a25a36e8b"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">libMesh::MeshBase::local_nodes_begin</a></div><div class="ttdeci">virtual node_iterator local_nodes_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a47575077b6ad40d4f05292634f7615f8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a47575077b6ad40d4f05292634f7615f8">libMesh::MeshBase::nodes_end</a></div><div class="ttdeci">virtual node_iterator nodes_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Sort_html"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Sort.html">libMesh::Parallel::Sort</a></div><div class="ttdef"><b>Definition:</b> <a href="parallel__sort_8h_source.html#l00048">parallel_sort.h:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ae10ed90b4b5f57304ff304b5e9073cef"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">libMesh::Parallel::Communicator::allgather</a></div><div class="ttdeci">void allgather(T send, std::vector&lt; T &gt; &amp;recv) const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l02975">parallel_implementation.h:2975</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1const__node__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">libMesh::MeshBase::const_node_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01209">mesh_base.h:1209</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a1a26de404deda110d5dd22d7b78ff1a4"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">libMesh::Parallel::Communicator::send_receive</a></div><div class="ttdeci">void send_receive(const unsigned int dest_processor_id, T1 &amp;send, const unsigned int source_processor_id, T2 &amp;recv, const MessageTag &amp;send_tag=no_tag, const MessageTag &amp;recv_tag=any_tag) const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l02722">parallel_implementation.h:2722</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a73e079f0714b243453b9c65d15fafd36"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">libMesh::Parallel::Communicator::rank</a></div><div class="ttdeci">unsigned int rank() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00672">parallel.h:672</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a190e556d3be87f5ccd8d4fc98d1779d3"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a190e556d3be87f5ccd8d4fc98d1779d3">libMesh::MeshBase::n_elem</a></div><div class="ttdeci">virtual dof_id_type n_elem() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1Point_html"><div class="ttname"><a href="classlibMesh_1_1Point.html">libMesh::Point</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00039">point.h:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5b76b109bc6bd087c981774897aa6167"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5b76b109bc6bd087c981774897aa6167">libMesh::MeshBase::n_nodes</a></div><div class="ttdeci">virtual dof_id_type n_nodes() const =0</div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private_html_acd3e3226af58784e414a3c242a3ef740"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">libMesh::MeshTools::Generation::Private::idx</a></div><div class="ttdeci">unsigned int idx(const ElemType type, const unsigned int nx, const unsigned int i, const unsigned int j)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__generation_8C_source.html#l00068">mesh_generation.C:68</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab9d0275f5567a8253e3b10fa0d39a623"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::broadcast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finds all the processors that may contain elements that neighbor my elements. This list is guaranteed to include all processors that border any of my elements, but may include additional ones as well. This method computes bounding boxes for the elements on each processor and checks for overlaps. This method takes a mesh (which is assumed to reside on processor 0) and broadcasts it to all the other processors. It also broadcasts any boundary information the mesh has associated with it. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l00768">768</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>Referenced by <a class="el" href="namebased__io_8C_source.html#l00064">libMesh::NameBasedIO::read()</a>, and <a class="el" href="checkpoint__io_8C_source.html#l00402">libMesh::CheckpointIO::read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;{</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">// no MPI == one processor, no need for this method...</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a19ea7ecf5b4741e026b46f09204c121f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::check_for_duplicate_global_indices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Throw an error if we have any index clashes in the numbering used by assign_global_indices. </p>

<p>Definition at line <a class="el" href="mesh__communication__global__indices_8C_source.html#l00584">584</a> of file <a class="el" href="mesh__communication__global__indices_8C_source.html">mesh_communication_global_indices.C</a>.</p>

<p>References <a class="el" href="mesh__tools_8C_source.html#l00417">libMesh::MeshTools::bounding_box()</a>, <a class="el" href="libmesh__common_8h_source.html#l00235">libMesh::err</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">libMesh::MeshBase::local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">libMesh::MeshBase::local_elements_end()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">libMesh::MeshBase::local_nodes_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ad0daaecd9c183194a99609db6507198c">libMesh::MeshBase::local_nodes_end()</a>, <a class="el" href="threads__none_8h_source.html#l00069">libMesh::Threads::parallel_for()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, and <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>.</p>
<div class="fragment"><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;{</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;check_for_duplicate_global_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// Global bounding box</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <a class="code" href="classlibMesh_1_1MeshTools_1_1BoundingBox.html">MeshTools::BoundingBox</a> bbox =</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="namespacelibMesh_1_1MeshTools.html#ab099ca10b8e0521017c6d28644b88135">MeshTools::bounding_box</a> (mesh);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  std::vector&lt;Parallel::DofObjectKey&gt;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    node_keys, elem_keys;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// Nodes first</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <a class="code" href="classlibMesh_1_1StoredRange.html">ConstNodeRange</a> nr (mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">local_nodes_begin</a>(),</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                         mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ad0daaecd9c183194a99609db6507198c">local_nodes_end</a>());</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      node_keys.resize (nr.size());</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a> (nr, ComputeHilbertKeys (bbox, node_keys));</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="comment">// It&#39;s O(N^2) to check that these keys don&#39;t duplicate before the</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="comment">// sort...</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <a class="code" href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">MeshBase::const_node_iterator</a> nodei = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">local_nodes_begin</a>();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">for</span> (std::size_t i = 0; i != node_keys.size(); ++i, ++nodei)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <a class="code" href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">MeshBase::const_node_iterator</a> nodej = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">local_nodes_begin</a>();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          <span class="keywordflow">for</span> (std::size_t j = 0; j != i; ++j, ++nodej)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;              <span class="keywordflow">if</span> (node_keys[i] == node_keys[j])</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                  CFixBitVec icoords[3], jcoords[3];</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                  get_hilbert_coords(**nodej, bbox, jcoords);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    <span class="stringliteral">&quot;node &quot;</span> &lt;&lt; (*nodej)-&gt;id() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    *(<a class="code" href="classlibMesh_1_1Point.html">Point</a> *)(*nodej) &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    node_keys[j] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                  get_hilbert_coords(**nodei, bbox, icoords);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    <span class="stringliteral">&quot;node &quot;</span> &lt;&lt; (*nodei)-&gt;id() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                    *(<a class="code" href="classlibMesh_1_1Point.html">Point</a> *)(*nodei) &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    node_keys[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                  libmesh_error_msg(<span class="stringliteral">&quot;Error: nodes with duplicate Hilbert keys!&quot;</span>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// Elements next</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <a class="code" href="classlibMesh_1_1StoredRange.html">ConstElemRange</a> er (mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">local_elements_begin</a>(),</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                         mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">local_elements_end</a>());</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      elem_keys.resize (er.size());</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <a class="code" href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">Threads::parallel_for</a> (er, ComputeHilbertKeys (bbox, elem_keys));</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="comment">// For elements, the keys can be (and in the case of TRI, are</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="comment">// expected to be) duplicates, but only if the elements are at</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// different levels</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> elemi = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">local_elements_begin</a>();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">for</span> (std::size_t i = 0; i != elem_keys.size(); ++i, ++elemi)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;          <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> elemj = mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">local_elements_begin</a>();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          <span class="keywordflow">for</span> (std::size_t j = 0; j != i; ++j, ++elemj)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              <span class="keywordflow">if</span> ((elem_keys[i] == elem_keys[j]) &amp;&amp;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                  ((*elemi)-&gt;level() == (*elemj)-&gt;level()))</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    <span class="stringliteral">&quot;level &quot;</span> &lt;&lt; (*elemj)-&gt;level() &lt;&lt; <span class="stringliteral">&quot; elem\n&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    (**elemj) &lt;&lt; <span class="stringliteral">&quot; centroid &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    (*elemj)-&gt;centroid() &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    elem_keys[j] &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    get_hilbert_index((*elemj), bbox) &lt;&lt;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    std::endl;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                  <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <span class="stringliteral">&quot;level &quot;</span> &lt;&lt; (*elemi)-&gt;level() &lt;&lt; <span class="stringliteral">&quot; elem\n&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    (**elemi) &lt;&lt; <span class="stringliteral">&quot; centroid &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    (*elemi)-&gt;centroid() &lt;&lt; <span class="stringliteral">&quot; has HilbertIndices &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    elem_keys[i] &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    get_hilbert_index((*elemi), bbox) &lt;&lt;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    std::endl;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                  libmesh_error_msg(<span class="stringliteral">&quot;Error: level &quot;</span> &lt;&lt; (*elemi)-&gt;level() &lt;&lt; <span class="stringliteral">&quot; elements with duplicate Hilbert keys!&quot;</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  } <span class="comment">// done checking Hilbert keys</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;check_for_duplicate_global_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_a97dcd01ff677ad850c3c9f6d8380dba2"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#a97dcd01ff677ad850c3c9f6d8380dba2">libMesh::Threads::parallel_for</a></div><div class="ttdeci">void parallel_for(const Range &amp;range, const Body &amp;body)</div><div class="ttdef"><b>Definition:</b> <a href="threads__none_8h_source.html#l00069">threads_none.h:69</a></div></div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1const__element__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">libMesh::MeshBase::const_element_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01152">mesh_base.h:1152</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a5b67c2aa94e76310a6db3470cce8ef11"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a5b67c2aa94e76310a6db3470cce8ef11">libMesh::MeshBase::local_elements_begin</a></div><div class="ttdeci">virtual element_iterator local_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1StoredRange_html"><div class="ttname"><a href="classlibMesh_1_1StoredRange.html">libMesh::StoredRange</a></div><div class="ttdef"><b>Definition:</b> <a href="stored__range_8h_source.html#l00051">stored_range.h:51</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshTools_1_1BoundingBox_html"><div class="ttname"><a href="classlibMesh_1_1MeshTools_1_1BoundingBox.html">libMesh::MeshTools::BoundingBox</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8h_source.html#l00064">mesh_tools.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_ab099ca10b8e0521017c6d28644b88135"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#ab099ca10b8e0521017c6d28644b88135">libMesh::MeshTools::bounding_box</a></div><div class="ttdeci">BoundingBox bounding_box(const MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l00417">mesh_tools.C:417</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ad0daaecd9c183194a99609db6507198c"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ad0daaecd9c183194a99609db6507198c">libMesh::MeshBase::local_nodes_end</a></div><div class="ttdeci">virtual node_iterator local_nodes_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ab8bd839216a1ef9c0912d523b68ae136"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ab8bd839216a1ef9c0912d523b68ae136">libMesh::MeshBase::local_elements_end</a></div><div class="ttdeci">virtual element_iterator local_elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a74e5bc8a72d210b3d87b0221b1f69db1"><div class="ttname"><a href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a></div><div class="ttdeci">OStreamProxy err(std::cerr)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00235">libmesh_common.h:235</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a7a87dbe56aaa89961e03d60a25a36e8b"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a7a87dbe56aaa89961e03d60a25a36e8b">libMesh::MeshBase::local_nodes_begin</a></div><div class="ttdeci">virtual node_iterator local_nodes_begin()=0</div></div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1const__node__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1const__node__iterator.html">libMesh::MeshBase::const_node_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01209">mesh_base.h:1209</a></div></div>
<div class="ttc" id="classlibMesh_1_1Point_html"><div class="ttname"><a href="classlibMesh_1_1Point.html">libMesh::Point</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00039">point.h:39</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a227f46dad6159d846d8e6c90a9cfe3cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clears all data structures and returns to a pristine state. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l00155">155</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">//  _neighboring_processors.clear();</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4a0107f13a8af6e904a6067b19d4f5be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::delete_remote_elements </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; <a class="el" href="classlibMesh_1_1Elem.html">Elem</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>extra_ghost_elem_ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method takes an input <code><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a></code> which may be distributed among all the processors. Each processor deletes all elements which are neither local elements nor "ghost" elements which touch local elements, and deletes all nodes which are not contained in local or ghost elements. The end result is that a previously serial <code><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a></code> will be distributed between processors. Since this method is collective it must be called by all processors.</p>
<p>The std::set is a list of extra elements that you <em>don't</em> want to delete. These will be left on the current processor along with local elements and ghosted neighbors. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l01228">1228</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00564">libMesh::ParallelMesh::delete_elem()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00736">libMesh::ParallelMesh::delete_node()</a>, <a class="el" href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">libMesh::Elem::dim()</a>, <a class="el" href="dof__object_8h_source.html#l00619">libMesh::DofObject::id()</a>, <a class="el" href="parallel__mesh_8h_source.html#l00115">libMesh::ParallelMesh::is_serial()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a63d5ea463788bcccba01c269685110cc">libMesh::ParallelMesh::level_elements_begin()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a09225de82e9edf2ec47646d4fcb1bbb3">libMesh::ParallelMesh::level_elements_end()</a>, <a class="el" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert()</a>, <a class="el" href="mesh__tools_8C_source.html#l01541">libMesh::MeshTools::libmesh_assert_valid_refinement_tree()</a>, <a class="el" href="libmesh__nullptr_8h.html#ad10985637963b309cf2bf815e508438d">libmesh_nullptr</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a51a59d202b3ee5b86ce6cd1ee8e395f1">libMesh::ParallelMesh::local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a87a829015a2b7b36d6f804578f709ca1">libMesh::ParallelMesh::local_elements_end()</a>, <a class="el" href="elem_8C_source.html#l01252">libMesh::Elem::make_links_to_me_remote()</a>, <a class="el" href="parallel__mesh_8h_source.html#l00190">libMesh::ParallelMesh::max_elem_id()</a>, <a class="el" href="parallel__mesh_8h_source.html#l00186">libMesh::ParallelMesh::max_node_id()</a>, <a class="el" href="mesh__tools_8C_source.html#l00626">libMesh::MeshTools::n_levels()</a>, <a class="el" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes()</a>, <a class="el" href="classlibMesh_1_1Elem.html#ae376bfa6ac14723330e07a97992b56c9">libMesh::Elem::n_sides()</a>, <a class="el" href="elem_8h_source.html#l01580">libMesh::Elem::neighbor()</a>, <a class="el" href="elem_8h_source.html#l01499">libMesh::Elem::node()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a07bd800b3567d85a97aca081a7e5199a">libMesh::ParallelMesh::nodes_begin()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#ad2efa46cd16a6057b94ea504583dada9">libMesh::ParallelMesh::nodes_end()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a0e14170a2b372932676f0bb606f6bf79">libMesh::ParallelMesh::not_local_elements_begin()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#ac5615329f928790a062de882729d1986">libMesh::ParallelMesh::not_local_elements_end()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00203">libMesh::ParallelMesh::parallel_max_elem_id()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00261">libMesh::ParallelMesh::parallel_max_node_id()</a>, <a class="el" href="elem_8h_source.html#l01810">libMesh::Elem::parent()</a>, <a class="el" href="elem_8h_source.html#l01590">libMesh::Elem::set_neighbor()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, <a class="el" href="elem_8h_source.html#l01739">libMesh::Elem::subactive()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a2a2489b41b614d2ea7782d24072f42c4">libMesh::ParallelMesh::unpartitioned_elements_begin()</a>, <a class="el" href="classlibMesh_1_1ParallelMesh.html#a02ed5c01912f370e21434d6b780e3d23">libMesh::ParallelMesh::unpartitioned_elements_end()</a>, and <a class="el" href="parallel__implementation_8h_source.html#l01349">libMesh::Parallel::Communicator::verify()</a>.</p>

<p>Referenced by <a class="el" href="parallel__mesh_8C_source.html#l01378">libMesh::ParallelMesh::delete_remote_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;{</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="comment">// The mesh should know it&#39;s about to be parallelized</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (!mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#acc0f442b6c3a87848c0cff25730fbbc0">is_serial</a>());</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a>(<span class="stringliteral">&quot;delete_remote_elements()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">// We expect maximum ids to be in sync so we can use them to size</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="comment">// vectors</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73baccf10ea74d75c5f4e40016696eff">verify</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a12bb27e750ca4cd4497172351d844f7d">max_node_id</a>());</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73baccf10ea74d75c5f4e40016696eff">verify</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a59ec3386df7e32678336f8bddd537da2">max_elem_id</a>());</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> par_max_node_id = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a7e70b42843346fec0055c354272d8424">parallel_max_node_id</a>();</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> par_max_elem_id = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#aa03297d86c1cc9516ad53ab0fafbaecb">parallel_max_elem_id</a>();</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  libmesh_assert_equal_to (par_max_node_id, mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a12bb27e750ca4cd4497172351d844f7d">max_node_id</a>());</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  libmesh_assert_equal_to (par_max_elem_id, mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a59ec3386df7e32678336f8bddd537da2">max_elem_id</a>());</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">// FIXME - should these be &quot;unsorted_set&quot;s?  O(N) is O(N)...</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  std::vector&lt;bool&gt; local_nodes(mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a12bb27e750ca4cd4497172351d844f7d">max_node_id</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  std::vector&lt;bool&gt; semilocal_nodes(mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a12bb27e750ca4cd4497172351d844f7d">max_node_id</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  std::vector&lt;bool&gt; semilocal_elems(mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a59ec3386df7e32678336f8bddd537da2">max_elem_id</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// We don&#39;t want to delete any element that shares a node</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="comment">// with or is an ancestor of a local element.</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="comment">// Using the local_nodes vector rather than e.g. point_neighbors()</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="comment">// gives us correct results even in corner cases, such as where two</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="comment">// elements meet only at a corner.  ;-)  Links between boundary and</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="comment">// interior elements on mixed dimensional meshes also give us</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="comment">// correct ghosting in this way.</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="comment">// We also preserve neighbors of local elements - in most cases this</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">// is redundant with the node check, but for non-conforming Tet4</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="comment">// meshes and non-level-one-conforming 2D+3D meshes it is possible</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// for an element and its coarse neighbor to not share any vertices.</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> l_elem_it = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a51a59d202b3ee5b86ce6cd1ee8e395f1">local_elements_begin</a>(),</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    l_end     = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a87a829015a2b7b36d6f804578f709ca1">local_elements_end</a>();</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keywordflow">for</span> (; l_elem_it != l_end; ++l_elem_it)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = *l_elem_it;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>(); ++n)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> nodeid = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">node</a>(n);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          libmesh_assert_less (nodeid, local_nodes.size());</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          local_nodes[nodeid] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=0; s != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ae376bfa6ac14723330e07a97992b56c9">n_sides</a>(); ++s)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * neighbor = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a06576c749e62f4a5962e112e5441c31b">neighbor</a>(s);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;          <span class="keywordflow">if</span> (neighbor)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            semilocal_elems[neighbor-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>()] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keywordflow">while</span> (elem)</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> elemid = elem-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>();</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          libmesh_assert_less (elemid, semilocal_elems.size());</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          semilocal_elems[elemid] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>(); ++n)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            semilocal_nodes[elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">node</a>(n)] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * parent = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cdd994bb4245128f8617b62d7968e35">parent</a>();</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          <span class="comment">// Don&#39;t proceed from a boundary mesh to an interior mesh</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;          <span class="keywordflow">if</span> (parent &amp;&amp; parent-&gt;<a class="code" href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">dim</a>() != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">dim</a>())</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          elem = parent;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="comment">// We don&#39;t want to delete any element that shares a node</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="comment">// with or is an ancestor of an unpartitioned element either.</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <a class="code" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    u_elem_it = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a2a2489b41b614d2ea7782d24072f42c4">unpartitioned_elements_begin</a>(),</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    u_end     = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a02ed5c01912f370e21434d6b780e3d23">unpartitioned_elements_end</a>();</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="keywordflow">for</span> (; u_elem_it != u_end; ++u_elem_it)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = *u_elem_it;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>(); ++n)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        local_nodes[elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">node</a>(n)] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keywordflow">while</span> (elem)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;          semilocal_elems[elem-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>()] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>(); ++n)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            semilocal_nodes[elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">node</a>(n)] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * parent = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cdd994bb4245128f8617b62d7968e35">parent</a>();</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;          <span class="comment">// Don&#39;t proceed from a boundary mesh to an interior mesh</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;          <span class="keywordflow">if</span> (parent &amp;&amp; parent-&gt;<a class="code" href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">dim</a>() != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">dim</a>())</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;          elem = parent;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="comment">// Flag all the elements that share nodes with</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="comment">// local and unpartitioned elements, along with their ancestors</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <a class="code" href="structlibMesh_1_1MeshBase_1_1element__iterator.html">MeshBase::element_iterator</a> nl_elem_it = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a0e14170a2b372932676f0bb606f6bf79">not_local_elements_begin</a>(),</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    nl_end     = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#ac5615329f928790a062de882729d1986">not_local_elements_end</a>();</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">for</span> (; nl_elem_it != nl_end; ++nl_elem_it)</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = *nl_elem_it;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>(); ++n)</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keywordflow">if</span> (local_nodes[elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">node</a>(n)])</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;          {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            <span class="keywordflow">while</span> (elem)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;              {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                semilocal_elems[elem-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>()] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nn=0; nn != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>(); ++nn)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                  semilocal_nodes[elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">node</a>(nn)] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * parent = elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cdd994bb4245128f8617b62d7968e35">parent</a>();</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                <span class="comment">// Don&#39;t proceed from a boundary mesh to an interior mesh</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                <span class="keywordflow">if</span> (parent &amp;&amp; parent-&gt;<a class="code" href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">dim</a>() != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">dim</a>())</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                elem = parent;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;              }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">// Don&#39;t delete elements that we were explicitly told not to</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordflow">for</span>(std::set&lt;Elem *&gt;::iterator it = extra_ghost_elem_ids.begin();</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      it != extra_ghost_elem_ids.end();</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      ++it)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = *it;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      semilocal_elems[elem-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>()] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">n_nodes</a>(); ++n)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        semilocal_nodes[elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">node</a>(n)] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// Delete all the elements we have no reason to save,</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="comment">// starting with the most refined so that the mesh</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="comment">// is valid at all intermediate steps</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacelibMesh_1_1MeshTools.html#ae15ece869d4ef3d283edb677942e8439">n_levels</a> = <a class="code" href="namespacelibMesh_1_1MeshTools.html#ae15ece869d4ef3d283edb677942e8439">MeshTools::n_levels</a>(mesh);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = n_levels - 1; l &gt;= 0; --l)</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <a class="code" href="structlibMesh_1_1MeshBase_1_1element__iterator.html">MeshBase::element_iterator</a> lev_elem_it = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a63d5ea463788bcccba01c269685110cc">level_elements_begin</a>(l),</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        lev_end     = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a09225de82e9edf2ec47646d4fcb1bbb3">level_elements_end</a>(l);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">for</span> (; lev_elem_it != lev_end; ++lev_elem_it)</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;          <a class="code" href="classlibMesh_1_1Elem.html">Elem</a> * elem = *lev_elem_it;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;          <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (elem);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;          <span class="comment">// Make sure we don&#39;t leave any invalid pointers</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          <span class="keywordflow">if</span> (!semilocal_elems[elem-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>()])</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a975ab6f3e93964a1c30821c3a97baecb">make_links_to_me_remote</a>();</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          <span class="comment">// Subactive neighbor pointers aren&#39;t preservable here</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ad1486ba6e3005fe331e4911907fadfbb">subactive</a>())</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=0; s != elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#ae376bfa6ac14723330e07a97992b56c9">n_sides</a>(); ++s)</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;              elem-&gt;<a class="code" href="classlibMesh_1_1Elem.html#a40980d9226643eb7dfd86b1c150c888e">set_neighbor</a>(s, <a class="code" href="libmesh__nullptr_8h.html#ad10985637963b309cf2bf815e508438d">libmesh_nullptr</a>);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          <span class="comment">// delete_elem doesn&#39;t currently invalidate element</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          <span class="comment">// iterators... that had better not change</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;          <span class="keywordflow">if</span> (!semilocal_elems[elem-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>()])</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#ad85d530a8010cde6ea84cd6d55c98ede">delete_elem</a>(elem);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="comment">// Delete all the nodes we have no reason to save</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <a class="code" href="structlibMesh_1_1MeshBase_1_1node__iterator.html">MeshBase::node_iterator</a> node_it  = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a07bd800b3567d85a97aca081a7e5199a">nodes_begin</a>(),</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    node_end = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#ad2efa46cd16a6057b94ea504583dada9">nodes_end</a>();</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="keywordflow">for</span> (node_it = mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a07bd800b3567d85a97aca081a7e5199a">nodes_begin</a>(); node_it != node_end; ++node_it)</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <a class="code" href="classlibMesh_1_1Node.html">Node</a> * node = *node_it;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(node);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordflow">if</span> (!semilocal_nodes[node-&gt;<a class="code" href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">id</a>()])</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        mesh.<a class="code" href="classlibMesh_1_1ParallelMesh.html#a5ee1fb6b3166fee93202daaf5c5b4f3e">delete_node</a>(node);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <a class="code" href="namespacelibMesh_1_1MeshTools.html#ad394faa2ff745fcf291cb4c03c20ce73">MeshTools::libmesh_assert_valid_refinement_tree</a>(mesh);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a>(<span class="stringliteral">&quot;delete_remote_elements()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1element__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1element__iterator.html">libMesh::MeshBase::element_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01133">mesh_base.h:1133</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a73baccf10ea74d75c5f4e40016696eff"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a73baccf10ea74d75c5f4e40016696eff">libMesh::Parallel::Communicator::verify</a></div><div class="ttdeci">bool verify(const T &amp;r) const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l01349">parallel_implementation.h:1349</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a87a829015a2b7b36d6f804578f709ca1"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a87a829015a2b7b36d6f804578f709ca1">libMesh::ParallelMesh::local_elements_end</a></div><div class="ttdeci">virtual element_iterator local_elements_end() libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1Node_html"><div class="ttname"><a href="classlibMesh_1_1Node.html">libMesh::Node</a></div><div class="ttdef"><b>Definition:</b> <a href="node_8h_source.html#l00053">node.h:53</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_ad1486ba6e3005fe331e4911907fadfbb"><div class="ttname"><a href="classlibMesh_1_1Elem.html#ad1486ba6e3005fe331e4911907fadfbb">libMesh::Elem::subactive</a></div><div class="ttdeci">bool subactive() const </div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01739">elem.h:1739</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a7e70b42843346fec0055c354272d8424"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a7e70b42843346fec0055c354272d8424">libMesh::ParallelMesh::parallel_max_node_id</a></div><div class="ttdeci">dof_id_type parallel_max_node_id() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__mesh_8C_source.html#l00261">parallel_mesh.C:261</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a07bd800b3567d85a97aca081a7e5199a"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a07bd800b3567d85a97aca081a7e5199a">libMesh::ParallelMesh::nodes_begin</a></div><div class="ttdeci">virtual node_iterator nodes_begin() libmesh_override</div></div>
<div class="ttc" id="namespacelibMesh_html_ac03a5d846eeb24a13168f6b5358f86e3"><div class="ttname"><a href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(remote_elem)</div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1const__element__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">libMesh::MeshBase::const_element_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01152">mesh_base.h:1152</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_ad2efa46cd16a6057b94ea504583dada9"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#ad2efa46cd16a6057b94ea504583dada9">libMesh::ParallelMesh::nodes_end</a></div><div class="ttdeci">virtual node_iterator nodes_end() libmesh_override</div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_ad394faa2ff745fcf291cb4c03c20ce73"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#ad394faa2ff745fcf291cb4c03c20ce73">libMesh::MeshTools::libmesh_assert_valid_refinement_tree</a></div><div class="ttdeci">void libmesh_assert_valid_refinement_tree(const MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l01541">mesh_tools.C:1541</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a7cdd994bb4245128f8617b62d7968e35"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a7cdd994bb4245128f8617b62d7968e35">libMesh::Elem::parent</a></div><div class="ttdeci">const Elem * parent() const </div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01810">elem.h:1810</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html"><div class="ttname"><a href="classlibMesh_1_1Elem.html">libMesh::Elem</a></div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l00091">elem.h:91</a></div></div>
<div class="ttc" id="libmesh__nullptr_8h_html_ad10985637963b309cf2bf815e508438d"><div class="ttname"><a href="libmesh__nullptr_8h.html#ad10985637963b309cf2bf815e508438d">libmesh_nullptr</a></div><div class="ttdeci">const class libmesh_nullptr_t libmesh_nullptr</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_acc0f442b6c3a87848c0cff25730fbbc0"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#acc0f442b6c3a87848c0cff25730fbbc0">libMesh::ParallelMesh::is_serial</a></div><div class="ttdeci">virtual bool is_serial() const libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="parallel__mesh_8h_source.html#l00115">parallel_mesh.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_aa03297d86c1cc9516ad53ab0fafbaecb"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#aa03297d86c1cc9516ad53ab0fafbaecb">libMesh::ParallelMesh::parallel_max_elem_id</a></div><div class="ttdeci">dof_id_type parallel_max_elem_id() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__mesh_8C_source.html#l00203">parallel_mesh.C:203</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a59ec3386df7e32678336f8bddd537da2"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a59ec3386df7e32678336f8bddd537da2">libMesh::ParallelMesh::max_elem_id</a></div><div class="ttdeci">virtual dof_id_type max_elem_id() const libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="parallel__mesh_8h_source.html#l00190">parallel_mesh.h:190</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a975ab6f3e93964a1c30821c3a97baecb"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a975ab6f3e93964a1c30821c3a97baecb">libMesh::Elem::make_links_to_me_remote</a></div><div class="ttdeci">void make_links_to_me_remote()</div><div class="ttdef"><b>Definition:</b> <a href="elem_8C_source.html#l01252">elem.C:1252</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a2a2489b41b614d2ea7782d24072f42c4"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a2a2489b41b614d2ea7782d24072f42c4">libMesh::ParallelMesh::unpartitioned_elements_begin</a></div><div class="ttdeci">virtual element_iterator unpartitioned_elements_begin() libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_ad85d530a8010cde6ea84cd6d55c98ede"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#ad85d530a8010cde6ea84cd6d55c98ede">libMesh::ParallelMesh::delete_elem</a></div><div class="ttdeci">virtual void delete_elem(Elem *e) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="parallel__mesh_8C_source.html#l00564">parallel_mesh.C:564</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_aa50d97d65dc379f64667da53c427b36f"><div class="ttname"><a href="classlibMesh_1_1Elem.html#aa50d97d65dc379f64667da53c427b36f">libMesh::Elem::dim</a></div><div class="ttdeci">virtual unsigned int dim() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a3a1e00b1906b0f6cf0cc1760c9a7da1f"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes</a></div><div class="ttdeci">virtual unsigned int n_nodes() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a5ee1fb6b3166fee93202daaf5c5b4f3e"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a5ee1fb6b3166fee93202daaf5c5b4f3e">libMesh::ParallelMesh::delete_node</a></div><div class="ttdeci">virtual void delete_node(Node *n) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="parallel__mesh_8C_source.html#l00736">parallel_mesh.C:736</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_ae15ece869d4ef3d283edb677942e8439"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#ae15ece869d4ef3d283edb677942e8439">libMesh::MeshTools::n_levels</a></div><div class="ttdeci">unsigned int n_levels(const MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l00626">mesh_tools.C:626</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a0e14170a2b372932676f0bb606f6bf79"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a0e14170a2b372932676f0bb606f6bf79">libMesh::ParallelMesh::not_local_elements_begin</a></div><div class="ttdeci">virtual element_iterator not_local_elements_begin() libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a02ed5c01912f370e21434d6b780e3d23"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a02ed5c01912f370e21434d6b780e3d23">libMesh::ParallelMesh::unpartitioned_elements_end</a></div><div class="ttdeci">virtual element_iterator unpartitioned_elements_end() libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a40980d9226643eb7dfd86b1c150c888e"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a40980d9226643eb7dfd86b1c150c888e">libMesh::Elem::set_neighbor</a></div><div class="ttdeci">void set_neighbor(const unsigned int i, Elem *n)</div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01590">elem.h:1590</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a7cffa0aae912cc004972c9ea34a22ad4"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a7cffa0aae912cc004972c9ea34a22ad4">libMesh::Elem::node</a></div><div class="ttdeci">dof_id_type node(const unsigned int i) const </div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01499">elem.h:1499</a></div></div>
<div class="ttc" id="structlibMesh_1_1MeshBase_1_1node__iterator_html"><div class="ttname"><a href="structlibMesh_1_1MeshBase_1_1node__iterator.html">libMesh::MeshBase::node_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh__base_8h_source.html#l01190">mesh_base.h:1190</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_ae376bfa6ac14723330e07a97992b56c9"><div class="ttname"><a href="classlibMesh_1_1Elem.html#ae376bfa6ac14723330e07a97992b56c9">libMesh::Elem::n_sides</a></div><div class="ttdeci">virtual unsigned int n_sides() const =0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a63d5ea463788bcccba01c269685110cc"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a63d5ea463788bcccba01c269685110cc">libMesh::ParallelMesh::level_elements_begin</a></div><div class="ttdeci">virtual element_iterator level_elements_begin(unsigned int level) libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a51a59d202b3ee5b86ce6cd1ee8e395f1"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a51a59d202b3ee5b86ce6cd1ee8e395f1">libMesh::ParallelMesh::local_elements_begin</a></div><div class="ttdeci">virtual element_iterator local_elements_begin() libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a12bb27e750ca4cd4497172351d844f7d"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a12bb27e750ca4cd4497172351d844f7d">libMesh::ParallelMesh::max_node_id</a></div><div class="ttdeci">virtual dof_id_type max_node_id() const libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="parallel__mesh_8h_source.html#l00186">parallel_mesh.h:186</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_a09225de82e9edf2ec47646d4fcb1bbb3"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#a09225de82e9edf2ec47646d4fcb1bbb3">libMesh::ParallelMesh::level_elements_end</a></div><div class="ttdeci">virtual element_iterator level_elements_end(unsigned int level) libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelMesh_html_ac5615329f928790a062de882729d1986"><div class="ttname"><a href="classlibMesh_1_1ParallelMesh.html#ac5615329f928790a062de882729d1986">libMesh::ParallelMesh::not_local_elements_end</a></div><div class="ttdeci">virtual element_iterator not_local_elements_end() libmesh_override</div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_aeceebf9cd5d53b02df3cd1e9907139e2"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#aeceebf9cd5d53b02df3cd1e9907139e2">libMesh::DofObject::id</a></div><div class="ttdeci">dof_id_type id() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00619">dof_object.h:619</a></div></div>
<div class="ttc" id="classlibMesh_1_1Elem_html_a06576c749e62f4a5962e112e5441c31b"><div class="ttname"><a href="classlibMesh_1_1Elem.html#a06576c749e62f4a5962e112e5441c31b">libMesh::Elem::neighbor</a></div><div class="ttdeci">Elem * neighbor(const unsigned int i) const </div><div class="ttdef"><b>Definition:</b> <a href="elem_8h_source.html#l01580">elem.h:1580</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b8e5bab57f0a189fe4b05185b3c2aec"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ForwardIterator &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::find_global_indices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td>
          <td class="paramname"><em>communicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1MeshTools_1_1BoundingBox.html">MeshTools::BoundingBox</a> &amp;&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ForwardIterator &amp;&#160;</td>
          <td class="paramname"><em>begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ForwardIterator &amp;&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>index_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method determines a globally unique, partition-agnostic index for each object in the input range. </p>

<p>Definition at line <a class="el" href="mesh__communication__global__indices_8C_source.html#l00680">680</a> of file <a class="el" href="mesh__communication__global__indices_8C_source.html">mesh_communication_global_indices.C</a>.</p>

<p>References <a class="el" href="parallel__implementation_8h_source.html#l02975">libMesh::Parallel::Communicator::allgather()</a>, <a class="el" href="parallel__sort_8C_source.html#l00376">libMesh::Parallel::Sort&lt; KeyType, IdxType &gt;::bin()</a>, <a class="el" href="variant__filter__iterator_8h_source.html#l00334">end</a>, <a class="el" href="mesh__generation_8C_source.html#l00068">libMesh::MeshTools::Generation::Private::idx()</a>, <a class="el" href="dof__object_8h_source.html#l00346">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert()</a>, <a class="el" href="libmesh__augment__std__namespace_8h_source.html#l00027">std::max()</a>, <a class="el" href="parallel_8h_source.html#l00672">libMesh::Parallel::Communicator::rank()</a>, <a class="el" href="libmesh__common_8h_source.html#l00131">libMesh::Real</a>, <a class="el" href="parallel__implementation_8h_source.html#l02722">libMesh::Parallel::Communicator::send_receive()</a>, <a class="el" href="parallel_8h_source.html#l00674">libMesh::Parallel::Communicator::size()</a>, <a class="el" href="parallel__sort_8C_source.html#l00058">libMesh::Parallel::Sort&lt; KeyType, IdxType &gt;::sort()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, and <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>.</p>

<p>Referenced by <a class="el" href="metis__partitioner_8C_source.html#l00062">libMesh::MetisPartitioner::_do_partition()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00205">libMesh::ParmetisPartitioner::initialize()</a>, and <a class="el" href="partitioner_8C_source.html#l00187">libMesh::Partitioner::partition_unpartitioned_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;find_global_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// This method determines partition-agnostic global indices</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// for nodes and elements.</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// Algorithm:</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">// (1) compute the Hilbert key for each local node/element</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">// (2) perform a parallel sort of the Hilbert key</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// (3) get the min/max value on each processor</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// (4) determine the position in the global ranking for</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="comment">//     each local object</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  index_map.clear();</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  std::size_t n_objects = std::distance (begin, <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  index_map.reserve(n_objects);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="comment">// (1) compute Hilbert keys</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">// These aren&#39;t trivial to compute, and we will need them again.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="comment">// But the binsort will sort the input vector, trashing the order</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">// that we&#39;d like to rely on.  So, two vectors...</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  std::vector&lt;Parallel::DofObjectKey&gt;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    sorted_hilbert_keys,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    hilbert_keys;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  sorted_hilbert_keys.reserve(n_objects);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  hilbert_keys.reserve(n_objects);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a>(<span class="stringliteral">&quot;compute_hilbert_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">for</span> (ForwardIterator it=begin; it!=<a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>; ++it)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> hi(get_hilbert_index (*it, bbox));</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        hilbert_keys.push_back(hi);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">if</span> ((*it)-&gt;processor_id() == communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>())</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          sorted_hilbert_keys.push_back(hi);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="comment">// someone needs to take care of unpartitioned objects!</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">if</span> ((communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>() == 0) &amp;&amp;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            ((*it)-&gt;processor_id() == <a class="code" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a>))</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          sorted_hilbert_keys.push_back(hi);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a>(<span class="stringliteral">&quot;compute_hilbert_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// (2) parallel sort the Hilbert keys</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;parallel_sort()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <a class="code" href="classlibMesh_1_1Parallel_1_1Sort.html">Parallel::Sort&lt;Parallel::DofObjectKey&gt;</a> sorter (communicator,</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                                                  sorted_hilbert_keys);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  sorter.sort();</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;parallel_sort()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keyword">const</span> std::vector&lt;Parallel::DofObjectKey&gt; &amp; my_bin = sorter.bin();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// The number of objects in my_bin on each processor</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  std::vector&lt;unsigned int&gt; bin_sizes(communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">allgather</a> (static_cast&lt;unsigned int&gt;(my_bin.size()), bin_sizes);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// The offset of my first global index</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_offset = 0;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pid=0; pid&lt;communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>(); pid++)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    my_offset += bin_sizes[pid];</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// (3) get the max value on each processor</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  std::vector&lt;Parallel::DofObjectKey&gt;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    upper_bounds(1);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">if</span> (!my_bin.empty())</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    upper_bounds[0] = my_bin.back();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">allgather</a> (upper_bounds, <span class="comment">/* identical_buffer_sizes = */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">// Be cereful here.  The *_upper_bounds will be used to find the processor</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="comment">// a given object belongs to.  So, if a processor contains no objects (possible!)</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="comment">// then copy the bound from the lower processor id.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p=1; p&lt;communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); p++)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span> (!bin_sizes[p]) upper_bounds[p] = upper_bounds[p-1];</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">// (4) determine the position in the global ranking for</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="comment">//     each local object</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">//----------------------------------------------</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">// all objects, not just local ones</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    std::vector&lt;std::vector&lt;Parallel::DofObjectKey&gt; &gt;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      requested_ids (communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="comment">// Results to gather from each processor</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    std::vector&lt;std::vector&lt;dof_id_type&gt; &gt;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      filled_request (communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// build up list of requests</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    std::vector&lt;Parallel::DofObjectKey&gt;::const_iterator hi =</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      hilbert_keys.begin();</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">for</span> (ForwardIterator it = begin; it != <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>; ++it)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (hi != hilbert_keys.end());</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        std::vector&lt;Parallel::DofObjectKey&gt;::iterator lb =</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          std::lower_bound(upper_bounds.begin(), upper_bounds.end(),</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                           *hi);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid =</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          (std::distance (upper_bounds.begin(), lb));</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        libmesh_assert_less (pid, communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        requested_ids[pid].push_back(*hi);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        ++hi;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="comment">// go ahead and put pid in index_map, that way we</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">// don&#39;t have to repeat the std::lower_bound()</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        index_map.push_back(pid);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// start with pid=0, so that we will trade with ourself</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    std::vector&lt;Parallel::DofObjectKey&gt; request_to_fill;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    std::vector&lt;dof_id_type&gt; global_ids;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid=0; pid&lt;communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); pid++)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">// Trade my requests with processor procup and procdown</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> procup = cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;          ((communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>() + pid) % communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> procdown = cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          ((communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>() + communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>() - pid) %</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;           communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">send_receive</a>(procup, requested_ids[procup],</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                  procdown, request_to_fill);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">// Fill the requests</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        global_ids.clear();  global_ids.reserve(request_to_fill.size());</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>=0; <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>&lt;request_to_fill.size(); <a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>++)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;          {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">Parallel::DofObjectKey</a> &amp; hilbert_indices = request_to_fill[<a class="code" href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">idx</a>];</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            libmesh_assert_less_equal (hilbert_indices, upper_bounds[communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>()]);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="comment">// find the requested index in my node bin</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            std::vector&lt;Parallel::DofObjectKey&gt;::const_iterator pos =</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;              std::lower_bound (my_bin.begin(), my_bin.end(), hilbert_indices);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (pos != my_bin.end());</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="comment">// If we could not find the requested Hilbert index in</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">// my_bin, something went terribly wrong, possibly the</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">// Mesh was displaced differently on different processors,</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="comment">// and therefore the Hilbert indices don&#39;t agree.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">if</span> (*pos != hilbert_indices)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;              {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="comment">// The input will be hilbert_indices.  We convert it</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                <span class="comment">// to BitVecType using the operator= provided by the</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <span class="comment">// BitVecType class. BitVecType is a CBigBitVec!</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                Hilbert::BitVecType input;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_UNIQUE_ID</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                input = hilbert_indices.first;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                input = hilbert_indices;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="comment">// Get output in a vector of CBigBitVec</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                std::vector&lt;CBigBitVec&gt; output(3);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <span class="comment">// Call the indexToCoords function</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                Hilbert::indexToCoords(&amp;output[0], 8*<span class="keyword">sizeof</span>(Hilbert::inttype), 3, input);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <span class="comment">// The entries in the output racks are integers in the</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                <span class="comment">// range [0, Hilbert::inttype::max] which can be</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <span class="comment">// converted to floating point values in [0,1] and</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <span class="comment">// finally to actual values using the bounding box.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> max_int_as_real = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a><span class="keyword">&gt;</span>(<a class="code" href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::numeric_limits&lt;Hilbert::inttype&gt;::max</a>());</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                <span class="comment">// Get the points in [0,1]^3.  The zeroth rack of each entry in</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <span class="comment">// &#39;output&#39; maps to the normalized x, y, and z locations,</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <span class="comment">// respectively.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <a class="code" href="classlibMesh_1_1Point.html">Point</a> p_hat(static_cast&lt;Real&gt;(output[0].racks()[0]) / max_int_as_real,</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                            static_cast&lt;Real&gt;(output[1].racks()[0]) / max_int_as_real,</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                            static_cast&lt;Real&gt;(output[2].racks()[0]) / max_int_as_real);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="comment">// Convert the points from [0,1]^3 to their actual (x,y,z) locations</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                  xmin = bbox.first(0),</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                  xmax = bbox.second(0),</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                  ymin = bbox.first(1),</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                  ymax = bbox.second(1),</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                  zmin = bbox.first(2),</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                  zmax = bbox.second(2);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <span class="comment">// Convert the points from [0,1]^3 to their actual (x,y,z) locations</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                <a class="code" href="classlibMesh_1_1Point.html">Point</a> p(xmin + (xmax-xmin)*p_hat(0),</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                        ymin + (ymax-ymin)*p_hat(1),</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                        zmin + (zmax-zmin)*p_hat(2));</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                libmesh_error_msg(<span class="stringliteral">&quot;Could not find hilbert indices: &quot;</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                  &lt;&lt; hilbert_indices</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                  &lt;&lt; <span class="stringliteral">&quot; corresponding to point &quot;</span> &lt;&lt; p);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;              }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="comment">// Finally, assign the global index based off the position of the index</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="comment">// in my array, properly offset.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            global_ids.push_back (cast_int&lt;dof_id_type&gt;(std::distance(my_bin.begin(), pos) + my_offset));</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">// and trade back</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">send_receive</a> (procdown, global_ids,</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                   procup,   filled_request[procup]);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">// We now have all the filled requests, so we can loop through our</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// nodes once and assign the global index to each one.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      std::vector&lt;std::vector&lt;dof_id_type&gt;::const_iterator&gt;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        next_obj_on_proc; next_obj_on_proc.reserve(communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pid=0; pid&lt;communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(); pid++)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        next_obj_on_proc.push_back(filled_request[pid].begin());</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cnt=0;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">for</span> (ForwardIterator it = begin; it != <a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>; ++it, cnt++)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> pid = cast_int&lt;processor_id_type&gt;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            (index_map[cnt]);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          libmesh_assert_less (pid, communicator.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>());</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a> (next_obj_on_proc[pid] != filled_request[pid].<a class="code" href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a>());</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> global_index = *next_obj_on_proc[pid];</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          index_map[cnt] = global_index;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          ++next_obj_on_proc[pid];</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  libmesh_assert_equal_to(index_map.size(), n_objects);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;find_global_indices()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ac03a5d846eeb24a13168f6b5358f86e3"><div class="ttname"><a href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(remote_elem)</div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3eca1f7abf02a11e5812b08b1d65f80b"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">unsigned int size() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00674">parallel.h:674</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_aefbe7c94fa1895557e56fdc001710b16"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">libMesh::Parallel::DofObjectKey</a></div><div class="ttdeci">std::pair&lt; Hilbert::HilbertIndices, unique_id_type &gt; DofObjectKey</div><div class="ttdef"><b>Definition:</b> <a href="parallel__hilbert_8h_source.html#l00068">parallel_hilbert.h:68</a></div></div>
<div class="ttc" id="namespacelibMesh_html_afebcb3616f8c81cda531dec404f2420d"><div class="ttname"><a href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00099">id_types.h:99</a></div></div>
<div class="ttc" id="variant__filter__iterator_8h_html_a785f0bd261d7bd1918b031c5133da2b9"><div class="ttname"><a href="variant__filter__iterator_8h.html#a785f0bd261d7bd1918b031c5133da2b9">end</a></div><div class="ttdeci">IterBase * end</div><div class="ttdef"><b>Definition:</b> <a href="variant__filter__iterator_8h_source.html#l00334">variant_filter_iterator.h:334</a></div></div>
<div class="ttc" id="namespacestd_html_a6987c84b7beab8b2ebdee7e2549d698f"><div class="ttname"><a href="namespacestd.html#a6987c84b7beab8b2ebdee7e2549d698f">std::max</a></div><div class="ttdeci">long double max(long double a, double b)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__augment__std__namespace_8h_source.html#l00027">libmesh_augment_std_namespace.h:27</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_aa65deab833c8b1802790cd43ab1b6ee4"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">libMesh::DofObject::invalid_processor_id</a></div><div class="ttdeci">static const processor_id_type invalid_processor_id</div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00346">dof_object.h:346</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00131">libmesh_common.h:131</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Sort_html"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Sort.html">libMesh::Parallel::Sort</a></div><div class="ttdef"><b>Definition:</b> <a href="parallel__sort_8h_source.html#l00048">parallel_sort.h:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_ae10ed90b4b5f57304ff304b5e9073cef"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#ae10ed90b4b5f57304ff304b5e9073cef">libMesh::Parallel::Communicator::allgather</a></div><div class="ttdeci">void allgather(T send, std::vector&lt; T &gt; &amp;recv) const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l02975">parallel_implementation.h:2975</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a1a26de404deda110d5dd22d7b78ff1a4"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a1a26de404deda110d5dd22d7b78ff1a4">libMesh::Parallel::Communicator::send_receive</a></div><div class="ttdeci">void send_receive(const unsigned int dest_processor_id, T1 &amp;send, const unsigned int source_processor_id, T2 &amp;recv, const MessageTag &amp;send_tag=no_tag, const MessageTag &amp;recv_tag=any_tag) const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__implementation_8h_source.html#l02722">parallel_implementation.h:2722</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a73e079f0714b243453b9c65d15fafd36"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">libMesh::Parallel::Communicator::rank</a></div><div class="ttdeci">unsigned int rank() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00672">parallel.h:672</a></div></div>
<div class="ttc" id="classlibMesh_1_1Point_html"><div class="ttname"><a href="classlibMesh_1_1Point.html">libMesh::Point</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00039">point.h:39</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private_html_acd3e3226af58784e414a3c242a3ef740"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools_1_1Generation_1_1Private.html#acd3e3226af58784e414a3c242a3ef740">libMesh::MeshTools::Generation::Private::idx</a></div><div class="ttdeci">unsigned int idx(const ElemType type, const unsigned int nx, const unsigned int i, const unsigned int j)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__generation_8C_source.html#l00068">mesh_generation.C:68</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00064">id_types.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5debc4e227d535b0f42f295edbaff199"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::gather </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>root_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method takes an input <code><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a></code> which may be distributed among all the processors. Each processor then sends its local nodes and elements to processor <code>root_id</code>. The end result is that a previously distributed <code><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a></code> will be serialized on processor <code>root_id</code>. Since this method is collective it must be called by all processors. For the special case of <code>root_id</code> equal to <code><a class="el" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a></code> this function performs an allgather. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l00834">834</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>Referenced by <a class="el" href="mesh__communication_8h_source.html#l00121">allgather()</a>.</p>
<div class="fragment"><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;{</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// no MPI == one processor, no need for this method...</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b5bcfce3b9a9daccb4abb795a0638e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::gather_neighboring_elements </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l00394">394</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>Referenced by <a class="el" href="nemesis__io_8C_source.html#l00136">libMesh::Nemesis_IO::read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;{</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// no MPI == one processor, no need for this method...</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a737da6ee13b781ac7aef37851a99af58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::make_elems_parallel_consistent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy ids of ghost elements from their local processors. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l01068">1068</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>References <a class="el" href="classlibMesh_1_1MeshBase.html#aefa4ded9eaf654a45ab593a0963ecbf3">libMesh::MeshBase::active_elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae3f09f1b7556aef88919249861728e23">libMesh::MeshBase::active_elements_end()</a>, <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, <a class="el" href="parallel__ghost__sync_8h_source.html#l00261">libMesh::Parallel::sync_dofobject_data_by_id()</a>, and <a class="el" href="parallel__ghost__sync_8h_source.html#l00341">libMesh::Parallel::sync_element_data_by_parent_id()</a>.</p>

<p>Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01529">libMesh::MeshRefinement::_refine_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;{</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <a class="code" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libmesh_parallel_only</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;make_elems_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  SyncIds syncids(mesh, &amp;<a class="code" href="classlibMesh_1_1MeshBase.html#a263b1727104cb46623b6e522cf90e6d4">MeshBase::renumber_elem</a>);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#a29c79f0c66ce48d4b3801a77b139df3b">Parallel::sync_element_data_by_parent_id</a></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    (mesh, mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#aefa4ded9eaf654a45ab593a0963ecbf3">active_elements_begin</a>(),</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ae3f09f1b7556aef88919249861728e23">active_elements_end</a>(), syncids);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_UNIQUE_ID</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  SyncUniqueIds&lt;Elem&gt; syncuniqueids(mesh, &amp;<a class="code" href="classlibMesh_1_1MeshBase.html#ad30effd4109ec1b62eed070339550f0c">MeshBase::query_elem</a>);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">Parallel::sync_dofobject_data_by_id</a></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    (mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>(), mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#aefa4ded9eaf654a45ab593a0963ecbf3">active_elements_begin</a>(),</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;     mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ae3f09f1b7556aef88919249861728e23">active_elements_end</a>(), syncuniqueids);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;make_elems_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_ac7d4f06bb34625465942e6b8d10f135e"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">libMesh::Parallel::sync_dofobject_data_by_id</a></div><div class="ttdeci">void sync_dofobject_data_by_id(const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00261">parallel_ghost_sync.h:261</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aba4e7b024f88416601a12d74a3ca2d26"><div class="ttname"><a href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only</a></div><div class="ttdeci">libmesh_parallel_only(this-&gt;comm())</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_aefa4ded9eaf654a45ab593a0963ecbf3"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#aefa4ded9eaf654a45ab593a0963ecbf3">libMesh::MeshBase::active_elements_begin</a></div><div class="ttdeci">virtual element_iterator active_elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae3f09f1b7556aef88919249861728e23"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae3f09f1b7556aef88919249861728e23">libMesh::MeshBase::active_elements_end</a></div><div class="ttdeci">virtual element_iterator active_elements_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a263b1727104cb46623b6e522cf90e6d4"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a263b1727104cb46623b6e522cf90e6d4">libMesh::MeshBase::renumber_elem</a></div><div class="ttdeci">virtual void renumber_elem(dof_id_type old_id, dof_id_type new_id)=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ad30effd4109ec1b62eed070339550f0c"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ad30effd4109ec1b62eed070339550f0c">libMesh::MeshBase::query_elem</a></div><div class="ttdeci">virtual const Elem * query_elem(const dof_id_type i) const =0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a29c79f0c66ce48d4b3801a77b139df3b"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a29c79f0c66ce48d4b3801a77b139df3b">libMesh::Parallel::sync_element_data_by_parent_id</a></div><div class="ttdeci">void sync_element_data_by_parent_id(MeshBase &amp;mesh, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00341">parallel_ghost_sync.h:341</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0eae4e562c489db701776c3970e772b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::make_node_ids_parallel_consistent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assuming all ids on local nodes are globally unique, and assuming all processor ids are parallel consistent, this function makes all other ids parallel consistent. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l01030">1030</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end()</a>, <a class="el" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, and <a class="el" href="parallel__ghost__sync_8h_source.html#l00459">libMesh::Parallel::sync_node_data_by_element_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;{</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libmesh_parallel_only</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;make_node_ids_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  SyncIds syncids(mesh, &amp;<a class="code" href="classlibMesh_1_1MeshBase.html#a721d506a05953aae24cb28bb0d56caab">MeshBase::renumber_node</a>);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#acfb509fd5bcfa928f440d52277258d1d">Parallel::sync_node_data_by_element_id</a></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    (mesh, mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">elements_begin</a>(), mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">elements_end</a>(), syncids);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;make_node_ids_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a721d506a05953aae24cb28bb0d56caab"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a721d506a05953aae24cb28bb0d56caab">libMesh::MeshBase::renumber_node</a></div><div class="ttdeci">virtual void renumber_node(dof_id_type old_id, dof_id_type new_id)=0</div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac266e1f5eb6ac9566ccbd7e6add6c239"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin</a></div><div class="ttdeci">virtual element_iterator elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae94f1bce0dc50c489c6bae9ba64d06e8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end</a></div><div class="ttdeci">virtual element_iterator elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_aba4e7b024f88416601a12d74a3ca2d26"><div class="ttname"><a href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only</a></div><div class="ttdeci">libmesh_parallel_only(this-&gt;comm())</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_acfb509fd5bcfa928f440d52277258d1d"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#acfb509fd5bcfa928f440d52277258d1d">libMesh::Parallel::sync_node_data_by_element_id</a></div><div class="ttdeci">void sync_node_data_by_element_id(MeshBase &amp;mesh, const MeshBase::const_element_iterator &amp;range_begin, const MeshBase::const_element_iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00459">parallel_ghost_sync.h:459</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab67880939a7d98e9cb3e7a6425a4d7ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::make_node_proc_ids_parallel_consistent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assuming all processor ids on nodes touching local elements are parallel consistent, this function makes all other processor ids parallel consistent as well. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l01156">1156</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end()</a>, <a class="el" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, and <a class="el" href="parallel__ghost__sync_8h_source.html#l00459">libMesh::Parallel::sync_node_data_by_element_id()</a>.</p>

<p>Referenced by <a class="el" href="mesh__tools_8C_source.html#l00979">libMesh::MeshTools::correct_node_proc_ids()</a>.</p>
<div class="fragment"><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;{</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;make_node_proc_ids_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <a class="code" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libmesh_parallel_only</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="comment">// When this function is called, each section of a parallelized mesh</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="comment">// should be in the following state:</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="comment">// All nodes should have the exact same physical location on every</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="comment">// processor where they exist.</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">// Local nodes should have unique authoritative ids,</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">// and processor ids consistent with all processors which own</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="comment">// an element touching them.</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">// Ghost nodes touching local elements should have processor ids</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="comment">// consistent with all processors which own an element touching</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="comment">// them.</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  SyncProcIds sync(mesh);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#acfb509fd5bcfa928f440d52277258d1d">Parallel::sync_node_data_by_element_id</a></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    (mesh, mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">elements_begin</a>(), mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">elements_end</a>(), sync);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;make_node_proc_ids_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac266e1f5eb6ac9566ccbd7e6add6c239"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin</a></div><div class="ttdeci">virtual element_iterator elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae94f1bce0dc50c489c6bae9ba64d06e8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end</a></div><div class="ttdeci">virtual element_iterator elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_aba4e7b024f88416601a12d74a3ca2d26"><div class="ttname"><a href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only</a></div><div class="ttdeci">libmesh_parallel_only(this-&gt;comm())</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_acfb509fd5bcfa928f440d52277258d1d"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#acfb509fd5bcfa928f440d52277258d1d">libMesh::Parallel::sync_node_data_by_element_id</a></div><div class="ttdeci">void sync_node_data_by_element_id(MeshBase &amp;mesh, const MeshBase::const_element_iterator &amp;range_begin, const MeshBase::const_element_iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00459">parallel_ghost_sync.h:459</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e83bbe1c114c9de7be87927f7db9e85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::make_node_unique_ids_parallel_consistent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assuming all unique_ids on local nodes are globally unique, and assuming all processor ids are parallel consistent, this function makes all ghost unique_ids parallel consistent. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l01047">1047</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">libMesh::MeshBase::nodes_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a47575077b6ad40d4f05292634f7615f8">libMesh::MeshBase::nodes_end()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, and <a class="el" href="parallel__ghost__sync_8h_source.html#l00261">libMesh::Parallel::sync_dofobject_data_by_id()</a>.</p>

<p>Referenced by <a class="el" href="boundary__info_8C_source.html#l00319">libMesh::BoundaryInfo::add_elements()</a>, and <a class="el" href="nemesis__io_8C_source.html#l00136">libMesh::Nemesis_IO::read()</a>.</p>
<div class="fragment"><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;{</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libmesh_parallel_only</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_UNIQUE_ID</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;make_node_unique_ids_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  SyncUniqueIds&lt;Node&gt; syncuniqueids(mesh, &amp;<a class="code" href="classlibMesh_1_1MeshBase.html#a88d3228c36aa7b481f0f5d77f95bd021">MeshBase::query_node_ptr</a>);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">Parallel::sync_dofobject_data_by_id</a></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    (mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>(), mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">nodes_begin</a>(), mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#a47575077b6ad40d4f05292634f7615f8">nodes_end</a>(),</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;     syncuniqueids);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;make_node_unique_ids_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a3ab1d28a6ea1e8028ce0c06e11cfb68d"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a3ab1d28a6ea1e8028ce0c06e11cfb68d">libMesh::MeshBase::nodes_begin</a></div><div class="ttdeci">virtual node_iterator nodes_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a88d3228c36aa7b481f0f5d77f95bd021"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a88d3228c36aa7b481f0f5d77f95bd021">libMesh::MeshBase::query_node_ptr</a></div><div class="ttdeci">virtual const Node * query_node_ptr(const dof_id_type i) const =0</div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_ac7d4f06bb34625465942e6b8d10f135e"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">libMesh::Parallel::sync_dofobject_data_by_id</a></div><div class="ttdeci">void sync_dofobject_data_by_id(const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00261">parallel_ghost_sync.h:261</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aba4e7b024f88416601a12d74a3ca2d26"><div class="ttname"><a href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only</a></div><div class="ttdeci">libmesh_parallel_only(this-&gt;comm())</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_a47575077b6ad40d4f05292634f7615f8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#a47575077b6ad40d4f05292634f7615f8">libMesh::MeshBase::nodes_end</a></div><div class="ttdeci">virtual node_iterator nodes_end()=0</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac76dd6bc5f023e8836591ca42a9caa94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::make_nodes_parallel_consistent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy processor_ids and ids on ghost nodes from their local processors. This is an internal function of <a class="el" href="classlibMesh_1_1MeshRefinement.html">MeshRefinement</a> which turns out to be useful for other code which wants to add nodes to a distributed mesh. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l01187">1187</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__tools_8C_source.html#l00979">libMesh::MeshTools::correct_node_proc_ids()</a>, and <a class="el" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only()</a>.</p>

<p>Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01407">libMesh::MeshRefinement::_coarsen_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01529">libMesh::MeshRefinement::_refine_elements()</a>, <a class="el" href="mesh__modification_8C_source.html#l00447">libMesh::UnstructuredMesh::all_second_order()</a>, and <a class="el" href="mesh__modification_8C_source.html#l00740">libMesh::MeshTools::Modification::all_tri()</a>.</p>
<div class="fragment"><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;{</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <a class="code" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libmesh_parallel_only</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="comment">// When this function is called, each section of a parallelized mesh</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">// should be in the following state:</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="comment">// All nodes should have the exact same physical location on every</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="comment">// processor where they exist.</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// Local nodes should have unique authoritative ids,</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="comment">// and processor ids consistent with all processors which own</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">// an element touching them.</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">// Ghost nodes touching local elements should have processor ids</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">// consistent with all processors which own an element touching</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="comment">// them.</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">// Ghost nodes should have ids which are either already correct</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="comment">// or which are in the &quot;unpartitioned&quot; id space.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="comment">// First, let&#39;s sync up processor ids.  Some of these processor ids</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">// may be &quot;wrong&quot; from coarsening, but they&#39;re right in the sense</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// that they&#39;ll tell us who has the authoritative dofobject ids for</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="comment">// each node.</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshCommunication.html#ab67880939a7d98e9cb3e7a6425a4d7ec">make_node_proc_ids_parallel_consistent</a>(mesh);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="comment">// Second, sync up dofobject ids.</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshCommunication.html#ab0eae4e562c489db701776c3970e772b">make_node_ids_parallel_consistent</a>(mesh);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="comment">// Third, sync up dofobject unique_ids if applicable.</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1MeshCommunication.html#a0e83bbe1c114c9de7be87927f7db9e85">make_node_unique_ids_parallel_consistent</a>(mesh);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="comment">// Finally, correct the processor ids to make DofMap happy</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <a class="code" href="namespacelibMesh_1_1MeshTools.html#aca8746be5247c3f44a3b0797b5ed88f0">MeshTools::correct_node_proc_ids</a>(mesh);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1MeshCommunication_html_a0e83bbe1c114c9de7be87927f7db9e85"><div class="ttname"><a href="classlibMesh_1_1MeshCommunication.html#a0e83bbe1c114c9de7be87927f7db9e85">libMesh::MeshCommunication::make_node_unique_ids_parallel_consistent</a></div><div class="ttdeci">void make_node_unique_ids_parallel_consistent(MeshBase &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01047">mesh_communication.C:1047</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1MeshTools_html_aca8746be5247c3f44a3b0797b5ed88f0"><div class="ttname"><a href="namespacelibMesh_1_1MeshTools.html#aca8746be5247c3f44a3b0797b5ed88f0">libMesh::MeshTools::correct_node_proc_ids</a></div><div class="ttdeci">void correct_node_proc_ids(MeshBase &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__tools_8C_source.html#l00979">mesh_tools.C:979</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aba4e7b024f88416601a12d74a3ca2d26"><div class="ttname"><a href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only</a></div><div class="ttdeci">libmesh_parallel_only(this-&gt;comm())</div></div>
<div class="ttc" id="classlibMesh_1_1MeshCommunication_html_ab0eae4e562c489db701776c3970e772b"><div class="ttname"><a href="classlibMesh_1_1MeshCommunication.html#ab0eae4e562c489db701776c3970e772b">libMesh::MeshCommunication::make_node_ids_parallel_consistent</a></div><div class="ttdeci">void make_node_ids_parallel_consistent(MeshBase &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01030">mesh_communication.C:1030</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1MeshCommunication_html_ab67880939a7d98e9cb3e7a6425a4d7ec"><div class="ttname"><a href="classlibMesh_1_1MeshCommunication.html#ab67880939a7d98e9cb3e7a6425a4d7ec">libMesh::MeshCommunication::make_node_proc_ids_parallel_consistent</a></div><div class="ttdeci">void make_node_proc_ids_parallel_consistent(MeshBase &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01156">mesh_communication.C:1156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9eb166973b14e95ae36c14a39105907a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::make_p_levels_parallel_consistent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy p levels of ghost elements from their local processors. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l01093">1093</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end()</a>, <a class="el" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, and <a class="el" href="parallel__ghost__sync_8h_source.html#l00261">libMesh::Parallel::sync_dofobject_data_by_id()</a>.</p>

<p>Referenced by <a class="el" href="mesh__refinement_8C_source.html#l01407">libMesh::MeshRefinement::_coarsen_elements()</a>, and <a class="el" href="mesh__refinement_8C_source.html#l01529">libMesh::MeshRefinement::_refine_elements()</a>.</p>
<div class="fragment"><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;{</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libmesh_parallel_only</a>(mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a> (<span class="stringliteral">&quot;make_p_levels_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  SyncPLevels syncplevels(mesh);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">Parallel::sync_dofobject_data_by_id</a></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    (mesh.<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>(), mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">elements_begin</a>(), mesh.<a class="code" href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">elements_end</a>(),</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;     syncplevels);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a> (<span class="stringliteral">&quot;make_p_levels_parallel_consistent()&quot;</span>, <span class="stringliteral">&quot;MeshCommunication&quot;</span>);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ac266e1f5eb6ac9566ccbd7e6add6c239"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ac266e1f5eb6ac9566ccbd7e6add6c239">libMesh::MeshBase::elements_begin</a></div><div class="ttdeci">virtual element_iterator elements_begin()=0</div></div>
<div class="ttc" id="classlibMesh_1_1MeshBase_html_ae94f1bce0dc50c489c6bae9ba64d06e8"><div class="ttname"><a href="classlibMesh_1_1MeshBase.html#ae94f1bce0dc50c489c6bae9ba64d06e8">libMesh::MeshBase::elements_end</a></div><div class="ttdeci">virtual element_iterator elements_end()=0</div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_ac7d4f06bb34625465942e6b8d10f135e"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">libMesh::Parallel::sync_dofobject_data_by_id</a></div><div class="ttdeci">void sync_dofobject_data_by_id(const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00261">parallel_ghost_sync.h:261</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aba4e7b024f88416601a12d74a3ca2d26"><div class="ttname"><a href="namespacelibMesh.html#aba4e7b024f88416601a12d74a3ca2d26">libMesh::libmesh_parallel_only</a></div><div class="ttdeci">libmesh_parallel_only(this-&gt;comm())</div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a64195de35a3f834f9393aad8b6ca1be2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::MeshCommunication::redistribute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ParallelMesh.html">ParallelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method takes a parallel distributed mesh and redistributes the elements. Specifically, any elements stored on a given processor are sent to the processor which "owns" them. Similarly, any elements assigned to the current processor but stored on another are received. Once this step is completed any required ghost elements are updated. The final result is that each processor stores only the elements it actually owns and any ghost elements required to satisfy data dependencies. This method can be invoked after a partitioning step to affect the new partitioning. </p>

<p>Definition at line <a class="el" href="mesh__communication_8C_source.html#l00164">164</a> of file <a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a>.</p>

<p>Referenced by <a class="el" href="parallel__mesh_8C_source.html#l00850">libMesh::ParallelMesh::redistribute()</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// no MPI == one processor, no redistribution</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="mesh__communication_8h_source.html">mesh_communication.h</a></li>
<li><a class="el" href="mesh__communication_8C_source.html">mesh_communication.C</a></li>
<li><a class="el" href="mesh__communication__global__indices_8C_source.html">mesh_communication_global_indices.C</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
generated by <a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a>
</small></address>
<!-- dynamic header stuff -->
<script type="text/javascript">
$(document).ready(function(){
  $(window).on('scroll',function() {
    var scrolltop = $(this).scrollTop();
    if(scrolltop >= 215) {
      $('#fixedbar').fadeIn(250);
    }
    else if(scrolltop <= 210) {
      $('#fixedbar').fadeOut(250);
    }
  });
});
</script>
<!-- Google Analytics stuff -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24978333-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
